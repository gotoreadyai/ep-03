const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginPage-C8W1JphF.js","assets/radix-ui-Cgpwho7y.js","assets/react-vendor-mGmSsCi4.js","assets/refine-core-DEHLOwib.js","assets/NarrowCol-7sHlIIuA.js","assets/ui-utils-s4wUxX08.js","assets/utils-Cjzj2mLR.js","assets/refine-ui-2CGAdPi0.js","assets/forms-twLHWMUg.js","assets/tables-D-JVthzY.js","assets/RegisterFlow-CTtbwmL0.js","assets/ForgotPasswordPage-CTg2wEoW.js","assets/UpdatePasswordPage-BlkJRkjl.js"])))=>i.map(i=>d[i]);
var Cj=Object.defineProperty;var Tj=(t,s,n)=>s in t?Cj(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var Oi=(t,s,n)=>Tj(t,typeof s!="symbol"?s+"":s,n);import{j as e,S as ec,R as th,I as sh,F as nh,a as ih,P as Aj,C as rh,b as ah,V as _j,c as Pj,d as oh,e as Dj,T as lh,f as Ij,g as ch,h as dh,i as Mj,k as uh,l as Ej,L as mh,m as hh,n as Lj,o as Oj,p as ph,q as Rj,r as $j,s as fh,t as xh,u as gh,v as jh,w as qj,x as yh,y as Fj,z as Cn,A as bh,B as tc,D as sn,E as Ne,G as Bj,H as Uj,J as Vj,K as wh,M as Wj,N as Kj,O as Gj,Q as Hj,U as vh,W as Nh,X as kh,Y as Ga,Z as Qj,_ as Zj,$ as Yj,a0 as Jj,a1 as Xj,a2 as ey,a3 as ty,a4 as sy,a5 as ny,a6 as iy,a7 as ry,a8 as ay,a9 as zh,aa as oy,ab as ly,ac as cy,ad as Md,ae as Sh,af as dy}from"./radix-ui-Cgpwho7y.js";import{k as uy,a as g,e as J,l as V,n as za,d as kr,u as ut,R as te,h as Bi,o as Ha,L as zr,N as Qs,p as sc,O as Ch,B as my}from"./react-vendor-mGmSsCi4.js";import{c as hy,t as W,a as Th,v as py,o as hi,u as ii,b as nc,n as Sr,d as Sa,e as fy,f as Ah,E as xy,g as ic,h as sr,m as Et,i as gy,j as jy,k as Ks,s as Ro,r as yy,l as Ui,p as Fn,q as by,M as Jn,T as wy}from"./utils-Cjzj2mLR.js";import{n as gt,M as rc,d as vy,e as Qa,f as Ue,$ as ie,k as _h,i as Ye,j as jn,I as Za,X as fs,l as Ny,E as Ph,o as Dh,Q as ky,m as zy,p as Sy,D as Cy}from"./refine-core-DEHLOwib.js";import{c as Ty,_ as Ya,k as ys,I as Ay}from"./refine-ui-2CGAdPi0.js";import{t as _y,c as Py,a as Ja,T as $e,Z as nt,A as ae,C as Ed,b as ze,d as yn,G as xl,e as nr,f as Ca,U as Pe,g as bn,h as It,S as wn,i as ir,M as Cr,j as Dy,k as ac,l as Tr,m as Iy,n as ot,o as oc,X as vt,L as lc,B as xe,p as Ar,q as My,r as fa,P as ri,s as lt,u as qe,E as _r,v as Ze,w as Ht,x as Xa,y as Ds,z as xs,F as We,D as Se,H as ye,I as Ih,J as fn,K as Ey,N as dt,W as Pr,O as Ly,Q as Oy,R as rr,V as Ry,Y as $y,_ as Kt,$ as qy,a0 as ai,a1 as st,a2 as Is,a3 as oi,a4 as Ld,a5 as Mh,a6 as Fy,a7 as Eh,a8 as By,a9 as Lh,aa as Oh,ab as ls,ac as Uy,ad as Od,ae as Vy,af as Wy,ag as pi,ah as Ta,ai as es,aj as Dr,ak as Ky,al as Rh,am as Gy,an as Hy,ao as Qy,ap as Rd,aq as Zy,ar as Yy,as as Jy,at as Xy,au as eb,av as tb}from"./ui-utils-s4wUxX08.js";import{R as Re,A as eo,a as Zs,X as wt,Y as ft,C as Mt,T as Be,P as Aa,b as _a,c as cs,B as Ir,d as li,L as $h,e as cc,F as sb,f as nb,g as ib,h as Xn,S as qh,Z as Fh,i as Bh,j as rb,k as ab,l as ob,m as lb,n as cb,o as db,p as ub,q as mb}from"./tables-D-JVthzY.js";import"./forms-twLHWMUg.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();var sa={},$d;function hb(){if($d)return sa;$d=1;var t=uy();return sa.createRoot=t.createRoot,sa.hydrateRoot=t.hydrateRoot,sa}var pb=hb();const fb="https://hqsyimochfcfqahcuprn.supabase.co",xb="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhxc3lpbW9jaGZjZnFhaGN1cHJuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4NjU4NTYsImV4cCI6MjA2OTQ0MTg1Nn0.KutvVrkDKuVyvrYQosU3SI6QrrMnWqDCSZ2E3fhCteI",ue=Ty(fb,xb,{db:{schema:"public"},auth:{persistSession:!0}}),$=(...t)=>_y(Py(t)),gb={invalid_credentials:"Nieprawidłowy email lub hasło.","Invalid login credentials":"Nieprawidłowy email lub hasło.",email_not_confirmed:"Email nie został potwierdzony.","Email not confirmed":"Email nie został potwierdzony.",user_not_found:"Nie znaleziono użytkownika.","User not found":"Nie znaleziono użytkownika.",network_error:"Błąd połączenia z serwerem.","Too many requests":"Zbyt wiele prób. Spróbuj ponownie za chwilę."},jb=t=>{if(!t)return{message:"Nieznany błąd",name:"UnknownError",statusCode:500};const s=t.message||t.error_description||"";for(const[n,i]of Object.entries(gb))if(s.includes(n))return{message:i,name:"LoginError",statusCode:t.code==="invalid_credentials"?401:400};return{message:s||"Błąd logowania",name:"LoginError",statusCode:400}},Uh={login:async(t,s)=>{try{if(!t||!s)return{success:!1,error:"Email i hasło są wymagane"};const{data:n,error:i}=await ue.auth.signInWithPassword({email:t.trim().toLowerCase(),password:s});if(i)return{success:!1,error:jb(i).message};if(!n.session)return{success:!1,error:"Nie udało się utworzyć sesji"};const{data:r}=await ue.from("users").select("role").eq("id",n.user.id).single();return{success:!0,redirectTo:r?.role==="teacher"||r?.role==="admin"?"/teacher/dashboard/overview":r?.role==="student"?"/student/dashboard":"/profiles"}}catch(n){return{success:!1,error:n.message||"Nieznany błąd"}}},loginForRefine:async(t,s)=>{const n=await Uh.login(t,s);return n.success?n:{success:!1,error:{message:n.error,name:"LoginError",statusCode:400}}},checkAuth:async()=>{const{data:{session:t}}=await ue.auth.getSession();return!!t}},yb={user_already_exists:"Konto z tym adresem email już istnieje","User already registered":"Konto z tym adresem email już istnieje","already exists":"Konto z tym adresem email już istnieje",weak_password:"Hasło musi mieć co najmniej 6 znaków","Password should be at least":"Hasło musi mieć co najmniej 6 znaków","Password cannot be longer than 72":"Hasło nie może być dłuższe niż 72 znaki",invalid_email:"Nieprawidłowy format adresu email","Invalid email":"Nieprawidłowy format adresu email",over_email_send_rate_limit:"Za szybko! Poczekaj 2 sekundy przed ponowną próbą"},qd=t=>{if(!t)return{message:"Nieznany błąd",name:"UnknownError",statusCode:500};const s=t.message||"";for(const[n,i]of Object.entries(yb))if(s.includes(n)){let r=400;return n.includes("already")&&(r=409),n.includes("email_send_rate")&&(r=429),{message:i,name:"RegisterError",statusCode:r}}return{message:s||"Rejestracja nie powiodła się",name:"RegisterError",statusCode:400}},Vh={register:async(t,s,n)=>{try{const{data:i,error:r}=await ue.auth.signUp({email:t.trim().toLowerCase(),password:s,options:{data:{full_name:n.trim(),role:"student"},emailRedirectTo:`${window.location.origin}/login?verified=true`}});return r?{success:!1,error:qd(r).message}:i.user?{success:!0,needsEmailConfirmation:!i.session}:{success:!1,error:"Rejestracja nie powiodła się"}}catch(i){return{success:!1,error:i.message||"Błąd rejestracji"}}},registerForRefine:async(t,s,n)=>{const i=await Vh.register(t,s,n);return i.success?{success:!0,successNotification:i.needsEmailConfirmation?{message:"Rejestracja udana!",description:"Sprawdź email aby potwierdzić konto."}:{message:"Rejestracja udana!",description:"Możesz się teraz zalogować."}}:{success:!1,error:qd({message:i.error})}}},bb={"User not found":"Nie znaleziono użytkownika z tym adresem email","Invalid email":"Nieprawidłowy format adresu email",over_email_send_rate_limit:"Za szybko! Poczekaj chwilę przed kolejną próbą",reset_password_rate_limit:"Zbyt wiele prób. Spróbuj ponownie za kilka minut"},Fd=t=>{if(!t)return{message:"Nieznany błąd",name:"UnknownError",statusCode:500};const s=t.message||"";for(const[n,i]of Object.entries(bb))if(s.includes(n))return{message:i,name:"ForgotPasswordError",statusCode:n.includes("rate_limit")?429:400};return{message:s||"Błąd podczas wysyłania emaila",name:"ForgotPasswordError",statusCode:400}},Wh={sendResetEmail:async t=>{try{const{error:s}=await ue.auth.resetPasswordForEmail(t.trim().toLowerCase(),{redirectTo:`${window.location.origin}/update-password`});return s?{success:!1,error:Fd(s).message}:{success:!0}}catch(s){return{success:!1,error:s.message||"Błąd podczas wysyłania emaila"}}},sendResetEmailForRefine:async t=>{const s=await Wh.sendResetEmail(t);return s.success?{success:!0,successNotification:{message:"Email wysłany!",description:"Sprawdź swoją skrzynkę odbiorczą"}}:{success:!1,error:Fd({message:s.error})}}},wb={"New password should be different":"Nowe hasło musi być inne niż obecne","Password should be at least":"Hasło musi mieć co najmniej 6 znaków","Invalid token":"Link wygasł lub jest nieprawidłowy",session_not_found:"Sesja wygasła. Spróbuj ponownie"},Bd=t=>{if(!t)return{message:"Nieznany błąd",name:"UnknownError",statusCode:500};const s=t.message||"";for(const[n,i]of Object.entries(wb))if(s.includes(n))return{message:i,name:"UpdatePasswordError",statusCode:n.includes("token")||n.includes("session")?401:400};return{message:s||"Błąd aktualizacji hasła",name:"UpdatePasswordError",statusCode:400}},Kh={checkSession:async()=>{try{const{data:t}=await ue.auth.getSession(),n=new URLSearchParams(window.location.hash.substring(1)).get("type");return!t.session&&n!=="recovery"?{isValid:!1,error:"Link wygasł lub jest nieprawidłowy"}:{isValid:!0}}catch{return{isValid:!1,error:"Błąd weryfikacji sesji"}}},updatePassword:async t=>{try{const{error:s}=await ue.auth.updateUser({password:t});return s?{success:!1,error:Bd(s).message}:{success:!0}}catch(s){return{success:!1,error:s.message||"Błąd aktualizacji hasła"}}},updatePasswordForRefine:async t=>{const s=await Kh.updatePassword(t);return s.success?{success:!0,redirectTo:"/login?passwordChanged=true"}:{success:!1,error:Bd({message:s.error})}}};class vb{constructor(){Oi(this,"cache",null);Oi(this,"lastFetch",0);Oi(this,"CACHE_DURATION",300*1e3);Oi(this,"fetchPromise",null)}async get(s=!1){const n=Date.now();if(!s&&this.cache&&n-this.lastFetch<this.CACHE_DURATION)return this.cache;if(this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetchUser();const i=await this.fetchPromise;return this.fetchPromise=null,i}async fetchUser(){try{const{data:{session:s}}=await ue.auth.getSession();if(!s?.user)return this.clear(),null;const{data:n,error:i}=await ue.from("users").select("*").eq("id",s.user.id).single();if(i||!n){console.error("Error fetching user data:",i);const a={id:s.user.id,email:s.user.email||"",full_name:s.user.user_metadata?.full_name||s.user.email?.split("@")[0]||"User",vendor_id:1,role:"student"};return this.set(a),a}const r={id:n.id,email:n.email,full_name:n.full_name,vendor_id:n.vendor_id,role:n.role,is_active:n.is_active,created_at:n.created_at};return this.set(r),r}catch(s){return console.error("Error in fetchUser:",s),this.clear(),null}}set(s){this.cache=s,this.lastFetch=Date.now()}clear(){this.cache=null,this.lastFetch=0,this.fetchPromise=null}async refresh(){return this.get(!0)}}const Gs=new vb;ue.auth.onAuthStateChange((t,s)=>{t==="SIGNED_OUT"||!s?Gs.clear():(t==="SIGNED_IN"||t==="TOKEN_REFRESHED")&&Gs.get(!0)});const $o={logout:async()=>{try{Gs.clear();const{error:t}=await ue.auth.signOut();return t?{success:!1,error:{message:"Błąd podczas wylogowania",name:"LogoutError",statusCode:500}}:{success:!0,redirectTo:"/login"}}catch{return{success:!1,error:{message:"Nieoczekiwany błąd podczas wylogowania",name:"LogoutError",statusCode:500}}}},check:async()=>{try{const{data:{session:t}}=await ue.auth.getSession();if(!t)return{authenticated:!1,redirectTo:"/login"};const s=t.expires_at;return s&&s*1e3<Date.now()?{authenticated:!1,redirectTo:"/login"}:{authenticated:!0}}catch{return{authenticated:!1,redirectTo:"/login"}}},handleError:async t=>(console.error("Auth error:",t),t?.statusCode===401?(Gs.clear(),{redirectTo:"/login",logout:!0,error:t}):{error:t})},Nb={login:async({email:t,password:s})=>{const n=await Uh.login(t,s);return n.success&&await Gs.refresh(),n},logout:async()=>await $o.logout(),check:async()=>await $o.check(),getIdentity:async()=>await Gs.get(),getPermissions:async()=>(await Gs.get())?.role||null,register:async({email:t,password:s,name:n})=>await Vh.registerForRefine(t,s,n),forgotPassword:async({email:t})=>await Wh.sendResetEmailForRefine(t),updatePassword:async({password:t})=>{const s=await Kh.updatePasswordForRefine(t);return s.success&&await Gs.clear(),s},onError:async t=>await $o.handleError(t)},to=({isLoading:t,isError:s,loadingText:n="Loading...",errorMsg:i="Error loading data"})=>t?e.jsx("div",{className:"p-6 text-gray-600 animate-reverse-pulse",children:n}):s?e.jsx("div",{className:"p-6 text-red-500",children:i}):null;function kb(t,s){let n;try{n=t()}catch{return}return{getItem:r=>{var a;const o=c=>c===null?null:JSON.parse(c,void 0),l=(a=n.getItem(r))!=null?a:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,a)=>n.setItem(r,JSON.stringify(a,void 0)),removeItem:r=>n.removeItem(r)}}const gl=t=>s=>{try{const n=t(s);return n instanceof Promise?n:{then(i){return gl(i)(n)},catch(i){return this}}}catch(n){return{then(i){return this},catch(i){return gl(i)(n)}}}},zb=(t,s)=>(n,i,r)=>{let a={storage:kb(()=>localStorage),partialize:f=>f,version:0,merge:(f,x)=>({...x,...f}),...s},o=!1;const l=new Set,c=new Set;let d=a.storage;if(!d)return t((...f)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),n(...f)},i,r);const m=()=>{const f=a.partialize({...i()});return d.setItem(a.name,{state:f,version:a.version})},u=r.setState;r.setState=(f,x)=>{u(f,x),m()};const h=t((...f)=>{n(...f),m()},i,r);r.getInitialState=()=>h;let p;const b=()=>{var f,x;if(!d)return;o=!1,l.forEach(y=>{var N;return y((N=i())!=null?N:h)});const w=((x=a.onRehydrateStorage)==null?void 0:x.call(a,(f=i())!=null?f:h))||void 0;return gl(d.getItem.bind(d))(a.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==a.version){if(a.migrate){const N=a.migrate(y.state,y.version);return N instanceof Promise?N.then(A=>[!0,A]):[!0,N]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var N;const[A,S]=y;if(p=a.merge(S,(N=i())!=null?N:h),n(p,!0),A)return m()}).then(()=>{w?.(p,void 0),p=i(),o=!0,c.forEach(y=>y(p))}).catch(y=>{w?.(void 0,y)})};return r.persist={setOptions:f=>{a={...a,...f},f.storage&&(d=f.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>b(),hasHydrated:()=>o,onHydrate:f=>(l.add(f),()=>{l.delete(f)}),onFinishHydration:f=>(c.add(f),()=>{c.delete(f)})},a.skipHydration||b(),p||h},Sb=zb;class Cb{static async call(s,n,i={}){const a={message:this.interpolateTemplate(n.user,i),...n.system&&{system:n.system},...s.model&&{model:s.model}},o=await fetch(s.endpoint,{method:"POST",headers:{"Content-Type":"application/json",...s.apiKey&&{Authorization:`Bearer ${s.apiKey}`}},body:JSON.stringify(a)});let l;try{l=await o.json()}catch{throw new Error(`LLM API Error: ${o.status} ${o.statusText}`)}if(!o.ok||l.error){const d=l.message||l.error||"Nieznany błąd",m=l.suggestion?` ${l.suggestion}`:"";throw new Error(`${d}${m}`)}const c=l.response||l;return n.responseFormat==="json"?this.parseJsonResponse(c):c}static interpolateTemplate(s,n){return s.replace(/\{\{(\w+)\}\}/g,(i,r)=>n[r]!==void 0?String(n[r]):i)}static cleanJsonResponse(s){let n=s;return n=n.replace(/```json\s*\n?([\s\S]*?)\n?```/g,"$1"),n=n.replace(/```\s*\n?([\s\S]*?)\n?```/g,"$1"),n.trim()}static parseJsonResponse(s){const n=this.cleanJsonResponse(s);try{return JSON.parse(n)}catch{try{const r=n.replace(/\\(\d+)\./g,"$1.");return JSON.parse(r)}catch{const a=s.match(/\{[\s\S]*\}/);if(a)try{const o=a[0].replace(/\\(\d+)\./g,"$1.");return JSON.parse(o)}catch{throw console.error("Failed to parse JSON response:",s),new Error("Nie udało się przetworzyć odpowiedzi JSON z API")}throw console.error("Failed to parse JSON response:",s),new Error("Nie udało się przetworzyć odpowiedzi JSON z API")}}}}const Ke=hy()(Sb((t,s)=>({processes:{},formData:{},llmOperations:{},registeredLLMOperations:{},register:n=>t(i=>({processes:{...i.processes,[n.id]:n}})),unregister:(n,i="all")=>t(r=>{switch(i){case"all":{const{[n]:a,...o}=r.processes,{[n]:l,...c}=r.formData,d=Object.keys(r.llmOperations).filter(u=>!u.startsWith(`${n}-`)).reduce((u,h)=>(u[h]=r.llmOperations[h],u),{}),m=Object.keys(r.registeredLLMOperations).filter(u=>!u.startsWith(`${n}-`)).reduce((u,h)=>(u[h]=r.registeredLLMOperations[h],u),{});return{processes:o,formData:c,llmOperations:d,registeredLLMOperations:m}}case"data":{const{[n]:a,...o}=r.formData;return{...r,formData:o}}default:return r}}),get:n=>s().processes[n]||null,getSchemaFragment:n=>{const[i,...r]=n.split("."),a=s().processes[i];if(!a)return null;let o=a.schema;for(const l of r)o=o?.[l];return o},setData:(n,i)=>t(r=>({formData:{...r.formData,[n]:{...r.formData[n],...i}}})),getData:n=>s().formData[n]||{},reset:n=>t(i=>({formData:{...i.formData,[n]:{}}})),registerLLMOperation:(n,i)=>t(r=>({registeredLLMOperations:{...r.registeredLLMOperations,[`${n}-${i.id}`]:i}})),unregisterLLMOperation:(n,i)=>t(r=>{const{[`${n}-${i}`]:a,...o}=r.registeredLLMOperations;return{registeredLLMOperations:o}}),executeLLMOperation:async(n,i,r={})=>{const a=`${n}-${i}`,o=s().registeredLLMOperations[a];if(!o)throw new Error(`LLM Operation not found: ${a}`);try{s().setLLMOperationState(n,i,{loading:!0,error:null});const l=s().getData(n),c={...l,...r},d=o.inputMapping?o.inputMapping(c):c,m=await Cb.call(o.config,o.prompt,d);if(o.validation&&!o.validation(m))throw new Error("LLM result failed validation");let u=m;return o.outputMapping&&(u=o.outputMapping(m,l),s().setData(n,u)),s().setLLMOperationState(n,i,{loading:!1,error:null,result:m}),m}catch(l){throw s().setLLMOperationState(n,i,{loading:!1,error:l.message||"Unknown error",result:null}),l}},setLLMOperationState:(n,i,r)=>t(a=>({llmOperations:{...a.llmOperations,[`${n}-${i}`]:r}})),getLLMOperationState:(n,i)=>s().llmOperations[`${n}-${i}`]||{loading:!1,error:null},clearLLMOperation:(n,i)=>t(r=>{const{[`${n}-${i}`]:a,...o}=r.llmOperations;return{llmOperations:o}})}),{name:"form-schema-store",version:2,partialize:t=>({processes:t.processes,formData:t.formData})})),Tn=(t,s)=>{const{registerLLMOperation:n,unregisterLLMOperation:i,executeLLMOperation:r,getLLMOperationState:a,clearLLMOperation:o}=Ke();return{...a(t,s),registerOperation:h=>{n(t,h)},executeOperation:async h=>await r(t,s,h),clearOperation:()=>{o(t,s)},unregisterOperation:()=>{i(t,s)}}},Tb=Ja("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),I=g.forwardRef(({className:t,variant:s,size:n,asChild:i=!1,...r},a)=>{const o=i?ec:"button";return e.jsx(o,{className:$(Tb({variant:s,size:n,className:t})),ref:a,...r})});I.displayName="Button";const Q=g.forwardRef(({className:t,type:s,...n},i)=>e.jsx("input",{type:s,className:$("flex h-9 w-full rounded-md border border-input bg-background px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:i,...n}));Q.displayName="Input";const Ab=Ja("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function H({className:t,variant:s,asChild:n=!1,...i}){const r=n?ec:"span";return e.jsx(r,{"data-slot":"badge",className:$(Ab({variant:s}),t),...i})}const _b=()=>{const t=J(),[s,n]=g.useState(0),[i,r]=g.useState("");g.useEffect(()=>{const o=()=>n(window.scrollY);return window.addEventListener("scroll",o),()=>window.removeEventListener("scroll",o)},[]);const a=[{name:"Sty",value:65},{name:"Lut",value:72},{name:"Mar",value:78},{name:"Kwi",value:85},{name:"Maj",value:88},{name:"Cze",value:94}];return e.jsxs("div",{className:"min-h-screen bg-white text-foreground",children:[e.jsx("nav",{className:"fixed top-0 w-full z-50 bg-white/80 backdrop-blur-xl border-b border-gray-100",children:e.jsx("div",{className:"container mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-600 to-purple-700 rounded-xl flex items-center justify-center",children:e.jsx($e,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-xl font-bold",children:"Smart Up"})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-8",children:[e.jsx("a",{href:"#funkcje",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Funkcje"}),e.jsx("a",{href:"#kursy",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Kursy"}),e.jsx("a",{href:"#firma",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Dla firm"}),e.jsx("a",{href:"#cennik",className:"text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Cennik"}),e.jsx(I,{className:"bg-gray-900 hover:bg-gray-800 text-white text-sm px-6",onClick:()=>t("/login"),children:"Rozpocznij"})]})]})})}),e.jsx("section",{className:"pt-32 pb-20 overflow-hidden",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"grid lg:grid-cols-12 gap-8 items-center",children:[e.jsxs("div",{className:"lg:col-span-5",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-50 rounded-full mb-8",children:[e.jsx(nt,{className:"w-4 h-4 text-purple-700"}),e.jsx("span",{className:"text-sm font-medium text-purple-700",children:"Gamifikacja w edukacji"})]}),e.jsxs("h1",{className:"text-5xl md:text-6xl font-bold leading-tight mb-6",children:["Nauka, która",e.jsx("span",{className:"block text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"motywuje"})]}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 leading-relaxed",children:"Przekształć edukację w angażującą przygodę. System poziomów, punktów i nagród sprawia, że nauka staje się uzależniająca."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-12",children:[e.jsxs(I,{size:"lg",className:"bg-gray-900 hover:bg-gray-800 text-white px-8",onClick:()=>t("/login"),children:["Zacznij za darmo",e.jsx(ae,{className:"ml-2 h-4 w-4"})]}),e.jsx(I,{size:"lg",variant:"outline",className:"border-gray-300",children:"Zobacz demo"})]}),e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:"15k+"}),e.jsx("div",{className:"text-sm text-gray-500",children:"aktywnych uczniów"})]}),e.jsx("div",{className:"w-px h-12 bg-gray-200"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:"92%"}),e.jsx("div",{className:"text-sm text-gray-500",children:"ukończalność"})]}),e.jsx("div",{className:"w-px h-12 bg-gray-200"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:"4.9"}),e.jsx("div",{className:"text-sm text-gray-500",children:"ocena"})]})]})]}),e.jsx("div",{className:"lg:col-span-7",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-4 bg-gradient-to-r from-pink-600/5 to-purple-700/5 rounded-3xl blur-2xl"}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-pink-600 to-purple-700 rounded-lg flex items-center justify-center",children:e.jsx($e,{className:"w-4 h-4 text-white"})}),e.jsx("span",{className:"font-semibold",children:"Dashboard ucznia"})]}),e.jsx(H,{className:"bg-green-50 text-green-700 border-green-200",children:"Online"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-pink-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Ed,{className:"w-5 h-5 text-pink-600"}),e.jsx("span",{className:"text-xs text-gray-500",children:"+125"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"1,842"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Punkty XP"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ze,{className:"w-5 h-5 text-purple-700"}),e.jsx("span",{className:"text-xs text-gray-500",children:"75%"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"Lvl 12"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Poziom"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-teal-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(yn,{className:"w-5 h-5 text-teal-600"}),e.jsx("span",{className:"text-xs text-gray-500",children:"New!"})]}),e.jsx("div",{className:"text-2xl font-bold",children:"24"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Odznaki"})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-sm font-medium",children:"Postęp nauki"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Ostatnie 6 miesięcy"})]}),e.jsx(Re,{width:"100%",height:120,children:e.jsxs(eo,{data:a,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorProgress",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#db2777",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#db2777",stopOpacity:0})]})}),e.jsx(Zs,{type:"monotone",dataKey:"value",stroke:"#db2777",strokeWidth:2,fill:"url(#colorProgress)"}),e.jsx(wt,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fontSize:11}}),e.jsx(ft,{hide:!0})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Aktywne kursy"}),e.jsx("a",{href:"#",className:"text-purple-700 hover:underline",children:"Zobacz wszystkie"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-pink-600 to-purple-700 rounded-lg flex items-center justify-center",children:e.jsx(xl,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:"JavaScript: Gra w kodowanie"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Rozdział 4 z 12"})]})]}),e.jsx(nr,{className:"w-4 h-4 text-gray-400"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-teal-500 to-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(Ca,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:"Analiza danych: Quest"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Rozdział 7 z 10"})]})]}),e.jsx(nr,{className:"w-4 h-4 text-gray-400"})]})]})]})]})]})]})})]})})}),e.jsx("section",{id:"funkcje",className:"py-20 bg-gray-50",children:e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsxs("h2",{className:"text-4xl font-bold mb-4",children:["Funkcje, które"," ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"angażują"})]}),e.jsx("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"System zaprojektowany, aby uczynić naukę uzależniającą jak najlepsza gra"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-pink-600/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-pink-600 to-purple-700 rounded-2xl flex items-center justify-center mb-6",children:e.jsx($e,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"System poziomów"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"99 poziomów do zdobycia. Każdy poziom odblokowuje nowe możliwości i nagrody."}),e.jsxs("div",{className:"flex items-center text-sm text-pink-600 font-medium",children:["Dowiedz się więcej",e.jsx(ae,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-700/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-700 to-teal-500 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(Ed,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Idle Points"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Zdobywaj punkty nawet gdy nie uczysz się aktywnie. System pasywnego rozwoju."}),e.jsxs("div",{className:"flex items-center text-sm text-purple-700 font-medium",children:["Dowiedz się więcej",e.jsx(ae,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-teal-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-teal-500 to-blue-600 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(ze,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Wyzwania"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Codzienne i tygodniowe wyzwania z dodatkowymi nagrodami za ukończenie."}),e.jsxs("div",{className:"flex items-center text-sm text-teal-600 font-medium",children:["Dowiedz się więcej",e.jsx(ae,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-orange-500 to-yellow-500 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(Pe,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Rankingi"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Rywalizuj z innymi uczniami. Rankingi globalne, lokalne i grupowe."}),e.jsxs("div",{className:"flex items-center text-sm text-orange-600 font-medium",children:["Dowiedz się więcej",e.jsx(ae,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-700/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-700 to-pink-600 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(yn,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Odznaki"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Kolekcjonuj unikalne odznaki za osiągnięcia i kamienie milowe."}),e.jsxs("div",{className:"flex items-center text-sm text-purple-700 font-medium",children:["Dowiedz się więcej",e.jsx(ae,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]}),e.jsxs("div",{className:"group relative bg-white rounded-2xl p-8 hover:shadow-lg transition-all duration-300 cursor-pointer border border-gray-100",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-teal-500/5 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-teal-500 to-purple-700 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(Ca,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3",children:"Analityka"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Szczegółowe statystyki postępów i personalizowane rekomendacje."}),e.jsxs("div",{className:"flex items-center text-sm text-teal-600 font-medium",children:["Dowiedz się więcej",e.jsx(ae,{className:"w-4 h-4 ml-2 transform group-hover:translate-x-1 transition-transform"})]})]})]})]})]})}),e.jsx("section",{className:"py-20 bg-white",children:e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("div",{className:"max-w-3xl mx-auto text-center mb-16",children:[e.jsxs("h2",{className:"text-4xl font-bold mb-4",children:["Jak to"," ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"działa"})]}),e.jsx("p",{className:"text-lg text-gray-600",children:"Cztery proste kroki do rozpoczęcia nauki z gamifikacją"})]}),e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 top-0 bottom-0 w-0.5 bg-gray-200"}),e.jsx("div",{className:"space-y-12",children:[{number:"01",title:"Stwórz profil",description:"Wybierz swoją rolę i spersonalizuj doświadczenie nauki",icon:Pe,color:"from-pink-600 to-purple-700"},{number:"02",title:"Wybierz kursy",description:"Przeglądaj bibliotekę kursów i wybierz te, które Cię interesują",icon:bn,color:"from-purple-700 to-teal-500"},{number:"03",title:"Ucz się i graj",description:"Rozwiązuj quizy, zdobywaj punkty i awansuj na kolejne poziomy",icon:xl,color:"from-teal-500 to-blue-600"},{number:"04",title:"Śledź postępy",description:"Monitoruj swoje osiągnięcia i rywalizuj z innymi",icon:It,color:"from-orange-500 to-yellow-500"}].map((o,l)=>e.jsx("div",{className:"relative",children:e.jsxs("div",{className:`flex items-center ${l%2===0?"flex-row":"flex-row-reverse"}`,children:[e.jsxs("div",{className:`w-5/12 ${l%2===0?"text-right pr-8":"text-left pl-8"}`,children:[e.jsxs("div",{className:`inline-flex items-center gap-4 mb-2 ${l%2===0?"flex-row-reverse":""}`,children:[e.jsx("h3",{className:"text-2xl font-bold",children:o.title}),e.jsx("span",{className:"text-4xl font-bold text-gray-200",children:o.number})]}),e.jsx("p",{className:"text-gray-600 text-lg",children:o.description})]}),e.jsx("div",{className:"w-2/12 flex justify-center",children:e.jsx("div",{className:`relative z-10 w-16 h-16 bg-gradient-to-br ${o.color} rounded-2xl flex items-center justify-center shadow-lg`,children:e.jsx(o.icon,{className:"w-8 h-8 text-white"})})}),e.jsx("div",{className:"w-5/12"})]})},l))})]})})]})}),e.jsx("section",{className:"py-20 bg-gradient-to-br from-gray-900 to-gray-800",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsx("div",{className:"grid md:grid-cols-4 gap-8",children:[{value:"15k+",label:"Aktywnych uczniów",icon:Pe},{value:"200+",label:"Kursów",icon:bn},{value:"92%",label:"Ukończalność",icon:ze},{value:"4.9/5",label:"Ocena",icon:wn}].map((o,l)=>e.jsxs("div",{className:"text-center",children:[e.jsx(o.icon,{className:"w-8 h-8 mx-auto mb-4 text-white/60"}),e.jsx("div",{className:"text-4xl font-bold text-white mb-2",children:o.value}),e.jsx("div",{className:"text-sm text-white/60",children:o.label})]},l))})})}),e.jsx("section",{className:"py-20 bg-white",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsxs("h2",{className:"text-4xl font-bold mb-6",children:["Gotowy na naukę, która"," ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-pink-600 to-purple-700",children:"wciąga"}),"?"]}),e.jsx("p",{className:"text-lg text-gray-600 mb-8 max-w-2xl mx-auto",children:"Dołącz do tysięcy uczniów, którzy odkryli radość z nauki dzięki gamifikacji. Pierwsze 30 dni gratis."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8",children:[e.jsx(Q,{type:"email",placeholder:"twoj@email.pl",value:i,onChange:o=>r(o.target.value),className:"max-w-xs h-12"}),e.jsxs(I,{size:"lg",className:"bg-gradient-to-r from-pink-600 to-purple-700 hover:opacity-90 text-white px-8 h-12",onClick:()=>t("/login"),children:["Rozpocznij za darmo",e.jsx(ae,{className:"ml-2 h-4 w-4"})]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Bez karty kredytowej • Anuluj w każdej chwili • Pełny dostęp"})]})})}),e.jsx("footer",{className:"bg-gray-900 text-white py-12",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-white/10 rounded-lg flex items-center justify-center",children:e.jsx($e,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-lg font-bold",children:"Smart Up"})]}),e.jsx("div",{className:"text-sm text-white/60",children:"© 2025 Smart Up. Wszystkie prawa zastrzeżone."})]})})})]})};console.log("1. Login index.tsx - ładowanie modułu");const Pb=g.lazy(()=>(console.log("2. Login - rozpoczęcie lazy load"),Ya(()=>import("./LoginPage-C8W1JphF.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(t=>(console.log("3. Login - moduł załadowany",t),t)))),Db=()=>(console.log("4. Login - renderowanie fallback"),e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Ładowanie logowania..."})]})})),Gh=e.jsx(V,{path:"/login",element:e.jsx(g.Suspense,{fallback:e.jsx(Db,{}),children:e.jsx(Pb,{})})});console.log("5. Login module exported",Gh);const Ib=g.lazy(()=>Ya(()=>import("./RegisterFlow-CTtbwmL0.js"),__vite__mapDeps([10,1,2,3,5,4,6,7,8,9]))),Mb=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Przygotowywanie rejestracji..."})]})}),Eb=e.jsx(V,{path:"/register/*",element:e.jsx(g.Suspense,{fallback:e.jsx(Mb,{}),children:e.jsx(Ib,{})})}),Lb=g.lazy(()=>Ya(()=>import("./ForgotPasswordPage-CTg2wEoW.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9]))),Ob=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Ładowanie formularza resetowania..."})]})}),Rb=e.jsx(V,{path:"/forgot-password",element:e.jsx(g.Suspense,{fallback:e.jsx(Ob,{}),children:e.jsx(Lb,{})})}),$b=g.lazy(()=>Ya(()=>import("./UpdatePasswordPage-BlkJRkjl.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9]))),qb=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Weryfikacja linku resetowania..."})]})}),Fb=e.jsx(V,{path:"/update-password",element:e.jsx(g.Suspense,{fallback:e.jsx(qb,{}),children:e.jsx($b,{})})}),ar=g.forwardRef(({className:t,...s},n)=>e.jsx(th,{ref:n,className:$("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...s}));ar.displayName=th.displayName;const Bb=g.forwardRef(({className:t,...s},n)=>e.jsx(sh,{ref:n,className:$("aspect-square h-full w-full object-cover",t),...s}));Bb.displayName=sh.displayName;const or=g.forwardRef(({className:t,...s},n)=>e.jsx(nh,{ref:n,className:$("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...s}));or.displayName=nh.displayName;function cn({className:t,...s}){return e.jsx("div",{className:$("animate-pulse rounded-md bg-primary/10",t),...s})}const Ub=({className:t="",showRole:s=!0,showEmail:n=!0,compact:i=!1})=>{const{data:r,isLoading:a,error:o}=gt(),l=h=>{switch(h){case"admin":return e.jsx(ac,{className:"h-3 w-3"});case"teacher":return e.jsx(Dy,{className:"h-3 w-3"});case"student":return e.jsx(bn,{className:"h-3 w-3"});default:return e.jsx(ir,{className:"h-3 w-3"})}},c=h=>{switch(h){case"admin":return"Administrator";case"teacher":return"Nauczyciel";case"student":return"Uczeń";default:return"Użytkownik"}},d=h=>{switch(h){case"admin":return"text-purple-600 bg-purple-50";case"teacher":return"text-blue-600 bg-blue-50";case"student":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}};if(a)return e.jsxs("div",{className:`flex items-center space-x-3 p-3 ${t}`,children:[e.jsx(cn,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(cn,{className:"h-4 w-28"}),e.jsx(cn,{className:"h-3 w-20"}),s&&e.jsx(cn,{className:"h-3 w-16"})]})]});if(o||!r)return e.jsxs("div",{className:`flex items-center space-x-3 p-3 text-muted-foreground ${t}`,children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(ir,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-gray-500",children:"Nie zalogowano"}),e.jsx("div",{className:"text-xs opacity-70",children:"Brak danych użytkownika"})]})]});const u=(h=>{if(!h)return"U";const p=h.trim().split(" ");return p.length>=2?`${p[0][0]}${p[p.length-1][0]}`.toUpperCase():h.slice(0,2).toUpperCase()})(r.full_name||r.email);return i?e.jsxs("div",{className:`flex items-center space-x-2 p-2 ${t}`,children:[e.jsx(ar,{className:"h-8 w-8",children:e.jsx(or,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white text-xs",children:u})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"font-medium text-sm truncate",children:r.full_name})})]}):e.jsxs("div",{className:`flex items-center space-x-3 px-4 pt-4 rounded-lg bg-white/50 backdrop-blur-sm border border-purple-100/20 ${t}`,children:[e.jsx(ar,{className:"h-12 w-12 ring-2 ring-purple-100 ring-offset-2",children:e.jsx(or,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white font-medium",children:u})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 truncate",title:r.full_name,children:r.full_name}),n&&r.email&&e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-500",children:[e.jsx(Cr,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",title:r.email,children:r.email})]}),s&&r.role&&e.jsx("div",{className:"inline-flex items-center gap-1.5",children:e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full text-xs font-medium ${d(r.role)}`,children:[l(r.role),c(r.role)]})})]})]})},Vb=Ja("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ge=g.forwardRef(({className:t,variant:s,...n},i)=>e.jsx("div",{ref:i,role:"alert",className:$(Vb({variant:s}),t),...n}));ge.displayName="Alert";const Wb=g.forwardRef(({className:t,...s},n)=>e.jsx("h5",{ref:n,className:$("mb-1 font-medium leading-none tracking-tight",t),...s}));Wb.displayName="AlertTitle";const je=g.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:$("text-sm [&_p]:leading-relaxed",t),...s}));je.displayName="AlertDescription";const Kb=g.forwardRef(({...t},s)=>e.jsx("nav",{ref:s,"aria-label":"breadcrumb",...t}));Kb.displayName="Breadcrumb";const Gb=g.forwardRef(({className:t,...s},n)=>e.jsx("ol",{ref:n,className:$("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",t),...s}));Gb.displayName="BreadcrumbList";const Hb=g.forwardRef(({className:t,...s},n)=>e.jsx("li",{ref:n,className:$("inline-flex items-center gap-1.5",t),...s}));Hb.displayName="BreadcrumbItem";const Qb=g.forwardRef(({asChild:t,className:s,...n},i)=>{const r=t?ec:"a";return e.jsx(r,{ref:i,className:$("transition-colors hover:text-foreground",s),...n})});Qb.displayName="BreadcrumbLink";const Zb=g.forwardRef(({className:t,...s},n)=>e.jsx("span",{ref:n,role:"link","aria-disabled":"true","aria-current":"page",className:$("font-normal text-foreground",t),...s}));Zb.displayName="BreadcrumbPage";const _=g.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:$("rounded-xl border bg-card text-card-foreground shadow flex flex-col overflow-hidden",t),...s}));_.displayName="Card";const O=g.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:$("flex flex-col space-y-1.5 p-6 pb-3 bg-pink-200/25",t),...s}));O.displayName="CardHeader";const L=g.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:$("text-lg font-semibold leading-tight tracking-tight pt-3",t),...s}));L.displayName="CardTitle";const Me=g.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:$("text-sm text-muted-foreground",t),...s}));Me.displayName="CardDescription";const P=g.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:$("p-3 lg:p-6 pt-3 space-y-3 flex-1 bg-background",t),...s}));P.displayName="CardContent";const Yb=g.forwardRef(({className:t,...s},n)=>e.jsx("div",{ref:n,className:$("flex items-center justify-between p-6 pt-0",t),...s}));Yb.displayName="CardFooter";const Jb=Ja("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),re=g.forwardRef(({className:t,...s},n)=>e.jsx(ih,{ref:n,className:$(Jb(),t),...s}));re.displayName=ih.displayName;g.createContext({});g.createContext({});const Xb=g.forwardRef(({className:t,align:s="center",sideOffset:n=4,...i},r)=>e.jsx(Aj,{children:e.jsx(rh,{ref:r,align:s,sideOffset:n,className:$("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",t),...i})}));Xb.displayName=rh.displayName;const dc=g.forwardRef(({className:t,children:s,...n},i)=>e.jsxs(ah,{ref:i,className:$("relative overflow-hidden",t),...n,children:[e.jsx(_j,{className:"h-full w-full rounded-[inherit]",children:s}),e.jsx(Hh,{}),e.jsx(Pj,{})]}));dc.displayName=ah.displayName;const Hh=g.forwardRef(({className:t,orientation:s="vertical",...n},i)=>e.jsx(oh,{ref:i,orientation:s,className:$("flex touch-none select-none transition-colors",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:e.jsx(Dj,{className:"relative flex-1 rounded-full bg-border"})}));Hh.displayName=oh.displayName;const me=Rj,he=$j,ce=g.forwardRef(({className:t,children:s,...n},i)=>e.jsxs(lh,{ref:i,className:$("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[s,e.jsx(Ij,{asChild:!0,children:e.jsx(Tr,{className:"h-4 w-4 opacity-50"})})]}));ce.displayName=lh.displayName;const Qh=g.forwardRef(({className:t,...s},n)=>e.jsx(ch,{ref:n,className:$("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Iy,{className:"h-4 w-4"})}));Qh.displayName=ch.displayName;const Zh=g.forwardRef(({className:t,...s},n)=>e.jsx(dh,{ref:n,className:$("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Tr,{className:"h-4 w-4"})}));Zh.displayName=dh.displayName;const de=g.forwardRef(({className:t,children:s,position:n="popper",...i},r)=>e.jsx(Mj,{children:e.jsxs(uh,{ref:r,className:$("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...i,children:[e.jsx(Qh,{}),e.jsx(Ej,{className:$("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(Zh,{})]})}));de.displayName=uh.displayName;const e0=g.forwardRef(({className:t,...s},n)=>e.jsx(mh,{ref:n,className:$("px-2 py-1.5 text-sm font-semibold",t),...s}));e0.displayName=mh.displayName;const B=g.forwardRef(({className:t,children:s,...n},i)=>e.jsxs(hh,{ref:i,className:$("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Lj,{children:e.jsx(ot,{className:"h-4 w-4"})})}),e.jsx(Oj,{children:s})]}));B.displayName=hh.displayName;const t0=g.forwardRef(({className:t,...s},n)=>e.jsx(ph,{ref:n,className:$("-mx-1 my-1 h-px bg-muted",t),...s}));t0.displayName=ph.displayName;const fi=g.forwardRef(({className:t,orientation:s="horizontal",decorative:n=!0,...i},r)=>e.jsx(fh,{ref:r,decorative:n,orientation:s,className:$("shrink-0 bg-border",s==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...i}));fi.displayName=fh.displayName;function so({className:t,...s}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:$("w-full caption-bottom text-sm",t),...s})})}function no({className:t,...s}){return e.jsx("thead",{"data-slot":"table-header",className:$("[&_tr]:border-b",t),...s})}function io({className:t,...s}){return e.jsx("tbody",{"data-slot":"table-body",className:$("[&_tr:last-child]:border-0",t),...s})}function Ys({className:t,...s}){return e.jsx("tr",{"data-slot":"table-row",className:$("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...s})}function Le({className:t,...s}){return e.jsx("th",{"data-slot":"table-head",className:$("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}function Oe({className:t,...s}){return e.jsx("td",{"data-slot":"table-cell",className:$("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}const Nt=g.forwardRef(({className:t,...s},n)=>e.jsx("textarea",{className:$("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...s}));Nt.displayName="Textarea";const uc=qj,ro=g.forwardRef(({className:t,...s},n)=>e.jsx(xh,{ref:n,className:$("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...s}));ro.displayName=xh.displayName;const Ft=g.forwardRef(({className:t,...s},n)=>e.jsx(gh,{ref:n,className:$("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...s}));Ft.displayName=gh.displayName;const Bt=g.forwardRef(({className:t,...s},n)=>e.jsx(jh,{ref:n,className:$("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s}));Bt.displayName=jh.displayName;const Xt=g.forwardRef(({className:t,...s},n)=>e.jsx(yh,{ref:n,className:$("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:e.jsx(Fj,{className:$("flex items-center justify-center text-current"),children:e.jsx(ot,{className:"h-4 w-4"})})}));Xt.displayName=yh.displayName;var ao="Switch",[s0,aP]=tc(ao),[n0,i0]=s0(ao),Yh=g.forwardRef((t,s)=>{const{__scopeSwitch:n,name:i,checked:r,defaultChecked:a,required:o,disabled:l,value:c="on",onCheckedChange:d,form:m,...u}=t,[h,p]=g.useState(null),b=Cn(s,N=>p(N)),f=g.useRef(!1),x=h?m||!!h.closest("form"):!0,[w,y]=bh({prop:r,defaultProp:a??!1,onChange:d,caller:ao});return e.jsxs(n0,{scope:n,checked:w,disabled:l,children:[e.jsx(sn.button,{type:"button",role:"switch","aria-checked":w,"aria-required":o,"data-state":tp(w),"data-disabled":l?"":void 0,disabled:l,value:c,...u,ref:b,onClick:Ne(t.onClick,N=>{y(A=>!A),x&&(f.current=N.isPropagationStopped(),f.current||N.stopPropagation())})}),x&&e.jsx(ep,{control:h,bubbles:!f.current,name:i,value:c,checked:w,required:o,disabled:l,form:m,style:{transform:"translateX(-100%)"}})]})});Yh.displayName=ao;var Jh="SwitchThumb",Xh=g.forwardRef((t,s)=>{const{__scopeSwitch:n,...i}=t,r=i0(Jh,n);return e.jsx(sn.span,{"data-state":tp(r.checked),"data-disabled":r.disabled?"":void 0,...i,ref:s})});Xh.displayName=Jh;var r0="SwitchBubbleInput",ep=g.forwardRef(({__scopeSwitch:t,control:s,checked:n,bubbles:i=!0,...r},a)=>{const o=g.useRef(null),l=Cn(o,a),c=Bj(n),d=Uj(s);return g.useEffect(()=>{const m=o.current;if(!m)return;const u=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(u,"checked").set;if(c!==n&&p){const b=new Event("click",{bubbles:i});p.call(m,n),m.dispatchEvent(b)}},[c,n,i]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...r,tabIndex:-1,ref:l,style:{...r.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ep.displayName=r0;function tp(t){return t?"checked":"unchecked"}var sp=Yh,a0=Xh;const ss=g.forwardRef(({className:t,...s},n)=>e.jsx(sp,{className:$("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...s,ref:n,children:e.jsx(a0,{className:$("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));ss.displayName=sp.displayName;const Cs=Wj,Ts=Kj,As=Gj,os=g.forwardRef(({className:t,sideOffset:s=4,...n},i)=>e.jsx(Vj,{children:e.jsx(wh,{ref:i,sideOffset:s,className:$("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...n})}));os.displayName=wh.displayName;const o0=({onClose:t})=>{const{mutate:s}=rc(),{menuItems:n}=vy(),{data:i}=gt(),r=()=>{t&&t()};return e.jsxs("div",{className:"flex h-full w-64 flex-col border-r bg-background",children:[e.jsxs("div",{className:"flex h-16 items-center justify-between border-b px-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(oc,{className:"h-6 w-6 mr-2"}),e.jsx("span",{className:"font-semibold",children:"Smart Up"})]}),t&&e.jsx(I,{variant:"ghost",size:"sm",onClick:t,className:"lg:hidden",children:e.jsx(vt,{className:"h-4 w-4"})})]}),e.jsx(dc,{className:"flex-1 px-3 py-4",children:e.jsx("nav",{className:"space-y-4",children:n.map(a=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(za,{to:a.route??"/",onClick:r,className:({isActive:o})=>$("flex items-center justify-between rounded-md px-3 py-2 text-sm font-semibold transition-colors hover:bg-accent hover:text-accent-foreground",o?"bg-accent text-accent-foreground":"text-foreground"),children:[e.jsxs("span",{className:"flex items-center",children:[a.icon&&e.jsx("span",{className:"mr-3",children:a.icon}),a.label]}),e.jsx(Tr,{className:"h-4 w-4 opacity-60"})]}),a.children&&a.children.length>0&&e.jsx("div",{className:"ml-3 border-l pl-3 space-y-1",children:a.children.map(o=>e.jsxs(za,{to:o.route??"/",onClick:r,className:({isActive:l})=>$("flex items-center rounded-md px-3 py-2 text-sm transition-colors hover:bg-accent hover:text-accent-foreground",l?"bg-accent text-accent-foreground":"text-muted-foreground"),children:[o.icon&&e.jsx("span",{className:"mr-3",children:o.icon}),o.label]},o.key))})]},a.key))})}),e.jsx(fi,{}),e.jsx(Ub,{className:"border-b"}),e.jsx("div",{className:"p-4",children:e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{s(),t&&t()},className:"w-full justify-start",children:[e.jsx(lc,{className:"mr-2 h-4 w-4"}),"Logout"]})})]})},l0=({children:t})=>{const[s,n]=g.useState(!1),i=()=>{n(!s)};return e.jsx("div",{className:"min-h-screen bg-stone-200 relative overflow-x-hidden",children:e.jsxs("div",{className:"flex relative",children:[s&&e.jsx("div",{className:"fixed inset-0 z-40 bg-purple-900/20 backdrop-blur-sm lg:hidden",onClick:()=>n(!1)}),e.jsx("aside",{className:`
            h-screen w-64 transform transition-transform duration-300 ease-in-out
            fixed left-0 top-0 z-50
            ${s?"translate-x-0":"-translate-x-full"}
            lg:translate-x-0
            bg-background/95 backdrop-blur-md border-r border-purple-200/20
          `,children:e.jsx(o0,{onClose:()=>n(!1)})}),e.jsxs("main",{className:"flex-1 lg:ml-64 min-w-0 relative z-10",children:[e.jsxs("div",{className:"sticky top-0 z-30 flex h-16 items-center border-b border-purple-200/20 bg-background/80 backdrop-blur-md px-4 lg:hidden",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:i,className:"mr-2 hover:bg-purple-100/20 hover:text-purple-700",children:e.jsx(oc,{className:"h-6 w-6"})}),e.jsx("span",{className:"font-semibold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Smart Up"})]}),t]})]})})},c0={"between-center":"flex justify-between items-center gap-2",center:"flex justify-center items-center gap-2",start:"flex justify-start items-center gap-2",end:"flex justify-end items-center gap-2"},Z=({children:t,variant:s="between-center",className:n=""})=>{const i=c0[s],r=n?`${i} ${n}`:i;return e.jsx("div",{className:r,children:t})},d0={"1-2-3":"grid gap-6 md:grid-cols-2 lg:grid-cols-3","1-2-2":"grid gap-6 md:grid-cols-2","1-1-1":"grid gap-6","2-2-4":"grid gap-6 grid-cols-2 lg:grid-cols-4"},it=({children:t,variant:s="1-2-3",className:n=""})=>{const i=d0[s],r=n?`${i} ${n}`:i;return e.jsx("div",{className:r,children:t})},u0={card:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},lg:{wrap:"space-y-0",title:"text-3xl font-bold tracking-tight",description:"text-muted-foreground"},md:{wrap:"space-y-0",title:"font-medium",description:"text-muted-foreground"},sm:{wrap:"space-y-1",title:"font-medium text-sm text-muted-foreground mb-1",description:"text-sm"}},ve=({title:t,description:s,variant:n="lg"})=>{const i=u0[n],r=()=>{switch(n){case"lg":return e.jsx("h1",{className:i.title,children:t});case"md":return e.jsx("h2",{className:i.title,children:t});case"sm":return e.jsx("h3",{className:i.title,children:t});default:return e.jsx("h1",{className:i.title,children:t})}};return n==="card"?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"text-lg font-semibold leading-tight flex items-center gap-2",children:t}),e.jsx(Me,{className:"text-sm text-muted-foreground mt-2",children:s})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:i.wrap,children:[r(),e.jsx("p",{className:`prose ${i.description}`,children:s})]})})},K=({children:t})=>e.jsx("div",{className:"p-2 md:p-12 space-y-6 max-w-7xl mx-auto",children:t}),m0=()=>{const{data:t,isLoading:s}=gt(),[n,i]=g.useState(null),[r,a]=g.useState(!0);return g.useEffect(()=>{if(s||!t?.vendor_id){a(!1);return}let o=!0;return(async()=>{try{const[c,d,m,u,h]=await Promise.all([ue.from("users").select("*",{count:"exact",head:!0}).eq("vendor_id",t.vendor_id),ue.from("courses").select("*",{count:"exact"}).eq("vendor_id",t.vendor_id),ue.from("activities").select("*, topics!inner(course_id, courses!inner(vendor_id))",{count:"exact"}).eq("topics.courses.vendor_id",t.vendor_id),ue.from("activity_progress").select("score, completed_at").not("completed_at","is",null),ue.from("user_stats").select("total_points")]);if(!o)return;const p=u.data?.length?u.data.reduce((f,x)=>f+(x.score||0),0)/u.data.length:0,b=h.data?.reduce((f,x)=>f+x.total_points,0)||0;i({totalUsers:c.count||0,activeUsers:c.count||0,totalCourses:d.count||0,publishedCourses:d.data?.filter(f=>f.is_published).length||0,totalActivities:m.count||0,completedActivities:u.data?.length||0,averageScore:Math.round(p),totalPoints:b})}catch(c){console.error("Error fetching dashboard stats:",c)}finally{o&&a(!1)}})(),()=>{o=!1}},[t?.vendor_id,s]),r||s?e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):t?e.jsxs(K,{children:[e.jsx(ve,{title:"Dashboard",description:"Przegląd statystyk systemu e-learning"}),e.jsxs(it,{variant:"1-2-2",children:[e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Użytkownicy"}),e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n?.totalUsers||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n?.activeUsers||0," aktywnych"]})]})]}),e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Kursy"}),e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n?.totalCourses||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n?.publishedCourses||0," opublikowanych"]})]})]}),e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Aktywności"}),e.jsx(Ar,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n?.totalActivities||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n?.completedActivities||0," ukończonych"]})]})]}),e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Średni wynik"}),e.jsx(ze,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[n?.averageScore||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"z wszystkich quizów"})]})]})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Aktywność w ostatnich 7 dniach"})}),e.jsx(P,{children:e.jsxs("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:[e.jsx(It,{className:"h-8 w-8 mr-2"}),"Wykres aktywności (do implementacji)"]})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Top 5 użytkowników"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(o=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($e,{className:`h-5 w-5 ${o<=3?"text-yellow-500":"text-muted-foreground"}`}),e.jsxs("span",{children:["Użytkownik ",o]})]}),e.jsxs("span",{className:"font-semibold",children:[1e3-o*100," pkt"]})]},o))})})]})]}):e.jsx(K,{children:e.jsx("div",{className:"text-center text-muted-foreground",children:"Nie można załadować danych użytkownika"})})},h0=[e.jsx(V,{path:"/dashboard/overview",element:e.jsx(m0,{})},"dashboard")],oo=({current:t,pageSize:s,total:n,setCurrent:i,setPageSize:r,itemName:a="elementów",pageSizeOptions:o=[10,20,50]})=>{const l=Math.ceil(n/s),c=(t-1)*s+1,d=Math.min(t*s,n),m=t>1,u=t<l,h=()=>{const p=[];if(l<=5)for(let f=1;f<=l;f++)p.push(f);else{p.push(1),t>3&&p.push("...");const f=Math.max(2,t-1),x=Math.min(l-1,t+1);for(let w=f;w<=x;w++)p.push(w);t<l-2&&p.push("..."),p.push(l)}return p};return n===0?null:e.jsxs(Z,{className:"mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pokazuje ",c,"-",d," z ",n," ",a]}),e.jsxs(Z,{className:"gap-2",children:[r&&e.jsxs(me,{value:s.toString(),onValueChange:p=>{r(parseInt(p)),i(1)},children:[e.jsx(ce,{className:"w-[100px]",children:e.jsx(he,{})}),e.jsx(de,{children:o.map(p=>e.jsxs(B,{value:p.toString(),children:[p," / str."]},p))})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>i(t-1),disabled:!m,children:e.jsx(My,{className:"w-4 h-4"})}),e.jsx("div",{className:"hidden sm:flex gap-1",children:h().map((p,b)=>p==="..."?e.jsx("span",{className:"px-3 py-1 text-sm text-muted-foreground",children:"..."},`ellipsis-${b}`):e.jsx(I,{variant:t===p?"default":"outline",size:"sm",onClick:()=>i(p),className:"min-w-[40px]",children:p},p))}),e.jsxs("div",{className:"flex sm:hidden items-center px-3 text-sm",children:[t," / ",l]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>i(t+1),disabled:!u,children:e.jsx(nr,{className:"w-4 h-4"})})]})]})};var jl=["Enter"," "],p0=["ArrowDown","PageUp","Home"],np=["ArrowUp","PageDown","End"],f0=[...p0,...np],x0={ltr:[...jl,"ArrowRight"],rtl:[...jl,"ArrowLeft"]},g0={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Mr="Menu",[lr,j0,y0]=Hj(Mr),[An,ip]=tc(Mr,[y0,vh,Nh]),lo=vh(),rp=Nh(),[b0,_n]=An(Mr),[w0,Er]=An(Mr),ap=t=>{const{__scopeMenu:s,open:n=!1,children:i,dir:r,onOpenChange:a,modal:o=!0}=t,l=lo(s),[c,d]=g.useState(null),m=g.useRef(!1),u=zh(a),h=oy(r);return g.useEffect(()=>{const p=()=>{m.current=!0,document.addEventListener("pointerdown",b,{capture:!0,once:!0}),document.addEventListener("pointermove",b,{capture:!0,once:!0})},b=()=>m.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",b,{capture:!0}),document.removeEventListener("pointermove",b,{capture:!0})}},[]),e.jsx(ly,{...l,children:e.jsx(b0,{scope:s,open:n,onOpenChange:u,content:c,onContentChange:d,children:e.jsx(w0,{scope:s,onClose:g.useCallback(()=>u(!1),[u]),isUsingKeyboardRef:m,dir:h,modal:o,children:i})})})};ap.displayName=Mr;var v0="MenuAnchor",mc=g.forwardRef((t,s)=>{const{__scopeMenu:n,...i}=t,r=lo(n);return e.jsx(Zj,{...r,...i,ref:s})});mc.displayName=v0;var hc="MenuPortal",[N0,op]=An(hc,{forceMount:void 0}),lp=t=>{const{__scopeMenu:s,forceMount:n,children:i,container:r}=t,a=_n(hc,s);return e.jsx(N0,{scope:s,forceMount:n,children:e.jsx(Ga,{present:n||a.open,children:e.jsx(Qj,{asChild:!0,container:r,children:i})})})};lp.displayName=hc;var Ut="MenuContent",[k0,pc]=An(Ut),cp=g.forwardRef((t,s)=>{const n=op(Ut,t.__scopeMenu),{forceMount:i=n.forceMount,...r}=t,a=_n(Ut,t.__scopeMenu),o=Er(Ut,t.__scopeMenu);return e.jsx(lr.Provider,{scope:t.__scopeMenu,children:e.jsx(Ga,{present:i||a.open,children:e.jsx(lr.Slot,{scope:t.__scopeMenu,children:o.modal?e.jsx(z0,{...r,ref:s}):e.jsx(S0,{...r,ref:s})})})})}),z0=g.forwardRef((t,s)=>{const n=_n(Ut,t.__scopeMenu),i=g.useRef(null),r=Cn(s,i);return g.useEffect(()=>{const a=i.current;if(a)return ry(a)},[]),e.jsx(fc,{...t,ref:r,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Ne(t.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),S0=g.forwardRef((t,s)=>{const n=_n(Ut,t.__scopeMenu);return e.jsx(fc,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),C0=ey("MenuContent.ScrollLock"),fc=g.forwardRef((t,s)=>{const{__scopeMenu:n,loop:i=!1,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:u,onInteractOutside:h,onDismiss:p,disableOutsideScroll:b,...f}=t,x=_n(Ut,n),w=Er(Ut,n),y=lo(n),N=rp(n),A=j0(n),[S,k]=g.useState(null),v=g.useRef(null),z=Cn(s,v,x.onContentChange),D=g.useRef(0),j=g.useRef(""),C=g.useRef(0),T=g.useRef(null),E=g.useRef("right"),M=g.useRef(0),F=b?Xj:g.Fragment,X=b?{as:C0,allowPinchZoom:!0}:void 0,R=U=>{const le=j.current+U,q=A().filter(He=>!He.disabled),ee=document.activeElement,Je=q.find(He=>He.ref.current===ee)?.textValue,Qt=q.map(He=>He.textValue),Os=$0(Qt,le,Je),Ge=q.find(He=>He.textValue===Os)?.ref.current;(function He(Zt){j.current=Zt,window.clearTimeout(D.current),Zt!==""&&(D.current=window.setTimeout(()=>He(""),1e3))})(le),Ge&&setTimeout(()=>Ge.focus())};g.useEffect(()=>()=>window.clearTimeout(D.current),[]),Jj();const G=g.useCallback(U=>E.current===T.current?.side&&F0(U,T.current?.area),[]);return e.jsx(k0,{scope:n,searchRef:j,onItemEnter:g.useCallback(U=>{G(U)&&U.preventDefault()},[G]),onItemLeave:g.useCallback(U=>{G(U)||(v.current?.focus(),k(null))},[G]),onTriggerLeave:g.useCallback(U=>{G(U)&&U.preventDefault()},[G]),pointerGraceTimerRef:C,onPointerGraceIntentChange:g.useCallback(U=>{T.current=U},[]),children:e.jsx(F,{...X,children:e.jsx(ty,{asChild:!0,trapped:r,onMountAutoFocus:Ne(a,U=>{U.preventDefault(),v.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:e.jsx(sy,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:u,onInteractOutside:h,onDismiss:p,children:e.jsx(ny,{asChild:!0,...N,dir:w.dir,orientation:"vertical",loop:i,currentTabStopId:S,onCurrentTabStopIdChange:k,onEntryFocus:Ne(c,U=>{w.isUsingKeyboardRef.current||U.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(iy,{role:"menu","aria-orientation":"vertical","data-state":zp(x.open),"data-radix-menu-content":"",dir:w.dir,...y,...f,ref:z,style:{outline:"none",...f.style},onKeyDown:Ne(f.onKeyDown,U=>{const q=U.target.closest("[data-radix-menu-content]")===U.currentTarget,ee=U.ctrlKey||U.altKey||U.metaKey,Je=U.key.length===1;q&&(U.key==="Tab"&&U.preventDefault(),!ee&&Je&&R(U.key));const Qt=v.current;if(U.target!==Qt||!f0.includes(U.key))return;U.preventDefault();const Ge=A().filter(He=>!He.disabled).map(He=>He.ref.current);np.includes(U.key)&&Ge.reverse(),O0(Ge)}),onBlur:Ne(t.onBlur,U=>{U.currentTarget.contains(U.target)||(window.clearTimeout(D.current),j.current="")}),onPointerMove:Ne(t.onPointerMove,cr(U=>{const le=U.target,q=M.current!==U.clientX;if(U.currentTarget.contains(le)&&q){const ee=U.clientX>M.current?"right":"left";E.current=ee,M.current=U.clientX}}))})})})})})})});cp.displayName=Ut;var T0="MenuGroup",xc=g.forwardRef((t,s)=>{const{__scopeMenu:n,...i}=t;return e.jsx(sn.div,{role:"group",...i,ref:s})});xc.displayName=T0;var A0="MenuLabel",dp=g.forwardRef((t,s)=>{const{__scopeMenu:n,...i}=t;return e.jsx(sn.div,{...i,ref:s})});dp.displayName=A0;var Pa="MenuItem",Ud="menu.itemSelect",co=g.forwardRef((t,s)=>{const{disabled:n=!1,onSelect:i,...r}=t,a=g.useRef(null),o=Er(Pa,t.__scopeMenu),l=pc(Pa,t.__scopeMenu),c=Cn(s,a),d=g.useRef(!1),m=()=>{const u=a.current;if(!n&&u){const h=new CustomEvent(Ud,{bubbles:!0,cancelable:!0});u.addEventListener(Ud,p=>i?.(p),{once:!0}),ay(u,h),h.defaultPrevented?d.current=!1:o.onClose()}};return e.jsx(up,{...r,ref:c,disabled:n,onClick:Ne(t.onClick,m),onPointerDown:u=>{t.onPointerDown?.(u),d.current=!0},onPointerUp:Ne(t.onPointerUp,u=>{d.current||u.currentTarget?.click()}),onKeyDown:Ne(t.onKeyDown,u=>{const h=l.searchRef.current!=="";n||h&&u.key===" "||jl.includes(u.key)&&(u.currentTarget.click(),u.preventDefault())})})});co.displayName=Pa;var up=g.forwardRef((t,s)=>{const{__scopeMenu:n,disabled:i=!1,textValue:r,...a}=t,o=pc(Pa,n),l=rp(n),c=g.useRef(null),d=Cn(s,c),[m,u]=g.useState(!1),[h,p]=g.useState("");return g.useEffect(()=>{const b=c.current;b&&p((b.textContent??"").trim())},[a.children]),e.jsx(lr.ItemSlot,{scope:n,disabled:i,textValue:r??h,children:e.jsx(Yj,{asChild:!0,...l,focusable:!i,children:e.jsx(sn.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...a,ref:d,onPointerMove:Ne(t.onPointerMove,cr(b=>{i?o.onItemLeave(b):(o.onItemEnter(b),b.defaultPrevented||b.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Ne(t.onPointerLeave,cr(b=>o.onItemLeave(b))),onFocus:Ne(t.onFocus,()=>u(!0)),onBlur:Ne(t.onBlur,()=>u(!1))})})})}),_0="MenuCheckboxItem",mp=g.forwardRef((t,s)=>{const{checked:n=!1,onCheckedChange:i,...r}=t;return e.jsx(gp,{scope:t.__scopeMenu,checked:n,children:e.jsx(co,{role:"menuitemcheckbox","aria-checked":Da(n)?"mixed":n,...r,ref:s,"data-state":jc(n),onSelect:Ne(r.onSelect,()=>i?.(Da(n)?!0:!n),{checkForDefaultPrevented:!1})})})});mp.displayName=_0;var hp="MenuRadioGroup",[P0,D0]=An(hp,{value:void 0,onValueChange:()=>{}}),pp=g.forwardRef((t,s)=>{const{value:n,onValueChange:i,...r}=t,a=zh(i);return e.jsx(P0,{scope:t.__scopeMenu,value:n,onValueChange:a,children:e.jsx(xc,{...r,ref:s})})});pp.displayName=hp;var fp="MenuRadioItem",xp=g.forwardRef((t,s)=>{const{value:n,...i}=t,r=D0(fp,t.__scopeMenu),a=n===r.value;return e.jsx(gp,{scope:t.__scopeMenu,checked:a,children:e.jsx(co,{role:"menuitemradio","aria-checked":a,...i,ref:s,"data-state":jc(a),onSelect:Ne(i.onSelect,()=>r.onValueChange?.(n),{checkForDefaultPrevented:!1})})})});xp.displayName=fp;var gc="MenuItemIndicator",[gp,I0]=An(gc,{checked:!1}),jp=g.forwardRef((t,s)=>{const{__scopeMenu:n,forceMount:i,...r}=t,a=I0(gc,n);return e.jsx(Ga,{present:i||Da(a.checked)||a.checked===!0,children:e.jsx(sn.span,{...r,ref:s,"data-state":jc(a.checked)})})});jp.displayName=gc;var M0="MenuSeparator",yp=g.forwardRef((t,s)=>{const{__scopeMenu:n,...i}=t;return e.jsx(sn.div,{role:"separator","aria-orientation":"horizontal",...i,ref:s})});yp.displayName=M0;var E0="MenuArrow",bp=g.forwardRef((t,s)=>{const{__scopeMenu:n,...i}=t,r=lo(n);return e.jsx(cy,{...r,...i,ref:s})});bp.displayName=E0;var L0="MenuSub",[oP,wp]=An(L0),Vi="MenuSubTrigger",vp=g.forwardRef((t,s)=>{const n=_n(Vi,t.__scopeMenu),i=Er(Vi,t.__scopeMenu),r=wp(Vi,t.__scopeMenu),a=pc(Vi,t.__scopeMenu),o=g.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=a,d={__scopeMenu:t.__scopeMenu},m=g.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return g.useEffect(()=>m,[m]),g.useEffect(()=>{const u=l.current;return()=>{window.clearTimeout(u),c(null)}},[l,c]),e.jsx(mc,{asChild:!0,...d,children:e.jsx(up,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":r.contentId,"data-state":zp(n.open),...t,ref:kh(s,r.onTriggerChange),onClick:u=>{t.onClick?.(u),!(t.disabled||u.defaultPrevented)&&(u.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Ne(t.onPointerMove,cr(u=>{a.onItemEnter(u),!u.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(a.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),m()},100))})),onPointerLeave:Ne(t.onPointerLeave,cr(u=>{m();const h=n.content?.getBoundingClientRect();if(h){const p=n.content?.dataset.side,b=p==="right",f=b?-5:5,x=h[b?"left":"right"],w=h[b?"right":"left"];a.onPointerGraceIntentChange({area:[{x:u.clientX+f,y:u.clientY},{x,y:h.top},{x:w,y:h.top},{x:w,y:h.bottom},{x,y:h.bottom}],side:p}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(u),u.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:Ne(t.onKeyDown,u=>{const h=a.searchRef.current!=="";t.disabled||h&&u.key===" "||x0[i.dir].includes(u.key)&&(n.onOpenChange(!0),n.content?.focus(),u.preventDefault())})})})});vp.displayName=Vi;var Np="MenuSubContent",kp=g.forwardRef((t,s)=>{const n=op(Ut,t.__scopeMenu),{forceMount:i=n.forceMount,...r}=t,a=_n(Ut,t.__scopeMenu),o=Er(Ut,t.__scopeMenu),l=wp(Np,t.__scopeMenu),c=g.useRef(null),d=Cn(s,c);return e.jsx(lr.Provider,{scope:t.__scopeMenu,children:e.jsx(Ga,{present:i||a.open,children:e.jsx(lr.Slot,{scope:t.__scopeMenu,children:e.jsx(fc,{id:l.contentId,"aria-labelledby":l.triggerId,...r,ref:d,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:m=>{o.isUsingKeyboardRef.current&&c.current?.focus(),m.preventDefault()},onCloseAutoFocus:m=>m.preventDefault(),onFocusOutside:Ne(t.onFocusOutside,m=>{m.target!==l.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:Ne(t.onEscapeKeyDown,m=>{o.onClose(),m.preventDefault()}),onKeyDown:Ne(t.onKeyDown,m=>{const u=m.currentTarget.contains(m.target),h=g0[o.dir].includes(m.key);u&&h&&(a.onOpenChange(!1),l.trigger?.focus(),m.preventDefault())})})})})})});kp.displayName=Np;function zp(t){return t?"open":"closed"}function Da(t){return t==="indeterminate"}function jc(t){return Da(t)?"indeterminate":t?"checked":"unchecked"}function O0(t){const s=document.activeElement;for(const n of t)if(n===s||(n.focus(),document.activeElement!==s))return}function R0(t,s){return t.map((n,i)=>t[(s+i)%t.length])}function $0(t,s,n){const r=s.length>1&&Array.from(s).every(d=>d===s[0])?s[0]:s,a=n?t.indexOf(n):-1;let o=R0(t,Math.max(a,0));r.length===1&&(o=o.filter(d=>d!==n));const c=o.find(d=>d.toLowerCase().startsWith(r.toLowerCase()));return c!==n?c:void 0}function q0(t,s){const{x:n,y:i}=t;let r=!1;for(let a=0,o=s.length-1;a<s.length;o=a++){const l=s[a],c=s[o],d=l.x,m=l.y,u=c.x,h=c.y;m>i!=h>i&&n<(u-d)*(i-m)/(h-m)+d&&(r=!r)}return r}function F0(t,s){if(!s)return!1;const n={x:t.clientX,y:t.clientY};return q0(n,s)}function cr(t){return s=>s.pointerType==="mouse"?t(s):void 0}var B0=ap,U0=mc,V0=lp,W0=cp,K0=xc,G0=dp,H0=co,Q0=mp,Z0=pp,Y0=xp,J0=jp,X0=yp,ew=bp,tw=vp,sw=kp,uo="DropdownMenu",[nw,lP]=tc(uo,[ip]),jt=ip(),[iw,Sp]=nw(uo),Cp=t=>{const{__scopeDropdownMenu:s,children:n,dir:i,open:r,defaultOpen:a,onOpenChange:o,modal:l=!0}=t,c=jt(s),d=g.useRef(null),[m,u]=bh({prop:r,defaultProp:a??!1,onChange:o,caller:uo});return e.jsx(iw,{scope:s,triggerId:Md(),triggerRef:d,contentId:Md(),open:m,onOpenChange:u,onOpenToggle:g.useCallback(()=>u(h=>!h),[u]),modal:l,children:e.jsx(B0,{...c,open:m,onOpenChange:u,dir:i,modal:l,children:n})})};Cp.displayName=uo;var Tp="DropdownMenuTrigger",Ap=g.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,disabled:i=!1,...r}=t,a=Sp(Tp,n),o=jt(n);return e.jsx(U0,{asChild:!0,...o,children:e.jsx(sn.button,{type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...r,ref:kh(s,a.triggerRef),onPointerDown:Ne(t.onPointerDown,l=>{!i&&l.button===0&&l.ctrlKey===!1&&(a.onOpenToggle(),a.open||l.preventDefault())}),onKeyDown:Ne(t.onKeyDown,l=>{i||(["Enter"," "].includes(l.key)&&a.onOpenToggle(),l.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});Ap.displayName=Tp;var rw="DropdownMenuPortal",_p=t=>{const{__scopeDropdownMenu:s,...n}=t,i=jt(s);return e.jsx(V0,{...i,...n})};_p.displayName=rw;var Pp="DropdownMenuContent",Dp=g.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...i}=t,r=Sp(Pp,n),a=jt(n),o=g.useRef(!1);return e.jsx(W0,{id:r.contentId,"aria-labelledby":r.triggerId,...a,...i,ref:s,onCloseAutoFocus:Ne(t.onCloseAutoFocus,l=>{o.current||r.triggerRef.current?.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:Ne(t.onInteractOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,m=c.button===2||d;(!r.modal||m)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Dp.displayName=Pp;var aw="DropdownMenuGroup",ow=g.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...i}=t,r=jt(n);return e.jsx(K0,{...r,...i,ref:s})});ow.displayName=aw;var lw="DropdownMenuLabel",Ip=g.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...i}=t,r=jt(n);return e.jsx(G0,{...r,...i,ref:s})});Ip.displayName=lw;var cw="DropdownMenuItem",Mp=g.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...i}=t,r=jt(n);return e.jsx(H0,{...r,...i,ref:s})});Mp.displayName=cw;var dw="DropdownMenuCheckboxItem",Ep=g.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...i}=t,r=jt(n);return e.jsx(Q0,{...r,...i,ref:s})});Ep.displayName=dw;var uw="DropdownMenuRadioGroup",mw=g.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...i}=t,r=jt(n);return e.jsx(Z0,{...r,...i,ref:s})});mw.displayName=uw;var hw="DropdownMenuRadioItem",Lp=g.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...i}=t,r=jt(n);return e.jsx(Y0,{...r,...i,ref:s})});Lp.displayName=hw;var pw="DropdownMenuItemIndicator",Op=g.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...i}=t,r=jt(n);return e.jsx(J0,{...r,...i,ref:s})});Op.displayName=pw;var fw="DropdownMenuSeparator",Rp=g.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...i}=t,r=jt(n);return e.jsx(X0,{...r,...i,ref:s})});Rp.displayName=fw;var xw="DropdownMenuArrow",gw=g.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...i}=t,r=jt(n);return e.jsx(ew,{...r,...i,ref:s})});gw.displayName=xw;var jw="DropdownMenuSubTrigger",$p=g.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...i}=t,r=jt(n);return e.jsx(tw,{...r,...i,ref:s})});$p.displayName=jw;var yw="DropdownMenuSubContent",qp=g.forwardRef((t,s)=>{const{__scopeDropdownMenu:n,...i}=t,r=jt(n);return e.jsx(sw,{...r,...i,ref:s,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});qp.displayName=yw;var bw=Cp,ww=Ap,vw=_p,Fp=Dp,Bp=Ip,Up=Mp,Vp=Ep,Wp=Lp,Kp=Op,Gp=Rp,Hp=$p,Qp=qp;const vn=bw,Nn=ww,Nw=g.forwardRef(({className:t,inset:s,children:n,...i},r)=>e.jsxs(Hp,{ref:r,className:$("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",t),...i,children:[n,e.jsx(nr,{className:"ml-auto"})]}));Nw.displayName=Hp.displayName;const kw=g.forwardRef(({className:t,...s},n)=>e.jsx(Qp,{ref:n,className:$("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...s}));kw.displayName=Qp.displayName;const Js=g.forwardRef(({className:t,sideOffset:s=4,...n},i)=>e.jsx(vw,{children:e.jsx(Fp,{ref:i,sideOffset:s,className:$("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n})}));Js.displayName=Fp.displayName;const pe=g.forwardRef(({className:t,inset:s,...n},i)=>e.jsx(Up,{ref:i,className:$("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",s&&"pl-8",t),...n}));pe.displayName=Up.displayName;const zw=g.forwardRef(({className:t,children:s,checked:n,...i},r)=>e.jsxs(Vp,{ref:r,className:$("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...i,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Kp,{children:e.jsx(ot,{className:"h-4 w-4"})})}),s]}));zw.displayName=Vp.displayName;const Sw=g.forwardRef(({className:t,children:s,...n},i)=>e.jsxs(Wp,{ref:i,className:$("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Kp,{children:e.jsx(fa,{className:"h-2 w-2 fill-current"})})}),s]}));Sw.displayName=Wp.displayName;const Zp=g.forwardRef(({className:t,inset:s,...n},i)=>e.jsx(Bp,{ref:i,className:$("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",t),...n}));Zp.displayName=Bp.displayName;const xt=g.forwardRef(({className:t,...s},n)=>e.jsx(Gp,{ref:n,className:$("-mx-1 my-1 h-px bg-muted",t),...s}));xt.displayName=Gp.displayName;const Cw=()=>{const t=J(),s=kr(),n=()=>{const o=`${s.pathname}${s.search}`;sessionStorage.setItem("returnUrl",o)};return{navigateWithReturn:o=>{n(),t(o)},goBack:o=>{const l=sessionStorage.getItem("returnUrl");l?(sessionStorage.removeItem("returnUrl"),t(l)):t(o||-1)},saveReturnUrl:n,navigateToWizard:(o,l)=>{l&&sessionStorage.setItem("wizardContext",JSON.stringify(l)),n(),t(o)},currentUrl:`${s.pathname}${s.search}`}},yl=t=>{const{mutate:s,isLoading:n}=Qa();return{togglePublish:async(r,a,o,l)=>{s({resource:t,id:r,values:{is_published:!a}},{onSuccess:()=>{W.success(a?`${o} został ukryty`:`${o} został opublikowany`),l?.()},onError:c=>{W.error("Nie udało się zmienić statusu publikacji"),console.error("Publish toggle error:",c)}})},isToggling:n}},Vd=t=>{const{mutate:s}=Qa(),n=_h(),[i,r]=g.useState(!1);return{updatePosition:g.useCallback(async(o,l)=>{if(!i){r(!0);try{await new Promise((c,d)=>{s({resource:t,id:o,values:{position:l},mutationMode:"optimistic"},{onSuccess:()=>{console.log(`Updated position for ${t} ${o} to ${l}`),c()},onError:m=>d(m)})}),setTimeout(()=>{n({resource:t,invalidates:["list"]})},1e3)}catch(c){console.error("Position update error:",c),W.error("Nie udało się zaktualizować pozycji"),await n({resource:t,invalidates:["list"]})}finally{r(!1)}}},[t,s,n,i]),isUpdating:i}},Tw=t=>{const{data:s,isLoading:n}=Ue({resource:"courses",id:t,queryOptions:{enabled:!!t}}),{data:i,isLoading:r,refetch:a}=ie({resource:"topics",filters:[{field:"course_id",operator:"eq",value:t}],sorters:[{field:"position",order:"asc"}],pagination:{mode:"off"},meta:{select:"*, activities(count)"},queryOptions:{enabled:!!t}}),{data:o,refetch:l}=ie({resource:"activities",filters:[{field:"topic_id",operator:"in",value:i?.data?.map(h=>h.id)||[]}],sorters:[{field:"position",order:"asc"}],pagination:{mode:"off"},meta:{select:"*, questions(count)"},queryOptions:{enabled:!!i?.data?.length}}),{data:c}=ie({resource:"course_access",filters:[{field:"course_id",operator:"eq",value:t}],queryOptions:{enabled:!!t}}),d=n||r,m={topicsCount:i?.total||0,activitiesCount:o?.total||0,accessCount:c?.total||0},u=h=>o?.data?.filter(p=>p.topic_id===h)||[];return{course:s?.data,topics:i?.data||[],activities:o?.data||[],stats:m,isLoading:d,refetchTopics:a,refetchActivities:l,getActivitiesForTopic:u}},Aw=()=>{const{create:t,edit:s,show:n}=Ye(),{mutate:i}=jn(),{togglePublish:r}=yl("courses"),{tableQuery:{data:a,isLoading:o,isError:l,refetch:c},current:d,setCurrent:m,pageSize:u,setFilters:h}=Za({sorters:{initial:[{field:"created_at",order:"desc"}]},meta:{select:"*, topics(count), course_access(count)"}}),p=to({isLoading:o,isError:l});if(p)return p;const b=(x,w)=>{confirm(`Czy na pewno chcesz usunąć kurs "${w}"?`)&&i({resource:"courses",id:x},{onSuccess:()=>{W.success("Kurs został usunięty"),c()}})},f=(x,w,y)=>{w&&y&&sessionStorage.setItem("wizardContext",JSON.stringify({courseId:w,courseTitle:y})),window.location.href=x};return e.jsxs(K,{children:[e.jsxs(Z,{children:[e.jsx(ve,{title:"Kursy",description:"Zarządzaj kursami w systemie"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Cs,{children:e.jsxs(Ts,{children:[e.jsx(As,{asChild:!0,children:e.jsxs(I,{variant:"outline",onClick:()=>f("/teacher/course-structure/step1"),children:[e.jsx(ri,{className:"w-4 h-4 mr-2"}),e.jsx(lt,{className:"w-3 h-3"})]})}),e.jsx(os,{children:e.jsx("p",{children:"Stwórz kurs z pomocą AI"})})]})}),e.jsxs(I,{onClick:()=>t("courses"),children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Dodaj kurs"]})]})]}),e.jsx(Z,{children:e.jsx(Q,{placeholder:"Szukaj kursów...",className:"max-w-sm",onChange:x=>{h([{field:"title",operator:"contains",value:x.target.value}])}})}),e.jsx(it,{children:a?.data?.map(x=>e.jsxs(_,{className:`relative cursor-pointer transition-all duration-200 ${x.is_published?"hover:shadow-lg":"opacity-80 hover:opacity-90 "}`,onClick:w=>{w.target.closest('[role="menu"]')||n("courses",x.id)},children:[e.jsx(O,{children:e.jsxs(Z,{children:[e.jsxs(L,{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"flex-shrink-0",children:x.icon_emoji?e.jsx("span",{className:"text-2xl",children:x.icon_emoji}):e.jsx(xe,{className:"w-5 h-5"})}),e.jsx(Cs,{delayDuration:200,children:e.jsxs(Ts,{children:[e.jsx(As,{asChild:!0,children:e.jsx("span",{className:"truncate",children:x.title})}),x.title.length>30&&e.jsx(os,{children:e.jsx("p",{className:"max-w-xs",children:x.title})})]})})]}),e.jsxs(vn,{children:[e.jsx(Nn,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"sm",onClick:w=>w.stopPropagation(),children:e.jsx(_r,{className:"h-4 w-4"})})}),e.jsxs(Js,{align:"end",children:[e.jsxs(pe,{onClick:()=>n("courses",x.id),children:[e.jsx(Ze,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),e.jsxs(pe,{onClick:()=>s("courses",x.id),children:[e.jsx(Ht,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),e.jsx(xt,{}),e.jsx(pe,{onClick:()=>r(x.id,x.is_published,x.title,c),children:x.is_published?e.jsxs(e.Fragment,{children:[e.jsx(Xa,{className:"mr-2 h-4 w-4"}),"Ukryj kurs"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"mr-2 h-4 w-4"}),"Opublikuj kurs"]})}),e.jsx(xt,{}),e.jsxs(pe,{onClick:()=>f("/teacher/educational-material/step1",x.id,x.title),className:"text-purple-600 focus:text-purple-600",children:[e.jsx(lt,{className:"mr-2 h-4 w-4"}),"Generuj materiał z AI"]}),e.jsxs(pe,{onClick:()=>f("/teacher/quiz-wizard/step1",x.id,x.title),className:"text-blue-600 focus:text-blue-600",children:[e.jsx(Ds,{className:"mr-2 h-4 w-4"}),"Generuj quiz z AI"]}),e.jsx(xt,{}),e.jsxs(pe,{onClick:()=>b(x.id,x.title),className:"text-red-600 focus:text-red-600",children:[e.jsx(xs,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})}),e.jsxs(P,{children:[x.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:x.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx(H,{variant:x.is_published?"default":"secondary",className:x.is_published?"bg-green-600":"",children:x.is_published?"Opublikowany":"Szkic"})}),e.jsxs("div",{className:"flex gap-3 text-sm text-muted-foreground",children:[e.jsx(Cs,{children:e.jsxs(Ts,{children:[e.jsx(As,{asChild:!0,children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(We,{className:"w-3 h-3"}),x.topics?.[0]?.count||0]})}),e.jsx(os,{children:e.jsx("p",{children:"Liczba tematów"})})]})}),e.jsx(Cs,{children:e.jsxs(Ts,{children:[e.jsx(As,{asChild:!0,children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Pe,{className:"w-3 h-3"}),x.course_access?.[0]?.count||0]})}),e.jsx(os,{children:e.jsx("p",{children:"Liczba uczestników"})})]})})]})]}),x.created_at&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-muted-foreground",children:[e.jsx(Se,{className:"w-3 h-3"}),e.jsxs("span",{children:["Utworzono:"," ",new Date(x.created_at).toLocaleDateString("pl-PL")]})]})]})]},x.id))}),a?.data?.length===0&&e.jsx(_,{className:"border-dashed border-2 bg-gradient-to-r from-indigo-50/50 to-purple-50/50 dark:from-indigo-950/20 dark:to-purple-950/20",children:e.jsxs(P,{className:"text-center py-12",children:[e.jsx(ri,{className:"w-12 h-12 mx-auto mb-4 text-indigo-600"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Brak kursów"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Rozpocznij od stworzenia pierwszego kursu"}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsxs(I,{variant:"outline",onClick:()=>t("courses"),children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Dodaj ręcznie"]}),e.jsxs(I,{onClick:()=>f("/course-structure/step1"),className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700",children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),"Wygeneruj z AI"]})]})]})}),e.jsx(oo,{current:d,pageSize:u,total:a?.total||0,setCurrent:m,itemName:"kursów"})]})},bs=({children:t,onSubmit:s,className:n="",...i})=>{const r="space-y-6",a=n?`${r} ${n}`:r;return e.jsx("form",{onSubmit:s,className:a,...i,children:t})},se=({children:t,label:s,htmlFor:n,error:i,required:r=!1,className:a="",hint:o})=>{const l="space-y-2",c=a?`${l} ${a}`:l,d=()=>s?typeof s=="string"?e.jsxs(re,{htmlFor:n,children:[s,r&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):e.jsxs(re,{htmlFor:n,className:"flex items-center",children:[s,r&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}):null,m=g.isValidElement(t)?g.cloneElement(t,{className:`${t.props.className||""} ${i?"border-red-500 ring-1 ring-red-500":""}`.trim()}):t;return e.jsxs("div",{className:c,children:[d(),m,o&&!i&&e.jsx("p",{className:"text-sm text-muted-foreground",children:o}),i&&e.jsx("p",{className:"text-sm text-red-500",children:i})]})},ws=({children:t,className:s=""})=>{const n="flex justify-end items-center gap-4 pt-6 border-t",i=s?`${n} ${s}`:n;return e.jsx("div",{className:i,children:t})},_w=["📚","🎓","💡","🚀","⭐","🏆","🎯","📖","✏️","🧮"],Pw=()=>{const{list:t}=Ye(),{data:s}=gt(),[n,i]=g.useState(!1),{refineCore:{onFinish:r},register:a,handleSubmit:o,setValue:l,watch:c,formState:{errors:d,isSubmitting:m}}=ys({defaultValues:{title:"",description:"",vendor_id:s?.vendor_id||0,is_published:!1,icon_emoji:"📚"}}),u=c("icon_emoji");return e.jsxs(K,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("courses"),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsx(Z,{children:e.jsx(ve,{title:"Dodaj kurs",description:"Utwórz nowy kurs w systemie"})}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Informacje o kursie"})}),e.jsx(P,{children:e.jsxs(bs,{onSubmit:o(r),children:[e.jsxs(it,{variant:"1-2-2",children:[e.jsx(se,{label:"Tytuł kursu",htmlFor:"title",error:d.title?.message?.toString(),required:!0,children:e.jsx(Q,{id:"title",placeholder:"np. Podstawy programowania",...a("title",{required:"Tytuł kursu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),e.jsx(se,{label:"Ikona kursu",htmlFor:"icon_emoji",children:e.jsxs("div",{className:"relative",children:[e.jsxs(I,{type:"button",variant:"outline",className:"w-full justify-start",onClick:()=>i(!n),children:[e.jsx("span",{className:"text-2xl mr-2",children:u||"📚"}),"Wybierz ikonę"]}),n&&e.jsx("div",{className:"absolute top-full mt-2 p-2 bg-white border rounded-lg shadow-lg z-10",children:e.jsx("div",{className:"grid grid-cols-5 gap-2",children:_w.map(h=>e.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 rounded text-2xl",onClick:()=>{l("icon_emoji",h),i(!1)},children:h},h))})})]})})]}),e.jsx(se,{label:"Opis kursu",htmlFor:"description",error:d.description?.message?.toString(),children:e.jsx(Nt,{id:"description",placeholder:"Opisz czego uczniowie nauczą się na tym kursie...",rows:4,...a("description")})}),e.jsx(se,{label:"Status publikacji",children:e.jsxs(Z,{variant:"start",children:[e.jsx(ss,{checked:c("is_published")||!1,onCheckedChange:h=>l("is_published",h)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj kurs od razu (możesz to zmienić później)"})]})}),e.jsxs(ws,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>t("courses"),children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:m,children:m?"Tworzenie...":"Utwórz kurs"})]})]})})]})]})},Dw=["📚","🎓","💡","🚀","⭐","🏆","🎯","📖","✏️","🧮"],Iw=()=>{const{list:t}=Ye(),{id:s}=ut(),[n,i]=g.useState(!1),{data:r,isLoading:a}=Ue({resource:"courses",id:s,liveMode:"off"}),{refineCore:{onFinish:o},register:l,handleSubmit:c,setValue:d,watch:m,formState:{errors:u,isSubmitting:h}}=ys({refineCoreProps:{resource:"courses",id:s,liveMode:"off"}}),p=m("icon_emoji");return a?e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs(K,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("courses"),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsx(Z,{children:e.jsx(ve,{title:"Edytuj kurs",description:`Edycja kursu: ${r?.data?.title}`})}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Informacje o kursie"})}),e.jsx(P,{children:e.jsxs(bs,{onSubmit:c(o),children:[e.jsxs(it,{variant:"1-2-2",children:[e.jsx(se,{label:"Tytuł kursu",htmlFor:"title",error:u.title?.message,required:!0,children:e.jsx(Q,{id:"title",placeholder:"np. Podstawy programowania",...l("title",{required:"Tytuł kursu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),e.jsx(se,{label:"Ikona kursu",htmlFor:"icon_emoji",children:e.jsxs("div",{className:"relative",children:[e.jsxs(I,{type:"button",variant:"outline",className:"w-full justify-start",onClick:()=>i(!n),children:[e.jsx("span",{className:"text-2xl mr-2",children:p||"📚"}),"Wybierz ikonę"]}),n&&e.jsx("div",{className:"absolute top-full mt-2 p-2 bg-white border rounded-lg shadow-lg z-10",children:e.jsx("div",{className:"grid grid-cols-5 gap-2",children:Dw.map(b=>e.jsx("button",{type:"button",className:"p-2 hover:bg-gray-100 rounded text-2xl",onClick:()=>{d("icon_emoji",b),i(!1)},children:b},b))})})]})})]}),e.jsx(se,{label:"Opis kursu",htmlFor:"description",error:u.description?.message,children:e.jsx(Nt,{id:"description",placeholder:"Opisz czego uczniowie nauczą się na tym kursie...",rows:4,...l("description")})}),e.jsx(se,{label:"Status publikacji",children:e.jsxs(Z,{variant:"start",children:[e.jsx(ss,{checked:m("is_published")||!1,onCheckedChange:b=>d("is_published",b)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Kurs jest opublikowany i widoczny dla uczniów"})]})}),e.jsxs(ws,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>t("courses"),children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:h,children:h?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},Mw=({topic:t,isExpanded:s,onToggle:n,onDelete:i,onEdit:r,onTogglePublish:a,onNavigateToWizard:o,courseId:l,courseTitle:c,children:d,activitiesCount:m,dragHandleProps:u})=>{const h=J(),p=f=>{const x=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",x),h(f)},b=(f,x)=>{o&&o(f,{courseId:l,courseTitle:c,topicId:t.id,topicTitle:t.title,...x})};return e.jsxs("div",{className:`border-2 rounded-lg overflow-hidden group ${s?"shadow-lg border-primary":"border-border hover:border-primary/50"}`,children:[e.jsx("div",{className:`p-4 ${s?"bg-primary text-primary-foreground":"bg-background hover:bg-muted"}`,children:e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("button",{onClick:n,className:`p-1 rounded ${s?"text-primary-foreground hover:bg-primary-foreground/20":"hover:bg-muted"}`,"aria-label":s?"Zwiń temat":"Rozwiń temat",children:s?e.jsx(Tr,{className:"w-5 h-5"}):e.jsx(nr,{className:"w-5 h-5"})}),e.jsx("div",{className:"cursor-move",...u,children:e.jsx(Ih,{className:`w-4 h-4 ${s?"text-primary-foreground/70":"text-muted-foreground"}`})}),e.jsxs("div",{className:"flex-1 cursor-pointer group",onClick:n,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h4",{className:`font-semibold text-base ${s?"text-primary-foreground":"group-hover:text-primary"}`,children:["Temat ",t.position,": ",t.title]}),e.jsx(H,{variant:t.is_published?s?"secondary":"default":"outline",className:s?"bg-primary-foreground/20 text-primary-foreground border-primary-foreground/30":"",children:t.is_published?"Opublikowany":"Szkic"})]}),e.jsx("div",{className:"flex items-center gap-4 mt-1",children:e.jsxs("span",{className:`text-sm flex items-center gap-1 ${s?"text-primary-foreground/80":"text-muted-foreground"}`,children:[e.jsx(We,{className:"w-3 h-3"}),m," ",m===1?"aktywność":"aktywności"]})})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(vn,{children:[e.jsx(Nn,{asChild:!0,children:e.jsx(I,{size:"sm",variant:s?"secondary":"ghost",title:"Dodaj aktywność",className:`h-8 w-8 p-0 ${s?"bg-primary-foreground/20 hover:bg-primary-foreground/30 text-primary-foreground":""}`,children:e.jsx(qe,{className:"h-4 w-4"})})}),e.jsxs(Js,{align:"end",children:[e.jsx(Zp,{children:"Dodaj treść"}),e.jsxs(pe,{onClick:()=>p(`/activities/create?topic_id=${t.id}`),children:[e.jsx(qe,{className:"mr-2 h-4 w-4"}),"Dodaj ręcznie"]}),e.jsx(xt,{}),e.jsxs(pe,{onClick:()=>b("/teacher/educational-material/step1"),className:"text-purple-600 focus:text-purple-600",children:[e.jsx(lt,{className:"mr-2 h-4 w-4"}),"Generuj materiał z AI"]}),e.jsxs(pe,{onClick:()=>b("/teacher/quiz-wizard/step1"),className:"text-blue-600 focus:text-blue-600",children:[e.jsx(Ds,{className:"mr-2 h-4 w-4"}),"Generuj quiz z AI"]})]})]}),e.jsxs(vn,{children:[e.jsx(Nn,{asChild:!0,children:e.jsx(I,{variant:s?"secondary":"ghost",size:"sm",className:`h-8 w-8 p-0 ${s?"bg-primary-foreground/20 hover:bg-primary-foreground/30 text-primary-foreground":""}`,children:e.jsx(_r,{className:"h-4 w-4"})})}),e.jsxs(Js,{align:"end",children:[e.jsxs(pe,{onClick:()=>r("teacher/topics",t.id),children:[e.jsx(Ht,{className:"mr-2 h-4 w-4"}),"Edytuj temat"]}),e.jsx(xt,{}),e.jsx(pe,{onClick:()=>a(t.id,t.is_published,t.title),children:t.is_published?e.jsxs(e.Fragment,{children:[e.jsx(Xa,{className:"mr-2 h-4 w-4"}),"Ukryj temat"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"mr-2 h-4 w-4"}),"Opublikuj temat"]})}),e.jsx(xt,{}),e.jsxs(pe,{onClick:()=>i(t.id,t.title),className:"text-red-600 focus:text-red-600",children:[e.jsx(xs,{className:"mr-2 h-4 w-4"}),"Usuń temat"]})]})]})]})]})}),s&&e.jsx("div",{className:"p-4 bg-muted/20 border-t-2 border-primary",children:e.jsx("div",{className:"space-y-2",children:d})})]})},Ew=({activity:t,topicPosition:s,onDelete:n,onEdit:i,onTogglePublish:r,dragHandleProps:a})=>{const o=J(),l=()=>t.type==="quiz"?e.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:e.jsx(dt,{className:"w-5 h-5 text-white"})}):e.jsx("div",{className:"p-2 bg-green-600 rounded-lg",children:e.jsx(We,{className:"w-5 h-5 text-white"})}),c=()=>t.type==="quiz"?"Quiz":"Materiał";return e.jsxs("div",{className:"group flex items-center gap-4 p-4 bg-white border-2 rounded-lg hover:border-primary/50 transition-all duration-200",children:[e.jsx("div",{className:"cursor-move opacity-0 group-hover:opacity-100 transition-opacity",...a,children:e.jsx(Ih,{className:"w-4 h-4 text-muted-foreground"})}),l(),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("h5",{className:"font-semibold text-sm text-foreground",children:[s,".",t.position," ",t.title]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{variant:t.type==="quiz"?"default":"secondary",className:"text-xs font-medium",children:c()}),t.type==="quiz"&&t._count?.questions!==void 0&&e.jsxs(H,{variant:"outline",className:"text-xs font-medium border-2",children:[e.jsx(fn,{className:"w-3 h-3 mr-1"}),t._count.questions," ",t._count.questions===1?"pytanie":"pytań"]}),e.jsx(H,{variant:t.is_published?"default":"outline",className:`text-xs font-medium ${t.is_published?"bg-green-600 hover:bg-green-700":"border-2"}`,children:t.is_published?e.jsxs(e.Fragment,{children:[e.jsx(Ey,{className:"w-3 h-3 mr-1"}),"Opublikowany"]}):"Szkic"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[t.duration_min&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Se,{className:"w-3 h-3"}),e.jsxs("span",{children:[t.duration_min," min"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Pe,{className:"w-3 h-3"}),e.jsx("span",{children:"0 ukończeń"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[t.type==="quiz"&&e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>o(`/teacher/questions/manage/${t.id}`),title:"Zarządzaj pytaniami",className:"h-8 w-8 p-0",children:e.jsx(fn,{className:"h-4 w-4"})}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>o(`/teacher/activities/show/${t.id}`),title:"Podgląd",className:"h-8 w-8 p-0",children:e.jsx(Ze,{className:"h-4 w-4"})}),e.jsxs(vn,{children:[e.jsx(Nn,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(_r,{className:"h-4 w-4"})})}),e.jsxs(Js,{align:"end",children:[e.jsxs(pe,{onClick:()=>o(`/teacher/activities/show/${t.id}`),children:[e.jsx(Ze,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),e.jsxs(pe,{onClick:()=>i("teacher/activities",t.id),children:[e.jsx(Ht,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),e.jsx(xt,{}),e.jsx(pe,{onClick:()=>r(t.id,t.is_published,t.title),children:t.is_published?e.jsxs(e.Fragment,{children:[e.jsx(Xa,{className:"mr-2 h-4 w-4"}),"Ukryj aktywność"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"mr-2 h-4 w-4"}),"Opublikuj aktywność"]})}),t.type==="quiz"&&e.jsxs(e.Fragment,{children:[e.jsx(xt,{}),e.jsxs(pe,{onClick:()=>o(`/teacher/questions/manage/${t.id}`),className:"text-blue-600 focus:text-blue-600",children:[e.jsx(fn,{className:"mr-2 h-4 w-4"}),"Zarządzaj pytaniami"]}),e.jsxs(pe,{onClick:()=>o(`/teacher/questions/create?activity_id=${t.id}`),className:"text-blue-600 focus:text-blue-600",children:[e.jsx(qe,{className:"mr-2 h-4 w-4"}),"Dodaj pytanie"]})]}),e.jsx(xt,{}),e.jsxs(pe,{onClick:()=>n(t.id,t.title),className:"text-red-600 focus:text-red-600",children:[e.jsx(xs,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})]})},Lw=({course:t})=>t?e.jsx(_,{className:"flex-1",children:e.jsx(P,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[t.icon_emoji&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-3xl",children:t.icon_emoji})})}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:t.title}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t.is_published?"Opublikowany":"Szkic"}),t.created_at&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Utworzony: ",new Date(t.created_at).toLocaleDateString("pl-PL")]})]})]}),t.description&&e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-muted-foreground leading-relaxed whitespace-pre-wrap",children:t.description})})]})]})})}):null;function Ow(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return g.useMemo(()=>i=>{s.forEach(r=>r(i))},s)}const mo=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function xi(t){const s=Object.prototype.toString.call(t);return s==="[object Window]"||s==="[object global]"}function yc(t){return"nodeType"in t}function kt(t){var s,n;return t?xi(t)?t:yc(t)&&(s=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?s:window:window}function bc(t){const{Document:s}=kt(t);return t instanceof s}function Lr(t){return xi(t)?!1:t instanceof kt(t).HTMLElement}function Yp(t){return t instanceof kt(t).SVGElement}function gi(t){return t?xi(t)?t.document:yc(t)?bc(t)?t:Lr(t)||Yp(t)?t.ownerDocument:document:document:document}const gs=mo?g.useLayoutEffect:g.useEffect;function wc(t){const s=g.useRef(t);return gs(()=>{s.current=t}),g.useCallback(function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return s.current==null?void 0:s.current(...i)},[])}function Rw(){const t=g.useRef(null),s=g.useCallback((i,r)=>{t.current=setInterval(i,r)},[]),n=g.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[s,n]}function dr(t,s){s===void 0&&(s=[t]);const n=g.useRef(t);return gs(()=>{n.current!==t&&(n.current=t)},s),n}function Or(t,s){const n=g.useRef();return g.useMemo(()=>{const i=t(n.current);return n.current=i,i},[...s])}function Ia(t){const s=wc(t),n=g.useRef(null),i=g.useCallback(r=>{r!==n.current&&s?.(r,n.current),n.current=r},[]);return[n,i]}function bl(t){const s=g.useRef();return g.useEffect(()=>{s.current=t},[t]),s.current}let qo={};function Rr(t,s){return g.useMemo(()=>{if(s)return s;const n=qo[t]==null?0:qo[t]+1;return qo[t]=n,t+"-"+n},[t,s])}function Jp(t){return function(s){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.reduce((a,o)=>{const l=Object.entries(o);for(const[c,d]of l){const m=a[c];m!=null&&(a[c]=m+t*d)}return a},{...s})}}const ei=Jp(1),ur=Jp(-1);function $w(t){return"clientX"in t&&"clientY"in t}function vc(t){if(!t)return!1;const{KeyboardEvent:s}=kt(t.target);return s&&t instanceof s}function qw(t){if(!t)return!1;const{TouchEvent:s}=kt(t.target);return s&&t instanceof s}function wl(t){if(qw(t)){if(t.touches&&t.touches.length){const{clientX:s,clientY:n}=t.touches[0];return{x:s,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:s,clientY:n}=t.changedTouches[0];return{x:s,y:n}}}return $w(t)?{x:t.clientX,y:t.clientY}:null}const mr=Object.freeze({Translate:{toString(t){if(!t)return;const{x:s,y:n}=t;return"translate3d("+(s?Math.round(s):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:s,scaleY:n}=t;return"scaleX("+s+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[mr.Translate.toString(t),mr.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:s,duration:n,easing:i}=t;return s+" "+n+"ms "+i}}}),Wd="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Fw(t){return t.matches(Wd)?t:t.querySelector(Wd)}const Bw={display:"none"};function Uw(t){let{id:s,value:n}=t;return te.createElement("div",{id:s,style:Bw},n)}function Vw(t){let{id:s,announcement:n,ariaLiveType:i="assertive"}=t;const r={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return te.createElement("div",{id:s,style:r,role:"status","aria-live":i,"aria-atomic":!0},n)}function Ww(){const[t,s]=g.useState("");return{announce:g.useCallback(i=>{i!=null&&s(i)},[]),announcement:t}}const Xp=g.createContext(null);function Kw(t){const s=g.useContext(Xp);g.useEffect(()=>{if(!s)throw new Error("useDndMonitor must be used within a children of <DndContext>");return s(t)},[t,s])}function Gw(){const[t]=g.useState(()=>new Set),s=g.useCallback(i=>(t.add(i),()=>t.delete(i)),[t]);return[g.useCallback(i=>{let{type:r,event:a}=i;t.forEach(o=>{var l;return(l=o[r])==null?void 0:l.call(o,a)})},[t]),s]}const Hw={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Qw={onDragStart(t){let{active:s}=t;return"Picked up draggable item "+s.id+"."},onDragOver(t){let{active:s,over:n}=t;return n?"Draggable item "+s.id+" was moved over droppable area "+n.id+".":"Draggable item "+s.id+" is no longer over a droppable area."},onDragEnd(t){let{active:s,over:n}=t;return n?"Draggable item "+s.id+" was dropped over droppable area "+n.id:"Draggable item "+s.id+" was dropped."},onDragCancel(t){let{active:s}=t;return"Dragging was cancelled. Draggable item "+s.id+" was dropped."}};function Zw(t){let{announcements:s=Qw,container:n,hiddenTextDescribedById:i,screenReaderInstructions:r=Hw}=t;const{announce:a,announcement:o}=Ww(),l=Rr("DndLiveRegion"),[c,d]=g.useState(!1);if(g.useEffect(()=>{d(!0)},[]),Kw(g.useMemo(()=>({onDragStart(u){let{active:h}=u;a(s.onDragStart({active:h}))},onDragMove(u){let{active:h,over:p}=u;s.onDragMove&&a(s.onDragMove({active:h,over:p}))},onDragOver(u){let{active:h,over:p}=u;a(s.onDragOver({active:h,over:p}))},onDragEnd(u){let{active:h,over:p}=u;a(s.onDragEnd({active:h,over:p}))},onDragCancel(u){let{active:h,over:p}=u;a(s.onDragCancel({active:h,over:p}))}}),[a,s])),!c)return null;const m=te.createElement(te.Fragment,null,te.createElement(Uw,{id:i,value:r.draggable}),te.createElement(Vw,{id:l,announcement:o}));return n?Bi.createPortal(m,n):m}var Ve;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Ve||(Ve={}));function Ma(){}function Kd(t,s){return g.useMemo(()=>({sensor:t,options:s??{}}),[t,s])}function Yw(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return g.useMemo(()=>[...s].filter(i=>i!=null),[...s])}const ts=Object.freeze({x:0,y:0});function ef(t,s){return Math.sqrt(Math.pow(t.x-s.x,2)+Math.pow(t.y-s.y,2))}function tf(t,s){let{data:{value:n}}=t,{data:{value:i}}=s;return n-i}function Jw(t,s){let{data:{value:n}}=t,{data:{value:i}}=s;return i-n}function Gd(t){let{left:s,top:n,height:i,width:r}=t;return[{x:s,y:n},{x:s+r,y:n},{x:s,y:n+i},{x:s+r,y:n+i}]}function sf(t,s){if(!t||t.length===0)return null;const[n]=t;return n[s]}function Hd(t,s,n){return s===void 0&&(s=t.left),n===void 0&&(n=t.top),{x:s+t.width*.5,y:n+t.height*.5}}const Xw=t=>{let{collisionRect:s,droppableRects:n,droppableContainers:i}=t;const r=Hd(s,s.left,s.top),a=[];for(const o of i){const{id:l}=o,c=n.get(l);if(c){const d=ef(Hd(c),r);a.push({id:l,data:{droppableContainer:o,value:d}})}}return a.sort(tf)},ev=t=>{let{collisionRect:s,droppableRects:n,droppableContainers:i}=t;const r=Gd(s),a=[];for(const o of i){const{id:l}=o,c=n.get(l);if(c){const d=Gd(c),m=r.reduce((h,p,b)=>h+ef(d[b],p),0),u=Number((m/4).toFixed(4));a.push({id:l,data:{droppableContainer:o,value:u}})}}return a.sort(tf)};function tv(t,s){const n=Math.max(s.top,t.top),i=Math.max(s.left,t.left),r=Math.min(s.left+s.width,t.left+t.width),a=Math.min(s.top+s.height,t.top+t.height),o=r-i,l=a-n;if(i<r&&n<a){const c=s.width*s.height,d=t.width*t.height,m=o*l,u=m/(c+d-m);return Number(u.toFixed(4))}return 0}const sv=t=>{let{collisionRect:s,droppableRects:n,droppableContainers:i}=t;const r=[];for(const a of i){const{id:o}=a,l=n.get(o);if(l){const c=tv(l,s);c>0&&r.push({id:o,data:{droppableContainer:a,value:c}})}}return r.sort(Jw)};function nv(t,s,n){return{...t,scaleX:s&&n?s.width/n.width:1,scaleY:s&&n?s.height/n.height:1}}function nf(t,s){return t&&s?{x:t.left-s.left,y:t.top-s.top}:ts}function iv(t){return function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),a=1;a<i;a++)r[a-1]=arguments[a];return r.reduce((o,l)=>({...o,top:o.top+t*l.y,bottom:o.bottom+t*l.y,left:o.left+t*l.x,right:o.right+t*l.x}),{...n})}}const rv=iv(1);function av(t){if(t.startsWith("matrix3d(")){const s=t.slice(9,-1).split(/, /);return{x:+s[12],y:+s[13],scaleX:+s[0],scaleY:+s[5]}}else if(t.startsWith("matrix(")){const s=t.slice(7,-1).split(/, /);return{x:+s[4],y:+s[5],scaleX:+s[0],scaleY:+s[3]}}return null}function ov(t,s,n){const i=av(s);if(!i)return t;const{scaleX:r,scaleY:a,x:o,y:l}=i,c=t.left-o-(1-r)*parseFloat(n),d=t.top-l-(1-a)*parseFloat(n.slice(n.indexOf(" ")+1)),m=r?t.width/r:t.width,u=a?t.height/a:t.height;return{width:m,height:u,top:d,right:c+m,bottom:d+u,left:c}}const lv={ignoreTransform:!1};function ji(t,s){s===void 0&&(s=lv);let n=t.getBoundingClientRect();if(s.ignoreTransform){const{transform:d,transformOrigin:m}=kt(t).getComputedStyle(t);d&&(n=ov(n,d,m))}const{top:i,left:r,width:a,height:o,bottom:l,right:c}=n;return{top:i,left:r,width:a,height:o,bottom:l,right:c}}function Qd(t){return ji(t,{ignoreTransform:!0})}function cv(t){const s=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:s,bottom:n,width:s,height:n}}function dv(t,s){return s===void 0&&(s=kt(t).getComputedStyle(t)),s.position==="fixed"}function uv(t,s){s===void 0&&(s=kt(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(r=>{const a=s[r];return typeof a=="string"?n.test(a):!1})}function ho(t,s){const n=[];function i(r){if(s!=null&&n.length>=s||!r)return n;if(bc(r)&&r.scrollingElement!=null&&!n.includes(r.scrollingElement))return n.push(r.scrollingElement),n;if(!Lr(r)||Yp(r)||n.includes(r))return n;const a=kt(t).getComputedStyle(r);return r!==t&&uv(r,a)&&n.push(r),dv(r,a)?n:i(r.parentNode)}return t?i(t):n}function rf(t){const[s]=ho(t,1);return s??null}function Fo(t){return!mo||!t?null:xi(t)?t:yc(t)?bc(t)||t===gi(t).scrollingElement?window:Lr(t)?t:null:null}function af(t){return xi(t)?t.scrollX:t.scrollLeft}function of(t){return xi(t)?t.scrollY:t.scrollTop}function vl(t){return{x:af(t),y:of(t)}}var Qe;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Qe||(Qe={}));function lf(t){return!mo||!t?!1:t===document.scrollingElement}function cf(t){const s={x:0,y:0},n=lf(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},i={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},r=t.scrollTop<=s.y,a=t.scrollLeft<=s.x,o=t.scrollTop>=i.y,l=t.scrollLeft>=i.x;return{isTop:r,isLeft:a,isBottom:o,isRight:l,maxScroll:i,minScroll:s}}const mv={x:.2,y:.2};function hv(t,s,n,i,r){let{top:a,left:o,right:l,bottom:c}=n;i===void 0&&(i=10),r===void 0&&(r=mv);const{isTop:d,isBottom:m,isLeft:u,isRight:h}=cf(t),p={x:0,y:0},b={x:0,y:0},f={height:s.height*r.y,width:s.width*r.x};return!d&&a<=s.top+f.height?(p.y=Qe.Backward,b.y=i*Math.abs((s.top+f.height-a)/f.height)):!m&&c>=s.bottom-f.height&&(p.y=Qe.Forward,b.y=i*Math.abs((s.bottom-f.height-c)/f.height)),!h&&l>=s.right-f.width?(p.x=Qe.Forward,b.x=i*Math.abs((s.right-f.width-l)/f.width)):!u&&o<=s.left+f.width&&(p.x=Qe.Backward,b.x=i*Math.abs((s.left+f.width-o)/f.width)),{direction:p,speed:b}}function pv(t){if(t===document.scrollingElement){const{innerWidth:a,innerHeight:o}=window;return{top:0,left:0,right:a,bottom:o,width:a,height:o}}const{top:s,left:n,right:i,bottom:r}=t.getBoundingClientRect();return{top:s,left:n,right:i,bottom:r,width:t.clientWidth,height:t.clientHeight}}function df(t){return t.reduce((s,n)=>ei(s,vl(n)),ts)}function fv(t){return t.reduce((s,n)=>s+af(n),0)}function xv(t){return t.reduce((s,n)=>s+of(n),0)}function gv(t,s){if(s===void 0&&(s=ji),!t)return;const{top:n,left:i,bottom:r,right:a}=s(t);rf(t)&&(r<=0||a<=0||n>=window.innerHeight||i>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const jv=[["x",["left","right"],fv],["y",["top","bottom"],xv]];class Nc{constructor(s,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const i=ho(n),r=df(i);this.rect={...s},this.width=s.width,this.height=s.height;for(const[a,o,l]of jv)for(const c of o)Object.defineProperty(this,c,{get:()=>{const d=l(i),m=r[a]-d;return this.rect[c]+m},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Gi{constructor(s){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var i;return(i=this.target)==null?void 0:i.removeEventListener(...n)})},this.target=s}add(s,n,i){var r;(r=this.target)==null||r.addEventListener(s,n,i),this.listeners.push([s,n,i])}}function yv(t){const{EventTarget:s}=kt(t);return t instanceof s?t:gi(t)}function Bo(t,s){const n=Math.abs(t.x),i=Math.abs(t.y);return typeof s=="number"?Math.sqrt(n**2+i**2)>s:"x"in s&&"y"in s?n>s.x&&i>s.y:"x"in s?n>s.x:"y"in s?i>s.y:!1}var qt;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(qt||(qt={}));function Zd(t){t.preventDefault()}function bv(t){t.stopPropagation()}var oe;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(oe||(oe={}));const uf={start:[oe.Space,oe.Enter],cancel:[oe.Esc],end:[oe.Space,oe.Enter,oe.Tab]},wv=(t,s)=>{let{currentCoordinates:n}=s;switch(t.code){case oe.Right:return{...n,x:n.x+25};case oe.Left:return{...n,x:n.x-25};case oe.Down:return{...n,y:n.y+25};case oe.Up:return{...n,y:n.y-25}}};class kc{constructor(s){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=s;const{event:{target:n}}=s;this.props=s,this.listeners=new Gi(gi(n)),this.windowListeners=new Gi(kt(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(qt.Resize,this.handleCancel),this.windowListeners.add(qt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(qt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:s,onStart:n}=this.props,i=s.node.current;i&&gv(i),n(ts)}handleKeyDown(s){if(vc(s)){const{active:n,context:i,options:r}=this.props,{keyboardCodes:a=uf,coordinateGetter:o=wv,scrollBehavior:l="smooth"}=r,{code:c}=s;if(a.end.includes(c)){this.handleEnd(s);return}if(a.cancel.includes(c)){this.handleCancel(s);return}const{collisionRect:d}=i.current,m=d?{x:d.left,y:d.top}:ts;this.referenceCoordinates||(this.referenceCoordinates=m);const u=o(s,{active:n,context:i.current,currentCoordinates:m});if(u){const h=ur(u,m),p={x:0,y:0},{scrollableAncestors:b}=i.current;for(const f of b){const x=s.code,{isTop:w,isRight:y,isLeft:N,isBottom:A,maxScroll:S,minScroll:k}=cf(f),v=pv(f),z={x:Math.min(x===oe.Right?v.right-v.width/2:v.right,Math.max(x===oe.Right?v.left:v.left+v.width/2,u.x)),y:Math.min(x===oe.Down?v.bottom-v.height/2:v.bottom,Math.max(x===oe.Down?v.top:v.top+v.height/2,u.y))},D=x===oe.Right&&!y||x===oe.Left&&!N,j=x===oe.Down&&!A||x===oe.Up&&!w;if(D&&z.x!==u.x){const C=f.scrollLeft+h.x,T=x===oe.Right&&C<=S.x||x===oe.Left&&C>=k.x;if(T&&!h.y){f.scrollTo({left:C,behavior:l});return}T?p.x=f.scrollLeft-C:p.x=x===oe.Right?f.scrollLeft-S.x:f.scrollLeft-k.x,p.x&&f.scrollBy({left:-p.x,behavior:l});break}else if(j&&z.y!==u.y){const C=f.scrollTop+h.y,T=x===oe.Down&&C<=S.y||x===oe.Up&&C>=k.y;if(T&&!h.x){f.scrollTo({top:C,behavior:l});return}T?p.y=f.scrollTop-C:p.y=x===oe.Down?f.scrollTop-S.y:f.scrollTop-k.y,p.y&&f.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(s,ei(ur(u,this.referenceCoordinates),p))}}}handleMove(s,n){const{onMove:i}=this.props;s.preventDefault(),i(n)}handleEnd(s){const{onEnd:n}=this.props;s.preventDefault(),this.detach(),n()}handleCancel(s){const{onCancel:n}=this.props;s.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}kc.activators=[{eventName:"onKeyDown",handler:(t,s,n)=>{let{keyboardCodes:i=uf,onActivation:r}=s,{active:a}=n;const{code:o}=t.nativeEvent;if(i.start.includes(o)){const l=a.activatorNode.current;return l&&t.target!==l?!1:(t.preventDefault(),r?.({event:t.nativeEvent}),!0)}return!1}}];function Yd(t){return!!(t&&"distance"in t)}function Jd(t){return!!(t&&"delay"in t)}class zc{constructor(s,n,i){var r;i===void 0&&(i=yv(s.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=s,this.events=n;const{event:a}=s,{target:o}=a;this.props=s,this.events=n,this.document=gi(o),this.documentListeners=new Gi(this.document),this.listeners=new Gi(i),this.windowListeners=new Gi(kt(o)),this.initialCoordinates=(r=wl(a))!=null?r:ts,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:s,props:{options:{activationConstraint:n,bypassActivationConstraint:i}}}=this;if(this.listeners.add(s.move.name,this.handleMove,{passive:!1}),this.listeners.add(s.end.name,this.handleEnd),s.cancel&&this.listeners.add(s.cancel.name,this.handleCancel),this.windowListeners.add(qt.Resize,this.handleCancel),this.windowListeners.add(qt.DragStart,Zd),this.windowListeners.add(qt.VisibilityChange,this.handleCancel),this.windowListeners.add(qt.ContextMenu,Zd),this.documentListeners.add(qt.Keydown,this.handleKeydown),n){if(i!=null&&i({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Jd(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Yd(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(s,n){const{active:i,onPending:r}=this.props;r(i,s,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:s}=this,{onStart:n}=this.props;s&&(this.activated=!0,this.documentListeners.add(qt.Click,bv,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(qt.SelectionChange,this.removeTextSelection),n(s))}handleMove(s){var n;const{activated:i,initialCoordinates:r,props:a}=this,{onMove:o,options:{activationConstraint:l}}=a;if(!r)return;const c=(n=wl(s))!=null?n:ts,d=ur(r,c);if(!i&&l){if(Yd(l)){if(l.tolerance!=null&&Bo(d,l.tolerance))return this.handleCancel();if(Bo(d,l.distance))return this.handleStart()}if(Jd(l)&&Bo(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}s.cancelable&&s.preventDefault(),o(c)}handleEnd(){const{onAbort:s,onEnd:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleCancel(){const{onAbort:s,onCancel:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleKeydown(s){s.code===oe.Esc&&this.handleCancel()}removeTextSelection(){var s;(s=this.document.getSelection())==null||s.removeAllRanges()}}const vv={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Sc extends zc{constructor(s){const{event:n}=s,i=gi(n.target);super(s,vv,i)}}Sc.activators=[{eventName:"onPointerDown",handler:(t,s)=>{let{nativeEvent:n}=t,{onActivation:i}=s;return!n.isPrimary||n.button!==0?!1:(i?.({event:n}),!0)}}];const Nv={move:{name:"mousemove"},end:{name:"mouseup"}};var Nl;(function(t){t[t.RightClick=2]="RightClick"})(Nl||(Nl={}));class kv extends zc{constructor(s){super(s,Nv,gi(s.event.target))}}kv.activators=[{eventName:"onMouseDown",handler:(t,s)=>{let{nativeEvent:n}=t,{onActivation:i}=s;return n.button===Nl.RightClick?!1:(i?.({event:n}),!0)}}];const Uo={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class zv extends zc{constructor(s){super(s,Uo)}static setup(){return window.addEventListener(Uo.move.name,s,{capture:!1,passive:!1}),function(){window.removeEventListener(Uo.move.name,s)};function s(){}}}zv.activators=[{eventName:"onTouchStart",handler:(t,s)=>{let{nativeEvent:n}=t,{onActivation:i}=s;const{touches:r}=n;return r.length>1?!1:(i?.({event:n}),!0)}}];var Hi;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(Hi||(Hi={}));var Ea;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ea||(Ea={}));function Sv(t){let{acceleration:s,activator:n=Hi.Pointer,canScroll:i,draggingRect:r,enabled:a,interval:o=5,order:l=Ea.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:m,delta:u,threshold:h}=t;const p=Tv({delta:u,disabled:!a}),[b,f]=Rw(),x=g.useRef({x:0,y:0}),w=g.useRef({x:0,y:0}),y=g.useMemo(()=>{switch(n){case Hi.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Hi.DraggableRect:return r}},[n,r,c]),N=g.useRef(null),A=g.useCallback(()=>{const k=N.current;if(!k)return;const v=x.current.x*w.current.x,z=x.current.y*w.current.y;k.scrollBy(v,z)},[]),S=g.useMemo(()=>l===Ea.TreeOrder?[...d].reverse():d,[l,d]);g.useEffect(()=>{if(!a||!d.length||!y){f();return}for(const k of S){if(i?.(k)===!1)continue;const v=d.indexOf(k),z=m[v];if(!z)continue;const{direction:D,speed:j}=hv(k,z,y,s,h);for(const C of["x","y"])p[C][D[C]]||(j[C]=0,D[C]=0);if(j.x>0||j.y>0){f(),N.current=k,b(A,o),x.current=j,w.current=D;return}}x.current={x:0,y:0},w.current={x:0,y:0},f()},[s,A,i,f,a,o,JSON.stringify(y),JSON.stringify(p),b,d,S,m,JSON.stringify(h)])}const Cv={x:{[Qe.Backward]:!1,[Qe.Forward]:!1},y:{[Qe.Backward]:!1,[Qe.Forward]:!1}};function Tv(t){let{delta:s,disabled:n}=t;const i=bl(s);return Or(r=>{if(n||!i||!r)return Cv;const a={x:Math.sign(s.x-i.x),y:Math.sign(s.y-i.y)};return{x:{[Qe.Backward]:r.x[Qe.Backward]||a.x===-1,[Qe.Forward]:r.x[Qe.Forward]||a.x===1},y:{[Qe.Backward]:r.y[Qe.Backward]||a.y===-1,[Qe.Forward]:r.y[Qe.Forward]||a.y===1}}},[n,s,i])}function Av(t,s){const n=s!=null?t.get(s):void 0,i=n?n.node.current:null;return Or(r=>{var a;return s==null?null:(a=i??r)!=null?a:null},[i,s])}function _v(t,s){return g.useMemo(()=>t.reduce((n,i)=>{const{sensor:r}=i,a=r.activators.map(o=>({eventName:o.eventName,handler:s(o.handler,i)}));return[...n,...a]},[]),[t,s])}var hr;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(hr||(hr={}));var kl;(function(t){t.Optimized="optimized"})(kl||(kl={}));const Xd=new Map;function Pv(t,s){let{dragging:n,dependencies:i,config:r}=s;const[a,o]=g.useState(null),{frequency:l,measure:c,strategy:d}=r,m=g.useRef(t),u=x(),h=dr(u),p=g.useCallback(function(w){w===void 0&&(w=[]),!h.current&&o(y=>y===null?w:y.concat(w.filter(N=>!y.includes(N))))},[h]),b=g.useRef(null),f=Or(w=>{if(u&&!n)return Xd;if(!w||w===Xd||m.current!==t||a!=null){const y=new Map;for(let N of t){if(!N)continue;if(a&&a.length>0&&!a.includes(N.id)&&N.rect.current){y.set(N.id,N.rect.current);continue}const A=N.node.current,S=A?new Nc(c(A),A):null;N.rect.current=S,S&&y.set(N.id,S)}return y}return w},[t,a,n,u,c]);return g.useEffect(()=>{m.current=t},[t]),g.useEffect(()=>{u||p()},[n,u]),g.useEffect(()=>{a&&a.length>0&&o(null)},[JSON.stringify(a)]),g.useEffect(()=>{u||typeof l!="number"||b.current!==null||(b.current=setTimeout(()=>{p(),b.current=null},l))},[l,u,p,...i]),{droppableRects:f,measureDroppableContainers:p,measuringScheduled:a!=null};function x(){switch(d){case hr.Always:return!1;case hr.BeforeDragging:return n;default:return!n}}}function mf(t,s){return Or(n=>t?n||(typeof s=="function"?s(t):t):null,[s,t])}function Dv(t,s){return mf(t,s)}function Iv(t){let{callback:s,disabled:n}=t;const i=wc(s),r=g.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(i)},[i,n]);return g.useEffect(()=>()=>r?.disconnect(),[r]),r}function po(t){let{callback:s,disabled:n}=t;const i=wc(s),r=g.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(i)},[n]);return g.useEffect(()=>()=>r?.disconnect(),[r]),r}function Mv(t){return new Nc(ji(t),t)}function eu(t,s,n){s===void 0&&(s=Mv);const[i,r]=g.useState(null);function a(){r(c=>{if(!t)return null;if(t.isConnected===!1){var d;return(d=c??n)!=null?d:null}const m=s(t);return JSON.stringify(c)===JSON.stringify(m)?c:m})}const o=Iv({callback(c){if(t)for(const d of c){const{type:m,target:u}=d;if(m==="childList"&&u instanceof HTMLElement&&u.contains(t)){a();break}}}}),l=po({callback:a});return gs(()=>{a(),t?(l?.observe(t),o?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),o?.disconnect())},[t]),i}function Ev(t){const s=mf(t);return nf(t,s)}const tu=[];function Lv(t){const s=g.useRef(t),n=Or(i=>t?i&&i!==tu&&t&&s.current&&t.parentNode===s.current.parentNode?i:ho(t):tu,[t]);return g.useEffect(()=>{s.current=t},[t]),n}function Ov(t){const[s,n]=g.useState(null),i=g.useRef(t),r=g.useCallback(a=>{const o=Fo(a.target);o&&n(l=>l?(l.set(o,vl(o)),new Map(l)):null)},[]);return g.useEffect(()=>{const a=i.current;if(t!==a){o(a);const l=t.map(c=>{const d=Fo(c);return d?(d.addEventListener("scroll",r,{passive:!0}),[d,vl(d)]):null}).filter(c=>c!=null);n(l.length?new Map(l):null),i.current=t}return()=>{o(t),o(a)};function o(l){l.forEach(c=>{const d=Fo(c);d?.removeEventListener("scroll",r)})}},[r,t]),g.useMemo(()=>t.length?s?Array.from(s.values()).reduce((a,o)=>ei(a,o),ts):df(t):ts,[t,s])}function su(t,s){s===void 0&&(s=[]);const n=g.useRef(null);return g.useEffect(()=>{n.current=null},s),g.useEffect(()=>{const i=t!==ts;i&&!n.current&&(n.current=t),!i&&n.current&&(n.current=null)},[t]),n.current?ur(t,n.current):ts}function Rv(t){g.useEffect(()=>{if(!mo)return;const s=t.map(n=>{let{sensor:i}=n;return i.setup==null?void 0:i.setup()});return()=>{for(const n of s)n?.()}},t.map(s=>{let{sensor:n}=s;return n}))}function $v(t,s){return g.useMemo(()=>t.reduce((n,i)=>{let{eventName:r,handler:a}=i;return n[r]=o=>{a(o,s)},n},{}),[t,s])}function hf(t){return g.useMemo(()=>t?cv(t):null,[t])}const nu=[];function qv(t,s){s===void 0&&(s=ji);const[n]=t,i=hf(n?kt(n):null),[r,a]=g.useState(nu);function o(){a(()=>t.length?t.map(c=>lf(c)?i:new Nc(s(c),c)):nu)}const l=po({callback:o});return gs(()=>{l?.disconnect(),o(),t.forEach(c=>l?.observe(c))},[t]),r}function Fv(t){if(!t)return null;if(t.children.length>1)return t;const s=t.children[0];return Lr(s)?s:t}function Bv(t){let{measure:s}=t;const[n,i]=g.useState(null),r=g.useCallback(d=>{for(const{target:m}of d)if(Lr(m)){i(u=>{const h=s(m);return u?{...u,width:h.width,height:h.height}:h});break}},[s]),a=po({callback:r}),o=g.useCallback(d=>{const m=Fv(d);a?.disconnect(),m&&a?.observe(m),i(m?s(m):null)},[s,a]),[l,c]=Ia(o);return g.useMemo(()=>({nodeRef:l,rect:n,setRef:c}),[n,l,c])}const Uv=[{sensor:Sc,options:{}},{sensor:kc,options:{}}],Vv={current:{}},xa={draggable:{measure:Qd},droppable:{measure:Qd,strategy:hr.WhileDragging,frequency:kl.Optimized},dragOverlay:{measure:ji}};class Qi extends Map{get(s){var n;return s!=null&&(n=super.get(s))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(s=>{let{disabled:n}=s;return!n})}getNodeFor(s){var n,i;return(n=(i=this.get(s))==null?void 0:i.node.current)!=null?n:void 0}}const Wv={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Qi,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ma},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:xa,measureDroppableContainers:Ma,windowRect:null,measuringScheduled:!1},Kv={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ma,draggableNodes:new Map,over:null,measureDroppableContainers:Ma},fo=g.createContext(Kv),pf=g.createContext(Wv);function Gv(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Qi}}}function Hv(t,s){switch(s.type){case Ve.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:s.initialCoordinates,active:s.active}};case Ve.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:s.coordinates.x-t.draggable.initialCoordinates.x,y:s.coordinates.y-t.draggable.initialCoordinates.y}}};case Ve.DragEnd:case Ve.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ve.RegisterDroppable:{const{element:n}=s,{id:i}=n,r=new Qi(t.droppable.containers);return r.set(i,n),{...t,droppable:{...t.droppable,containers:r}}}case Ve.SetDroppableDisabled:{const{id:n,key:i,disabled:r}=s,a=t.droppable.containers.get(n);if(!a||i!==a.key)return t;const o=new Qi(t.droppable.containers);return o.set(n,{...a,disabled:r}),{...t,droppable:{...t.droppable,containers:o}}}case Ve.UnregisterDroppable:{const{id:n,key:i}=s,r=t.droppable.containers.get(n);if(!r||i!==r.key)return t;const a=new Qi(t.droppable.containers);return a.delete(n),{...t,droppable:{...t.droppable,containers:a}}}default:return t}}function Qv(t){let{disabled:s}=t;const{active:n,activatorEvent:i,draggableNodes:r}=g.useContext(fo),a=bl(i),o=bl(n?.id);return g.useEffect(()=>{if(!s&&!i&&a&&o!=null){if(!vc(a)||document.activeElement===a.target)return;const l=r.get(o);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const m of[c.current,d.current]){if(!m)continue;const u=Fw(m);if(u){u.focus();break}}})}},[i,s,r,o,a]),null}function Zv(t,s){let{transform:n,...i}=s;return t!=null&&t.length?t.reduce((r,a)=>a({transform:r,...i}),n):n}function Yv(t){return g.useMemo(()=>({draggable:{...xa.draggable,...t?.draggable},droppable:{...xa.droppable,...t?.droppable},dragOverlay:{...xa.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function Jv(t){let{activeNode:s,measure:n,initialRect:i,config:r=!0}=t;const a=g.useRef(!1),{x:o,y:l}=typeof r=="boolean"?{x:r,y:r}:r;gs(()=>{if(!o&&!l||!s){a.current=!1;return}if(a.current||!i)return;const d=s?.node.current;if(!d||d.isConnected===!1)return;const m=n(d),u=nf(m,i);if(o||(u.x=0),l||(u.y=0),a.current=!0,Math.abs(u.x)>0||Math.abs(u.y)>0){const h=rf(d);h&&h.scrollBy({top:u.y,left:u.x})}},[s,o,l,i,n])}const ff=g.createContext({...ts,scaleX:1,scaleY:1});var Vs;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Vs||(Vs={}));const Xv=g.memo(function(s){var n,i,r,a;let{id:o,accessibility:l,autoScroll:c=!0,children:d,sensors:m=Uv,collisionDetection:u=sv,measuring:h,modifiers:p,...b}=s;const f=g.useReducer(Hv,void 0,Gv),[x,w]=f,[y,N]=Gw(),[A,S]=g.useState(Vs.Uninitialized),k=A===Vs.Initialized,{draggable:{active:v,nodes:z,translate:D},droppable:{containers:j}}=x,C=v!=null?z.get(v):null,T=g.useRef({initial:null,translated:null}),E=g.useMemo(()=>{var rt;return v!=null?{id:v,data:(rt=C?.data)!=null?rt:Vv,rect:T}:null},[v,C]),M=g.useRef(null),[F,X]=g.useState(null),[R,G]=g.useState(null),U=dr(b,Object.values(b)),le=Rr("DndDescribedBy",o),q=g.useMemo(()=>j.getEnabled(),[j]),ee=Yv(h),{droppableRects:Je,measureDroppableContainers:Qt,measuringScheduled:Os}=Pv(q,{dragging:k,dependencies:[D.x,D.y],config:ee.droppable}),Ge=Av(z,v),He=g.useMemo(()=>R?wl(R):null,[R]),Zt=Sj(),Ns=Dv(Ge,ee.draggable.measure);Jv({activeNode:v!=null?z.get(v):null,config:Zt.layoutShiftCompensation,initialRect:Ns,measure:ee.draggable.measure});const fe=eu(Ge,ee.draggable.measure,Ns),Di=eu(Ge?Ge.parentElement:null),is=g.useRef({activatorEvent:null,active:null,activeNode:Ge,collisionRect:null,collisions:null,droppableRects:Je,draggableNodes:z,draggingNode:null,draggingNodeRect:null,droppableContainers:j,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),In=j.getNodeFor((n=is.current.over)==null?void 0:n.id),ks=Bv({measure:ee.dragOverlay.measure}),Mn=(i=ks.nodeRef.current)!=null?i:Ge,En=k?(r=ks.rect)!=null?r:fe:null,Sd=!!(ks.nodeRef.current&&ks.rect),Cd=Ev(Sd?null:fe),Eo=hf(Mn?kt(Mn):null),Rs=Lv(k?In??Ge:null),ea=qv(Rs),ta=Zv(p,{transform:{x:D.x-Cd.x,y:D.y-Cd.y,scaleX:1,scaleY:1},activatorEvent:R,active:E,activeNodeRect:fe,containerNodeRect:Di,draggingNodeRect:En,over:is.current.over,overlayNodeRect:ks.rect,scrollableAncestors:Rs,scrollableAncestorRects:ea,windowRect:Eo}),Td=He?ei(He,D):null,Ad=Ov(Rs),yj=su(Ad),bj=su(Ad,[fe]),Ln=ei(ta,yj),On=En?rv(En,ta):null,Ii=E&&On?u({active:E,collisionRect:On,droppableRects:Je,droppableContainers:q,pointerCoordinates:Td}):null,_d=sf(Ii,"id"),[$s,Pd]=g.useState(null),wj=Sd?ta:ei(ta,bj),vj=nv(wj,(a=$s?.rect)!=null?a:null,fe),Lo=g.useRef(null),Dd=g.useCallback((rt,zt)=>{let{sensor:St,options:qs}=zt;if(M.current==null)return;const Lt=z.get(M.current);if(!Lt)return;const Ct=rt.nativeEvent,rs=new St({active:M.current,activeNode:Lt,event:Ct,options:qs,context:is,onAbort(Xe){if(!z.get(Xe))return;const{onDragAbort:as}=U.current,zs={id:Xe};as?.(zs),y({type:"onDragAbort",event:zs})},onPending(Xe,Fs,as,zs){if(!z.get(Xe))return;const{onDragPending:Ei}=U.current,Bs={id:Xe,constraint:Fs,initialCoordinates:as,offset:zs};Ei?.(Bs),y({type:"onDragPending",event:Bs})},onStart(Xe){const Fs=M.current;if(Fs==null)return;const as=z.get(Fs);if(!as)return;const{onDragStart:zs}=U.current,Mi={activatorEvent:Ct,active:{id:Fs,data:as.data,rect:T}};Bi.unstable_batchedUpdates(()=>{zs?.(Mi),S(Vs.Initializing),w({type:Ve.DragStart,initialCoordinates:Xe,active:Fs}),y({type:"onDragStart",event:Mi}),X(Lo.current),G(Ct)})},onMove(Xe){w({type:Ve.DragMove,coordinates:Xe})},onEnd:Rn(Ve.DragEnd),onCancel:Rn(Ve.DragCancel)});Lo.current=rs;function Rn(Xe){return async function(){const{active:as,collisions:zs,over:Mi,scrollAdjustedTranslate:Ei}=is.current;let Bs=null;if(as&&Ei){const{cancelDrop:Li}=U.current;Bs={activatorEvent:Ct,active:as,collisions:zs,delta:Ei,over:Mi},Xe===Ve.DragEnd&&typeof Li=="function"&&await Promise.resolve(Li(Bs))&&(Xe=Ve.DragCancel)}M.current=null,Bi.unstable_batchedUpdates(()=>{w({type:Xe}),S(Vs.Uninitialized),Pd(null),X(null),G(null),Lo.current=null;const Li=Xe===Ve.DragEnd?"onDragEnd":"onDragCancel";if(Bs){const Oo=U.current[Li];Oo?.(Bs),y({type:Li,event:Bs})}})}}},[z]),Nj=g.useCallback((rt,zt)=>(St,qs)=>{const Lt=St.nativeEvent,Ct=z.get(qs);if(M.current!==null||!Ct||Lt.dndKit||Lt.defaultPrevented)return;const rs={active:Ct};rt(St,zt.options,rs)===!0&&(Lt.dndKit={capturedBy:zt.sensor},M.current=qs,Dd(St,zt))},[z,Dd]),Id=_v(m,Nj);Rv(m),gs(()=>{fe&&A===Vs.Initializing&&S(Vs.Initialized)},[fe,A]),g.useEffect(()=>{const{onDragMove:rt}=U.current,{active:zt,activatorEvent:St,collisions:qs,over:Lt}=is.current;if(!zt||!St)return;const Ct={active:zt,activatorEvent:St,collisions:qs,delta:{x:Ln.x,y:Ln.y},over:Lt};Bi.unstable_batchedUpdates(()=>{rt?.(Ct),y({type:"onDragMove",event:Ct})})},[Ln.x,Ln.y]),g.useEffect(()=>{const{active:rt,activatorEvent:zt,collisions:St,droppableContainers:qs,scrollAdjustedTranslate:Lt}=is.current;if(!rt||M.current==null||!zt||!Lt)return;const{onDragOver:Ct}=U.current,rs=qs.get(_d),Rn=rs&&rs.rect.current?{id:rs.id,rect:rs.rect.current,data:rs.data,disabled:rs.disabled}:null,Xe={active:rt,activatorEvent:zt,collisions:St,delta:{x:Lt.x,y:Lt.y},over:Rn};Bi.unstable_batchedUpdates(()=>{Pd(Rn),Ct?.(Xe),y({type:"onDragOver",event:Xe})})},[_d]),gs(()=>{is.current={activatorEvent:R,active:E,activeNode:Ge,collisionRect:On,collisions:Ii,droppableRects:Je,draggableNodes:z,draggingNode:Mn,draggingNodeRect:En,droppableContainers:j,over:$s,scrollableAncestors:Rs,scrollAdjustedTranslate:Ln},T.current={initial:En,translated:On}},[E,Ge,Ii,On,z,Mn,En,Je,j,$s,Rs,Ln]),Sv({...Zt,delta:D,draggingRect:On,pointerCoordinates:Td,scrollableAncestors:Rs,scrollableAncestorRects:ea});const kj=g.useMemo(()=>({active:E,activeNode:Ge,activeNodeRect:fe,activatorEvent:R,collisions:Ii,containerNodeRect:Di,dragOverlay:ks,draggableNodes:z,droppableContainers:j,droppableRects:Je,over:$s,measureDroppableContainers:Qt,scrollableAncestors:Rs,scrollableAncestorRects:ea,measuringConfiguration:ee,measuringScheduled:Os,windowRect:Eo}),[E,Ge,fe,R,Ii,Di,ks,z,j,Je,$s,Qt,Rs,ea,ee,Os,Eo]),zj=g.useMemo(()=>({activatorEvent:R,activators:Id,active:E,activeNodeRect:fe,ariaDescribedById:{draggable:le},dispatch:w,draggableNodes:z,over:$s,measureDroppableContainers:Qt}),[R,Id,E,fe,w,le,z,$s,Qt]);return te.createElement(Xp.Provider,{value:N},te.createElement(fo.Provider,{value:zj},te.createElement(pf.Provider,{value:kj},te.createElement(ff.Provider,{value:vj},d)),te.createElement(Qv,{disabled:l?.restoreFocus===!1})),te.createElement(Zw,{...l,hiddenTextDescribedById:le}));function Sj(){const rt=F?.autoScrollEnabled===!1,zt=typeof c=="object"?c.enabled===!1:c===!1,St=k&&!rt&&!zt;return typeof c=="object"?{...c,enabled:St}:{enabled:St}}}),eN=g.createContext(null),iu="button",tN="Draggable";function sN(t){let{id:s,data:n,disabled:i=!1,attributes:r}=t;const a=Rr(tN),{activators:o,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:m,draggableNodes:u,over:h}=g.useContext(fo),{role:p=iu,roleDescription:b="draggable",tabIndex:f=0}=r??{},x=c?.id===s,w=g.useContext(x?ff:eN),[y,N]=Ia(),[A,S]=Ia(),k=$v(o,s),v=dr(n);gs(()=>(u.set(s,{id:s,key:a,node:y,activatorNode:A,data:v}),()=>{const D=u.get(s);D&&D.key===a&&u.delete(s)}),[u,s]);const z=g.useMemo(()=>({role:p,tabIndex:f,"aria-disabled":i,"aria-pressed":x&&p===iu?!0:void 0,"aria-roledescription":b,"aria-describedby":m.draggable}),[i,p,f,x,b,m.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:z,isDragging:x,listeners:i?void 0:k,node:y,over:h,setNodeRef:N,setActivatorNodeRef:S,transform:w}}function nN(){return g.useContext(pf)}const iN="Droppable",rN={timeout:25};function aN(t){let{data:s,disabled:n=!1,id:i,resizeObserverConfig:r}=t;const a=Rr(iN),{active:o,dispatch:l,over:c,measureDroppableContainers:d}=g.useContext(fo),m=g.useRef({disabled:n}),u=g.useRef(!1),h=g.useRef(null),p=g.useRef(null),{disabled:b,updateMeasurementsFor:f,timeout:x}={...rN,...r},w=dr(f??i),y=g.useCallback(()=>{if(!u.current){u.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{d(Array.isArray(w.current)?w.current:[w.current]),p.current=null},x)},[x]),N=po({callback:y,disabled:b||!o}),A=g.useCallback((z,D)=>{N&&(D&&(N.unobserve(D),u.current=!1),z&&N.observe(z))},[N]),[S,k]=Ia(A),v=dr(s);return g.useEffect(()=>{!N||!S.current||(N.disconnect(),u.current=!1,N.observe(S.current))},[S,N]),g.useEffect(()=>(l({type:Ve.RegisterDroppable,element:{id:i,key:a,disabled:n,node:S,rect:h,data:v}}),()=>l({type:Ve.UnregisterDroppable,key:a,id:i})),[i]),g.useEffect(()=>{n!==m.current.disabled&&(l({type:Ve.SetDroppableDisabled,id:i,key:a,disabled:n}),m.current.disabled=n)},[i,a,n,l]),{active:o,rect:h,isOver:c?.id===i,node:S,over:c,setNodeRef:k}}function Cc(t,s,n){const i=t.slice();return i.splice(n<0?i.length+n:n,0,i.splice(s,1)[0]),i}function oN(t,s){return t.reduce((n,i,r)=>{const a=s.get(i);return a&&(n[r]=a),n},Array(t.length))}function na(t){return t!==null&&t>=0}function lN(t,s){if(t===s)return!0;if(t.length!==s.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==s[n])return!1;return!0}function cN(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const xf=t=>{let{rects:s,activeIndex:n,overIndex:i,index:r}=t;const a=Cc(s,i,n),o=s[r],l=a[r];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},ia={scaleX:1,scaleY:1},dN=t=>{var s;let{activeIndex:n,activeNodeRect:i,index:r,rects:a,overIndex:o}=t;const l=(s=a[n])!=null?s:i;if(!l)return null;if(r===n){const d=a[o];return d?{x:0,y:n<o?d.top+d.height-(l.top+l.height):d.top-l.top,...ia}:null}const c=uN(a,r,n);return r>n&&r<=o?{x:0,y:-l.height-c,...ia}:r<n&&r>=o?{x:0,y:l.height+c,...ia}:{x:0,y:0,...ia}};function uN(t,s,n){const i=t[s],r=t[s-1],a=t[s+1];return i?n<s?r?i.top-(r.top+r.height):a?a.top-(i.top+i.height):0:a?a.top-(i.top+i.height):r?i.top-(r.top+r.height):0:0}const gf="Sortable",jf=te.createContext({activeIndex:-1,containerId:gf,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:xf,disabled:{draggable:!1,droppable:!1}});function mN(t){let{children:s,id:n,items:i,strategy:r=xf,disabled:a=!1}=t;const{active:o,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:m}=nN(),u=Rr(gf,n),h=l.rect!==null,p=g.useMemo(()=>i.map(k=>typeof k=="object"&&"id"in k?k.id:k),[i]),b=o!=null,f=o?p.indexOf(o.id):-1,x=d?p.indexOf(d.id):-1,w=g.useRef(p),y=!lN(p,w.current),N=x!==-1&&f===-1||y,A=cN(a);gs(()=>{y&&b&&m(p)},[y,p,b,m]),g.useEffect(()=>{w.current=p},[p]);const S=g.useMemo(()=>({activeIndex:f,containerId:u,disabled:A,disableTransforms:N,items:p,overIndex:x,useDragOverlay:h,sortedRects:oN(p,c),strategy:r}),[f,u,A.draggable,A.droppable,N,p,x,c,h,r]);return te.createElement(jf.Provider,{value:S},s)}const hN=t=>{let{id:s,items:n,activeIndex:i,overIndex:r}=t;return Cc(n,i,r).indexOf(s)},pN=t=>{let{containerId:s,isSorting:n,wasDragging:i,index:r,items:a,newIndex:o,previousItems:l,previousContainerId:c,transition:d}=t;return!d||!i||l!==a&&r===o?!1:n?!0:o!==r&&s===c},fN={duration:200,easing:"ease"},yf="transform",xN=mr.Transition.toString({property:yf,duration:0,easing:"linear"}),gN={roleDescription:"sortable"};function jN(t){let{disabled:s,index:n,node:i,rect:r}=t;const[a,o]=g.useState(null),l=g.useRef(n);return gs(()=>{if(!s&&n!==l.current&&i.current){const c=r.current;if(c){const d=ji(i.current,{ignoreTransform:!0}),m={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(m.x||m.y)&&o(m)}}n!==l.current&&(l.current=n)},[s,n,i,r]),g.useEffect(()=>{a&&o(null)},[a]),a}function yN(t){let{animateLayoutChanges:s=pN,attributes:n,disabled:i,data:r,getNewIndex:a=hN,id:o,strategy:l,resizeObserverConfig:c,transition:d=fN}=t;const{items:m,containerId:u,activeIndex:h,disabled:p,disableTransforms:b,sortedRects:f,overIndex:x,useDragOverlay:w,strategy:y}=g.useContext(jf),N=bN(i,p),A=m.indexOf(o),S=g.useMemo(()=>({sortable:{containerId:u,index:A,items:m},...r}),[u,r,A,m]),k=g.useMemo(()=>m.slice(m.indexOf(o)),[m,o]),{rect:v,node:z,isOver:D,setNodeRef:j}=aN({id:o,data:S,disabled:N.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:C,activatorEvent:T,activeNodeRect:E,attributes:M,setNodeRef:F,listeners:X,isDragging:R,over:G,setActivatorNodeRef:U,transform:le}=sN({id:o,data:S,attributes:{...gN,...n},disabled:N.draggable}),q=Ow(j,F),ee=!!C,Je=ee&&!b&&na(h)&&na(x),Qt=!w&&R,Os=Qt&&Je?le:null,He=Je?Os??(l??y)({rects:f,activeNodeRect:E,activeIndex:h,overIndex:x,index:A}):null,Zt=na(h)&&na(x)?a({id:o,items:m,activeIndex:h,overIndex:x}):A,Ns=C?.id,fe=g.useRef({activeId:Ns,items:m,newIndex:Zt,containerId:u}),Di=m!==fe.current.items,is=s({active:C,containerId:u,isDragging:R,isSorting:ee,id:o,index:A,items:m,newIndex:fe.current.newIndex,previousItems:fe.current.items,previousContainerId:fe.current.containerId,transition:d,wasDragging:fe.current.activeId!=null}),In=jN({disabled:!is,index:A,node:z,rect:v});return g.useEffect(()=>{ee&&fe.current.newIndex!==Zt&&(fe.current.newIndex=Zt),u!==fe.current.containerId&&(fe.current.containerId=u),m!==fe.current.items&&(fe.current.items=m)},[ee,Zt,u,m]),g.useEffect(()=>{if(Ns===fe.current.activeId)return;if(Ns!=null&&fe.current.activeId==null){fe.current.activeId=Ns;return}const Mn=setTimeout(()=>{fe.current.activeId=Ns},50);return()=>clearTimeout(Mn)},[Ns]),{active:C,activeIndex:h,attributes:M,data:S,rect:v,index:A,newIndex:Zt,items:m,isOver:D,isSorting:ee,isDragging:R,listeners:X,node:z,overIndex:x,over:G,setNodeRef:q,setActivatorNodeRef:U,setDroppableNodeRef:j,setDraggableNodeRef:F,transform:In??He,transition:ks()};function ks(){if(In||Di&&fe.current.newIndex===A)return xN;if(!(Qt&&!vc(T)||!d)&&(ee||is))return mr.Transition.toString({...d,property:yf})}}function bN(t,s){var n,i;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(n=t?.draggable)!=null?n:s.draggable,droppable:(i=t?.droppable)!=null?i:s.droppable}}function La(t){if(!t)return!1;const s=t.data.current;return!!(s&&"sortable"in s&&typeof s.sortable=="object"&&"containerId"in s.sortable&&"items"in s.sortable&&"index"in s.sortable)}const wN=[oe.Down,oe.Right,oe.Up,oe.Left],vN=(t,s)=>{let{context:{active:n,collisionRect:i,droppableRects:r,droppableContainers:a,over:o,scrollableAncestors:l}}=s;if(wN.includes(t.code)){if(t.preventDefault(),!n||!i)return;const c=[];a.getEnabled().forEach(u=>{if(!u||u!=null&&u.disabled)return;const h=r.get(u.id);if(h)switch(t.code){case oe.Down:i.top<h.top&&c.push(u);break;case oe.Up:i.top>h.top&&c.push(u);break;case oe.Left:i.left>h.left&&c.push(u);break;case oe.Right:i.left<h.left&&c.push(u);break}});const d=ev({collisionRect:i,droppableRects:r,droppableContainers:c});let m=sf(d,"id");if(m===o?.id&&d.length>1&&(m=d[1].id),m!=null){const u=a.get(n.id),h=a.get(m),p=h?r.get(h.id):null,b=h?.node.current;if(b&&p&&u&&h){const x=ho(b).some((k,v)=>l[v]!==k),w=bf(u,h),y=NN(u,h),N=x||!w?{x:0,y:0}:{x:y?i.width-p.width:0,y:y?i.height-p.height:0},A={x:p.left,y:p.top};return N.x&&N.y?A:ur(A,N)}}}};function bf(t,s){return!La(t)||!La(s)?!1:t.data.current.sortable.containerId===s.data.current.sortable.containerId}function NN(t,s){return!La(t)||!La(s)||!bf(t,s)?!1:t.data.current.sortable.index<s.data.current.sortable.index}const kN=()=>e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),zN=({course:t,topicsCount:s,activitiesCount:n,accessCount:i})=>e.jsxs(it,{variant:"2-2-4",children:[e.jsxs(_,{children:[e.jsx(O,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Status"})}),e.jsx(P,{children:e.jsx(H,{variant:t?.is_published?"default":"secondary",children:t?.is_published?"Opublikowany":"Szkic"})})]}),e.jsxs(_,{children:[e.jsx(O,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Tematy"})}),e.jsx(P,{children:e.jsx("div",{className:"text-2xl font-bold",children:s})})]}),e.jsxs(_,{children:[e.jsx(O,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Aktywności"})}),e.jsx(P,{children:e.jsx("div",{className:"text-2xl font-bold",children:n})})]}),e.jsxs(_,{children:[e.jsx(O,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Uczestników"})}),e.jsx(P,{children:e.jsx("div",{className:"text-2xl font-bold",children:i})})]})]}),SN=({id:t,disabled:s=!1,children:n})=>{const{attributes:i,listeners:r,setNodeRef:a,transform:o,transition:l,isDragging:c}=yN({id:t,disabled:s}),d={transform:mr.Transform.toString(o),transition:l,opacity:c?.5:1,cursor:c?"grabbing":"grab"},m=s?{}:{...i,...r,style:{cursor:c?"grabbing":"grab"}};return e.jsx("div",{ref:a,style:d,className:c?"z-50":"",children:n({dragHandleProps:m,isDragging:c})})},ru=({items:t,renderItem:s,onReorder:n,className:i="space-y-2",disabled:r=!1})=>{const[a,o]=g.useState(t),[l,c]=g.useState(null),[d,m]=g.useState(null);g.useEffect(()=>{if(!d)o(t);else{const b=a.map(f=>{const x=t.find(w=>w.id===f.id);return x?{...x,position:f.position}:f});o(b)}},[t]);const u=Yw(Kd(Sc,{activationConstraint:{distance:8}}),Kd(kc,{coordinateGetter:vN})),h=b=>{c(Number(b.active.id))},p=b=>{const{active:f,over:x}=b;if(c(null),x&&f.id!==x.id){const w=a.findIndex(N=>N.id===Number(f.id)),y=a.findIndex(N=>N.id===Number(x.id));if(w!==-1&&y!==-1&&w!==y){let N;const A=a[w];if(y===0)N=a[0].position/2;else if(y===a.length-1)N=a[a.length-1].position+1e3;else if(w<y){const v=a[y],z=y+1<a.length?a[y+1]:null;z?N=(v.position+z.position)/2:N=v.position+1e3}else{const v=y>0?a[y-1]:null,z=a[y];v?N=(v.position+z.position)/2:N=z.position/2}const k=Cc(a,w,y).map(v=>v.id===A.id?{...v,position:N}:v);o(k),m({id:A.id,position:N}),n(A.id,N),setTimeout(()=>m(null),2e3)}}};return e.jsx(Xv,{sensors:u,collisionDetection:Xw,onDragStart:h,onDragEnd:p,children:e.jsx(mN,{items:a.map(b=>b.id),strategy:dN,children:e.jsx("div",{className:i,children:a.map((b,f)=>e.jsx(SN,{id:b.id,disabled:r||d!==null&&d.id!==b.id,children:x=>s(b,f,x.dragHandleProps)},b.id))})})})},CN=()=>{const{list:t,edit:s}=Ye(),{id:n}=ut(),[i,r]=Ha(),{navigateWithReturn:a,navigateToWizard:o}=Cw(),{course:l,topics:c,stats:d,isLoading:m,refetchTopics:u,refetchActivities:h,getActivitiesForTopic:p}=Tw(n),{togglePublish:b}=yl("topics"),{togglePublish:f}=yl("activities"),{updatePosition:x,isUpdating:w}=Vd("topics"),{updatePosition:y,isUpdating:N}=Vd("activities"),{mutate:A}=jn(),{mutate:S}=jn(),k=i.get("expanded");if(m)return e.jsx(kN,{});if(!l)return e.jsx(K,{children:e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Nie znaleziono kursu"})})});const v=T=>{k===T.toString()?(i.delete("expanded"),r(i)):r({expanded:T.toString()})},z=(T,E)=>{confirm(`Czy na pewno chcesz usunąć temat "${E}" wraz ze wszystkimi aktywnościami?`)&&A({resource:"topics",id:T},{onSuccess:()=>{W.success("Temat został usunięty"),u(),h(),k===T.toString()&&(i.delete("expanded"),r(i))}})},D=(T,E)=>{confirm(`Czy na pewno chcesz usunąć aktywność "${E}"?`)&&S({resource:"activities",id:T},{onSuccess:()=>{W.success("Aktywność została usunięta"),h(),u()}})},j=async(T,E)=>{try{await x(T,E)}catch(M){console.error("Failed to reorder topic:",M)}},C=async(T,E)=>{try{await y(T,E)}catch(M){console.error("Failed to reorder activity:",M)}};return e.jsxs(K,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("courses"),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Szczegóły kursu"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{onClick:()=>a(`/teacher/course-structure/edit/${l?.id}`),size:"sm",variant:"secondary",children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),"Edytuj z AI"]}),e.jsxs(I,{onClick:()=>s("courses",l?.id??0),size:"sm",children:[e.jsx(Ht,{className:"w-4 h-4 mr-2"}),"Edytuj kurs"]})]})]}),e.jsx(Lw,{course:l})]}),e.jsx(zN,{course:l,topicsCount:d.topicsCount,activitiesCount:d.activitiesCount,accessCount:d.accessCount}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(Z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:["Struktura kursu",(w||N)&&e.jsxs("span",{className:"text-sm font-normal text-muted-foreground flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),"Zapisywanie..."]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>a(`/teacher/course-structure/edit/${l?.id}`),children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Dodaj tematy z AI"]}),e.jsxs(I,{size:"sm",onClick:()=>a(`/teacher/topics/create?course_id=${n}`),children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Dodaj temat"]})]})]})}),e.jsx(P,{children:c.length>0?e.jsx(ru,{items:c,onReorder:j,disabled:w||N,renderItem:(T,E,M)=>{const F=p(T.id),X=k===T.id.toString();return e.jsx(Mw,{topic:{...T,position:E+1},isExpanded:X,onToggle:()=>v(T.id),onDelete:z,onEdit:(R,G)=>a(`/${R}/edit/${G}`),onTogglePublish:(R,G,U)=>b(R,G,U,u),activitiesCount:F.length,onNavigateToWizard:o,courseId:Number(l?.id),courseTitle:l?.title,dragHandleProps:M,children:F.length>0?e.jsx(ru,{items:F,onReorder:C,disabled:N,renderItem:(R,G,U)=>e.jsx(Ew,{activity:{...R,position:G+1},topicPosition:E+1,onDelete:D,onEdit:(le,q)=>a(`/${le}/edit/${q}`),onTogglePublish:(le,q,ee)=>f(le,q,ee,h),dragHandleProps:U},R.id)}):e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx("p",{children:"Brak aktywności w tym temacie"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center mt-4",children:[e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>a(`/activities/create?topic_id=${T.id}`),children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Dodaj ręcznie"]}),e.jsxs(I,{size:"sm",onClick:()=>o("/teacher/educational-material/step1",{courseId:l?.id,courseTitle:l?.title,topicId:T.id,topicTitle:T.title}),children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),"Generuj materiał z AI"]}),e.jsxs(I,{size:"sm",variant:"secondary",onClick:()=>o("/teacher/quiz-wizard/step1",{courseId:l?.id,courseTitle:l?.title,topicId:T.id,topicTitle:T.title}),children:[e.jsx(Ds,{className:"w-4 h-4 mr-2"}),"Generuj quiz z AI"]})]})]})},T.id)}}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(We,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Brak tematów w tym kursie"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center mt-4",children:[e.jsxs(I,{onClick:()=>a(`/topics/create?course_id=${n}`),children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Dodaj pierwszy temat"]}),e.jsxs(I,{variant:"secondary",onClick:()=>a(`/teacher/course-structure/edit/${l?.id}`),children:[e.jsx(ri,{className:"w-4 h-4 mr-2"}),"Wygeneruj strukturę z AI"]})]})]})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Grupy z dostępem"})}),e.jsx(P,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Pe,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Lista grup (do implementacji)"})]})})]}),e.jsxs(_,{className:"border-dashed border-2 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-950/20 dark:to-blue-950/20",children:[e.jsx(O,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(lt,{className:"w-5 h-5 text-purple-600"}),"Szybkie akcje AI"]})}),e.jsx(P,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx(I,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white dark:bg-background",onClick:()=>a(`/teacher/course-structure/edit/${l?.id}`),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ri,{className:"w-5 h-5 text-indigo-600 mt-0.5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"Rozbuduj strukturę kursu"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Dodaj nowe tematy z AI"})]})]})}),e.jsx(I,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white dark:bg-background",onClick:()=>o("/educational-material/step1",{courseId:l?.id,courseTitle:l?.title}),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Pr,{className:"w-5 h-5 text-purple-600 mt-0.5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"Generuj materiał"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Stwórz treści z AI"})]})]})}),e.jsx(I,{variant:"outline",className:"justify-start h-auto py-3 px-4 bg-white dark:bg-background",onClick:()=>o("/quiz-wizard/step1",{courseId:l?.id,courseTitle:l?.title}),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ds,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:"Stwórz quiz"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Quiz sprawdzający z AI"})]})]})})]})})]})]})},au={name:"courses",list:"/teacher/courses",create:"/teacher/courses/create",edit:"/teacher/courses/edit/:id",show:"/teacher/courses/show/:id",meta:{label:"Kursy",icon:e.jsx(xe,{className:"h-4 w-4"})}},TN=[e.jsx(V,{path:"courses",element:e.jsx(Aw,{})},"courses-list"),e.jsx(V,{path:"courses/create",element:e.jsx(Pw,{})},"courses-create"),e.jsx(V,{path:"courses/edit/:id",element:e.jsx(Iw,{})},"courses-edit"),e.jsx(V,{path:"courses/show/:id",element:e.jsx(CN,{})},"courses-show")],AN=()=>{const{edit:t,list:s}=Ye(),{mutate:n}=Qa(),{mutate:i}=jn(),[r,a]=g.useState("all"),[o,l]=g.useState(!1),[c,d]=g.useState(null),m=r!=="all"?[{field:"course_id",operator:"eq",value:r}]:[],{data:u,isLoading:h,refetch:p}=ie({resource:"topics",meta:{populate:["courses"]},filters:m,pagination:{pageSize:20},sorters:[{field:"courses.title",order:"asc"},{field:"position",order:"asc"}]}),{data:b}=ie({resource:"courses",pagination:{pageSize:100},sorters:[{field:"title",order:"asc"}]}),f=u?.data||[],x=b?.data||[],w=async N=>{await n({resource:"topics",id:N.id,values:{is_published:!N.is_published},successNotification:()=>({message:N.is_published?"Temat został ukryty":"Temat został opublikowany",type:"success"})}),p()},y=N=>{d(N),l(!0)};return e.jsxs(K,{children:[e.jsxs(Z,{children:[e.jsx(ve,{title:"Tematy",description:"Zarządzaj tematami kursów"}),e.jsxs(Z,{variant:"start",className:"gap-2",children:[x.length>0&&e.jsxs(me,{value:r,onValueChange:a,children:[e.jsxs(ce,{className:"w-[250px]",children:[e.jsx(Ly,{className:"h-4 w-4 mr-2"}),e.jsx(he,{placeholder:"Filtruj po kursie"})]}),e.jsxs(de,{children:[e.jsx(B,{value:"all",children:"Wszystkie kursy"}),e.jsx(xt,{}),x.map(N=>e.jsx(B,{value:N.id.toString(),children:N.title},N.id))]})]}),e.jsxs(I,{onClick:()=>s("courses"),children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Przejdź do kursów"]})]})]}),e.jsx(_,{children:e.jsx(P,{className:"p-0",children:h?e.jsx("div",{className:"p-8",children:e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((N,A)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(cn,{className:"h-12 w-12"}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(cn,{className:"h-4 w-3/4"}),e.jsx(cn,{className:"h-4 w-1/2"})]})]},A))})}):f.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(xe,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:r!=="all"?"Brak tematów w wybranym kursie":"Brak tematów"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Aby dodać temat, przejdź do kursu"}),e.jsxs(I,{onClick:()=>s("courses"),children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Przejdź do kursów"]})]}):e.jsxs(so,{children:[e.jsx(no,{children:e.jsxs(Ys,{children:[e.jsx(Le,{className:"w-[50px]",children:"#"}),e.jsx(Le,{children:"Tytuł"}),e.jsx(Le,{className:"w-[200px]",children:"Kurs"}),e.jsx(Le,{className:"w-[120px]",children:"Status"}),e.jsx(Le,{className:"w-[140px]",children:"Data utworzenia"}),e.jsx(Le,{className:"text-right w-[80px]",children:"Akcje"})]})}),e.jsx(io,{children:f.map(N=>e.jsxs(Ys,{children:[e.jsx(Oe,{className:"font-medium",children:e.jsx(H,{variant:"outline",className:"w-12 justify-center",children:N.position})}),e.jsx(Oe,{children:e.jsx("div",{className:"font-medium",children:N.title})}),e.jsx(Oe,{className:"max-w-[200px]",children:e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(xe,{className:"h-4 w-4 mr-2 text-muted-foreground shrink-0"}),e.jsx("span",{className:"truncate block",title:N.courses?.title||"Brak kursu",children:N.courses?.title||"Brak kursu"})]})}),e.jsx(Oe,{children:e.jsx(H,{variant:N.is_published?"default":"secondary",children:N.is_published?"Opublikowany":"Szkic"})}),e.jsx(Oe,{children:e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),new Date(N.created_at).toLocaleDateString("pl-PL")]})}),e.jsx(Oe,{className:"text-right",children:e.jsxs(vn,{children:[e.jsx(Nn,{asChild:!0,children:e.jsxs(I,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Otwórz menu"}),e.jsx(Oy,{className:"h-4 w-4"})]})}),e.jsxs(Js,{align:"end",children:[e.jsxs(pe,{onClick:()=>t("topics",N.id),children:[e.jsx(Ht,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),e.jsx(xt,{}),e.jsx(pe,{onClick:()=>w(N),children:N.is_published?e.jsxs(e.Fragment,{children:[e.jsx(rr,{className:"mr-2 h-4 w-4"}),"Ukryj temat"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ry,{className:"mr-2 h-4 w-4"}),"Opublikuj temat"]})}),e.jsx(xt,{}),e.jsxs(pe,{onClick:()=>y(N),className:"text-destructive focus:text-destructive",children:[e.jsx(xs,{className:"mr-2 h-4 w-4"}),"Usuń temat"]})]})]})})]},N.id))})]})})})]})},_N=()=>{const{show:t}=Ye(),s=J(),[n]=Ha(),i=n.get("course_id"),{data:r}=Ue({resource:"courses",id:i,queryOptions:{enabled:!!i}}),{data:a,isLoading:o}=ie({resource:"topics",filters:[{field:"course_id",operator:"eq",value:i}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!i}}),{refineCore:{onFinish:l},register:c,handleSubmit:d,setValue:m,watch:u,formState:{errors:h,isSubmitting:p}}=ys({defaultValues:{course_id:i?parseInt(i):void 0,is_published:!1,position:1},refineCoreProps:{successNotification:()=>({message:"Temat został utworzony",type:"success"}),redirect:!1,onMutationSuccess:()=>{i?t("courses",i):s("/courses")}}});g.useEffect(()=>{if(!o&&a&&a.data.length>0){const f=a.data[0].position+1;m("position",f)}},[a,o,m]);const b=()=>{i?t("courses",i):s("/courses")};return e.jsxs(K,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:b,children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Powrót do kursu"]}),e.jsx(Z,{children:e.jsx(ve,{title:"Dodaj temat",description:r?.data?`Do kursu: ${r.data.title}`:"Utwórz nowy temat"})}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Informacje o temacie"})}),e.jsx(P,{children:e.jsxs(bs,{onSubmit:d(l),children:[e.jsx("input",{type:"hidden",...c("course_id")}),e.jsx(se,{label:"Tytuł tematu",htmlFor:"title",error:h.title?.message,required:!0,children:e.jsx(Q,{id:"title",placeholder:"np. Wprowadzenie do zmiennych",...c("title",{required:"Tytuł tematu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),e.jsx(se,{label:"Pozycja",htmlFor:"position",error:h.position?.message,required:!0,children:e.jsx(Q,{id:"position",type:"number",min:"1",disabled:!0,className:"bg-muted",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),e.jsx(se,{label:"Status publikacji",children:e.jsxs(Z,{variant:"start",children:[e.jsx(ss,{checked:u("is_published")||!1,onCheckedChange:f=>m("is_published",f)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj temat od razu"})]})}),e.jsxs(ws,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:b,children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:p||!i,children:p?"Tworzenie...":"Utwórz temat"})]})]})})]})]})},kn=({variant:t="outline",size:s="sm",children:n="Powrót do kursu"})=>{const i=J(),r=kr(),a=()=>{const o=sessionStorage.getItem("returnUrl");if(o){sessionStorage.removeItem("returnUrl"),i(o);return}const c=new URLSearchParams(r.search).get("returnUrl");if(c){i(decodeURIComponent(c));return}i(-1)};return e.jsxs(I,{variant:t,size:s,onClick:a,children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),n]})},PN=()=>{const{show:t}=Ye(),{id:s}=ut(),n=J(),{data:i,isLoading:r}=Ue({resource:"topics",id:s,liveMode:"off"}),a=i?.data,o=a?.course_id,{refineCore:{onFinish:l},register:c,handleSubmit:d,setValue:m,watch:u,formState:{errors:h,isSubmitting:p}}=ys({refineCoreProps:{resource:"topics",id:s,liveMode:"off",successNotification:()=>({message:"Temat został zaktualizowany",type:"success"}),redirect:!1,onMutationSuccess:()=>{const f=sessionStorage.getItem("returnUrl");f?(sessionStorage.removeItem("returnUrl"),n(f)):o&&n(`/teacher/courses/show/${o}?expanded=${s}`)}}}),b=()=>{const f=sessionStorage.getItem("returnUrl");f?(sessionStorage.removeItem("returnUrl"),n(f)):o?n(`/teacher/courses/show/${o}?expanded=${s}`):t("courses","")};return r?e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs(K,{children:[e.jsx(kn,{}),e.jsx(Z,{children:e.jsx(ve,{title:"Edytuj temat",description:`Edycja: ${a?.title}`})}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Informacje o temacie"})}),e.jsx(P,{children:e.jsxs(bs,{onSubmit:d(l),children:[e.jsx(se,{label:"Tytuł tematu",htmlFor:"title",error:h.title?.message,required:!0,children:e.jsx(Q,{id:"title",placeholder:"np. Wprowadzenie do zmiennych",...c("title",{required:"Tytuł tematu jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),e.jsx(se,{label:"Pozycja",htmlFor:"position",error:h.position?.message,required:!0,children:e.jsx(Q,{id:"position",type:"number",min:"1",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),e.jsx(se,{label:"Status publikacji",children:e.jsxs(Z,{variant:"start",children:[e.jsx(ss,{checked:u("is_published")||!1,onCheckedChange:f=>m("is_published",f)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Temat jest opublikowany"})]})}),e.jsxs(ws,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:b,children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:p,children:p?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},ou={name:"topics",list:"/teacher/topics",create:"/teacher/topics/create",edit:"/teacher/topics/edit/:id",meta:{label:"Tematy",icon:e.jsx(We,{className:"h-4 w-4"})}},DN=[e.jsx(V,{path:"topics",element:e.jsx(AN,{})},"topics-list"),e.jsx(V,{path:"topics/create",element:e.jsx(_N,{})},"topics-create"),e.jsx(V,{path:"topics/edit/:id",element:e.jsx(PN,{})},"topics-edit")],IN=()=>{const{show:t}=Ye(),s=J(),[n]=Ha(),i=n.get("topic_id"),{data:r}=Ue({resource:"topics",id:i,meta:{select:"*, courses(*)"},queryOptions:{enabled:!!i}}),{data:a,isLoading:o}=ie({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:i}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!i}}),{refineCore:{onFinish:l},register:c,handleSubmit:d,setValue:m,watch:u,formState:{errors:h,isSubmitting:p}}=ys({defaultValues:{topic_id:i?parseInt(i):void 0,type:"material",is_published:!1,position:1,passing_score:70},refineCoreProps:{successNotification:!1,redirect:!1,onMutationSuccess:x=>{const w=r?.data?.course_id,y=x.data.type;if(W.success("Aktywność została utworzona"),y==="quiz")W.info("Dodaj pytania do quizu"),s(`/teacher/questions/manage/${x.data.id}`);else{const N=sessionStorage.getItem("returnUrl");N?(sessionStorage.removeItem("returnUrl"),s(N)):s(w?`/teacher/courses/show/${w}?expanded=${i}`:"/teacher/courses")}}}}),b=u("type");g.useEffect(()=>{if(!o&&a&&a.data.length>0){const x=a.data[0].position+1;m("position",x)}},[a,o,m]);const f=()=>{const x=sessionStorage.getItem("returnUrl");x?(sessionStorage.removeItem("returnUrl"),s(x)):r?.data?.course_id?s(`/courses/show/${r.data.course_id}?expanded=${i}`):s("/courses")};return r?.data?.course_id,i?e.jsxs(K,{children:[e.jsx(kn,{}),e.jsx(Z,{children:e.jsx(ve,{title:"Dodaj aktywność",description:r?.data?e.jsxs("div",{children:[e.jsx("div",{className:"text-lg",children:r.data.courses?.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Temat ",r.data.position,": ",r.data.title]})]}):"Utwórz nowy materiał lub quiz"})}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Informacje o aktywności"})}),e.jsx(P,{children:e.jsxs(bs,{onSubmit:d(l),children:[e.jsx("input",{type:"hidden",...c("topic_id")}),e.jsxs(it,{variant:"1-2-2",children:[e.jsx(se,{label:"Typ aktywności",error:h.type?.message,required:!0,children:e.jsxs(me,{value:b,onValueChange:x=>m("type",x),children:[e.jsx(ce,{children:e.jsx(he,{placeholder:"Wybierz typ"})}),e.jsxs(de,{children:[e.jsx(B,{value:"material",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(We,{className:"w-4 h-4"}),"Materiał"]})}),e.jsx(B,{value:"quiz",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"w-4 h-4"}),"Quiz"]})})]})]})}),e.jsx(se,{label:"Tytuł",htmlFor:"title",error:h.title?.message,required:!0,children:e.jsx(Q,{id:"title",placeholder:b==="quiz"?"np. Test wiedzy z rozdziału":"np. Wprowadzenie do tematu",...c("title",{required:"Tytuł jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),e.jsx(se,{label:"Pozycja w temacie",htmlFor:"position",error:h.position?.message,required:!0,children:e.jsx(Q,{id:"position",type:"number",min:"1",disabled:!0,className:"bg-muted",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),e.jsx(se,{label:"Czas trwania (min)",htmlFor:"duration_min",hint:"Szacowany czas potrzebny na ukończenie",children:e.jsx(Q,{id:"duration_min",type:"number",min:"1",placeholder:"np. 15",...c("duration_min",{min:{value:1,message:"Czas musi być większy od 0"},valueAsNumber:!0})})})]}),b==="material"&&e.jsx(se,{label:"Treść materiału",htmlFor:"content",error:h.content?.message,required:!0,hint:"Możesz używać formatowania Markdown",children:e.jsx(Nt,{id:"content",placeholder:"Wprowadź treść materiału edukacyjnego...",rows:10,...c("content",{required:b==="material"?"Treść jest wymagana dla materiału":!1})})}),b==="quiz"&&e.jsxs(e.Fragment,{children:[e.jsxs(it,{variant:"1-1-1",children:[e.jsx(se,{label:"Próg zaliczenia (%)",htmlFor:"passing_score",error:h.passing_score?.message,hint:"Minimalny wynik do zaliczenia",children:e.jsx(Q,{id:"passing_score",type:"number",min:"0",max:"100",...c("passing_score",{min:{value:0,message:"Wartość minimalna to 0"},max:{value:100,message:"Wartość maksymalna to 100"},valueAsNumber:!0})})}),e.jsx(se,{label:"Limit czasu (min)",htmlFor:"time_limit",hint:"Pozostaw puste dla braku limitu",children:e.jsx(Q,{id:"time_limit",type:"number",min:"1",placeholder:"Brak limitu",...c("time_limit",{min:{value:1,message:"Limit musi być większy od 0"},valueAsNumber:!0})})}),e.jsx(se,{label:"Maksymalna liczba prób",htmlFor:"max_attempts",hint:"Pozostaw puste dla nieograniczonej liczby",children:e.jsx(Q,{id:"max_attempts",type:"number",min:"1",placeholder:"Bez limitu",...c("max_attempts",{min:{value:1,message:"Minimum 1 próba"},valueAsNumber:!0})})})]}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{className:"text-blue-700 dark:text-blue-300",children:"💡 Wskazówka:"})," ",e.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:"Po utworzeniu quizu zostaniesz przekierowany do ekranu dodawania pytań."})]})})]}),e.jsx(se,{label:"Status publikacji",children:e.jsxs(Z,{variant:"start",children:[e.jsx(ss,{checked:u("is_published")||!1,onCheckedChange:x=>m("is_published",x)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Opublikuj aktywność od razu (uczniowie będą mogli ją zobaczyć)"})]})}),e.jsxs(ws,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:f,disabled:p,children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:p||!i,children:p?"Tworzenie...":b==="quiz"?"Utwórz i dodaj pytania":"Utwórz aktywność"})]})]})})]})]}):e.jsx(K,{children:e.jsx(_,{children:e.jsxs(P,{className:"text-center py-12",children:[e.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-4",children:"Nie wybrano tematu"}),e.jsx(I,{onClick:()=>s("/courses"),children:"Przejdź do kursów"})]})})})},MN=()=>{const{list:t}=Ye(),{id:s}=ut(),n=J(),{data:i,isLoading:r}=Ue({resource:"activities",id:s,liveMode:"off",meta:{select:"*, topics(*, courses(*))"}}),{data:a}=Ue({resource:"questions",id:s,meta:{select:"count",filter:`activity_id.eq.${s}`},queryOptions:{enabled:!!s&&i?.data?.type==="quiz"}}),{refineCore:{onFinish:o,formLoading:l},register:c,handleSubmit:d,setValue:m,watch:u,reset:h,formState:{errors:p,isSubmitting:b}}=ys({refineCoreProps:{resource:"activities",id:s,liveMode:"off",redirect:!1,successNotification:!1,onMutationSuccess:()=>{const D=i?.data?.topics?.course_id,j=i?.data?.topic_id;W.success("Aktywność została zaktualizowana");const C=sessionStorage.getItem("returnUrl");C?(sessionStorage.removeItem("returnUrl"),n(C)):D?n(`/teacher/courses/show/${D}?expanded=${j}`):t("activities")},onMutationError:D=>{console.error("Błąd podczas aktualizacji:",D),D?.code==="PGRST204"?W.error("Błąd konfiguracji - skontaktuj się z administratorem"):D?.code==="23505"?W.error("Aktywność o tej pozycji już istnieje w tym temacie"):D?.code==="23503"?W.error("Nieprawidłowe powiązanie z tematem"):D?.message?W.error(`Błąd: ${D.message}`):W.error("Wystąpił nieoczekiwany błąd. Spróbuj ponownie.")}}});g.useEffect(()=>{if(i?.data){const{topics:D,_count:j,questions:C,...T}=i.data;h(T)}},[i,h]);const f=u("type")||i?.data?.type||"material";if(r||l)return e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const x=i?.data,w=x?.topics,y=w?.courses,N=y?.id,A=x?.topic_id,S=()=>{const D=sessionStorage.getItem("returnUrl");D?(sessionStorage.removeItem("returnUrl"),n(D)):N?n(`/teacher/courses/show/${N}?expanded=${A}`):t("activities")},k=()=>f==="quiz"?e.jsx(dt,{className:"w-6 h-6 text-blue-500"}):e.jsx(We,{className:"w-6 h-6 text-green-500"}),v=()=>{const D=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",D),n(`/teacher/questions/manage/${x?.id}`)},z=a?.data?.[0]?.count||0;return e.jsxs(K,{children:[e.jsx(kn,{}),e.jsxs(Z,{children:[e.jsx(ve,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[k(),"Edytuj aktywność"]}),description:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-medium",children:x?.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[y?.title," → Temat ",w?.position,": ",w?.title]})]})}),f==="quiz"&&e.jsxs(I,{onClick:v,variant:"outline",children:[e.jsx(fn,{className:"w-4 h-4 mr-2"}),"Zarządzaj pytaniami (",z,")"]})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Informacje o aktywności"})}),e.jsx(P,{children:e.jsxs(bs,{onSubmit:d(o),children:[e.jsxs(it,{variant:"1-2-2",children:[e.jsxs(se,{label:"Typ aktywności",error:p.type?.message,required:!0,children:[e.jsxs(me,{value:f,disabled:!0,children:[e.jsx(ce,{className:"bg-muted",children:e.jsx(he,{placeholder:"Wybierz typ"})}),e.jsxs(de,{children:[e.jsx(B,{value:"material",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(We,{className:"w-4 h-4"}),"Materiał"]})}),e.jsx(B,{value:"quiz",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"w-4 h-4"}),"Quiz"]})})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Typ aktywności nie może być zmieniony"})]}),e.jsx(se,{label:"Tytuł",htmlFor:"title",error:p.title?.message,required:!0,children:e.jsx(Q,{id:"title",placeholder:f==="quiz"?"np. Test wiedzy":"np. Wprowadzenie",...c("title",{required:"Tytuł jest wymagany",minLength:{value:3,message:"Tytuł musi mieć minimum 3 znaki"}})})}),e.jsx(se,{label:"Pozycja w temacie",htmlFor:"position",error:p.position?.message,required:!0,children:e.jsx(Q,{id:"position",type:"number",min:"1",...c("position",{required:"Pozycja jest wymagana",min:{value:1,message:"Pozycja musi być większa od 0"},valueAsNumber:!0})})}),e.jsx(se,{label:"Czas trwania (min)",htmlFor:"duration_min",hint:"Szacowany czas potrzebny na ukończenie",children:e.jsx(Q,{id:"duration_min",type:"number",min:"1",placeholder:"np. 15",...c("duration_min",{min:{value:1,message:"Czas musi być większy od 0"},valueAsNumber:!0})})})]}),f==="material"&&e.jsx(se,{label:"Treść materiału",htmlFor:"content",error:p.content?.message,required:!0,hint:"Możesz używać formatowania Markdown",children:e.jsx(Nt,{id:"content",placeholder:"Wprowadź treść materiału...",rows:10,...c("content",{required:f==="material"?"Treść jest wymagana dla materiału":!1})})}),f==="quiz"&&e.jsxs(e.Fragment,{children:[e.jsxs(it,{variant:"1-1-1",children:[e.jsx(se,{label:"Próg zaliczenia (%)",htmlFor:"passing_score",error:p.passing_score?.message,hint:"Minimalny wynik do zaliczenia",children:e.jsx(Q,{id:"passing_score",type:"number",min:"0",max:"100",...c("passing_score",{min:{value:0,message:"Wartość minimalna to 0"},max:{value:100,message:"Wartość maksymalna to 100"},valueAsNumber:!0})})}),e.jsx(se,{label:"Limit czasu (min)",htmlFor:"time_limit",hint:"Pozostaw puste dla braku limitu",children:e.jsx(Q,{id:"time_limit",type:"number",min:"1",placeholder:"Brak limitu",...c("time_limit",{min:{value:1,message:"Limit musi być większy od 0"},valueAsNumber:!0})})}),e.jsx(se,{label:"Maksymalna liczba prób",htmlFor:"max_attempts",hint:"Pozostaw puste dla nieograniczonej liczby",children:e.jsx(Q,{id:"max_attempts",type:"number",min:"1",placeholder:"Bez limitu",...c("max_attempts",{min:{value:1,message:"Minimum 1 próba"},valueAsNumber:!0})})})]}),z>0&&e.jsx(_,{className:"mt-4 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800",children:e.jsx(P,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["Ten quiz zawiera ",z," ",z===1?"pytanie":"pytań"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Możesz zarządzać pytaniami klikając przycisk powyżej"})]}),e.jsx(H,{variant:"outline",className:"text-lg px-3 py-1",children:z})]})})})]}),e.jsx(se,{label:"Status publikacji",children:e.jsxs(Z,{variant:"start",children:[e.jsx(ss,{checked:u("is_published")||!1,onCheckedChange:D=>m("is_published",D)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Aktywność jest opublikowana (uczniowie mogą ją zobaczyć)"})]})}),e.jsxs(ws,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:S,disabled:b,children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:b,children:b?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})};function lu(t,s){const n=String(t);if(typeof s!="string")throw new TypeError("Expected character");let i=0,r=n.indexOf(s);for(;r!==-1;)i++,r=n.indexOf(s,r+s.length);return i}function EN(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function LN(t,s,n){const r=Th((n||{}).ignore||[]),a=ON(s);let o=-1;for(;++o<a.length;)py(t,"text",l);function l(d,m){let u=-1,h;for(;++u<m.length;){const p=m[u],b=h?h.children:void 0;if(r(p,b?b.indexOf(p):void 0,h))return;h=p}if(h)return c(d,m)}function c(d,m){const u=m[m.length-1],h=a[o][0],p=a[o][1];let b=0;const x=u.children.indexOf(d);let w=!1,y=[];h.lastIndex=0;let N=h.exec(d.value);for(;N;){const A=N.index,S={index:N.index,input:N.input,stack:[...m,d]};let k=p(...N,S);if(typeof k=="string"&&(k=k.length>0?{type:"text",value:k}:void 0),k===!1?h.lastIndex=A+1:(b!==A&&y.push({type:"text",value:d.value.slice(b,A)}),Array.isArray(k)?y.push(...k):k&&y.push(k),b=A+N[0].length,w=!0),!h.global)break;N=h.exec(d.value)}return w?(b<d.value.length&&y.push({type:"text",value:d.value.slice(b)}),u.children.splice(x,1,...y)):y=[d],x+y.length}}function ON(t){const s=[];if(!Array.isArray(t))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!t[0]||Array.isArray(t[0])?t:[t];let i=-1;for(;++i<n.length;){const r=n[i];s.push([RN(r[0]),$N(r[1])])}return s}function RN(t){return typeof t=="string"?new RegExp(EN(t),"g"):t}function $N(t){return typeof t=="function"?t:function(){return t}}const Vo="phrasing",Wo=["autolink","link","image","label"];function qN(){return{transforms:[GN],enter:{literalAutolink:BN,literalAutolinkEmail:Ko,literalAutolinkHttp:Ko,literalAutolinkWww:Ko},exit:{literalAutolink:KN,literalAutolinkEmail:WN,literalAutolinkHttp:UN,literalAutolinkWww:VN}}}function FN(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Vo,notInConstruct:Wo},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Vo,notInConstruct:Wo},{character:":",before:"[ps]",after:"\\/",inConstruct:Vo,notInConstruct:Wo}]}}function BN(t){this.enter({type:"link",title:null,url:"",children:[]},t)}function Ko(t){this.config.enter.autolinkProtocol.call(this,t)}function UN(t){this.config.exit.autolinkProtocol.call(this,t)}function VN(t){this.config.exit.data.call(this,t);const s=this.stack[this.stack.length-1];hi(s.type==="link"),s.url="http://"+this.sliceSerialize(t)}function WN(t){this.config.exit.autolinkEmail.call(this,t)}function KN(t){this.exit(t)}function GN(t){LN(t,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,HN],[/(?<=^|\s|\p{P}|\p{S})([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/gu,QN]],{ignore:["link","linkReference"]})}function HN(t,s,n,i,r){let a="";if(!wf(r)||(/^w/i.test(s)&&(n=s+n,s="",a="http://"),!ZN(n)))return!1;const o=YN(n+i);if(!o[0])return!1;const l={type:"link",title:null,url:a+s+o[0],children:[{type:"text",value:s+o[0]}]};return o[1]?[l,{type:"text",value:o[1]}]:l}function QN(t,s,n,i){return!wf(i,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+s+"@"+n,children:[{type:"text",value:s+"@"+n}]}}function ZN(t){const s=t.split(".");return!(s.length<2||s[s.length-1]&&(/_/.test(s[s.length-1])||!/[a-zA-Z\d]/.test(s[s.length-1]))||s[s.length-2]&&(/_/.test(s[s.length-2])||!/[a-zA-Z\d]/.test(s[s.length-2])))}function YN(t){const s=/[!"&'),.:;<>?\]}]+$/.exec(t);if(!s)return[t,void 0];t=t.slice(0,s.index);let n=s[0],i=n.indexOf(")");const r=lu(t,"(");let a=lu(t,")");for(;i!==-1&&r>a;)t+=n.slice(0,i+1),n=n.slice(i+1),i=n.indexOf(")"),a++;return[t,n]}function wf(t,s){const n=t.input.charCodeAt(t.index-1);return(t.index===0||ii(n)||nc(n))&&(!s||n!==47)}vf.peek=ak;function JN(){this.buffer()}function XN(t){this.enter({type:"footnoteReference",identifier:"",label:""},t)}function ek(){this.buffer()}function tk(t){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},t)}function sk(t){const s=this.resume(),n=this.stack[this.stack.length-1];hi(n.type==="footnoteReference"),n.identifier=Sr(this.sliceSerialize(t)).toLowerCase(),n.label=s}function nk(t){this.exit(t)}function ik(t){const s=this.resume(),n=this.stack[this.stack.length-1];hi(n.type==="footnoteDefinition"),n.identifier=Sr(this.sliceSerialize(t)).toLowerCase(),n.label=s}function rk(t){this.exit(t)}function ak(){return"["}function vf(t,s,n,i){const r=n.createTracker(i);let a=r.move("[^");const o=n.enter("footnoteReference"),l=n.enter("reference");return a+=r.move(n.safe(n.associationId(t),{after:"]",before:a})),l(),o(),a+=r.move("]"),a}function ok(){return{enter:{gfmFootnoteCallString:JN,gfmFootnoteCall:XN,gfmFootnoteDefinitionLabelString:ek,gfmFootnoteDefinition:tk},exit:{gfmFootnoteCallString:sk,gfmFootnoteCall:nk,gfmFootnoteDefinitionLabelString:ik,gfmFootnoteDefinition:rk}}}function lk(t){let s=!1;return t&&t.firstLineBlank&&(s=!0),{handlers:{footnoteDefinition:n,footnoteReference:vf},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(i,r,a,o){const l=a.createTracker(o);let c=l.move("[^");const d=a.enter("footnoteDefinition"),m=a.enter("label");return c+=l.move(a.safe(a.associationId(i),{before:c,after:"]"})),m(),c+=l.move("]:"),i.children&&i.children.length>0&&(l.shift(4),c+=l.move((s?`
`:" ")+a.indentLines(a.containerFlow(i,l.current()),s?Nf:ck))),d(),c}}function ck(t,s,n){return s===0?t:Nf(t,s,n)}function Nf(t,s,n){return(n?"":"    ")+t}const dk=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];kf.peek=fk;function uk(){return{canContainEols:["delete"],enter:{strikethrough:hk},exit:{strikethrough:pk}}}function mk(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:dk}],handlers:{delete:kf}}}function hk(t){this.enter({type:"delete",children:[]},t)}function pk(t){this.exit(t)}function kf(t,s,n,i){const r=n.createTracker(i),a=n.enter("strikethrough");let o=r.move("~~");return o+=n.containerPhrasing(t,{...r.current(),before:o,after:"~"}),o+=r.move("~~"),a(),o}function fk(){return"~"}function xk(t){return t.length}function gk(t,s){const n=s||{},i=(n.align||[]).concat(),r=n.stringLength||xk,a=[],o=[],l=[],c=[];let d=0,m=-1;for(;++m<t.length;){const f=[],x=[];let w=-1;for(t[m].length>d&&(d=t[m].length);++w<t[m].length;){const y=jk(t[m][w]);if(n.alignDelimiters!==!1){const N=r(y);x[w]=N,(c[w]===void 0||N>c[w])&&(c[w]=N)}f.push(y)}o[m]=f,l[m]=x}let u=-1;if(typeof i=="object"&&"length"in i)for(;++u<d;)a[u]=cu(i[u]);else{const f=cu(i);for(;++u<d;)a[u]=f}u=-1;const h=[],p=[];for(;++u<d;){const f=a[u];let x="",w="";f===99?(x=":",w=":"):f===108?x=":":f===114&&(w=":");let y=n.alignDelimiters===!1?1:Math.max(1,c[u]-x.length-w.length);const N=x+"-".repeat(y)+w;n.alignDelimiters!==!1&&(y=x.length+y+w.length,y>c[u]&&(c[u]=y),p[u]=y),h[u]=N}o.splice(1,0,h),l.splice(1,0,p),m=-1;const b=[];for(;++m<o.length;){const f=o[m],x=l[m];u=-1;const w=[];for(;++u<d;){const y=f[u]||"";let N="",A="";if(n.alignDelimiters!==!1){const S=c[u]-(x[u]||0),k=a[u];k===114?N=" ".repeat(S):k===99?S%2?(N=" ".repeat(S/2+.5),A=" ".repeat(S/2-.5)):(N=" ".repeat(S/2),A=N):A=" ".repeat(S)}n.delimiterStart!==!1&&!u&&w.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&y==="")&&(n.delimiterStart!==!1||u)&&w.push(" "),n.alignDelimiters!==!1&&w.push(N),w.push(y),n.alignDelimiters!==!1&&w.push(A),n.padding!==!1&&w.push(" "),(n.delimiterEnd!==!1||u!==d-1)&&w.push("|")}b.push(n.delimiterEnd===!1?w.join("").replace(/ +$/,""):w.join(""))}return b.join(`
`)}function jk(t){return t==null?"":String(t)}function cu(t){const s=typeof t=="string"?t.codePointAt(0):0;return s===67||s===99?99:s===76||s===108?108:s===82||s===114?114:0}function yk(t,s,n,i){const r=n.enter("blockquote"),a=n.createTracker(i);a.move("> "),a.shift(2);const o=n.indentLines(n.containerFlow(t,a.current()),bk);return r(),o}function bk(t,s,n){return">"+(n?"":" ")+t}function wk(t,s){return du(t,s.inConstruct,!0)&&!du(t,s.notInConstruct,!1)}function du(t,s,n){if(typeof s=="string"&&(s=[s]),!s||s.length===0)return n;let i=-1;for(;++i<s.length;)if(t.includes(s[i]))return!0;return!1}function uu(t,s,n,i){let r=-1;for(;++r<n.unsafe.length;)if(n.unsafe[r].character===`
`&&wk(n.stack,n.unsafe[r]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function vk(t,s){const n=String(t);let i=n.indexOf(s),r=i,a=0,o=0;if(typeof s!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===r?++a>o&&(o=a):a=1,r=i+s.length,i=n.indexOf(s,r);return o}function Nk(t,s){return!!(s.options.fences===!1&&t.value&&!t.lang&&/[^ \r\n]/.test(t.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(t.value))}function kk(t){const s=t.options.fence||"`";if(s!=="`"&&s!=="~")throw new Error("Cannot serialize code with `"+s+"` for `options.fence`, expected `` ` `` or `~`");return s}function zk(t,s,n,i){const r=kk(n),a=t.value||"",o=r==="`"?"GraveAccent":"Tilde";if(Nk(t,n)){const u=n.enter("codeIndented"),h=n.indentLines(a,Sk);return u(),h}const l=n.createTracker(i),c=r.repeat(Math.max(vk(a,r)+1,3)),d=n.enter("codeFenced");let m=l.move(c);if(t.lang){const u=n.enter(`codeFencedLang${o}`);m+=l.move(n.safe(t.lang,{before:m,after:" ",encode:["`"],...l.current()})),u()}if(t.lang&&t.meta){const u=n.enter(`codeFencedMeta${o}`);m+=l.move(" "),m+=l.move(n.safe(t.meta,{before:m,after:`
`,encode:["`"],...l.current()})),u()}return m+=l.move(`
`),a&&(m+=l.move(a+`
`)),m+=l.move(c),d(),m}function Sk(t,s,n){return(n?"":"    ")+t}function Tc(t){const s=t.options.quote||'"';if(s!=='"'&&s!=="'")throw new Error("Cannot serialize title with `"+s+"` for `options.quote`, expected `\"`, or `'`");return s}function Ck(t,s,n,i){const r=Tc(n),a=r==='"'?"Quote":"Apostrophe",o=n.enter("definition");let l=n.enter("label");const c=n.createTracker(i);let d=c.move("[");return d+=c.move(n.safe(n.associationId(t),{before:d,after:"]",...c.current()})),d+=c.move("]: "),l(),!t.url||/[\0- \u007F]/.test(t.url)?(l=n.enter("destinationLiteral"),d+=c.move("<"),d+=c.move(n.safe(t.url,{before:d,after:">",...c.current()})),d+=c.move(">")):(l=n.enter("destinationRaw"),d+=c.move(n.safe(t.url,{before:d,after:t.title?" ":`
`,...c.current()}))),l(),t.title&&(l=n.enter(`title${a}`),d+=c.move(" "+r),d+=c.move(n.safe(t.title,{before:d,after:r,...c.current()})),d+=c.move(r),l()),o(),d}function Tk(t){const s=t.options.emphasis||"*";if(s!=="*"&&s!=="_")throw new Error("Cannot serialize emphasis with `"+s+"` for `options.emphasis`, expected `*`, or `_`");return s}function pr(t){return"&#x"+t.toString(16).toUpperCase()+";"}function Oa(t,s,n){const i=Sa(t),r=Sa(s);return i===void 0?r===void 0?n==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:i===1?r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:r===void 0?{inside:!1,outside:!1}:r===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}zf.peek=Ak;function zf(t,s,n,i){const r=Tk(n),a=n.enter("emphasis"),o=n.createTracker(i),l=o.move(r);let c=o.move(n.containerPhrasing(t,{after:r,before:l,...o.current()}));const d=c.charCodeAt(0),m=Oa(i.before.charCodeAt(i.before.length-1),d,r);m.inside&&(c=pr(d)+c.slice(1));const u=c.charCodeAt(c.length-1),h=Oa(i.after.charCodeAt(0),u,r);h.inside&&(c=c.slice(0,-1)+pr(u));const p=o.move(r);return a(),n.attentionEncodeSurroundingInfo={after:h.outside,before:m.outside},l+c+p}function Ak(t,s,n){return n.options.emphasis||"*"}function _k(t,s){let n=!1;return fy(t,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return n=!0,xy}),!!((!t.depth||t.depth<3)&&Ah(t)&&(s.options.setext||n))}function Pk(t,s,n,i){const r=Math.max(Math.min(6,t.depth||1),1),a=n.createTracker(i);if(_k(t,n)){const m=n.enter("headingSetext"),u=n.enter("phrasing"),h=n.containerPhrasing(t,{...a.current(),before:`
`,after:`
`});return u(),m(),h+`
`+(r===1?"=":"-").repeat(h.length-(Math.max(h.lastIndexOf("\r"),h.lastIndexOf(`
`))+1))}const o="#".repeat(r),l=n.enter("headingAtx"),c=n.enter("phrasing");a.move(o+" ");let d=n.containerPhrasing(t,{before:"# ",after:`
`,...a.current()});return/^[\t ]/.test(d)&&(d=pr(d.charCodeAt(0))+d.slice(1)),d=d?o+" "+d:o,n.options.closeAtx&&(d+=" "+o),c(),l(),d}Sf.peek=Dk;function Sf(t){return t.value||""}function Dk(){return"<"}Cf.peek=Ik;function Cf(t,s,n,i){const r=Tc(n),a=r==='"'?"Quote":"Apostrophe",o=n.enter("image");let l=n.enter("label");const c=n.createTracker(i);let d=c.move("![");return d+=c.move(n.safe(t.alt,{before:d,after:"]",...c.current()})),d+=c.move("]("),l(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(l=n.enter("destinationLiteral"),d+=c.move("<"),d+=c.move(n.safe(t.url,{before:d,after:">",...c.current()})),d+=c.move(">")):(l=n.enter("destinationRaw"),d+=c.move(n.safe(t.url,{before:d,after:t.title?" ":")",...c.current()}))),l(),t.title&&(l=n.enter(`title${a}`),d+=c.move(" "+r),d+=c.move(n.safe(t.title,{before:d,after:r,...c.current()})),d+=c.move(r),l()),d+=c.move(")"),o(),d}function Ik(){return"!"}Tf.peek=Mk;function Tf(t,s,n,i){const r=t.referenceType,a=n.enter("imageReference");let o=n.enter("label");const l=n.createTracker(i);let c=l.move("![");const d=n.safe(t.alt,{before:c,after:"]",...l.current()});c+=l.move(d+"]["),o();const m=n.stack;n.stack=[],o=n.enter("reference");const u=n.safe(n.associationId(t),{before:c,after:"]",...l.current()});return o(),n.stack=m,a(),r==="full"||!d||d!==u?c+=l.move(u+"]"):r==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function Mk(){return"!"}Af.peek=Ek;function Af(t,s,n){let i=t.value||"",r="`",a=-1;for(;new RegExp("(^|[^`])"+r+"([^`]|$)").test(i);)r+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++a<n.unsafe.length;){const o=n.unsafe[a],l=n.compilePattern(o);let c;if(o.atBreak)for(;c=l.exec(i);){let d=c.index;i.charCodeAt(d)===10&&i.charCodeAt(d-1)===13&&d--,i=i.slice(0,d)+" "+i.slice(c.index+1)}}return r+i+r}function Ek(){return"`"}function _f(t,s){const n=Ah(t);return!!(!s.options.resourceLink&&t.url&&!t.title&&t.children&&t.children.length===1&&t.children[0].type==="text"&&(n===t.url||"mailto:"+n===t.url)&&/^[a-z][a-z+.-]+:/i.test(t.url)&&!/[\0- <>\u007F]/.test(t.url))}Pf.peek=Lk;function Pf(t,s,n,i){const r=Tc(n),a=r==='"'?"Quote":"Apostrophe",o=n.createTracker(i);let l,c;if(_f(t,n)){const m=n.stack;n.stack=[],l=n.enter("autolink");let u=o.move("<");return u+=o.move(n.containerPhrasing(t,{before:u,after:">",...o.current()})),u+=o.move(">"),l(),n.stack=m,u}l=n.enter("link"),c=n.enter("label");let d=o.move("[");return d+=o.move(n.containerPhrasing(t,{before:d,after:"](",...o.current()})),d+=o.move("]("),c(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(c=n.enter("destinationLiteral"),d+=o.move("<"),d+=o.move(n.safe(t.url,{before:d,after:">",...o.current()})),d+=o.move(">")):(c=n.enter("destinationRaw"),d+=o.move(n.safe(t.url,{before:d,after:t.title?" ":")",...o.current()}))),c(),t.title&&(c=n.enter(`title${a}`),d+=o.move(" "+r),d+=o.move(n.safe(t.title,{before:d,after:r,...o.current()})),d+=o.move(r),c()),d+=o.move(")"),l(),d}function Lk(t,s,n){return _f(t,n)?"<":"["}Df.peek=Ok;function Df(t,s,n,i){const r=t.referenceType,a=n.enter("linkReference");let o=n.enter("label");const l=n.createTracker(i);let c=l.move("[");const d=n.containerPhrasing(t,{before:c,after:"]",...l.current()});c+=l.move(d+"]["),o();const m=n.stack;n.stack=[],o=n.enter("reference");const u=n.safe(n.associationId(t),{before:c,after:"]",...l.current()});return o(),n.stack=m,a(),r==="full"||!d||d!==u?c+=l.move(u+"]"):r==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function Ok(){return"["}function Ac(t){const s=t.options.bullet||"*";if(s!=="*"&&s!=="+"&&s!=="-")throw new Error("Cannot serialize items with `"+s+"` for `options.bullet`, expected `*`, `+`, or `-`");return s}function Rk(t){const s=Ac(t),n=t.options.bulletOther;if(!n)return s==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===s)throw new Error("Expected `bullet` (`"+s+"`) and `bulletOther` (`"+n+"`) to be different");return n}function $k(t){const s=t.options.bulletOrdered||".";if(s!=="."&&s!==")")throw new Error("Cannot serialize items with `"+s+"` for `options.bulletOrdered`, expected `.` or `)`");return s}function If(t){const s=t.options.rule||"*";if(s!=="*"&&s!=="-"&&s!=="_")throw new Error("Cannot serialize rules with `"+s+"` for `options.rule`, expected `*`, `-`, or `_`");return s}function qk(t,s,n,i){const r=n.enter("list"),a=n.bulletCurrent;let o=t.ordered?$k(n):Ac(n);const l=t.ordered?o==="."?")":".":Rk(n);let c=s&&n.bulletLastUsed?o===n.bulletLastUsed:!1;if(!t.ordered){const m=t.children?t.children[0]:void 0;if((o==="*"||o==="-")&&m&&(!m.children||!m.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(c=!0),If(n)===o&&m){let u=-1;for(;++u<t.children.length;){const h=t.children[u];if(h&&h.type==="listItem"&&h.children&&h.children[0]&&h.children[0].type==="thematicBreak"){c=!0;break}}}}c&&(o=l),n.bulletCurrent=o;const d=n.containerFlow(t,i);return n.bulletLastUsed=o,n.bulletCurrent=a,r(),d}function Fk(t){const s=t.options.listItemIndent||"one";if(s!=="tab"&&s!=="one"&&s!=="mixed")throw new Error("Cannot serialize items with `"+s+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return s}function Bk(t,s,n,i){const r=Fk(n);let a=n.bulletCurrent||Ac(n);s&&s.type==="list"&&s.ordered&&(a=(typeof s.start=="number"&&s.start>-1?s.start:1)+(n.options.incrementListMarker===!1?0:s.children.indexOf(t))+a);let o=a.length+1;(r==="tab"||r==="mixed"&&(s&&s.type==="list"&&s.spread||t.spread))&&(o=Math.ceil(o/4)*4);const l=n.createTracker(i);l.move(a+" ".repeat(o-a.length)),l.shift(o);const c=n.enter("listItem"),d=n.indentLines(n.containerFlow(t,l.current()),m);return c(),d;function m(u,h,p){return h?(p?"":" ".repeat(o))+u:(p?a:a+" ".repeat(o-a.length))+u}}function Uk(t,s,n,i){const r=n.enter("paragraph"),a=n.enter("phrasing"),o=n.containerPhrasing(t,i);return a(),r(),o}const Vk=Th(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function Wk(t,s,n,i){return(t.children.some(function(o){return Vk(o)})?n.containerPhrasing:n.containerFlow).call(n,t,i)}function Kk(t){const s=t.options.strong||"*";if(s!=="*"&&s!=="_")throw new Error("Cannot serialize strong with `"+s+"` for `options.strong`, expected `*`, or `_`");return s}Mf.peek=Gk;function Mf(t,s,n,i){const r=Kk(n),a=n.enter("strong"),o=n.createTracker(i),l=o.move(r+r);let c=o.move(n.containerPhrasing(t,{after:r,before:l,...o.current()}));const d=c.charCodeAt(0),m=Oa(i.before.charCodeAt(i.before.length-1),d,r);m.inside&&(c=pr(d)+c.slice(1));const u=c.charCodeAt(c.length-1),h=Oa(i.after.charCodeAt(0),u,r);h.inside&&(c=c.slice(0,-1)+pr(u));const p=o.move(r+r);return a(),n.attentionEncodeSurroundingInfo={after:h.outside,before:m.outside},l+c+p}function Gk(t,s,n){return n.options.strong||"*"}function Hk(t,s,n,i){return n.safe(t.value,i)}function Qk(t){const s=t.options.ruleRepetition||3;if(s<3)throw new Error("Cannot serialize rules with repetition `"+s+"` for `options.ruleRepetition`, expected `3` or more");return s}function Zk(t,s,n){const i=(If(n)+(n.options.ruleSpaces?" ":"")).repeat(Qk(n));return n.options.ruleSpaces?i.slice(0,-1):i}const Ef={blockquote:yk,break:uu,code:zk,definition:Ck,emphasis:zf,hardBreak:uu,heading:Pk,html:Sf,image:Cf,imageReference:Tf,inlineCode:Af,link:Pf,linkReference:Df,list:qk,listItem:Bk,paragraph:Uk,root:Wk,strong:Mf,text:Hk,thematicBreak:Zk};function Yk(){return{enter:{table:Jk,tableData:mu,tableHeader:mu,tableRow:ez},exit:{codeText:tz,table:Xk,tableData:Go,tableHeader:Go,tableRow:Go}}}function Jk(t){const s=t._align;this.enter({type:"table",align:s.map(function(n){return n==="none"?null:n}),children:[]},t),this.data.inTable=!0}function Xk(t){this.exit(t),this.data.inTable=void 0}function ez(t){this.enter({type:"tableRow",children:[]},t)}function Go(t){this.exit(t)}function mu(t){this.enter({type:"tableCell",children:[]},t)}function tz(t){let s=this.resume();this.data.inTable&&(s=s.replace(/\\([\\|])/g,sz));const n=this.stack[this.stack.length-1];hi(n.type==="inlineCode"),n.value=s,this.exit(t)}function sz(t,s){return s==="|"?s:t}function nz(t){const s=t||{},n=s.tableCellPadding,i=s.tablePipeAlign,r=s.stringLength,a=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:h,table:o,tableCell:c,tableRow:l}};function o(p,b,f,x){return d(m(p,f,x),p.align)}function l(p,b,f,x){const w=u(p,f,x),y=d([w]);return y.slice(0,y.indexOf(`
`))}function c(p,b,f,x){const w=f.enter("tableCell"),y=f.enter("phrasing"),N=f.containerPhrasing(p,{...x,before:a,after:a});return y(),w(),N}function d(p,b){return gk(p,{align:b,alignDelimiters:i,padding:n,stringLength:r})}function m(p,b,f){const x=p.children;let w=-1;const y=[],N=b.enter("table");for(;++w<x.length;)y[w]=u(x[w],b,f);return N(),y}function u(p,b,f){const x=p.children;let w=-1;const y=[],N=b.enter("tableRow");for(;++w<x.length;)y[w]=c(x[w],p,b,f);return N(),y}function h(p,b,f){let x=Ef.inlineCode(p,b,f);return f.stack.includes("tableCell")&&(x=x.replace(/\|/g,"\\$&")),x}}function iz(){return{exit:{taskListCheckValueChecked:hu,taskListCheckValueUnchecked:hu,paragraph:az}}}function rz(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:oz}}}function hu(t){const s=this.stack[this.stack.length-2];hi(s.type==="listItem"),s.checked=t.type==="taskListCheckValueChecked"}function az(t){const s=this.stack[this.stack.length-2];if(s&&s.type==="listItem"&&typeof s.checked=="boolean"){const n=this.stack[this.stack.length-1];hi(n.type==="paragraph");const i=n.children[0];if(i&&i.type==="text"){const r=s.children;let a=-1,o;for(;++a<r.length;){const l=r[a];if(l.type==="paragraph"){o=l;break}}o===n&&(i.value=i.value.slice(1),i.value.length===0?n.children.shift():n.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,n.position.start=Object.assign({},i.position.start)))}}this.exit(t)}function oz(t,s,n,i){const r=t.children[0],a=typeof t.checked=="boolean"&&r&&r.type==="paragraph",o="["+(t.checked?"x":" ")+"] ",l=n.createTracker(i);a&&l.move(o);let c=Ef.listItem(t,s,n,{...i,...l.current()});return a&&(c=c.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,d)),c;function d(m){return m+o}}function lz(){return[qN(),ok(),uk(),Yk(),iz()]}function cz(t){return{extensions:[FN(),lk(t),mk(),nz(t),rz()]}}const dz={tokenize:xz,partial:!0},Lf={tokenize:gz,partial:!0},Of={tokenize:jz,partial:!0},Rf={tokenize:yz,partial:!0},uz={tokenize:bz,partial:!0},$f={name:"wwwAutolink",tokenize:pz,previous:Ff},qf={name:"protocolAutolink",tokenize:fz,previous:Bf},Ls={name:"emailAutolink",tokenize:hz,previous:Uf},vs={};function mz(){return{text:vs}}let an=48;for(;an<123;)vs[an]=Ls,an++,an===58?an=65:an===91&&(an=97);vs[43]=Ls;vs[45]=Ls;vs[46]=Ls;vs[95]=Ls;vs[72]=[Ls,qf];vs[104]=[Ls,qf];vs[87]=[Ls,$f];vs[119]=[Ls,$f];function hz(t,s,n){const i=this;let r,a;return o;function o(u){return!zl(u)||!Uf.call(i,i.previous)||_c(i.events)?n(u):(t.enter("literalAutolink"),t.enter("literalAutolinkEmail"),l(u))}function l(u){return zl(u)?(t.consume(u),l):u===64?(t.consume(u),c):n(u)}function c(u){return u===46?t.check(uz,m,d)(u):u===45||u===95||ic(u)?(a=!0,t.consume(u),c):m(u)}function d(u){return t.consume(u),r=!0,c}function m(u){return a&&r&&sr(i.previous)?(t.exit("literalAutolinkEmail"),t.exit("literalAutolink"),s(u)):n(u)}}function pz(t,s,n){const i=this;return r;function r(o){return o!==87&&o!==119||!Ff.call(i,i.previous)||_c(i.events)?n(o):(t.enter("literalAutolink"),t.enter("literalAutolinkWww"),t.check(dz,t.attempt(Lf,t.attempt(Of,a),n),n)(o))}function a(o){return t.exit("literalAutolinkWww"),t.exit("literalAutolink"),s(o)}}function fz(t,s,n){const i=this;let r="",a=!1;return o;function o(u){return(u===72||u===104)&&Bf.call(i,i.previous)&&!_c(i.events)?(t.enter("literalAutolink"),t.enter("literalAutolinkHttp"),r+=String.fromCodePoint(u),t.consume(u),l):n(u)}function l(u){if(sr(u)&&r.length<5)return r+=String.fromCodePoint(u),t.consume(u),l;if(u===58){const h=r.toLowerCase();if(h==="http"||h==="https")return t.consume(u),c}return n(u)}function c(u){return u===47?(t.consume(u),a?d:(a=!0,c)):n(u)}function d(u){return u===null||gy(u)||Et(u)||ii(u)||nc(u)?n(u):t.attempt(Lf,t.attempt(Of,m),n)(u)}function m(u){return t.exit("literalAutolinkHttp"),t.exit("literalAutolink"),s(u)}}function xz(t,s,n){let i=0;return r;function r(o){return(o===87||o===119)&&i<3?(i++,t.consume(o),r):o===46&&i===3?(t.consume(o),a):n(o)}function a(o){return o===null?n(o):s(o)}}function gz(t,s,n){let i,r,a;return o;function o(d){return d===46||d===95?t.check(Rf,c,l)(d):d===null||Et(d)||ii(d)||d!==45&&nc(d)?c(d):(a=!0,t.consume(d),o)}function l(d){return d===95?i=!0:(r=i,i=void 0),t.consume(d),o}function c(d){return r||i||!a?n(d):s(d)}}function jz(t,s){let n=0,i=0;return r;function r(o){return o===40?(n++,t.consume(o),r):o===41&&i<n?a(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?t.check(Rf,s,a)(o):o===null||Et(o)||ii(o)?s(o):(t.consume(o),r)}function a(o){return o===41&&i++,t.consume(o),r}}function yz(t,s,n){return i;function i(l){return l===33||l===34||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===63||l===95||l===126?(t.consume(l),i):l===38?(t.consume(l),a):l===93?(t.consume(l),r):l===60||l===null||Et(l)||ii(l)?s(l):n(l)}function r(l){return l===null||l===40||l===91||Et(l)||ii(l)?s(l):i(l)}function a(l){return sr(l)?o(l):n(l)}function o(l){return l===59?(t.consume(l),i):sr(l)?(t.consume(l),o):n(l)}}function bz(t,s,n){return i;function i(a){return t.consume(a),r}function r(a){return ic(a)?n(a):s(a)}}function Ff(t){return t===null||t===40||t===42||t===95||t===91||t===93||t===126||Et(t)}function Bf(t){return!sr(t)}function Uf(t){return!(t===47||zl(t))}function zl(t){return t===43||t===45||t===46||t===95||ic(t)}function _c(t){let s=t.length,n=!1;for(;s--;){const i=t[s][1];if((i.type==="labelLink"||i.type==="labelImage")&&!i._balanced){n=!0;break}if(i._gfmAutolinkLiteralWalkedInto){n=!1;break}}return t.length>0&&!n&&(t[t.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const wz={tokenize:Az,partial:!0};function vz(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:Sz,continuation:{tokenize:Cz},exit:Tz}},text:{91:{name:"gfmFootnoteCall",tokenize:zz},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:Nz,resolveTo:kz}}}}function Nz(t,s,n){const i=this;let r=i.events.length;const a=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let o;for(;r--;){const c=i.events[r][1];if(c.type==="labelImage"){o=c;break}if(c.type==="gfmFootnoteCall"||c.type==="labelLink"||c.type==="label"||c.type==="image"||c.type==="link")break}return l;function l(c){if(!o||!o._balanced)return n(c);const d=Sr(i.sliceSerialize({start:o.end,end:i.now()}));return d.codePointAt(0)!==94||!a.includes(d.slice(1))?n(c):(t.enter("gfmFootnoteCallLabelMarker"),t.consume(c),t.exit("gfmFootnoteCallLabelMarker"),s(c))}}function kz(t,s){let n=t.length;for(;n--;)if(t[n][1].type==="labelImage"&&t[n][0]==="enter"){t[n][1];break}t[n+1][1].type="data",t[n+3][1].type="gfmFootnoteCallLabelMarker";const i={type:"gfmFootnoteCall",start:Object.assign({},t[n+3][1].start),end:Object.assign({},t[t.length-1][1].end)},r={type:"gfmFootnoteCallMarker",start:Object.assign({},t[n+3][1].end),end:Object.assign({},t[n+3][1].end)};r.end.column++,r.end.offset++,r.end._bufferIndex++;const a={type:"gfmFootnoteCallString",start:Object.assign({},r.end),end:Object.assign({},t[t.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},a.start),end:Object.assign({},a.end)},l=[t[n+1],t[n+2],["enter",i,s],t[n+3],t[n+4],["enter",r,s],["exit",r,s],["enter",a,s],["enter",o,s],["exit",o,s],["exit",a,s],t[t.length-2],t[t.length-1],["exit",i,s]];return t.splice(n,t.length-n+1,...l),t}function zz(t,s,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let a=0,o;return l;function l(u){return t.enter("gfmFootnoteCall"),t.enter("gfmFootnoteCallLabelMarker"),t.consume(u),t.exit("gfmFootnoteCallLabelMarker"),c}function c(u){return u!==94?n(u):(t.enter("gfmFootnoteCallMarker"),t.consume(u),t.exit("gfmFootnoteCallMarker"),t.enter("gfmFootnoteCallString"),t.enter("chunkString").contentType="string",d)}function d(u){if(a>999||u===93&&!o||u===null||u===91||Et(u))return n(u);if(u===93){t.exit("chunkString");const h=t.exit("gfmFootnoteCallString");return r.includes(Sr(i.sliceSerialize(h)))?(t.enter("gfmFootnoteCallLabelMarker"),t.consume(u),t.exit("gfmFootnoteCallLabelMarker"),t.exit("gfmFootnoteCall"),s):n(u)}return Et(u)||(o=!0),a++,t.consume(u),u===92?m:d}function m(u){return u===91||u===92||u===93?(t.consume(u),a++,d):d(u)}}function Sz(t,s,n){const i=this,r=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let a,o=0,l;return c;function c(b){return t.enter("gfmFootnoteDefinition")._container=!0,t.enter("gfmFootnoteDefinitionLabel"),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(b),t.exit("gfmFootnoteDefinitionLabelMarker"),d}function d(b){return b===94?(t.enter("gfmFootnoteDefinitionMarker"),t.consume(b),t.exit("gfmFootnoteDefinitionMarker"),t.enter("gfmFootnoteDefinitionLabelString"),t.enter("chunkString").contentType="string",m):n(b)}function m(b){if(o>999||b===93&&!l||b===null||b===91||Et(b))return n(b);if(b===93){t.exit("chunkString");const f=t.exit("gfmFootnoteDefinitionLabelString");return a=Sr(i.sliceSerialize(f)),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(b),t.exit("gfmFootnoteDefinitionLabelMarker"),t.exit("gfmFootnoteDefinitionLabel"),h}return Et(b)||(l=!0),o++,t.consume(b),b===92?u:m}function u(b){return b===91||b===92||b===93?(t.consume(b),o++,m):m(b)}function h(b){return b===58?(t.enter("definitionMarker"),t.consume(b),t.exit("definitionMarker"),r.includes(a)||r.push(a),Ks(t,p,"gfmFootnoteDefinitionWhitespace")):n(b)}function p(b){return s(b)}}function Cz(t,s,n){return t.check(jy,s,t.attempt(wz,s,n))}function Tz(t){t.exit("gfmFootnoteDefinition")}function Az(t,s,n){const i=this;return Ks(t,r,"gfmFootnoteDefinitionIndent",5);function r(a){const o=i.events[i.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?s(a):n(a)}}function _z(t){let n=(t||{}).singleTilde;const i={name:"strikethrough",tokenize:a,resolveAll:r};return n==null&&(n=!0),{text:{126:i},insideSpan:{null:[i]},attentionMarkers:{null:[126]}};function r(o,l){let c=-1;for(;++c<o.length;)if(o[c][0]==="enter"&&o[c][1].type==="strikethroughSequenceTemporary"&&o[c][1]._close){let d=c;for(;d--;)if(o[d][0]==="exit"&&o[d][1].type==="strikethroughSequenceTemporary"&&o[d][1]._open&&o[c][1].end.offset-o[c][1].start.offset===o[d][1].end.offset-o[d][1].start.offset){o[c][1].type="strikethroughSequence",o[d][1].type="strikethroughSequence";const m={type:"strikethrough",start:Object.assign({},o[d][1].start),end:Object.assign({},o[c][1].end)},u={type:"strikethroughText",start:Object.assign({},o[d][1].end),end:Object.assign({},o[c][1].start)},h=[["enter",m,l],["enter",o[d][1],l],["exit",o[d][1],l],["enter",u,l]],p=l.parser.constructs.insideSpan.null;p&&Ro(h,h.length,0,yy(p,o.slice(d+1,c),l)),Ro(h,h.length,0,[["exit",u,l],["enter",o[c][1],l],["exit",o[c][1],l],["exit",m,l]]),Ro(o,d-1,c-d+3,h),c=d+h.length-2;break}}for(c=-1;++c<o.length;)o[c][1].type==="strikethroughSequenceTemporary"&&(o[c][1].type="data");return o}function a(o,l,c){const d=this.previous,m=this.events;let u=0;return h;function h(b){return d===126&&m[m.length-1][1].type!=="characterEscape"?c(b):(o.enter("strikethroughSequenceTemporary"),p(b))}function p(b){const f=Sa(d);if(b===126)return u>1?c(b):(o.consume(b),u++,p);if(u<2&&!n)return c(b);const x=o.exit("strikethroughSequenceTemporary"),w=Sa(b);return x._open=!w||w===2&&!!f,x._close=!f||f===2&&!!w,l(b)}}}class Pz{constructor(){this.map=[]}add(s,n,i){Dz(this,s,n,i)}consume(s){if(this.map.sort(function(a,o){return a[0]-o[0]}),this.map.length===0)return;let n=this.map.length;const i=[];for(;n>0;)n-=1,i.push(s.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),s.length=this.map[n][0];i.push(s.slice()),s.length=0;let r=i.pop();for(;r;){for(const a of r)s.push(a);r=i.pop()}this.map.length=0}}function Dz(t,s,n,i){let r=0;if(!(n===0&&i.length===0)){for(;r<t.map.length;){if(t.map[r][0]===s){t.map[r][1]+=n,t.map[r][2].push(...i);return}r+=1}t.map.push([s,n,i])}}function Iz(t,s){let n=!1;const i=[];for(;s<t.length;){const r=t[s];if(n){if(r[0]==="enter")r[1].type==="tableContent"&&i.push(t[s+1][1].type==="tableDelimiterMarker"?"left":"none");else if(r[1].type==="tableContent"){if(t[s-1][1].type==="tableDelimiterMarker"){const a=i.length-1;i[a]=i[a]==="left"?"center":"right"}}else if(r[1].type==="tableDelimiterRow")break}else r[0]==="enter"&&r[1].type==="tableDelimiterRow"&&(n=!0);s+=1}return i}function Mz(){return{flow:{null:{name:"table",tokenize:Ez,resolveAll:Lz}}}}function Ez(t,s,n){const i=this;let r=0,a=0,o;return l;function l(j){let C=i.events.length-1;for(;C>-1;){const M=i.events[C][1].type;if(M==="lineEnding"||M==="linePrefix")C--;else break}const T=C>-1?i.events[C][1].type:null,E=T==="tableHead"||T==="tableRow"?k:c;return E===k&&i.parser.lazy[i.now().line]?n(j):E(j)}function c(j){return t.enter("tableHead"),t.enter("tableRow"),d(j)}function d(j){return j===124||(o=!0,a+=1),m(j)}function m(j){return j===null?n(j):Ui(j)?a>1?(a=0,i.interrupt=!0,t.exit("tableRow"),t.enter("lineEnding"),t.consume(j),t.exit("lineEnding"),p):n(j):Fn(j)?Ks(t,m,"whitespace")(j):(a+=1,o&&(o=!1,r+=1),j===124?(t.enter("tableCellDivider"),t.consume(j),t.exit("tableCellDivider"),o=!0,m):(t.enter("data"),u(j)))}function u(j){return j===null||j===124||Et(j)?(t.exit("data"),m(j)):(t.consume(j),j===92?h:u)}function h(j){return j===92||j===124?(t.consume(j),u):u(j)}function p(j){return i.interrupt=!1,i.parser.lazy[i.now().line]?n(j):(t.enter("tableDelimiterRow"),o=!1,Fn(j)?Ks(t,b,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(j):b(j))}function b(j){return j===45||j===58?x(j):j===124?(o=!0,t.enter("tableCellDivider"),t.consume(j),t.exit("tableCellDivider"),f):S(j)}function f(j){return Fn(j)?Ks(t,x,"whitespace")(j):x(j)}function x(j){return j===58?(a+=1,o=!0,t.enter("tableDelimiterMarker"),t.consume(j),t.exit("tableDelimiterMarker"),w):j===45?(a+=1,w(j)):j===null||Ui(j)?A(j):S(j)}function w(j){return j===45?(t.enter("tableDelimiterFiller"),y(j)):S(j)}function y(j){return j===45?(t.consume(j),y):j===58?(o=!0,t.exit("tableDelimiterFiller"),t.enter("tableDelimiterMarker"),t.consume(j),t.exit("tableDelimiterMarker"),N):(t.exit("tableDelimiterFiller"),N(j))}function N(j){return Fn(j)?Ks(t,A,"whitespace")(j):A(j)}function A(j){return j===124?b(j):j===null||Ui(j)?!o||r!==a?S(j):(t.exit("tableDelimiterRow"),t.exit("tableHead"),s(j)):S(j)}function S(j){return n(j)}function k(j){return t.enter("tableRow"),v(j)}function v(j){return j===124?(t.enter("tableCellDivider"),t.consume(j),t.exit("tableCellDivider"),v):j===null||Ui(j)?(t.exit("tableRow"),s(j)):Fn(j)?Ks(t,v,"whitespace")(j):(t.enter("data"),z(j))}function z(j){return j===null||j===124||Et(j)?(t.exit("data"),v(j)):(t.consume(j),j===92?D:z)}function D(j){return j===92||j===124?(t.consume(j),z):z(j)}}function Lz(t,s){let n=-1,i=!0,r=0,a=[0,0,0,0],o=[0,0,0,0],l=!1,c=0,d,m,u;const h=new Pz;for(;++n<t.length;){const p=t[n],b=p[1];p[0]==="enter"?b.type==="tableHead"?(l=!1,c!==0&&(pu(h,s,c,d,m),m=void 0,c=0),d={type:"table",start:Object.assign({},b.start),end:Object.assign({},b.end)},h.add(n,0,[["enter",d,s]])):b.type==="tableRow"||b.type==="tableDelimiterRow"?(i=!0,u=void 0,a=[0,0,0,0],o=[0,n+1,0,0],l&&(l=!1,m={type:"tableBody",start:Object.assign({},b.start),end:Object.assign({},b.end)},h.add(n,0,[["enter",m,s]])),r=b.type==="tableDelimiterRow"?2:m?3:1):r&&(b.type==="data"||b.type==="tableDelimiterMarker"||b.type==="tableDelimiterFiller")?(i=!1,o[2]===0&&(a[1]!==0&&(o[0]=o[1],u=ra(h,s,a,r,void 0,u),a=[0,0,0,0]),o[2]=n)):b.type==="tableCellDivider"&&(i?i=!1:(a[1]!==0&&(o[0]=o[1],u=ra(h,s,a,r,void 0,u)),a=o,o=[a[1],n,0,0])):b.type==="tableHead"?(l=!0,c=n):b.type==="tableRow"||b.type==="tableDelimiterRow"?(c=n,a[1]!==0?(o[0]=o[1],u=ra(h,s,a,r,n,u)):o[1]!==0&&(u=ra(h,s,o,r,n,u)),r=0):r&&(b.type==="data"||b.type==="tableDelimiterMarker"||b.type==="tableDelimiterFiller")&&(o[3]=n)}for(c!==0&&pu(h,s,c,d,m),h.consume(s.events),n=-1;++n<s.events.length;){const p=s.events[n];p[0]==="enter"&&p[1].type==="table"&&(p[1]._align=Iz(s.events,n))}return t}function ra(t,s,n,i,r,a){const o=i===1?"tableHeader":i===2?"tableDelimiter":"tableData",l="tableContent";n[0]!==0&&(a.end=Object.assign({},Bn(s.events,n[0])),t.add(n[0],0,[["exit",a,s]]));const c=Bn(s.events,n[1]);if(a={type:o,start:Object.assign({},c),end:Object.assign({},c)},t.add(n[1],0,[["enter",a,s]]),n[2]!==0){const d=Bn(s.events,n[2]),m=Bn(s.events,n[3]),u={type:l,start:Object.assign({},d),end:Object.assign({},m)};if(t.add(n[2],0,[["enter",u,s]]),i!==2){const h=s.events[n[2]],p=s.events[n[3]];if(h[1].end=Object.assign({},p[1].end),h[1].type="chunkText",h[1].contentType="text",n[3]>n[2]+1){const b=n[2]+1,f=n[3]-n[2]-1;t.add(b,f,[])}}t.add(n[3]+1,0,[["exit",u,s]])}return r!==void 0&&(a.end=Object.assign({},Bn(s.events,r)),t.add(r,0,[["exit",a,s]]),a=void 0),a}function pu(t,s,n,i,r){const a=[],o=Bn(s.events,n);r&&(r.end=Object.assign({},o),a.push(["exit",r,s])),i.end=Object.assign({},o),a.push(["exit",i,s]),t.add(n+1,0,a)}function Bn(t,s){const n=t[s],i=n[0]==="enter"?"start":"end";return n[1][i]}const Oz={name:"tasklistCheck",tokenize:$z};function Rz(){return{text:{91:Oz}}}function $z(t,s,n){const i=this;return r;function r(c){return i.previous!==null||!i._gfmTasklistFirstContentOfListItem?n(c):(t.enter("taskListCheck"),t.enter("taskListCheckMarker"),t.consume(c),t.exit("taskListCheckMarker"),a)}function a(c){return Et(c)?(t.enter("taskListCheckValueUnchecked"),t.consume(c),t.exit("taskListCheckValueUnchecked"),o):c===88||c===120?(t.enter("taskListCheckValueChecked"),t.consume(c),t.exit("taskListCheckValueChecked"),o):n(c)}function o(c){return c===93?(t.enter("taskListCheckMarker"),t.consume(c),t.exit("taskListCheckMarker"),t.exit("taskListCheck"),l):n(c)}function l(c){return Ui(c)?s(c):Fn(c)?t.check({tokenize:qz},s,n)(c):n(c)}}function qz(t,s,n){return Ks(t,i,"whitespace");function i(r){return r===null?n(r):s(r)}}function Fz(t){return by([mz(),vz(),_z(t),Mz(),Rz()])}const Bz={};function Sl(t){const s=this,n=t||Bz,i=s.data(),r=i.micromarkExtensions||(i.micromarkExtensions=[]),a=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),o=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);r.push(Fz(n)),a.push(lz()),o.push(cz(n))}const Uz=({activity:t})=>e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[1fr,300px]",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Treść materiału"})}),e.jsx(P,{children:t.content?e.jsx("div",{className:"prose max-w-none",children:e.jsx(Jn,{remarkPlugins:[Sl],children:t.content})}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(We,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Brak treści materiału"})]})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs(_,{children:[e.jsx(O,{className:"pb-3",children:e.jsx(L,{className:"text-base",children:"Informacje"})}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[e.jsx(Se,{className:"w-4 h-4"}),"Czas trwania"]}),e.jsxs("p",{className:"font-medium",children:[t.duration_min||"-"," minut"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[e.jsx($y,{className:"w-4 h-4"}),"Pozycja w temacie"]}),e.jsx("p",{className:"font-medium",children:t.position})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[e.jsx(Kt,{className:"w-4 h-4"}),"Data utworzenia"]}),e.jsx("p",{className:"font-medium",children:new Date(t.created_at).toLocaleDateString("pl-PL")})]}),t.updated_at&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[e.jsx(Kt,{className:"w-4 h-4"}),"Ostatnia aktualizacja"]}),e.jsx("p",{className:"font-medium",children:new Date(t.updated_at).toLocaleDateString("pl-PL")})]})]})]})})]}),Vz=({activity:t,questionsCount:s,questionsData:n,questionsLoading:i,onNavigateToQuestions:r})=>{const a=n?.reduce((l,c)=>l+(c.points||0),0)||0,o=Math.ceil((t.passing_score||70)/100*a);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Parametry quizu"})}),e.jsx(P,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Se,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Czas trwania"})]}),e.jsxs("p",{className:"text-2xl font-bold",children:[t.duration_min||"-"," min"]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ze,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Próg zaliczenia"})]}),e.jsxs("p",{className:"text-2xl font-bold",children:[t.passing_score||70,"%"]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(qy,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Limit czasu"})]}),e.jsx("p",{className:"text-2xl font-bold",children:t.time_limit?`${t.time_limit} min`:"Brak"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ai,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Liczba prób"})]}),e.jsx("p",{className:"text-2xl font-bold",children:t.max_attempts||"Bez limitu"})]})]})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(L,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:["Pytania (",s,")"]}),s>0&&e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>r(t.id),children:[e.jsx(Ht,{className:"w-3 h-3 mr-1"}),"Zarządzaj"]})]})}),e.jsx(P,{children:s===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(dt,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground/30"}),e.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-2",children:"Ten quiz nie ma jeszcze pytań"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Dodaj pytania, aby uczniowie mogli rozwiązać quiz"}),e.jsxs(I,{onClick:()=>r(t.id),children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Dodaj pierwsze pytanie"]})]}):i?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):e.jsx("div",{className:"space-y-2",children:n?.map((l,c)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center text-sm font-semibold",children:c+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.type==="single_choice"&&e.jsxs(H,{variant:"outline",className:"text-xs",children:[e.jsx(st,{className:"w-3 h-3 mr-1"}),"Jednokrotny wybór"]}),l.type==="multiple_choice"&&e.jsxs(H,{variant:"outline",className:"text-xs",children:[e.jsx(fn,{className:"w-3 h-3 mr-1"}),"Wielokrotny wybór"]}),l.type==="true_false"&&e.jsxs(H,{variant:"outline",className:"text-xs",children:[e.jsx(Is,{className:"w-3 h-3 mr-1"}),"Prawda/Fałsz"]}),e.jsxs(H,{variant:"secondary",className:"text-xs",children:[l.points," pkt"]})]}),e.jsx("p",{className:"text-sm font-medium line-clamp-2",children:l.content}),l.explanation&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-1",children:[e.jsx("span",{className:"font-medium",children:"Wyjaśnienie:"})," ",l.explanation]})]})]},l.id))})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(_,{children:[e.jsx(O,{className:"pb-3",children:e.jsx(L,{className:"text-base",children:"Statystyki"})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Liczba pytań"}),e.jsx("span",{className:"font-medium",children:s})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Maksymalna liczba punktów"}),e.jsx("span",{className:"font-medium",children:a})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Wymagane punkty do zaliczenia"}),e.jsx("span",{className:"font-medium",children:o})]})]})})]}),e.jsxs(_,{children:[e.jsx(O,{className:"pb-3",children:e.jsx(L,{className:"text-base",children:"Informacje"})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Pozycja w temacie"}),e.jsx("span",{className:"font-medium",children:t.position})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Data utworzenia"}),e.jsx("span",{className:"font-medium",children:new Date(t.created_at).toLocaleDateString("pl-PL")})]}),t.updated_at&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Ostatnia aktualizacja"}),e.jsx("span",{className:"font-medium",children:new Date(t.updated_at).toLocaleDateString("pl-PL")})]})]})})]})]})]})},Wz=()=>{const{edit:t}=Ye(),{id:s}=ut(),n=J(),{data:i,isLoading:r}=Ue({resource:"activities",id:s,meta:{select:"*, topics(*, courses(*)), questions:questions(count)"}}),{data:a,isLoading:o}=ie({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(s)}],sorters:[{field:"position",order:"asc"}],queryOptions:{enabled:i?.data?.type==="quiz"&&!!s}});if(r)return e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const l=i?.data;if(!l)return e.jsx(K,{children:e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Nie znaleziono aktywności"})})});const c=l.topics,d=c?.courses,m=l.questions?.[0]?.count||l._count?.questions||0,u=()=>{const f=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",f),t("activities",l.id??"")},h=f=>{const x=window.location.pathname+window.location.search;sessionStorage.setItem("returnUrl",x),n(f)},p=()=>l.type==="quiz"?e.jsx(dt,{className:"w-5 h-5"}):e.jsx(We,{className:"w-5 h-5"}),b=()=>l.type==="quiz"?"text-blue-500":"text-green-500";return e.jsxs(K,{children:[e.jsx(kn,{}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:[d?.title," → Temat ",c?.position,": ",c?.title]}),e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-muted ${b()}`,children:p()}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:l.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(H,{variant:l.type==="quiz"?"default":"secondary",children:l.type==="quiz"?"Quiz":"Materiał"}),e.jsx(H,{variant:l.is_published?"default":"outline",children:l.is_published?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"w-3 h-3 mr-1"})," Opublikowany"]}):e.jsxs(e.Fragment,{children:[e.jsx(Xa,{className:"w-3 h-3 mr-1"})," Szkic"]})})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[l.type==="quiz"&&e.jsxs(I,{variant:"outline",onClick:()=>h(`/teacher/questions/manage/${l.id}`),children:[e.jsx(fn,{className:"w-4 h-4 mr-2"}),"Zarządzaj pytaniami (",m,")"]}),e.jsxs(I,{onClick:u,children:[e.jsx(Ht,{className:"w-4 h-4 mr-2"}),"Edytuj"]})]})]})]}),l.type==="material"?e.jsx(Uz,{activity:l}):e.jsx(Vz,{activity:l,questionsCount:m,questionsData:a?.data,questionsLoading:o,onNavigateToQuestions:f=>h(`/teacher/questions/manage/${f}`)})]})},fu={name:"activities",list:"/teacher/activities/create",create:"/teacher/activities/create",edit:"/teacher/activities/edit/:id",show:"/teacher/activities/show/:id",meta:{hide:!0}},Kz=[e.jsx(V,{path:"activities/create",element:e.jsx(IN,{})},"activities-create"),e.jsx(V,{path:"activities/edit/:id",element:e.jsx(MN,{})},"activities-edit"),e.jsx(V,{path:"activities/show/:id",element:e.jsx(Wz,{})},"activities-show")],Gz=()=>{const{create:t,edit:s,show:n}=Ye(),i=J(),{mutate:r}=jn(),{tableQuery:{data:a,isLoading:o,isError:l,refetch:c},current:d,setCurrent:m,pageSize:u,setFilters:h}=Za({sorters:{initial:[{field:"created_at",order:"desc"}]},meta:{select:"*, group_members(count), course_access(count)"}}),p=to({isLoading:o,isError:l});if(p)return p;const b=(y,N)=>{confirm(`Czy na pewno chcesz usunąć grupę "${N}"? Ta akcja usunie również wszystkie przypisania uczniów i kursów.`)&&r({resource:"groups",id:y},{onSuccess:()=>{W.success("Grupa została usunięta"),c()},onError:()=>{W.error("Błąd podczas usuwania grupy")}})},f=(y,N)=>{N?.stopPropagation(),i(`/teacher/groups/${y}/assign-courses`)},x=(y,N)=>{N?.stopPropagation(),i(`/teacher/groups/${y}/assign-students`)},w=y=>!y||!Array.isArray(y)||y.length===0?0:y[0].count||0;return e.jsxs(K,{children:[e.jsxs(Z,{children:[e.jsx(ve,{title:"Grupy",description:"Zarządzaj grupami uczniów i przypisuj im kursy"}),e.jsxs(I,{onClick:()=>t("groups"),children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Dodaj grupę"]})]}),e.jsx(Z,{children:e.jsx(Q,{placeholder:"Szukaj grup...",className:"max-w-sm",onChange:y=>{h([{field:"name",operator:"contains",value:y.target.value}])}})}),a?.data?.length===0?e.jsx(_,{className:"border-dashed border-2",children:e.jsxs(P,{className:"text-center py-12",children:[e.jsx(Pe,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Brak grup"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Utwórz pierwszą grupę, aby móc przypisywać uczniów do kursów"}),e.jsxs(I,{onClick:()=>t("groups"),children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Utwórz pierwszą grupę"]})]})}):e.jsx(it,{children:a?.data?.map(y=>{const N=w(y.group_members),A=w(y.course_access);return e.jsxs(_,{className:"cursor-pointer transition-all hover:shadow-lg hover:border-primary/50 relative overflow-hidden",onClick:S=>{!S.target.closest('[role="menu"]')&&!S.target.closest(".quick-action")&&n("groups",y.id)},children:[!y.is_active&&e.jsx("div",{className:"absolute inset-0 bg-muted/50 z-10 pointer-events-none"}),e.jsx(O,{children:e.jsxs(Z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"truncate",children:y.name})]}),e.jsxs(vn,{children:[e.jsx(Nn,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"sm",onClick:S=>S.stopPropagation(),className:"relative z-20",children:e.jsx(_r,{className:"h-4 w-4"})})}),e.jsxs(Js,{align:"end",children:[e.jsxs(pe,{onClick:()=>n("groups",y.id),children:[e.jsx(Ze,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),e.jsxs(pe,{onClick:()=>s("groups",y.id),children:[e.jsx(Ht,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),e.jsx(xt,{}),e.jsxs(pe,{onClick:S=>x(y.id,S),className:"text-blue-600 focus:text-blue-600",children:[e.jsx(oi,{className:"mr-2 h-4 w-4"}),"Dodaj uczniów"]}),e.jsxs(pe,{onClick:S=>f(y.id,S),className:"text-green-600 focus:text-green-600",children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"Przypisz kursy"]}),e.jsx(xt,{}),e.jsxs(pe,{onClick:()=>b(y.id,y.name),className:"text-red-600 focus:text-red-600",children:[e.jsx(xs,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Kt,{className:"w-4 h-4"}),e.jsxs("span",{children:["Rok akademicki: ",y.academic_year]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-background rounded-md",children:e.jsx(Pe,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Uczniowie"}),e.jsx("p",{className:"text-lg font-semibold",children:N})]})]})}),e.jsx("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-background rounded-md",children:e.jsx(xe,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Kursy"}),e.jsx("p",{className:"text-lg font-semibold",children:A})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsx(H,{variant:y.is_active?"default":"secondary",className:y.is_active?"bg-green-600":"",children:y.is_active?"Aktywna":"Nieaktywna"}),e.jsxs("div",{className:"flex gap-1",children:[N===0&&e.jsx(I,{size:"sm",variant:"ghost",className:"h-8 px-2 quick-action text-blue-600 hover:text-blue-700 hover:bg-blue-50",onClick:S=>x(y.id,S),title:"Dodaj uczniów",children:e.jsx(oi,{className:"h-4 w-4"})}),e.jsxs(I,{size:"sm",variant:"ghost",className:"h-8 px-2 quick-action text-green-600 hover:text-green-700 hover:bg-green-50",onClick:S=>f(y.id,S),title:"Przypisz kursy",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx(ae,{className:"h-3 w-3 ml-1"})]})]})]})]})})]},y.id)})}),e.jsx(oo,{current:d,pageSize:u,total:a?.total||0,setCurrent:m,itemName:"grup"})]})},Hz=()=>{const{list:t}=Ye(),{data:s}=gt(),{refineCore:{onFinish:n},register:i,handleSubmit:r,setValue:a,watch:o,formState:{errors:l,isSubmitting:c}}=ys({defaultValues:{name:"",vendor_id:s?.vendor_id||0,is_active:!0,academic_year:new Date().getFullYear().toString()+"/"+(new Date().getFullYear()+1).toString()}});return e.jsxs(K,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("groups"),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsx(Z,{children:e.jsx(ve,{title:"Dodaj grupę",description:"Utwórz nową grupę uczniów"})}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Informacje o grupie"})}),e.jsx(P,{children:e.jsxs(bs,{onSubmit:r(n),children:[e.jsx(se,{label:"Nazwa grupy",htmlFor:"name",error:l.name?.message?.toString(),required:!0,children:e.jsx(Q,{id:"name",placeholder:"np. Klasa 1A",...i("name",{required:"Nazwa grupy jest wymagana",minLength:{value:2,message:"Nazwa musi mieć minimum 2 znaki"}})})}),e.jsx(se,{label:"Rok akademicki",htmlFor:"academic_year",error:l.academic_year?.message?.toString(),required:!0,children:e.jsx(Q,{id:"academic_year",placeholder:"np. 2024/2025",...i("academic_year",{required:"Rok akademicki jest wymagany",pattern:{value:/^\d{4}\/\d{4}$/,message:"Format: RRRR/RRRR (np. 2024/2025)"}})})}),e.jsx(se,{label:"Status grupy",children:e.jsxs(Z,{variant:"start",children:[e.jsx(ss,{checked:o("is_active"),onCheckedChange:d=>a("is_active",d)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Grupa aktywna"})]})}),e.jsxs(ws,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>t("groups"),children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:c,children:c?"Tworzenie...":"Utwórz grupę"})]})]})})]})]})},Qz=()=>{const{list:t}=Ye(),{id:s}=ut(),{data:n,isLoading:i}=Ue({resource:"groups",id:s,liveMode:"off"}),{refineCore:{onFinish:r},register:a,handleSubmit:o,setValue:l,watch:c,reset:d,formState:{errors:m,isSubmitting:u}}=ys({refineCoreProps:{resource:"groups",id:s,redirect:"list",liveMode:"off"}});return g.useEffect(()=>{n?.data&&d({name:n.data.name,academic_year:n.data.academic_year,is_active:n.data.is_active,vendor_id:n.data.vendor_id})},[n,d]),i?e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs(K,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("groups"),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsx(Z,{children:e.jsx(ve,{title:"Edytuj grupę",description:`Edycja: ${n?.data?.name}`})}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Informacje o grupie"})}),e.jsx(P,{children:e.jsxs(bs,{onSubmit:o(r),children:[e.jsx(se,{label:"Nazwa grupy",htmlFor:"name",error:m.name?.message,required:!0,children:e.jsx(Q,{id:"name",placeholder:"np. Klasa 1A",...a("name",{required:"Nazwa grupy jest wymagana",minLength:{value:2,message:"Nazwa musi mieć minimum 2 znaki"}})})}),e.jsx(se,{label:"Rok akademicki",htmlFor:"academic_year",error:m.academic_year?.message,required:!0,children:e.jsx(Q,{id:"academic_year",placeholder:"np. 2024/2025",...a("academic_year",{required:"Rok akademicki jest wymagany",pattern:{value:/^\d{4}\/\d{4}$/,message:"Format: RRRR/RRRR (np. 2024/2025)"}})})}),e.jsx(se,{label:"Status grupy",children:e.jsxs(Z,{variant:"start",children:[e.jsx(ss,{checked:c("is_active"),onCheckedChange:h=>l("is_active",h)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Grupa aktywna"})]})}),e.jsxs(ws,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>t("groups"),children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:u,children:u?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},Zz=()=>{const{list:t,edit:s,show:n}=Ye(),{id:i}=ut(),r=J(),a=_h(),{data:o,isLoading:l}=Ue({resource:"groups",id:i,liveMode:"off"}),{data:c,isLoading:d}=ie({resource:"group_members",filters:[{field:"group_id",operator:"eq",value:i}],meta:{select:"*, users(*)"},queryOptions:{enabled:!!i},liveMode:"off"}),{data:m,isLoading:u}=ie({resource:"course_access",filters:[{field:"group_id",operator:"eq",value:i}],meta:{select:"*, courses(*)"},queryOptions:{enabled:!!i},liveMode:"off"}),h=async(w,y)=>{if(confirm(`Czy na pewno chcesz odpiąć kurs "${y}" od tej grupy?`))try{const{error:N}=await ue.from("course_access").delete().eq("course_id",w).eq("group_id",parseInt(i));if(N)throw N;W.success("Kurs został odpięty od grupy"),a({resource:"course_access",invalidates:["list"]})}catch(N){console.error("Error removing course:",N),W.error("Błąd podczas odpinania kursu")}},p=async(w,y)=>{if(confirm(`Czy na pewno chcesz usunąć "${y}" z tej grupy?`))try{const{error:N}=await ue.from("group_members").delete().eq("user_id",w).eq("group_id",parseInt(i));if(N)throw N;W.success("Uczeń został usunięty z grupy"),a({resource:"group_members",invalidates:["list"]})}catch(N){console.error("Error removing member:",N),W.error("Błąd podczas usuwania ucznia z grupy")}};if(l||d||u)return e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const b=o?.data,f=c?.total||0,x=m?.total||0;return e.jsxs(K,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("groups"),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsxs(Z,{children:[e.jsxs("div",{children:[e.jsx(ve,{title:b?.name,description:`Rok akademicki: ${b?.academic_year}`}),!b?.is_active&&e.jsx(H,{variant:"secondary",className:"mt-2",children:"Grupa nieaktywna"})]}),e.jsxs(I,{onClick:()=>s("groups",b?.id??""),children:[e.jsx(Ht,{className:"w-4 h-4 mr-2"}),"Edytuj grupę"]})]}),!b?.is_active&&e.jsxs(ge,{children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsx(je,{children:"Ta grupa jest nieaktywna. Uczniowie nie mają dostępu do przypisanych kursów."})]}),e.jsxs(it,{variant:"2-2-4",children:[e.jsxs(_,{children:[e.jsx(O,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Status"})}),e.jsx(P,{children:e.jsx(H,{variant:b?.is_active?"default":"secondary",className:b?.is_active?"bg-green-600":"",children:b?.is_active?"Aktywna":"Nieaktywna"})})]}),e.jsxs(_,{children:[e.jsx(O,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Uczniowie"})}),e.jsx(P,{children:e.jsx("div",{className:"text-2xl font-bold",children:f})})]}),e.jsxs(_,{children:[e.jsx(O,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Kursy"})}),e.jsx(P,{children:e.jsx("div",{className:"text-2xl font-bold",children:x})})]}),e.jsxs(_,{children:[e.jsx(O,{className:"pb-2",children:e.jsx(L,{className:"text-sm font-medium",children:"Utworzono"})}),e.jsx(P,{children:e.jsx("div",{className:"text-sm",children:new Date(b?.created_at).toLocaleDateString("pl-PL")})})]})]}),e.jsxs(it,{variant:"1-2-2",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(Z,{children:[e.jsx(L,{children:"Uczniowie grupy"}),e.jsxs(I,{size:"sm",onClick:()=>r(`/teacher/groups/${i}/assign-students`),children:[e.jsx(oi,{className:"w-4 h-4 mr-2"}),"Dodaj ucznia"]})]})}),e.jsx(P,{children:c?.data?.length?e.jsx("div",{className:"space-y-2",children:c.data.map(w=>e.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/30 transition-all duration-200 group",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-muted/50 flex items-center justify-center flex-shrink-0",children:e.jsx(Pe,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-base leading-tight truncate pr-2",children:w.users?.full_name}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(Cr,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:w.users?.email})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(Cs,{children:e.jsxs(Ts,{children:[e.jsx(As,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>n("users",w.user_id),children:e.jsx(Ld,{className:"h-4 w-4"})})}),e.jsx(os,{children:e.jsx("p",{children:"Zobacz profil"})})]})}),e.jsx(Cs,{children:e.jsxs(Ts,{children:[e.jsx(As,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-red-50",onClick:()=>p(w.user_id,w.users?.full_name),children:e.jsx(xs,{className:"h-4 w-4 text-red-600"})})}),e.jsx(os,{children:e.jsx("p",{children:"Usuń z grupy"})})]})})]})]})},w.user_id))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Pe,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Brak uczniów w grupie"}),e.jsxs(I,{size:"sm",variant:"outline",className:"mt-4",onClick:()=>r(`/teacher/groups/${i}/assign-students`),children:[e.jsx(oi,{className:"w-4 h-4 mr-2"}),"Dodaj pierwszego ucznia"]})]})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(Z,{children:[e.jsx(L,{children:"Przypisane kursy"}),e.jsxs(I,{size:"sm",onClick:()=>r(`/teacher/groups/${i}/assign-courses`),children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Przypisz kurs"]})]})}),e.jsx(P,{children:m?.data?.length?e.jsx("div",{className:"space-y-2",children:m.data.map(w=>e.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/30 transition-all duration-200 group",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:w.courses?.icon_emoji?e.jsx("div",{className:"h-10 w-10 rounded-lg bg-muted/50 flex items-center justify-center",children:e.jsx("span",{className:"text-xl",children:w.courses.icon_emoji})}):e.jsx("div",{className:"h-10 w-10 rounded-lg bg-muted/50 flex items-center justify-center",children:e.jsx(xe,{className:"h-5 w-5 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-base leading-tight truncate pr-2",children:w.courses?.title}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(Kt,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:new Date(w.assigned_at).toLocaleDateString("pl-PL")})]}),e.jsx(H,{variant:w.courses?.is_published?"default":"secondary",className:`text-xs ${w.courses?.is_published?"bg-green-100 text-green-700 hover:bg-green-100":""}`,children:w.courses?.is_published?"Opublikowany":"Szkic"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(Cs,{children:e.jsxs(Ts,{children:[e.jsx(As,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>n("courses",w.course_id),children:e.jsx(Ld,{className:"h-4 w-4"})})}),e.jsx(os,{children:e.jsx("p",{children:"Zobacz kurs"})})]})}),e.jsx(Cs,{children:e.jsxs(Ts,{children:[e.jsx(As,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-red-50",onClick:()=>h(w.course_id,w.courses?.title),children:e.jsx(xs,{className:"h-4 w-4 text-red-600"})})}),e.jsx(os,{children:e.jsx("p",{children:"Odepnij kurs"})})]})})]})]})},w.course_id))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(xe,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Brak przypisanych kursów"}),e.jsxs(I,{size:"sm",variant:"outline",className:"mt-4",onClick:()=>r(`/teacher/groups/${i}/assign-courses`),children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Przypisz pierwszy kurs"]})]})})]})]})]})},Yz=()=>{const{id:t}=ut(),s=J(),[n,i]=g.useState([]),[r,a]=g.useState(""),[o,l]=g.useState(!1),{data:c,isLoading:d}=Ue({resource:"groups",id:t}),{data:m,isLoading:u}=ie({resource:"courses",pagination:{mode:"off"},meta:{select:"*, topics(count)"}}),{data:h,isLoading:p}=ie({resource:"course_access",filters:[{field:"group_id",operator:"eq",value:parseInt(t)}],pagination:{mode:"off"},meta:{select:"course_id, group_id"}}),{mutate:b,isLoading:f}=fs(),x=async()=>{if(n.length===0){W.error("Wybierz przynajmniej jeden kurs");return}try{const j=n.map(C=>b({resource:"course_access",values:{course_id:C,group_id:parseInt(t)}},{onSuccess:()=>{console.log(`Course ${C} assigned successfully`)},onError:T=>{console.error("Error assigning course:",C,T)}}));await Promise.all(j),W.success(`Przypisano ${n.length} ${n.length===1?"kurs":"kursów"} do grupy`),s(`/groups/show/${t}`)}catch(j){W.error("Błąd podczas przypisywania kursów"),console.error("Error details:",j)}};if(d||u||p)return e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const w=c?.data,y=h?.data?.map(j=>j.course_id)||[];let N=m?.data?.filter(j=>!y.includes(j.id))||[];o&&(N=N.filter(j=>j.is_published));const A=N.filter(j=>j.title.toLowerCase().includes(r.toLowerCase())||j.description?.toLowerCase().includes(r.toLowerCase())),S=j=>{i(C=>C.includes(j)?C.filter(T=>T!==j):[...C,j])},k=()=>{i(A.map(j=>j.id))},v=()=>{i([])},z=N.filter(j=>j.is_published).length,D=N.length-z;return e.jsxs(K,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>s(`/teacher/groups/show/${t}`),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Powrót do grupy"]}),e.jsx(Z,{children:e.jsx(ve,{title:"Przypisz kursy",description:`Przypisywanie kursów do grupy: ${w?.name}`})}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(Z,{children:[e.jsxs("div",{children:[e.jsx(L,{children:"Dostępne kursy"}),N.length>0&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[z," opublikowanych, ",D," szkiców"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>l(!o),className:o?"bg-primary text-primary-foreground":"",children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Tylko opublikowane"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:k,disabled:A.length===0,children:[e.jsx(ot,{className:"w-4 h-4 mr-2"}),"Zaznacz wszystkie"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:v,disabled:n.length===0,children:[e.jsx(vt,{className:"w-4 h-4 mr-2"}),"Odznacz wszystkie"]})]})]})}),e.jsxs(P,{children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(Mh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(Q,{placeholder:"Szukaj kursów po nazwie lub opisie...",value:r,onChange:j=>a(j.target.value),className:"pl-10"})]}),A.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:N.length===0?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{className:"font-medium mb-1",children:"Wszystkie kursy są już przypisane"}),e.jsx("p",{className:"text-sm",children:"Ta grupa ma dostęp do wszystkich dostępnych kursów"}),e.jsx(I,{size:"sm",variant:"outline",className:"mt-4",onClick:()=>s("/courses"),children:"Przejdź do listy kursów"})]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Nie znaleziono kursów spełniających kryteria"})]})}):e.jsx("div",{className:"space-y-2",children:A.map(j=>{const C=j._count?.topics||0;return e.jsxs("div",{className:`
                      flex items-center space-x-3 p-3 border rounded-lg 
                      cursor-pointer transition-all
                      ${n.includes(j.id)?"border-primary bg-primary/5":"hover:bg-muted/50"}
                    `,onClick:()=>S(j.id),children:[e.jsx(Xt,{checked:n.includes(j.id),onCheckedChange:()=>S(j.id),onClick:T=>T.stopPropagation()}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[j.icon_emoji&&e.jsx("span",{className:"text-xl",children:j.icon_emoji}),e.jsx("span",{className:"font-medium",children:j.title}),e.jsx(H,{variant:j.is_published?"default":"secondary",className:"text-xs",children:j.is_published?"Opublikowany":"Szkic"})]}),j.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:j.description}),e.jsx("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:e.jsxs("span",{children:[C," ",C===1?"temat":"tematów"]})})]}),e.jsx(Cs,{children:e.jsxs(Ts,{children:[e.jsx(As,{asChild:!0,children:e.jsx(I,{size:"sm",variant:"ghost",onClick:T=>{T.stopPropagation(),s(`/courses/show/${j.id}`)},children:e.jsx(Ze,{className:"h-4 w-4"})})}),e.jsx(os,{children:e.jsx("p",{children:"Zobacz kurs"})})]})})]},j.id)})}),n.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:["Wybrano ",n.length," kursów do przypisania"]}),e.jsxs(Z,{children:[e.jsx(I,{variant:"outline",onClick:()=>s(`/teacher/groups/show/${t}`),children:"Anuluj"}),e.jsx(I,{onClick:x,disabled:f,children:f?"Przypisywanie...":"Przypisz kursy"})]})]})]})]})]})},Jz=()=>{const{id:t}=ut(),s=J(),[n,i]=g.useState([]),[r,a]=g.useState(""),{data:o,isLoading:l}=Ue({resource:"groups",id:t}),{data:c,isLoading:d}=ie({resource:"users",filters:[{field:"role",operator:"eq",value:"student"}],pagination:{mode:"off"}}),{data:m,isLoading:u}=ie({resource:"group_members",filters:[{field:"group_id",operator:"eq",value:parseInt(t)}],pagination:{mode:"off"},meta:{select:"user_id, group_id"}}),{mutate:h,isLoading:p}=fs(),b=async()=>{if(n.length===0){W.error("Wybierz przynajmniej jednego ucznia");return}try{const k=n.map(v=>h({resource:"group_members",values:{user_id:v,group_id:parseInt(t)}},{onSuccess:()=>{console.log(`Student ${v} assigned successfully`)},onError:z=>{console.error("Error assigning student:",v,z)}}));await Promise.all(k),W.success(`Dodano ${n.length} uczniów do grupy`),s(`/groups/show/${t}`)}catch(k){W.error("Błąd podczas dodawania uczniów"),console.error("Error details:",k)}};if(l||d||u)return e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const f=o?.data,x=m?.data?.map(k=>k.user_id)||[],w=c?.data?.filter(k=>!x.includes(k.id))||[],y=w.filter(k=>k.full_name.toLowerCase().includes(r.toLowerCase())||k.email.toLowerCase().includes(r.toLowerCase())),N=k=>{i(v=>v.includes(k)?v.filter(z=>z!==k):[...v,k])},A=()=>{i(y.map(k=>k.id))},S=()=>{i([])};return e.jsxs(K,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>s(`/teacher/groups/show/${t}`),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Powrót do grupy"]}),e.jsx(Z,{children:e.jsx(ve,{title:"Dodaj uczniów",description:`Dodawanie uczniów do grupy: ${f?.name}`})}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(Z,{children:[e.jsx(L,{children:"Dostępni uczniowie"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:A,disabled:y.length===0,children:[e.jsx(ot,{className:"w-4 h-4 mr-2"}),"Zaznacz wszystkich"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:S,disabled:n.length===0,children:[e.jsx(vt,{className:"w-4 h-4 mr-2"}),"Odznacz wszystkich"]})]})]})}),e.jsxs(P,{children:[e.jsx(Q,{placeholder:"Szukaj uczniów...",value:r,onChange:k=>a(k.target.value),className:"mb-4"}),y.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:w.length===0?e.jsxs(e.Fragment,{children:[e.jsx(oi,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Wszyscy uczniowie są już w tej grupie"})]}):e.jsxs(e.Fragment,{children:[e.jsx(oi,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Nie znaleziono uczniów"})]})}):e.jsx("div",{className:"space-y-2",children:y.map(k=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-muted/50 cursor-pointer",onClick:()=>N(k.id),children:[e.jsx(Xt,{checked:n.includes(k.id),onCheckedChange:()=>N(k.id),onClick:v=>v.stopPropagation()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:k.full_name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Cr,{className:"w-3 h-3"}),k.email]})]}),e.jsx(H,{variant:"secondary",className:"text-xs",children:"Uczeń"})]},k.id))}),n.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:["Wybrano ",n.length," uczniów do dodania"]}),e.jsxs(Z,{children:[e.jsx(I,{variant:"outline",onClick:()=>s(`/teacher/groups/show/${t}`),children:"Anuluj"}),e.jsx(I,{onClick:b,disabled:p,children:p?"Dodawanie...":"Dodaj uczniów"})]})]})]})]})]})},xu={name:"groups",list:"/teacher/groups",create:"/teacher/groups/create",edit:"/teacher/groups/edit/:id",show:"/teacher/groups/show/:id",meta:{label:"Grupy",icon:e.jsx(Pe,{className:"h-4 w-4"})}},Xz=[e.jsx(V,{path:"groups",element:e.jsx(Gz,{})},"groups-list"),e.jsx(V,{path:"groups/create",element:e.jsx(Hz,{})},"groups-create"),e.jsx(V,{path:"groups/edit/:id",element:e.jsx(Qz,{})},"groups-edit"),e.jsx(V,{path:"groups/show/:id",element:e.jsx(Zz,{})},"groups-show"),e.jsx(V,{path:"groups/:id/assign-courses",element:e.jsx(Yz,{})},"groups-assign-courses"),e.jsx(V,{path:"groups/:id/assign-students",element:e.jsx(Jz,{})},"groups-assign-students")],e1=()=>{const{create:t,edit:s,show:n}=Ye(),{mutate:i}=jn(),[r,a]=g.useState("all"),{tableQuery:{data:o,isLoading:l,isError:c},current:d,setCurrent:m,pageSize:u,setFilters:h}=Za({sorters:{initial:[{field:"created_at",order:"desc"}]},meta:{select:"*, user_stats(total_points, current_level)"}}),p=to({isLoading:l,isError:c});if(p)return p;const b=(y,N)=>{confirm(`Czy na pewno chcesz usunąć użytkownika "${N}"?`)&&i({resource:"users",id:y})},f=y=>{const N=[];y&&N.push({operator:"or",value:[{field:"full_name",operator:"contains",value:y},{field:"email",operator:"contains",value:y}]}),r!=="all"&&N.push({field:"role",operator:"eq",value:r}),h(N)},x=y=>{switch(y){case"admin":return e.jsx(ac,{className:"w-3 h-3"});case"teacher":return e.jsx(bn,{className:"w-3 h-3"});default:return e.jsx(Fy,{className:"w-3 h-3"})}},w=y=>{switch(y){case"admin":return"destructive";case"teacher":return"default";default:return"secondary"}};return e.jsxs(K,{children:[e.jsxs(Z,{children:[e.jsx(ve,{title:"Użytkownicy",description:"Zarządzaj użytkownikami systemu"}),e.jsxs(I,{onClick:()=>t("users"),children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Dodaj użytkownika"]})]}),e.jsxs(Z,{className:"gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(Mh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(Q,{placeholder:"Szukaj po nazwie lub email...",className:"pl-10",onChange:y=>f(y.target.value)})]}),e.jsxs(me,{value:r,onValueChange:y=>{a(y),f("")},children:[e.jsx(ce,{className:"w-[180px]",children:e.jsx(he,{placeholder:"Filtruj po roli"})}),e.jsxs(de,{children:[e.jsx(B,{value:"all",children:"Wszystkie role"}),e.jsx(B,{value:"student",children:"Studenci"}),e.jsx(B,{value:"teacher",children:"Nauczyciele"}),e.jsx(B,{value:"admin",children:"Administratorzy"})]})]})]}),e.jsx("div",{className:"space-y-4",children:o?.data?.map(y=>e.jsx(_,{children:e.jsx(P,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center",children:e.jsx(Pe,{className:"h-6 w-6 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:y.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:y.email})]}),e.jsxs(H,{variant:w(y.role),children:[x(y.role),e.jsx("span",{className:"ml-1 capitalize",children:y.role})]}),e.jsx(H,{variant:y.is_active?"outline":"secondary",children:y.is_active?"Aktywny":"Nieaktywny"})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[y.user_stats&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Punkty"}),e.jsx("p",{className:"font-semibold",children:y.user_stats.total_points})]}),e.jsxs(vn,{children:[e.jsx(Nn,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"sm",children:e.jsx(_r,{className:"h-4 w-4"})})}),e.jsxs(Js,{align:"end",children:[e.jsxs(pe,{onClick:()=>n("users",y.id),children:[e.jsx(Ze,{className:"mr-2 h-4 w-4"}),"Podgląd"]}),e.jsxs(pe,{onClick:()=>s("users",y.id),children:[e.jsx(Ht,{className:"mr-2 h-4 w-4"}),"Edytuj"]}),e.jsxs(pe,{onClick:()=>b(y.id,y.full_name),className:"text-red-600",children:[e.jsx(xs,{className:"mr-2 h-4 w-4"}),"Usuń"]})]})]})]})]})})},y.id))}),e.jsx(oo,{current:d,pageSize:u,total:o?.total||0,setCurrent:m,itemName:"użytkowników"})]})},t1=()=>{const{list:t}=Ye(),{data:s}=gt(),{refineCore:{onFinish:n},register:i,handleSubmit:r,setValue:a,watch:o,formState:{errors:l,isSubmitting:c}}=ys({defaultValues:{full_name:"",email:"",vendor_id:s?.vendor_id||0,role:"student",is_active:!0}});return e.jsxs(K,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("users"),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsx(Z,{children:e.jsx(ve,{title:"Dodaj użytkownika",description:"Utwórz nowe konto użytkownika"})}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Dane użytkownika"})}),e.jsx(P,{children:e.jsxs(bs,{onSubmit:r(n),children:[e.jsxs(it,{variant:"1-2-2",children:[e.jsx(se,{label:"Imię i nazwisko",htmlFor:"full_name",error:l.full_name?.message?.toString(),required:!0,children:e.jsx(Q,{id:"full_name",placeholder:"np. Jan Kowalski",...i("full_name",{required:"Imię i nazwisko są wymagane",minLength:{value:3,message:"Minimum 3 znaki"}})})}),e.jsx(se,{label:"Email",htmlFor:"email",error:l.email?.message?.toString(),required:!0,children:e.jsx(Q,{id:"email",type:"email",placeholder:"np. jan.kowalski@example.com",...i("email",{required:"Email jest wymagany",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Nieprawidłowy format email"}})})}),e.jsx(se,{label:"Rola",error:l.role?.message?.toString(),required:!0,children:e.jsxs(me,{value:o("role"),onValueChange:d=>a("role",d),children:[e.jsx(ce,{children:e.jsx(he,{placeholder:"Wybierz rolę"})}),e.jsxs(de,{children:[e.jsx(B,{value:"student",children:"Student"}),e.jsx(B,{value:"teacher",children:"Nauczyciel"}),e.jsx(B,{value:"admin",children:"Administrator"})]})]})})]}),e.jsx(se,{label:"Status konta",children:e.jsxs(Z,{variant:"start",children:[e.jsx(ss,{checked:o("is_active"),onCheckedChange:d=>a("is_active",d)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Konto aktywne (użytkownik może się zalogować)"})]})}),e.jsxs(ws,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>t("users"),children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:c,children:c?"Tworzenie...":"Utwórz użytkownika"})]})]})})]})]})},s1=()=>{const{list:t}=Ye(),{id:s}=ut(),{data:n,isLoading:i}=Ue({resource:"users",id:s,liveMode:"off"}),{refineCore:{onFinish:r},register:a,handleSubmit:o,setValue:l,watch:c,reset:d,formState:{errors:m,isSubmitting:u}}=ys({refineCoreProps:{resource:"users",id:s,redirect:"list",liveMode:"off"}});return g.useEffect(()=>{n?.data&&d({full_name:n.data.full_name,email:n.data.email,role:n.data.role,is_active:n.data.is_active,vendor_id:n.data.vendor_id})},[n,d]),i?e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs(K,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("users"),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsx(Z,{children:e.jsx(ve,{title:"Edytuj użytkownika",description:`Edycja: ${n?.data?.full_name}`})}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Dane użytkownika"})}),e.jsx(P,{children:e.jsxs(bs,{onSubmit:o(r),children:[e.jsxs(it,{variant:"1-2-2",children:[e.jsx(se,{label:"Imię i nazwisko",htmlFor:"full_name",error:m.full_name?.message,required:!0,children:e.jsx(Q,{id:"full_name",placeholder:"np. Jan Kowalski",...a("full_name",{required:"Imię i nazwisko są wymagane",minLength:{value:3,message:"Minimum 3 znaki"}})})}),e.jsx(se,{label:"Email",htmlFor:"email",error:m.email?.message,required:!0,children:e.jsx(Q,{id:"email",type:"email",placeholder:"np. jan.kowalski@example.com",...a("email",{required:"Email jest wymagany",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Nieprawidłowy format email"}}),disabled:!0})}),e.jsx(se,{label:"Rola",error:m.role?.message,required:!0,children:e.jsxs(me,{value:c("role")||"student",onValueChange:h=>l("role",h),children:[e.jsx(ce,{children:e.jsx(he,{placeholder:"Wybierz rolę"})}),e.jsxs(de,{children:[e.jsx(B,{value:"student",children:"Student"}),e.jsx(B,{value:"teacher",children:"Nauczyciel"}),e.jsx(B,{value:"admin",children:"Administrator"})]})]})})]}),e.jsx(se,{label:"Status konta",children:e.jsxs(Z,{variant:"start",children:[e.jsx(ss,{checked:c("is_active")??!0,onCheckedChange:h=>l("is_active",h)}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Konto aktywne (użytkownik może się zalogować)"})]})}),e.jsxs(ws,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>t("users"),children:"Anuluj"}),e.jsx(I,{type:"submit",disabled:u,children:u?"Zapisywanie...":"Zapisz zmiany"})]})]})})]})]})},n1=()=>{const{list:t,edit:s}=Ye(),{id:n}=ut(),{data:i,isLoading:r}=Ue({resource:"users",id:n,meta:{select:"*, user_stats(*)"}}),{data:a}=ie({resource:"activity_progress",filters:[{field:"user_id",operator:"eq",value:n}]});if(r)return e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const o=i?.data,l=o?.user_stats?.[0]||{},c=d=>{switch(d){case"admin":return e.jsx(ac,{className:"w-4 h-4"});case"teacher":return e.jsx(xe,{className:"w-4 h-4"});default:return e.jsx(ir,{className:"w-4 h-4"})}};return e.jsxs(K,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>t("users"),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Powrót do listy"]}),e.jsxs(Z,{children:[e.jsx(ve,{title:o?.full_name,description:o?.email}),e.jsxs(I,{onClick:()=>s("users",o?.id??""),children:[e.jsx(Ht,{className:"w-4 h-4 mr-2"}),"Edytuj użytkownika"]})]}),e.jsxs(it,{children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Informacje podstawowe"})}),e.jsx(P,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Imię i nazwisko"}),e.jsx("p",{className:"text-lg",children:o?.full_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsxs("p",{className:"text-lg flex items-center gap-2",children:[e.jsx(Cr,{className:"w-4 h-4"}),o?.email]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Rola"}),e.jsxs(H,{variant:"default",className:"mt-1",children:[c(o?.role),e.jsx("span",{className:"ml-1 capitalize",children:o?.role})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx(H,{variant:o?.is_active?"outline":"secondary",className:"mt-1",children:o?.is_active?"Aktywny":"Nieaktywny"})]})]})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Statystyki gamifikacji"})}),e.jsx(P,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx($e,{className:"w-8 h-8 mx-auto mb-2 text-yellow-500"}),e.jsx("p",{className:"text-2xl font-bold",children:l.total_points||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Punkty"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(ze,{className:"w-8 h-8 mx-auto mb-2 text-blue-500"}),e.jsx("p",{className:"text-2xl font-bold",children:l.current_level||1}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Poziom"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(Ar,{className:"w-8 h-8 mx-auto mb-2 text-green-500"}),e.jsx("p",{className:"text-2xl font-bold",children:l.daily_streak||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Dni z rzędu"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx(Se,{className:"w-8 h-8 mx-auto mb-2 text-purple-500"}),e.jsx("p",{className:"text-2xl font-bold",children:Math.round((l.total_time_spent||0)/60)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Godzin nauki"})]})]})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Postępy w nauce"})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Ukończone quizy"}),e.jsx("span",{className:"font-bold",children:l.quizzes_completed||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Wyniki perfekcyjne"}),e.jsx("span",{className:"font-bold",children:l.perfect_scores||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Ukończone aktywności"}),e.jsx("span",{className:"font-bold",children:a?.data?.filter(d=>d.completed_at).length||0})]})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{className:"text-lg",children:"Daty"})}),e.jsxs(P,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Utworzono"}),e.jsx("p",{className:"text-sm font-medium",children:new Date(o?.created_at).toLocaleDateString("pl-PL")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ostatnia aktywność"}),e.jsx("p",{className:"text-sm font-medium",children:l.last_active?new Date(l.last_active).toLocaleDateString("pl-PL"):"Brak aktywności"})]})]})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{className:"text-lg",children:"Idle Game"})}),e.jsxs(P,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Punkty/h"}),e.jsx("span",{className:"font-bold",children:l.idle_points_rate||1})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ostatnie odebranie"}),e.jsx("p",{className:"text-sm font-medium",children:l.last_idle_claim?new Date(l.last_idle_claim).toLocaleString("pl-PL"):"Nigdy"})]})]})]})]})]})]})},i1={name:"users",list:"/teacher/users",create:"/teacher/users/create",edit:"/teacher/users/edit/:id",show:"/teacher/users/show/:id",meta:{label:"Użytkownicy",icon:e.jsx(Pe,{className:"h-4 w-4"})}},r1=[e.jsx(V,{path:"users",element:e.jsx(e1,{})},"users-list"),e.jsx(V,{path:"users/create",element:e.jsx(t1,{})},"users-create"),e.jsx(V,{path:"users/edit/:id",element:e.jsx(s1,{})},"users-edit"),e.jsx(V,{path:"users/show/:id",element:e.jsx(n1,{})},"users-show")],a1=()=>{const{tableQuery:{data:t,isLoading:s,isError:n},current:i,setCurrent:r,pageSize:a,setFilters:o}=Za({sorters:{initial:[{field:"created_at",order:"desc"}]}}),l=to({isLoading:s,isError:n});return l||e.jsxs(K,{children:[e.jsx(ve,{title:"Organizacje",description:"Lista wszystkich organizacji w systemie"}),e.jsx(Z,{children:e.jsx(Q,{placeholder:"Szukaj organizacji...",className:"max-w-sm",onChange:c=>{o([{operator:"or",value:[{field:"name",operator:"contains",value:c.target.value},{field:"subdomain",operator:"contains",value:c.target.value}]}])}})}),e.jsx(it,{children:t?.data?.map(c=>e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(Z,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Eh,{className:"w-5 h-5"}),c.name]}),e.jsx(H,{variant:c.is_active?"default":"secondary",children:c.is_active?"Aktywna":"Nieaktywna"})]})}),e.jsxs(P,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(By,{className:"w-3 h-3"}),e.jsxs("span",{children:[c.subdomain,".example.com"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Kt,{className:"w-3 h-3"}),e.jsxs("span",{children:["Utworzono: ",new Date(c.created_at).toLocaleDateString("pl-PL")]})]})]})]},c.id))}),e.jsx(oo,{current:i,pageSize:a,total:t?.total||0,setCurrent:r,itemName:"organizacji"})]})},o1={name:"vendors",list:"/teacher/vendors",meta:{label:"Organizacje",icon:e.jsx(Eh,{className:"h-4 w-4"})}},l1=[e.jsx(V,{path:"vendors",element:e.jsx(a1,{})},"vendors-list")],c1=t=>{const s=new Date(t);return new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate())).toISOString().slice(0,10)},d1=()=>{const t=J(),s={queryOptions:{staleTime:1/0,gcTime:1800*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,refetchInterval:!1,retry:0}},{data:n}=ie({resource:"user_stats",filters:[{field:"last_active",operator:"gte",value:new Date(Date.now()-10080*60*1e3).toISOString().split("T")[0]}],pagination:{mode:"off"},...s}),{data:i}=ie({resource:"activity_progress",pagination:{mode:"off"},meta:{select:"*, activities(type, passing_score)",query:m=>m.not("completed_at","is",null)},...s}),{data:r}=ie({resource:"user_stats",pagination:{mode:"off"},sorters:[{field:"total_points",order:"desc"}],...s}),a=g.useMemo(()=>{const m=n?.data?.length||0,u=i?.data?.filter(w=>w.activities?.type==="quiz"&&w.score!==null).map(w=>Number(w.score))||[],h=u.length>0?Math.round(u.reduce((w,y)=>w+y,0)/u.length):0,p=i?.data?.length||0,b=i?.data?.filter(w=>w.completed_at).length||0,f=p>0?Math.round(b/p*100):0,x=r?.data?.reduce((w,y)=>w+Number(y.total_points),0)||0;return{activeUsers:m,activeUsersChange:12,avgQuizScore:h,avgQuizScoreChange:3,completionRate:f,completionRateChange:5,totalPoints:x,totalPointsChange:8}},[n?.data,i?.data,r?.data]),o=g.useMemo(()=>{const m=Array.from({length:7},(h,p)=>{const b=new Date;return b.setUTCDate(b.getUTCDate()-(6-p)),b.toISOString().slice(0,10)}),u=new Map;for(const h of m)u.set(h,{quizzes:0,materials:0});for(const h of i?.data||[]){if(!h?.started_at)continue;const p=c1(h.started_at);if(!u.has(p))continue;const b=u.get(p);h.activities?.type==="quiz"?b.quizzes+=1:h.activities?.type==="material"&&(b.materials+=1)}return m.map(h=>({date:new Date(h+"T00:00:00Z").toLocaleDateString("pl-PL",{weekday:"short",day:"numeric"}),quizzes:u.get(h).quizzes,materials:u.get(h).materials}))},[i?.data]),l=[{title:"Aktywni użytkownicy",value:a.activeUsers,change:a.activeUsersChange,icon:Pe,color:"text-blue-600",bgColor:"bg-blue-50",link:"/teacher/reports/engagement"},{title:"Średni wynik quizów",value:`${a.avgQuizScore}%`,change:a.avgQuizScoreChange,icon:ze,color:"text-green-600",bgColor:"bg-green-50",link:"/teacher/reports/performance"},{title:"Wskaźnik ukończeń",value:`${a.completionRate}%`,change:a.completionRateChange,icon:It,color:"text-purple-600",bgColor:"bg-purple-50",link:"/teacher/reports/progress"},{title:"Suma punktów",value:a.totalPoints.toLocaleString("pl-PL"),change:a.totalPointsChange,icon:$e,color:"text-orange-600",bgColor:"bg-orange-50",link:"/teacher/reports/gamification"}],c=[{to:"/teacher/reports/engagement",title:"Raport zaangażowania",description:"Aktywność użytkowników, czas nauki, trendy",icon:e.jsx(Ar,{className:"h-5 w-5"}),color:"text-blue-600"},{to:"/teacher/reports/progress",title:"Raport postępów",description:"Postęp kursów, wskaźniki ukończeń",icon:e.jsx(It,{className:"h-5 w-5"}),color:"text-purple-600"},{to:"/teacher/reports/performance",title:"Raport wyników",description:"Wyniki quizów, najtrudniejsze pytania",icon:e.jsx(ze,{className:"h-5 w-5"}),color:"text-green-600"},{to:"/teacher/reports/gamification",title:"Raport gamifikacji",description:"Ranking punktowy, poziomy, osiągnięcia",icon:e.jsx($e,{className:"h-5 w-5"}),color:"text-orange-600"}],d=r?.data?.slice(0,5)||[];return e.jsxs(K,{children:[e.jsx(Z,{children:e.jsx(ve,{title:"Centrum Raportów",description:"Kompleksowy przegląd wyników i postępów uczniów"})}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-6",children:l.map((m,u)=>e.jsxs(_,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>t(m.link),children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:m.title}),e.jsx("div",{className:`${m.bgColor} p-2 rounded-lg`,children:e.jsx(m.icon,{className:`h-4 w-4 ${m.color}`})})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:m.value}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{className:m.change>0?"text-green-600":"text-red-600",children:[m.change>0?"+":"",m.change,"%"]})," ","vs. ostatnie 7 dni"]})]})]},u))}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3 mb-6",children:[e.jsxs(_,{className:"lg:col-span-2",children:[e.jsx(O,{children:e.jsxs(L,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Aktywność w ostatnich 7 dniach"}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>t("/teacher/reports/engagement"),children:"Zobacz więcej →"})]})}),e.jsx(P,{children:e.jsx("div",{style:{width:"100%",height:250},children:e.jsx(Re,{width:"100%",height:"100%",children:e.jsxs(eo,{data:o,children:[e.jsx(Mt,{strokeDasharray:"3 3"}),e.jsx(wt,{dataKey:"date"}),e.jsx(ft,{allowDecimals:!1}),e.jsx(Be,{}),e.jsx(Zs,{type:"monotone",dataKey:"materials",stackId:"1",stroke:"#82ca9d",fill:"#82ca9d",name:"Materiały",isAnimationActive:!1,dot:!0}),e.jsx(Zs,{type:"monotone",dataKey:"quizzes",stackId:"1",stroke:"#8884d8",fill:"#8884d8",name:"Quizy",isAnimationActive:!1,dot:!0})]},`${o.map(m=>m.quizzes+m.materials).join("-")}`)})})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(L,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Top 5 uczniów"}),e.jsx($e,{className:"h-4 w-4 text-orange-600"})]})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:d.map((m,u)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold
                      ${u===0?"bg-yellow-100 text-yellow-700":u===1?"bg-gray-100 text-gray-700":u===2?"bg-orange-100 text-orange-700":"bg-muted text-muted-foreground"}`,children:u+1}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:["Uczeń #",u+1]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Poziom ",m.current_level]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-bold",children:m.total_points}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"punktów"})]})]},m.user_id))})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Szczegółowe raporty"}),e.jsx(it,{variant:"2-2-4",children:c.map(m=>e.jsxs(_,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>t(m.to),children:[e.jsx(O,{children:e.jsxs(L,{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:m.color,children:m.icon}),m.title]})}),e.jsx(P,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:m.description})})]},m.to))})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Ostatnie aktywności"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-2",children:i?.data?.slice(0,10).map(m=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{variant:m.activities?.type==="quiz"?"default":"secondary",children:m.activities?.type==="quiz"?"Quiz":"Materiał"}),e.jsxs("span",{className:"text-sm",children:["Aktywność #",m.activity_id]})]}),e.jsxs("div",{className:"text-right",children:[m.score!==null&&e.jsxs("span",{className:"text-sm font-medium",children:[m.score,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(m.started_at).toLocaleDateString("pl-PL")})]})]},`${m.user_id}-${m.activity_id}`))})})]})]})},u1=()=>{const[t,s]=g.useState("7d"),[n,i]=g.useState("all"),r=Ny()(),[a,o]=g.useState(!0),[l,c]=g.useState([]),[d,m]=g.useState([]),[u,h]=g.useState([]),[p,b]=g.useState([]),f=()=>{const j=new Date,C=new Date;switch(t){case"7d":C.setDate(C.getDate()-7);break;case"30d":C.setDate(C.getDate()-30);break;case"90d":C.setDate(C.getDate()-90);break}return{start:C,end:j}},{start:x,end:w}=f();g.useEffect(()=>{(async()=>{try{o(!0);const[C,T,E,M]=await Promise.all([r.getList({resource:"activity_progress",filters:[{field:"started_at",operator:"gte",value:x.toISOString()}],pagination:{mode:"off"}}),r.getList({resource:"activities",pagination:{mode:"off"},meta:{select:"id, type, topic_id"}}),r.getList({resource:"topics",pagination:{mode:"off"},meta:{select:"id, course_id"}}),r.getList({resource:"courses",filters:[{field:"is_published",operator:"eq",value:!0}],pagination:{mode:"off"}})]);c(C.data),m(T.data),h(E.data),b(M.data)}catch(C){console.error("Error fetching data:",C)}finally{o(!1)}})()},[]);const y=g.useMemo(()=>{if(!l.length||!d.length||!u.length)return[];const j=new Map(d.map(M=>[M.id,{type:M.type,topicId:M.topic_id}])),C=new Map(u.map(M=>[M.id,M.course_id])),T=l.map(M=>{const F=j.get(M.activity_id),X=F?.topicId?C.get(F.topicId):void 0;return{...M,activityType:F?.type,courseId:X}});if(n==="all")return T;const E=parseInt(n);return T.filter(M=>M.courseId===E)},[l,d,u,n]),N=g.useMemo(()=>{const j=new Set(y.map(F=>F.user_id)).size,C=y.reduce((F,X)=>F+(X.time_spent||0),0),T=j>0?(C/60/j).toFixed(1):"0",E=y.filter(F=>F.completed_at).length,M=y.length>0?Math.round(E/y.length*100):0;return{activeUsers:j,activeUsersChange:12,avgTimeHours:T,avgTimeChange:5,completedActivities:E,completedChange:18,engagementRate:M,engagementChange:3}},[y]),A=g.useMemo(()=>{const j=Math.ceil((w.getTime()-x.getTime())/864e5),C=[];for(let T=0;T<j;T++){const E=new Date(x);E.setDate(E.getDate()+T);const M=E.toISOString().split("T")[0],F=y.filter(R=>R.started_at.startsWith(M)),X=new Set(F.map(R=>R.user_id)).size;C.push({date:E.toLocaleDateString("pl-PL",{day:"numeric",month:"short"}),users:X})}return C},[y,x,w]),S=g.useMemo(()=>{const j=y.filter(E=>E.activityType==="quiz").length,C=y.filter(E=>E.activityType==="material").length;return j+C===0?[{name:"Brak danych",value:1,color:"#e5e7eb"}]:[{name:"Quizy",value:j,color:"#8884d8"},{name:"Materiały",value:C,color:"#82ca9d"}].filter(E=>E.value>0)},[y]),k=g.useMemo(()=>{const j=new Map;y.forEach(T=>{const E=j.get(T.user_id)||0;j.set(T.user_id,E+(T.time_spent||0))});const C=[{range:"0-30min",count:0,color:"#94a3b8"},{range:"30-60min",count:0,color:"#60a5fa"},{range:"1-2h",count:0,color:"#818cf8"},{range:"2-5h",count:0,color:"#a78bfa"},{range:"5h+",count:0,color:"#c084fc"}];return j.forEach(T=>{T<=30?C[0].count++:T<=60?C[1].count++:T<=120?C[2].count++:T<=300?C[3].count++:C[4].count++}),C.filter(T=>T.count>0)},[y]),v=g.useMemo(()=>{const j=Math.ceil((w.getTime()-x.getTime())/864e5),C=[];for(let T=0;T<j;T++){const E=new Date(x);E.setDate(E.getDate()+T);const M=E.toISOString().split("T")[0],F=y.filter(U=>U.started_at.startsWith(M)),X=F.filter(U=>U.completed_at).length,R=F.length,G=R>0?Math.round(X/R*100):0;C.push({date:E.toLocaleDateString("pl-PL",{day:"numeric",month:"short"}),rate:G,completed:X,total:R})}return C},[y,x,w]),z=[{label:"Aktywni użytkownicy",value:N.activeUsers.toString(),icon:Pe,change:`+${N.activeUsersChange}%`,color:"text-blue-600",bgColor:"bg-blue-50"},{label:"Średni czas nauki",value:`${N.avgTimeHours}h`,icon:Se,change:`+${N.avgTimeChange}%`,color:"text-purple-600",bgColor:"bg-purple-50"},{label:"Ukończone aktywności",value:N.completedActivities.toString(),icon:Ar,change:`+${N.completedChange}%`,color:"text-green-600",bgColor:"bg-green-50"},{label:"Wskaźnik zaangażowania",value:`${N.engagementRate}%`,icon:It,change:`+${N.engagementChange}%`,color:"text-orange-600",bgColor:"bg-orange-50"}],D=g.useMemo(()=>{if(!p.length||!y.length)return[];const j=new Map;return p.forEach(C=>{const T=typeof C.id=="number"?C.id:parseInt(C.id);isNaN(T)||j.set(T,{title:C.title||"",users:new Set,activities:0,completed:0})}),y.forEach(C=>{const T=C.courseId;if(T&&j.has(T)){const E=j.get(T);E&&(E.users.add(C.user_id),E.activities++,C.completed_at&&E.completed++)}}),Array.from(j.entries()).filter(([C,T])=>T.activities>0).map(([C,T])=>({id:C,title:T.title,users:T.users.size,activities:T.activities,completionRate:T.activities>0?Math.round(T.completed/T.activities*100):0})).sort((C,T)=>T.users-C.users).slice(0,5)},[y,p]);return a?e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-muted-foreground",children:"Ładowanie danych..."})})}):e.jsxs(K,{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(zr,{to:"/teacher/reports/overview",children:e.jsxs(I,{variant:"ghost",size:"sm",children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),"Powrót do centrum raportów"]})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Raport zaangażowania"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(me,{value:n,onValueChange:i,children:[e.jsx(ce,{className:"w-[200px]",children:e.jsx(he,{placeholder:"Wybierz kurs"})}),e.jsxs(de,{children:[e.jsx(B,{value:"all",children:"Wszystkie kursy"}),p.map(j=>{const C=typeof j.id=="number"?j.id:parseInt(j.id);return e.jsx(B,{value:C.toString(),children:j.title},C)})]})]}),e.jsxs(me,{value:t,onValueChange:s,children:[e.jsx(ce,{className:"w-[150px]",children:e.jsx(he,{})}),e.jsxs(de,{children:[e.jsx(B,{value:"7d",children:"Ostatnie 7 dni"}),e.jsx(B,{value:"30d",children:"Ostatnie 30 dni"}),e.jsx(B,{value:"90d",children:"Ostatnie 90 dni"})]})]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-6",children:z.map((j,C)=>e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:j.label}),e.jsx("div",{className:`${j.bgColor} p-2 rounded-lg`,children:e.jsx(j.icon,{className:`h-4 w-4 ${j.color}`})})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:j.value}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"text-green-600",children:j.change})," vs. poprzedni okres"]})]})]},C))}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3 mb-6",children:[e.jsxs(_,{className:"lg:col-span-2",children:[e.jsx(O,{children:e.jsx(L,{children:"Aktywni użytkownicy w czasie"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:300,children:e.jsxs(eo,{data:A,children:[e.jsx(Mt,{strokeDasharray:"3 3"}),e.jsx(wt,{dataKey:"date"}),e.jsx(ft,{}),e.jsx(Be,{}),e.jsx(Zs,{type:"monotone",dataKey:"users",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.6,name:"Aktywni użytkownicy",isAnimationActive:!1})]},`${A.map(j=>j.users).join("-")}`)})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Typy aktywności"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:300,children:e.jsxs(Aa,{children:[e.jsx(_a,{data:S,cx:"50%",cy:"50%",labelLine:!1,label:({name:j,percent:C})=>C!==void 0&&C>0?`${j}: ${(C*100).toFixed(0)}%`:"",outerRadius:80,fill:"#8884d8",dataKey:"value",isAnimationActive:!1,children:S.map((j,C)=>e.jsx(cs,{fill:j.color},`cell-${C}`))}),e.jsx(Be,{})]})})})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2 mb-6",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Rozkład czasu nauki użytkowników"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:250,children:e.jsxs(Ir,{data:k,children:[e.jsx(Mt,{strokeDasharray:"3 3"}),e.jsx(wt,{dataKey:"range"}),e.jsx(ft,{}),e.jsx(Be,{}),e.jsx(li,{dataKey:"count",name:"Liczba użytkowników",isAnimationActive:!1,children:k.map((j,C)=>e.jsx(cs,{fill:j.color},`cell-${C}`))})]},`${k.map(j=>j.count).join("-")}`)})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Wskaźnik ukończeń w czasie"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:250,children:e.jsxs($h,{data:v,children:[e.jsx(Mt,{strokeDasharray:"3 3"}),e.jsx(wt,{dataKey:"date"}),e.jsx(ft,{}),e.jsx(Be,{content:({active:j,payload:C})=>{if(j&&C&&C.length){const T=C[0].payload;return e.jsxs("div",{className:"bg-white p-2 border rounded shadow-sm",children:[e.jsx("p",{className:"font-medium text-sm",children:T.date}),e.jsxs("p",{className:"text-xs",children:["Wskaźnik: ",T.rate,"%"]}),e.jsxs("p",{className:"text-xs",children:["Ukończone: ",T.completed,"/",T.total]})]})}return null}}),e.jsx(cc,{type:"monotone",dataKey:"rate",stroke:"#22c55e",strokeWidth:2,dot:{fill:"#22c55e"},name:"Wskaźnik ukończeń %",isAnimationActive:!1})]},`${v.map(j=>j.rate).join("-")}`)})})]})]}),D.length>0&&e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Zaangażowanie według kursów"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:D.map(j=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:j.title}),e.jsxs("div",{className:"flex gap-4 mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Użytkownicy: ",j.users]}),e.jsxs("span",{children:["Aktywności: ",j.activities]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs(H,{variant:j.completionRate>=70?"default":"secondary",children:[j.completionRate,"% ukończonych"]})})]},j.id))})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Kluczowe wnioski"})}),e.jsx(P,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Kt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Trendy"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:N.activeUsers>0?`${N.activeUsers} unikalnych użytkowników aktywnych w wybranym okresie`:"Brak aktywności w wybranym okresie"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Wskaźnik ukończeń"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[N.engagementRate,"% rozpoczętych aktywności zostało ukończonych"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Średnie zaangażowanie"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Średnio ",N.avgTimeHours," godzin nauki na użytkownika"]})]})]})})]})]})},ds=g.forwardRef(({className:t,value:s,...n},i)=>e.jsx(Sh,{ref:i,className:$("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",t),...n,children:e.jsx(dy,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));ds.displayName=Sh.displayName;const m1=()=>{const[t,s]=g.useState("all"),[n,i]=g.useState(null),[r,a]=g.useState("progress"),o={queryOptions:{staleTime:1/0,gcTime:1800*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,refetchInterval:!1,retry:0}},{data:l}=ie({resource:"courses",filters:[{field:"is_published",operator:"eq",value:!0}],pagination:{mode:"off"},...o}),{data:c}=ie({resource:"activities",filters:[{field:"is_published",operator:"eq",value:!0}],pagination:{mode:"off"},meta:{select:"id, topic_id, type, topics(id, course_id)"},...o}),{data:d}=ie({resource:"activity_progress",pagination:{mode:"off"},meta:{select:"*, activities(id, topic_id, type, topics(id, course_id))"},...o}),{data:m}=ie({resource:"groups",pagination:{mode:"off"},...o}),{data:u}=ie({resource:"group_members",pagination:{mode:"off"},filters:t!=="all"?[{field:"group_id",operator:"eq",value:parseInt(t)}]:[],...o}),h=g.useMemo(()=>{if(!l?.data||!c?.data||!d?.data)return[];const x=new Map;return l.data.forEach(w=>{const y=typeof w.id=="number"?w.id:parseInt(w.id),A=c.data.filter(M=>M.topics?.course_id===y).length,S=d.data.filter(M=>M.activities?.topics?.course_id===y),k=t!=="all"&&u?.data?S.filter(M=>u.data.some(F=>F.user_id===M.user_id)):S,v=new Set(k.map(M=>M.user_id)),z=new Map,D=new Map;k.forEach(M=>{if(M.completed_at){const F=z.get(M.user_id)||0;z.set(M.user_id,F+1)}if(M.score!==null&&M.score!==void 0){const F=D.get(M.user_id)||[];F.push(Number(M.score)),D.set(M.user_id,F)}});const j=z.size,C=j>0?Array.from(z.values()).reduce((M,F)=>M+F,0)/j:0,T=Array.from(D.values()).flat(),E=T.length>0?Math.round(T.reduce((M,F)=>M+F,0)/T.length):null;x.set(y,{courseId:y,courseTitle:w.title||"",totalActivities:A,completedActivities:Math.round(C),avgScore:E,totalStudents:v.size,activeStudents:j})}),Array.from(x.values()).filter(w=>w.totalActivities>0).sort((w,y)=>{const N=w.totalActivities>0?w.completedActivities/w.totalActivities:0;return(y.totalActivities>0?y.completedActivities/y.totalActivities:0)-N})},[l?.data,c?.data,d?.data,t,u?.data]),p=g.useMemo(()=>{if(!d?.data||!h.length)return[];const x=new Map;h.forEach(y=>{const N=d.data.filter(S=>S.activities?.topics?.course_id===y.courseId);(t!=="all"&&u?.data?N.filter(S=>u.data.some(k=>k.user_id===S.user_id)):N).forEach(S=>{x.has(S.user_id)||x.set(S.user_id,new Map);const k=x.get(S.user_id);k.has(y.courseId)||k.set(y.courseId,{userId:S.user_id,courseId:y.courseId,courseTitle:y.courseTitle,completedActivities:0,totalActivities:y.totalActivities,avgScore:null,lastActivity:null,timeSpent:0});const v=k.get(y.courseId);if(S.completed_at&&v.completedActivities++,S.score!==null&&S.score!==void 0){const z=[];v.avgScore!==null&&z.push(v.avgScore),z.push(Number(S.score)),v.avgScore=Math.round(z.reduce((D,j)=>D+j,0)/z.length)}v.timeSpent+=S.time_spent||0,(!v.lastActivity||new Date(S.started_at)>new Date(v.lastActivity))&&(v.lastActivity=S.started_at)})});const w=[];return x.forEach(y=>{y.forEach(N=>{w.push(N)})}),w.sort((y,N)=>{switch(r){case"progress":{const A=y.totalActivities>0?y.completedActivities/y.totalActivities:0;return(N.totalActivities>0?N.completedActivities/N.totalActivities:0)-A}case"score":return(N.avgScore||0)-(y.avgScore||0);case"activity":return new Date(N.lastActivity||0).getTime()-new Date(y.lastActivity||0).getTime();default:return 0}})},[d?.data,h,t,u?.data,r]),b=g.useMemo(()=>{const x=[{name:"Rozpoczęli kurs",value:0,fill:"#8884d8"},{name:"Ukończyli 25%",value:0,fill:"#83a6ed"},{name:"Ukończyli 50%",value:0,fill:"#8dd1e1"},{name:"Ukończyli 75%",value:0,fill:"#82ca9d"},{name:"Ukończyli 100%",value:0,fill:"#67b26f"}],w=new Map;return p.forEach(y=>{const N=y.totalActivities>0?y.completedActivities/y.totalActivities*100:0,A=w.get(y.userId)||0;w.set(y.userId,Math.max(A,N))}),w.forEach(y=>{y>0&&x[0].value++,y>=25&&x[1].value++,y>=50&&x[2].value++,y>=75&&x[3].value++,y>=100&&x[4].value++}),x},[p]),f=g.useMemo(()=>{const x=new Set(p.map(S=>S.userId)).size,w=new Set(p.filter(S=>S.completedActivities>0).map(S=>S.userId)).size,y=h.length>0?Math.round(h.reduce((S,k)=>S+(k.totalActivities>0?k.completedActivities/k.totalActivities*100:0),0)/h.length):0,N=h.filter(S=>S.avgScore!==null),A=N.length>0?Math.round(N.reduce((S,k)=>S+k.avgScore,0)/N.length):0;return{totalStudents:x,activeStudents:w,avgCompletion:y,avgScore:A}},[p,h]);return e.jsxs(K,{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(zr,{to:"/teacher/reports/overview",children:e.jsxs(I,{variant:"ghost",size:"sm",children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),"Powrót do centrum raportów"]})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Raport postępów"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(me,{value:t,onValueChange:s,children:[e.jsx(ce,{className:"w-[200px]",children:e.jsx(he,{placeholder:"Wybierz grupę"})}),e.jsxs(de,{children:[e.jsx(B,{value:"all",children:"Wszystkie grupy"}),m?.data?.map(x=>e.jsx(B,{value:x.id?.toString()||"",children:x.name||"Bez nazwy"},x.id||"unknown"))]})]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(Lh,{className:"mr-2 h-4 w-4"}),"Eksportuj"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4 mb-6",children:[e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Wszyscy uczniowie"}),e.jsx(Pe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.totalStudents}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"w wybranych grupach"})]})]}),e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Aktywni uczniowie"}),e.jsx(It,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.activeStudents}),e.jsx("p",{className:"text-xs text-muted-foreground",children:f.totalStudents>0?`${Math.round(f.activeStudents/f.totalStudents*100)}% wszystkich`:"0% wszystkich"})]})]}),e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Średni postęp"}),e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[f.avgCompletion,"%"]}),e.jsx(ds,{value:f.avgCompletion,className:"mt-2"})]})]}),e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Średni wynik"}),e.jsx(ze,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[f.avgScore,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"z ukończonych quizów"})]})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2 mb-6",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Postęp według kursów"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:300,children:e.jsxs(Ir,{data:h,layout:"vertical",children:[e.jsx(Mt,{strokeDasharray:"3 3"}),e.jsx(wt,{type:"number",domain:[0,100]}),e.jsx(ft,{dataKey:"courseTitle",type:"category",width:120,tick:{fontSize:12}}),e.jsx(Be,{formatter:x=>`${x}%`,content:({active:x,payload:w})=>{if(x&&w&&w.length){const y=w[0].payload;return e.jsxs("div",{className:"bg-white p-2 border rounded shadow-sm",children:[e.jsx("p",{className:"font-medium text-sm",children:y.courseTitle}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Ukończono: ",y.completedActivities,"/",y.totalActivities," aktywności"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Aktywnych: ",y.activeStudents,"/",y.totalStudents," uczniów"]}),y.avgScore!==null&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Średni wynik: ",y.avgScore,"%"]})]})}return null}}),e.jsx(li,{dataKey:x=>x.totalActivities>0?Math.round(x.completedActivities/x.totalActivities*100):0,fill:"#8884d8",name:"Postęp",isAnimationActive:!1})]},`${h.map(x=>x.courseId).join("-")}`)})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Lejek ukończeń"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:300,children:e.jsxs(sb,{children:[e.jsx(Be,{}),e.jsxs(nb,{dataKey:"value",data:b,isAnimationActive:!1,children:[e.jsx(ib,{position:"center",fill:"#fff"}),b.map((x,w)=>e.jsx(cs,{fill:x.fill},`cell-${w}`))]})]})})})]})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(L,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Szczegółowe postępy uczniów"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(me,{value:r,onValueChange:x=>a(x),children:[e.jsx(ce,{className:"w-[150px]",children:e.jsx(he,{})}),e.jsxs(de,{children:[e.jsx(B,{value:"progress",children:"Sortuj wg postępu"}),e.jsx(B,{value:"score",children:"Sortuj wg wyniku"}),e.jsx(B,{value:"activity",children:"Sortuj wg aktywności"})]})]})})]})}),e.jsxs(P,{children:[e.jsx("div",{className:"rounded-md border",children:e.jsxs(so,{children:[e.jsx(no,{children:e.jsxs(Ys,{children:[e.jsx(Le,{children:"Uczeń"}),e.jsx(Le,{children:"Kurs"}),e.jsx(Le,{children:"Postęp"}),e.jsx(Le,{children:"Średni wynik"}),e.jsx(Le,{children:"Czas nauki"}),e.jsx(Le,{children:"Ostatnia aktywność"})]})}),e.jsx(io,{children:p.slice(0,20).map((x,w)=>{const y=x.totalActivities>0?Math.round(x.completedActivities/x.totalActivities*100):0;return e.jsxs(Ys,{children:[e.jsxs(Oe,{className:"font-medium",children:["Uczeń #",w+1]}),e.jsx(Oe,{children:x.courseTitle}),e.jsx(Oe,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ds,{value:y,className:"w-[60px]"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[y,"%"]})]})}),e.jsx(Oe,{children:x.avgScore!==null?e.jsxs(H,{variant:x.avgScore>=70?"default":"secondary",children:[x.avgScore,"%"]}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsxs(Oe,{children:[Math.floor(x.timeSpent/60),"h ",x.timeSpent%60,"m"]}),e.jsx(Oe,{children:x.lastActivity?new Date(x.lastActivity).toLocaleDateString("pl-PL"):"-"})]},`${x.userId}-${x.courseId}`)})})]})}),p.length>20&&e.jsx("div",{className:"mt-4 text-center",children:e.jsxs(I,{variant:"outline",size:"sm",children:["Zobacz wszystkich (",p.length,")"]})})]})]})]})},Vf=["#94a3b8","#60a5fa","#818cf8","#a78bfa","#c084fc","#e879f9","#f472b6","#fb923c","#fbbf24","#fde047"],gu=t=>{const s=Math.min(Math.floor((t-1)/10),9);return Vf[s]},h1=()=>{const[t,s]=g.useState("all"),[n,i]=g.useState("30d"),[r,a]=g.useState(!1),o=()=>{const k=new Date,v=new Date;switch(n){case"7d":v.setDate(v.getDate()-7);break;case"30d":v.setDate(v.getDate()-30);break;case"90d":v.setDate(v.getDate()-90);break}return{start:v,end:k}},{start:l}=o(),c={queryOptions:{staleTime:1/0,gcTime:1800*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,refetchInterval:!1,retry:0}},{data:d}=ie({resource:"user_stats",pagination:{mode:"off"},sorters:[{field:"total_points",order:"desc"}],meta:{select:"*, users(full_name, email, role)"},...c}),{data:m}=ie({resource:"groups",pagination:{mode:"off"},...c}),{data:u}=ie({resource:"group_members",filters:t!=="all"?[{field:"group_id",operator:"eq",value:parseInt(t)}]:[],pagination:{mode:"off"},...c}),{data:h}=ie({resource:"activity_progress",filters:[{field:"started_at",operator:"gte",value:l.toISOString()}],pagination:{mode:"off"},meta:{select:"*, activities(type)"},...c}),p=g.useMemo(()=>{let k=d?.data||[];if(k=k.filter(v=>!v.users?.role||v.users.role==="student"),t!=="all"&&u?.data){const v=u.data.map(z=>z.user_id);k=k.filter(z=>v.includes(z.user_id))}if(r){const v=new Date;v.setDate(v.getDate()-7),k=k.filter(z=>new Date(z.last_active)>v)}return k},[d?.data,t,u?.data,r]),b=g.useMemo(()=>{const k=p.length,v=p.reduce((C,T)=>C+T.total_points,0),z=k>0?Math.round(p.reduce((C,T)=>C+T.current_level,0)/k):0,D=p.filter(C=>C.daily_streak>0).length,j=Math.max(...p.map(C=>C.daily_streak),0);return{totalUsers:k,totalPoints:v,avgLevel:z,activeStreaks:D,maxStreak:j}},[p]),f=g.useMemo(()=>{const k=new Map;return p.forEach(v=>{const z=Math.floor((v.current_level-1)/10)*10+1;k.set(z,(k.get(z)||0)+1)}),Array.from(k.entries()).map(([v,z])=>({level:`${v}-${v+9}`,count:z,percentage:p.length>0?Math.round(z/p.length*100):0})).sort((v,z)=>parseInt(v.level)-parseInt(z.level))},[p]),x=g.useMemo(()=>p.slice(0,10),[p]),w=g.useMemo(()=>{if(!h?.data)return[];const k=new Map;return h.data.forEach(v=>{if(v.activities?.type==="quiz"&&v.completed_at){const z=k.get(v.user_id)||0;k.set(v.user_id,z+1)}}),p.map(v=>({points:v.total_points,quizzes:k.get(v.user_id)||0,level:v.current_level,streak:v.daily_streak,timeHours:Math.round((v.total_time_spent||0)/60)}))},[p,h?.data]),y=g.useMemo(()=>{const k=[{range:"0",count:0},{range:"1-3",count:0},{range:"4-7",count:0},{range:"8-14",count:0},{range:"15-30",count:0},{range:"30+",count:0}];return p.forEach(v=>{v.daily_streak===0?k[0].count++:v.daily_streak<=3?k[1].count++:v.daily_streak<=7?k[2].count++:v.daily_streak<=14?k[3].count++:v.daily_streak<=30?k[4].count++:k[5].count++}),k},[p]),N=g.useMemo(()=>{if(!h?.data)return[];const k=new Map,v=[];for(let z=13;z>=0;z--){const D=new Date;D.setDate(D.getDate()-z);const j=D.toISOString().split("T")[0];v.push(j),k.set(j,{points:0,activities:0})}return h.data.forEach(z=>{const D=z.started_at.split("T")[0];if(k.has(D)){const j=k.get(D);j.activities++,z.activities?.type==="material"&&z.completed_at?j.points+=10:z.activities?.type==="quiz"&&z.score!==null&&z.score!==void 0&&(j.points+=Math.round(20+z.score/100*30))}}),v.map(z=>({date:new Date(z+"T00:00:00").toLocaleDateString("pl-PL",{day:"numeric",month:"short"}),points:k.get(z)?.points||0}))},[h?.data]),A=g.useMemo(()=>{if(!h?.data)return[];let k=0,v=0;const z=p.filter(j=>j.daily_streak>0).length*5,D=p.filter(j=>j.current_level>1).length*50;return h.data.forEach(j=>{j.activities?.type==="quiz"&&j.score!==null&&j.score!==void 0?k+=Math.round(20+j.score/100*30):j.activities?.type==="material"&&j.completed_at&&(v+=10)}),[{type:"Ukończone quizy",points:k,color:"#8884d8"},{type:"Materiały",points:v,color:"#82ca9d"},{type:"Codzienne logowanie",points:z,color:"#ffc658"},{type:"Awans poziomów",points:D,color:"#ff8042"}].filter(j=>j.points>0).sort((j,C)=>C.points-j.points)},[h?.data,p]),S=g.useMemo(()=>{if(!h?.data)return[];const k=new Map;return h.data.forEach(v=>{v.activities?.type==="quiz"&&v.completed_at&&k.set(v.user_id,(k.get(v.user_id)||0)+1)}),x.map(v=>({...v,quizzesCompleted:k.get(v.user_id)||0}))},[x,h?.data]);return e.jsxs(K,{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(zr,{to:"/teacher/reports/overview",children:e.jsxs(I,{variant:"ghost",size:"sm",children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),"Powrót do centrum raportów"]})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Raport gamifikacji"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(me,{value:t,onValueChange:s,children:[e.jsx(ce,{className:"w-[200px]",children:e.jsx(he,{placeholder:"Wybierz grupę"})}),e.jsxs(de,{children:[e.jsx(B,{value:"all",children:"Wszystkie grupy"}),m?.data?.map(k=>e.jsx(B,{value:k.id.toString(),children:k.name},k.id))]})]}),e.jsxs(me,{value:n,onValueChange:i,children:[e.jsx(ce,{className:"w-[150px]",children:e.jsx(he,{})}),e.jsxs(de,{children:[e.jsx(B,{value:"7d",children:"Ostatnie 7 dni"}),e.jsx(B,{value:"30d",children:"Ostatnie 30 dni"}),e.jsx(B,{value:"90d",children:"Ostatnie 90 dni"})]})]}),e.jsx(I,{variant:r?"default":"outline",size:"sm",onClick:()=>a(!r),children:"Tylko aktywni"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-5 mb-6",children:[e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Uczniowie"}),e.jsx($e,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.totalUsers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"w rankingu"})]})]}),e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Łączne punkty"}),e.jsx(wn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.totalPoints.toLocaleString("pl-PL")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"zdobytych"})]})]}),e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Średni poziom"}),e.jsx(Oh,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.avgLevel}),e.jsx(ds,{value:b.avgLevel/99*100,className:"mt-2 h-1"})]})]}),e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Aktywne serie"}),e.jsx(ls,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.activeStreaks}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"uczniów"})]})]}),e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Najdłuższa seria"}),e.jsx(nt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.maxStreak}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"dni"})]})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3 mb-6",children:[e.jsxs(_,{className:"lg:col-span-2",children:[e.jsx(O,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-yellow-600"}),"Top 10 uczniów"]})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:S.map((k,v)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold
                      ${v===0?"bg-yellow-100 text-yellow-700 ring-2 ring-yellow-500":v===1?"bg-gray-100 text-gray-700 ring-2 ring-gray-400":v===2?"bg-orange-100 text-orange-700 ring-2 ring-orange-500":"bg-muted text-muted-foreground"}`,children:v+1}),e.jsx(ar,{children:e.jsx(or,{className:"text-xs",children:k.users?.full_name?k.users.full_name.split(" ").map(z=>z[0]).join("").toUpperCase():`U${v+1}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:k.users?.full_name||`Uczeń #${v+1}`}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsxs(H,{variant:"outline",className:"text-xs",style:{borderColor:gu(k.current_level),color:gu(k.current_level)},children:["Poziom ",k.current_level]}),k.daily_streak>0&&e.jsxs(H,{variant:"secondary",className:"text-xs",children:[e.jsx(ls,{className:"w-3 h-3 mr-1"}),k.daily_streak," dni"]}),k.perfect_scores>0&&e.jsxs(H,{variant:"secondary",className:"text-xs",children:[e.jsx(wn,{className:"w-3 h-3 mr-1"}),k.perfect_scores," perfect"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold",children:k.total_points.toLocaleString("pl-PL")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"punktów"})]})]},k.user_id))})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Rozkład poziomów"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:300,children:e.jsxs(Aa,{children:[e.jsx(_a,{data:f,cx:"50%",cy:"50%",labelLine:!1,label:({percentage:k})=>k>0?`${k}%`:"",outerRadius:80,fill:"#8884d8",dataKey:"count",isAnimationActive:!1,children:f.map((k,v)=>e.jsx(cs,{fill:Vf[v]},`cell-${v}`))}),e.jsx(Be,{}),e.jsx(Xn,{formatter:(k,v)=>v?.payload&&"level"in v.payload?`Poziom ${v.payload.level}`:""})]})})})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2 mb-6",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Punkty vs Ukończone quizy"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:300,children:e.jsxs(qh,{children:[e.jsx(Mt,{strokeDasharray:"3 3"}),e.jsx(wt,{dataKey:"quizzes",name:"Ukończone quizy"}),e.jsx(ft,{dataKey:"points",name:"Punkty"}),e.jsx(Fh,{dataKey:"level",range:[50,200]}),e.jsx(Be,{cursor:{strokeDasharray:"3 3"}}),e.jsx(Bh,{name:"Uczniowie",data:w,fill:"#8884d8",isAnimationActive:!1})]})})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Rozkład daily streaks"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:300,children:e.jsxs(Ir,{data:y,children:[e.jsx(Mt,{strokeDasharray:"3 3"}),e.jsx(wt,{dataKey:"range"}),e.jsx(ft,{}),e.jsx(Be,{}),e.jsx(li,{dataKey:"count",fill:"#fbbf24",name:"Liczba uczniów",isAnimationActive:!1,children:y.map((k,v)=>e.jsx(cs,{fill:v===0?"#94a3b8":v<=2?"#fbbf24":v<=4?"#f97316":"#ef4444"},`cell-${v}`))})]},`${y.map(k=>k.count).join("-")}`)})})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Zdobywane punkty w czasie"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:250,children:e.jsxs($h,{data:N,children:[e.jsx(Mt,{strokeDasharray:"3 3"}),e.jsx(wt,{dataKey:"date"}),e.jsx(ft,{}),e.jsx(Be,{}),e.jsx(cc,{type:"monotone",dataKey:"points",stroke:"#8884d8",strokeWidth:2,dot:{fill:"#8884d8"},name:"Punkty",isAnimationActive:!1})]},`${N.map(k=>k.points).join("-")}`)})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Źródła punktów"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:250,children:e.jsxs(Aa,{children:[e.jsx(_a,{data:A,cx:"50%",cy:"50%",labelLine:!1,label:({value:k})=>k!==void 0&&k>0?`${k.toLocaleString("pl-PL")}`:"",outerRadius:80,fill:"#8884d8",dataKey:"points",isAnimationActive:!1,children:A.map((k,v)=>e.jsx(cs,{fill:k.color},`cell-${v}`))}),e.jsx(Be,{}),e.jsx(Xn,{})]})})})]})]}),e.jsxs(_,{className:"mt-6 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-950/20 dark:to-blue-950/20",children:[e.jsx(O,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(yn,{className:"h-5 w-5 text-purple-600"}),"Kluczowe osiągnięcia"]})}),e.jsx(P,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Najaktywniejszy uczeń"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[S[0]?.quizzesCompleted||0," ukończonych quizów"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(It,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Największy wzrost"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["+",Math.round(b.totalPoints*.15).toLocaleString("pl-PL")," punktów w tym okresie"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Zaangażowanie"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[b.totalUsers>0?Math.round(b.activeStreaks/b.totalUsers*100):0,"% uczniów ma aktywną serię"]})]})]})})]})]})},Ri={veryActive:"#22c55e",active:"#3b82f6",moderate:"#f59e0b",lowActivity:"#ef4444",inactive:"#6b7280"},mt={champions:"#8b5cf6",loyalists:"#3b82f6",potentials:"#10b981",newUsers:"#f59e0b",atRisk:"#ef4444",dormant:"#6b7280"},p1=()=>{const[t,s]=g.useState("30d"),[n,i]=g.useState("all"),[r,a]=g.useState("all"),o=g.useMemo(()=>({staleTime:1/0,gcTime:1800*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,refetchInterval:1e4,retry:0}),[]),{startISO:l}=g.useMemo(()=>{const j=new Date,C=new Date(j);switch(t){case"7d":C.setDate(C.getDate()-7);break;case"30d":C.setDate(C.getDate()-30);break;case"90d":C.setDate(C.getDate()-90);break}return C.setHours(0,0,0,0),{startISO:C.toISOString(),endISO:j.toISOString()}},[t]),c=g.useMemo(()=>n!=="all"?[{field:"role",operator:"eq",value:n}]:[],[n]),d=g.useMemo(()=>({select:"*, users!user_stats_user_id_fkey(email, full_name)"}),[]),m=g.useMemo(()=>({select:"*, activities(type)"}),[]),u=g.useMemo(()=>[{field:"started_at",operator:"gte",value:l}],[l]),{data:h}=ie({resource:"users",pagination:{mode:"off"},filters:c,queryOptions:o}),{data:p}=ie({resource:"user_stats",pagination:{mode:"off"},meta:d,queryOptions:o}),{data:b}=ie({resource:"activity_progress",filters:u,pagination:{mode:"off"},meta:m,queryOptions:o}),f=g.useMemo(()=>{if(!h?.data||!p?.data||!b?.data)return[];const j=new Map(p.data.map(T=>[T.user_id,T])),C=new Map;return b.data.forEach(T=>{const E=C.get(T.user_id)||[];E.push(T),C.set(T.user_id,E)}),h.data.map(T=>{const E=j.get(T.id),M=C.get(T.id)||[];let F;const X=E?.last_active?Math.floor((Date.now()-new Date(E.last_active).getTime())/(1e3*60*60*24)):999;E?X>30?F="dormant":X>14?F="atRisk":E.total_points<100&&X<7?F="newUsers":E.total_points>1e3&&E.daily_streak>7?F="champions":E.daily_streak>3?F="loyalists":F="potentials":F="dormant";const R=M.filter(U=>typeof U.score=="number"),G=R.length?Math.round(R.reduce((U,le)=>U+le.score,0)/R.length):null;return{...T,stats:E,activities:M,segment:F,daysSinceLastActive:X,avgScore:G}})},[h?.data,p?.data,b?.data]),x=g.useMemo(()=>r==="all"?f:f.filter(j=>j.segment===r),[f,r]),w=g.useMemo(()=>{const j=x.length,C=x.filter(R=>R.is_active).length,T=x.filter(R=>R.daysSinceLastActive<=7).length,E=x.filter(R=>R.stats),M=E.length?Math.round(E.reduce((R,G)=>R+(G.stats?.current_level||0),0)/E.length):0,F=E.filter(R=>(R.stats?.daily_streak||0)>0).length,X=E.length?Math.round(E.reduce((R,G)=>R+(G.stats?.total_time_spent||0),0)/E.length/60):0;return{total:j,active:C,activePercent:j>0?Math.round(C/j*100):0,activeLastWeek:T,activeLastWeekPercent:j>0?Math.round(T/j*100):0,avgLevel:M,withStreaks:F,streakPercent:j>0?Math.round(F/j*100):0,avgTimeHours:X}},[x]),y=g.useMemo(()=>{const j=[{name:"Champions",key:"champions",count:0,color:mt.champions,description:"Wysokie punkty, aktywna seria"},{name:"Lojaliści",key:"loyalists",count:0,color:mt.loyalists,description:"Regularna aktywność"},{name:"Potencjalni",key:"potentials",count:0,color:mt.potentials,description:"Niska regularność"},{name:"Nowi",key:"newUsers",count:0,color:mt.newUsers,description:"Niedawno dołączyli"},{name:"Zagrożeni",key:"atRisk",count:0,color:mt.atRisk,description:"Spadek aktywności"},{name:"Nieaktywni",key:"dormant",count:0,color:mt.dormant,description:"Brak aktywności >30 dni"}],C={};return f.forEach(T=>{C[T.segment]=(C[T.segment]||0)+1}),j.map(T=>({...T,count:C[T.key]||0})).filter(T=>T.count>0)},[f]),N=g.useMemo(()=>{const j=[{name:"Champions",key:"champions",count:0,color:mt.champions,description:"Wysokie punkty, aktywna seria"},{name:"Lojaliści",key:"loyalists",count:0,color:mt.loyalists,description:"Regularna aktywność"},{name:"Potencjalni",key:"potentials",count:0,color:mt.potentials,description:"Niska regularność"},{name:"Nowi",key:"newUsers",count:0,color:mt.newUsers,description:"Niedawno dołączyli"},{name:"Zagrożeni",key:"atRisk",count:0,color:mt.atRisk,description:"Spadek aktywności"},{name:"Nieaktywni",key:"dormant",count:0,color:mt.dormant,description:"Brak aktywności >30 dni"}],C={};return f.forEach(T=>{C[T.segment]=(C[T.segment]||0)+1}),j.map(T=>({...T,count:C[T.key]||0}))},[f]),A=g.useMemo(()=>{const j=[{name:"Bardzo aktywni",range:"Codziennie",count:0,color:Ri.veryActive},{name:"Aktywni",range:"2-6 dni/tydz",count:0,color:Ri.active},{name:"Umiarkowani",range:"1 dzień/tydz",count:0,color:Ri.moderate},{name:"Niska aktywność",range:"<1 dzień/tydz",count:0,color:Ri.lowActivity},{name:"Nieaktywni",range:"Brak",count:0,color:Ri.inactive}];return x.forEach(C=>{!C.stats||C.daysSinceLastActive>30?j[4].count++:C.daysSinceLastActive<=1?j[0].count++:C.daysSinceLastActive<=3?j[1].count++:C.daysSinceLastActive<=7?j[2].count++:j[3].count++}),j},[x]),S=g.useMemo(()=>{const j=new Map;return b?.data?.forEach(T=>{const E=T.started_at.slice(0,10),M=j.get(E)||new Set;M.add(T.user_id),j.set(E,M)}),Array.from(j.keys()).sort().slice(-30).map(T=>({date:new Date(T).toLocaleDateString("pl-PL",{day:"numeric",month:"short"}),activeUsers:j.get(T)?.size||0,newUsers:x.filter(E=>E.created_at?.slice(0,10)===T).length}))},[b?.data,x]),k=g.useMemo(()=>x.filter(j=>j.stats&&(j.stats.total_time_spent||0)>0).map(j=>({timeHours:Math.round((j.stats.total_time_spent||0)/60),points:j.stats.total_points,level:j.stats.current_level,streak:j.stats.daily_streak,segment:j.segment})),[x]),v=g.useMemo(()=>x.filter(j=>j.stats).sort((j,C)=>(C.stats?.total_points||0)-(j.stats?.total_points||0)).slice(0,10),[x]),z=g.useMemo(()=>{const j=new Map,C=4;return x.forEach(T=>{const E=new Date(T.created_at);E.setHours(0,0,0,0),E.setDate(E.getDate()-E.getDay());const M=E.toISOString().slice(0,10);j.has(M)||j.set(M,{total:0,retained:Array(C).fill(0)});const F=j.get(M);F.total++;for(let X=0;X<C;X++){const R=new Date(E);R.setDate(R.getDate()+X*7);const G=new Date(R);G.setDate(G.getDate()+7),T.activities.some(le=>{const q=new Date(le.started_at);return q>=R&&q<G})&&F.retained[X]++}}),Array.from(j.entries()).map(([T,E])=>({cohort:new Date(T).toLocaleDateString("pl-PL",{day:"numeric",month:"short"}),week0:100,week1:E.total>0?Math.round(E.retained[1]/E.total*100):0,week2:E.total>0?Math.round(E.retained[2]/E.total*100):0,week3:E.total>0?Math.round(E.retained[3]/E.total*100):0,total:E.total})).slice(-4)},[x]),D=[{label:"Wszyscy użytkownicy",value:w.total.toString(),subValue:`${w.activePercent}% aktywnych`,icon:Pe,color:"text-blue-600",bgColor:"bg-blue-50"},{label:"Aktywni w ostatnim tygodniu",value:w.activeLastWeek.toString(),subValue:`${w.activeLastWeekPercent}% wszystkich`,icon:Uy,color:"text-green-600",bgColor:"bg-green-50"},{label:"Średni poziom",value:w.avgLevel.toString(),subValue:`${w.avgTimeHours}h średnio`,icon:yn,color:"text-purple-600",bgColor:"bg-purple-50"},{label:"Z aktywną serią",value:w.withStreaks.toString(),subValue:`${w.streakPercent}% wszystkich`,icon:nt,color:"text-orange-600",bgColor:"bg-orange-50"}];return e.jsxs(K,{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(zr,{to:"/teacher/reports/overview",children:e.jsxs(I,{variant:"ghost",size:"sm",children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),"Powrót do centrum raportów"]})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Analiza użytkowników"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(me,{value:n,onValueChange:i,children:[e.jsx(ce,{className:"w-[150px]",children:e.jsx(he,{})}),e.jsxs(de,{children:[e.jsx(B,{value:"all",children:"Wszystkie role"}),e.jsx(B,{value:"student",children:"Uczniowie"}),e.jsx(B,{value:"teacher",children:"Nauczyciele"}),e.jsx(B,{value:"admin",children:"Administratorzy"})]})]}),e.jsxs(me,{value:r,onValueChange:a,children:[e.jsx(ce,{className:"w-[180px]",children:e.jsx(he,{})}),e.jsxs(de,{children:[e.jsx(B,{value:"all",children:"Wszystkie segmenty"}),N.map(j=>e.jsxs(B,{value:j.key,children:[j.name," (",j.count,")"]},j.key))]})]}),e.jsxs(me,{value:t,onValueChange:s,children:[e.jsx(ce,{className:"w-[150px]",children:e.jsx(he,{})}),e.jsxs(de,{children:[e.jsx(B,{value:"7d",children:"Ostatnie 7 dni"}),e.jsx(B,{value:"30d",children:"Ostatnie 30 dni"}),e.jsx(B,{value:"90d",children:"Ostatnie 90 dni"})]})]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-6",children:D.map((j,C)=>e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:j.label}),e.jsx("div",{className:`${j.bgColor} p-2 rounded-lg`,children:e.jsx(j.icon,{className:`h-4 w-4 ${j.color}`})})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:j.value}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:j.subValue})]})]},C))}),e.jsxs(uc,{defaultValue:"segments",className:"space-y-4",children:[e.jsxs(ro,{className:"grid w-full grid-cols-5",children:[e.jsx(Ft,{value:"segments",children:"Segmentacja"}),e.jsx(Ft,{value:"activity",children:"Aktywność"}),e.jsx(Ft,{value:"performance",children:"Wyniki"}),e.jsx(Ft,{value:"retention",children:"Retencja"}),e.jsx(Ft,{value:"leaderboard",children:"Ranking"})]}),e.jsxs(Bt,{value:"segments",className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Segmentacja użytkowników"})}),e.jsx(P,{children:y.length===0?e.jsx("div",{className:"text-sm text-muted-foreground p-6 border rounded-lg",children:"Brak danych do wyświetlenia dla wybranego zakresu."}):e.jsx(Re,{width:"100%",height:300,children:e.jsxs(Aa,{children:[e.jsx(_a,{data:y,cx:"50%",cy:"50%",outerRadius:100,dataKey:"count",label:({name:j,percent:C})=>C!==void 0?`${j}: ${(C*100).toFixed(0)}%`:j,isAnimationActive:!1,children:y.map((j,C)=>e.jsx(cs,{fill:j.color},`cell-${C}`))}),e.jsx(Be,{})]})})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Charakterystyka segmentów"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:N.map(j=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:j.color}}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:j.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:j.description})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold",children:j.count}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"użytkowników"})]})]},j.key))})})]})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Od,{className:"h-5 w-5 text-orange-600"}),"Kluczowe obserwacje"]})}),e.jsx(P,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[N.find(j=>j.key==="atRisk")?.count?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-orange-600",children:[e.jsx(Vy,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Użytkownicy zagrożeni"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[N.find(j=>j.key==="atRisk")?.count," użytkowników wymaga uwagi – rozważ wysłanie powiadomień motywacyjnych"]})]}):null,N.find(j=>j.key==="champions")?.count?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-600",children:[e.jsx(yn,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Champions do wykorzystania"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[N.find(j=>j.key==="champions")?.count," najaktywniejszych użytkowników – mogą być mentorami lub ambasadorami"]})]}):null,N.find(j=>j.key==="newUsers")?.count?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Nowi użytkownicy"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[N.find(j=>j.key==="newUsers")?.count," nowych użytkowników – upewnij się, że mają dobre wsparcie onboardingowe"]})]}):null]})})]})]}),e.jsxs(Bt,{value:"activity",className:"space-y-4",children:[e.jsx("div",{className:"grid gap-6 lg:grid-cols-2",children:e.jsxs(_,{className:"lg:col-span-2",children:[e.jsx(O,{children:e.jsx(L,{children:"Wzorzec aktywności użytkowników"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:300,children:e.jsxs(eo,{data:S,children:[e.jsx(Mt,{strokeDasharray:"3 3"}),e.jsx(wt,{dataKey:"date"}),e.jsx(ft,{}),e.jsx(Be,{}),e.jsx(Xn,{}),e.jsx(Zs,{type:"monotone",dataKey:"activeUsers",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6,name:"Aktywni użytkownicy",isAnimationActive:!1}),e.jsx(Zs,{type:"monotone",dataKey:"newUsers",stackId:"1",stroke:"#10b981",fill:"#10b981",fillOpacity:.6,name:"Nowi użytkownicy",isAnimationActive:!1})]})})})]})}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Poziomy aktywności"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:250,children:e.jsxs(Ir,{data:A,children:[e.jsx(Mt,{strokeDasharray:"3 3"}),e.jsx(wt,{dataKey:"name"}),e.jsx(ft,{}),e.jsx(Be,{}),e.jsx(li,{dataKey:"count",name:"Użytkownicy",isAnimationActive:!1,children:A.map((j,C)=>e.jsx(cs,{fill:j.color},`cell-${C}`))})]})})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Metryki zaangażowania"})}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ar,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Średnia częstotliwość logowania"})]}),e.jsx(H,{variant:"outline",children:"3.2 dni/tydzień"})]}),e.jsx(ds,{value:64,className:"h-2"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Średni czas sesji"})]}),e.jsx(H,{variant:"outline",children:"24 min"})]}),e.jsx(ds,{value:48,className:"h-2"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:"Ukończenia na użytkownika"})]}),e.jsx(H,{variant:"outline",children:"7.8 aktywności"})]}),e.jsx(ds,{value:78,className:"h-2"})]})]})]})]})]}),e.jsxs(Bt,{value:"performance",className:"space-y-4",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Punkty vs Czas nauki"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:400,children:e.jsxs(qh,{children:[e.jsx(Mt,{strokeDasharray:"3 3"}),e.jsx(wt,{dataKey:"timeHours",name:"Czas nauki (h)"}),e.jsx(ft,{dataKey:"points",name:"Punkty"}),e.jsx(Fh,{dataKey:"level",range:[50,400]}),e.jsx(Be,{cursor:{strokeDasharray:"3 3"}}),e.jsx(Xn,{}),e.jsx(Bh,{name:"Użytkownicy",data:k,fill:"#8884d8",isAnimationActive:!1,children:k.map((j,C)=>e.jsx(cs,{fill:mt[j.segment]||"#8884d8"},`cell-${C}`))})]})})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Rozkład wyników"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-4",children:[{label:"90-100%",count:x.filter(j=>j.avgScore!==null&&j.avgScore>=90).length,color:"#22c55e"},{label:"80-89%",count:x.filter(j=>j.avgScore!==null&&j.avgScore>=80&&j.avgScore<90).length,color:"#84cc16"},{label:"70-79%",count:x.filter(j=>j.avgScore!==null&&j.avgScore>=70&&j.avgScore<80).length,color:"#eab308"},{label:"60-69%",count:x.filter(j=>j.avgScore!==null&&j.avgScore>=60&&j.avgScore<70).length,color:"#f97316"},{label:"<60%",count:x.filter(j=>j.avgScore!==null&&j.avgScore<60).length,color:"#ef4444"}].map(j=>{const C=x.filter(E=>E.avgScore!==null).length,T=C>0?j.count/C*100:0;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:j.label}),e.jsxs("span",{className:"font-medium",children:[j.count," użytkowników"]})]}),e.jsx("div",{className:"relative h-8 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"absolute left-0 top-0 h-full transition-all duration-500",style:{width:`${T}%`,backgroundColor:j.color}})})]},j.label)})})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Wskaźniki sukcesu"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:250,children:e.jsxs(rb,{cx:"50%",cy:"50%",innerRadius:"10%",outerRadius:"90%",data:[{name:"Ukończenia",value:68,fill:"#8884d8"},{name:"Zdawalność",value:74,fill:"#82ca9d"},{name:"Zaangażowanie",value:82,fill:"#ffc658"}],children:[e.jsx(ab,{dataKey:"value",isAnimationActive:!1}),e.jsx(Xn,{}),e.jsx(Be,{})]})})})]})]})]}),e.jsxs(Bt,{value:"retention",className:"space-y-4",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Analiza kohortowa retencji"})}),e.jsxs(P,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(so,{children:[e.jsx(no,{children:e.jsxs(Ys,{children:[e.jsx(Le,{children:"Kohorta"}),e.jsx(Le,{className:"text-center",children:"Tydzień 0"}),e.jsx(Le,{className:"text-center",children:"Tydzień 1"}),e.jsx(Le,{className:"text-center",children:"Tydzień 2"}),e.jsx(Le,{className:"text-center",children:"Tydzień 3"}),e.jsx(Le,{className:"text-center",children:"Liczba użytkowników"})]})}),e.jsx(io,{children:z.map(j=>e.jsxs(Ys,{children:[e.jsx(Oe,{className:"font-medium",children:j.cohort}),e.jsx(Oe,{className:"text-center",children:e.jsxs("div",{className:"inline-flex items-center justify-center w-16 h-8 rounded",style:{backgroundColor:`rgba(34, 197, 94, ${j.week0/100})`},children:[j.week0,"%"]})}),e.jsx(Oe,{className:"text-center",children:e.jsxs("div",{className:"inline-flex items-center justify-center w-16 h-8 rounded",style:{backgroundColor:`rgba(34, 197, 94, ${j.week1/100})`},children:[j.week1,"%"]})}),e.jsx(Oe,{className:"text-center",children:e.jsxs("div",{className:"inline-flex items-center justify-center w-16 h-8 rounded",style:{backgroundColor:`rgba(34, 197, 94, ${j.week2/100})`},children:[j.week2,"%"]})}),e.jsx(Oe,{className:"text-center",children:e.jsxs("div",{className:"inline-flex items-center justify-center w-16 h-8 rounded",style:{backgroundColor:`rgba(34, 197, 94, ${j.week3/100})`},children:[j.week3,"%"]})}),e.jsx(Oe,{className:"text-center",children:j.total})]},j.cohort))})]})}),e.jsx("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Interpretacja:"})," Wartości pokazują procent użytkowników z danej kohorty, którzy byli aktywni w kolejnych tygodniach po dołączeniu."]})})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Czynniki wpływające na retencję"})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ds,{className:"h-5 w-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Ukończenie pierwszego quizu"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+42% retencji po 30 dniach"})]})]}),e.jsx(H,{variant:"default",children:"Kluczowy"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ze,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Osiągnięcie 100 punktów"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+28% retencji po 30 dniach"})]})]}),e.jsx(H,{variant:"secondary",children:"Ważny"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pe,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Dołączenie do grupy"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+15% retencji po 30 dniach"})]})]}),e.jsx(H,{variant:"outline",children:"Pomocny"})]})]})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Prognoza churn"})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl font-bold text-orange-600 mb-2",children:N.find(j=>j.key==="atRisk")?.count||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"użytkowników zagrożonych odejściem"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Główne przyczyny:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("li",{children:"• Brak aktywności powyżej 14 dni (78%)"}),e.jsx("li",{children:"• Niskie wyniki quizów (45%)"}),e.jsx("li",{children:"• Brak postępów w kursie (34%)"}),e.jsx("li",{children:"• Utrata daily streak (23%)"})]})]}),e.jsxs(I,{className:"w-full",variant:"outline",children:[e.jsx(Od,{className:"mr-2 h-4 w-4"}),"Wygeneruj kampanię reaktywacyjną"]})]})})]})]})]}),e.jsxs(Bt,{value:"leaderboard",className:"space-y-4",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-yellow-600"}),"Top 10 użytkowników"]})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:v.map((j,C)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold
                        ${C===0?"bg-yellow-100 text-yellow-700 ring-2 ring-yellow-500":C===1?"bg-gray-100 text-gray-700 ring-2 ring-gray-400":C===2?"bg-orange-100 text-orange-700 ring-2 ring-orange-500":"bg-muted text-muted-foreground"}`,children:C+1}),e.jsx(ar,{children:e.jsx(or,{className:"text-xs",children:j.full_name?.split(" ").map(T=>T[0]).join("")||j.email.substring(0,2).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:j.full_name||`Użytkownik ${C+1}`}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(H,{variant:"outline",className:"text-xs",style:{borderColor:mt[j.segment]||"#8884d8",color:mt[j.segment]||"#8884d8"},children:N.find(T=>T.key===j.segment)?.name||j.segment}),e.jsxs(H,{variant:"secondary",className:"text-xs",children:["Poziom ",j.stats?.current_level||0]}),j.stats&&j.stats.daily_streak>0&&e.jsxs(H,{variant:"secondary",className:"text-xs",children:[e.jsx(nt,{className:"w-3 h-3 mr-1"}),j.stats.daily_streak," dni"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold",children:j.stats?.total_points.toLocaleString("pl-PL")||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"punktów"})]})]},j.id))})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{className:"text-base",children:"Najbardziej zaangażowani"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:x.filter(j=>j.stats).sort((j,C)=>(C.stats?.total_time_spent||0)-(j.stats?.total_time_spent||0)).slice(0,5).map((j,C)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:j.full_name||`Użytkownik ${C+1}`}),e.jsxs(H,{variant:"outline",children:[Math.round((j.stats?.total_time_spent||0)/60),"h"]})]},j.id))})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{className:"text-base",children:"Najlepsze wyniki"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:x.filter(j=>j.avgScore!==null).sort((j,C)=>j.avgScore<C.avgScore?1:-1).slice(0,5).map((j,C)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:j.full_name||`Użytkownik ${C+1}`}),e.jsxs(H,{variant:j.avgScore>=80?"default":"secondary",children:[j.avgScore,"%"]})]},j.id))})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{className:"text-base",children:"Najdłuższe serie"})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:x.filter(j=>j.stats).sort((j,C)=>(C.stats?.daily_streak||0)-(j.stats?.daily_streak||0)).slice(0,5).map((j,C)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:j.full_name||`Użytkownik ${C+1}`}),e.jsxs(H,{variant:"outline",children:[e.jsx(nt,{className:"w-3 h-3 mr-1"}),j.stats?.daily_streak," dni"]})]},j.id))})})]})]})]})]})]})},f1=()=>{const[t,s]=g.useState("30d"),[n,i]=g.useState("all"),[r,a]=g.useState("all"),o={queryOptions:{staleTime:1/0,gcTime:1800*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,refetchInterval:!1,retry:0}},l=()=>{const v=new Date,z=new Date;switch(t){case"7d":z.setDate(z.getDate()-7);break;case"30d":z.setDate(z.getDate()-30);break;case"90d":z.setDate(z.getDate()-90);break}return{start:z,end:v}},{start:c}=l(),{data:d}=ie({resource:"questions",pagination:{mode:"off"},...o}),{data:m}=ie({resource:"courses",pagination:{mode:"off"},...o}),{data:u}=ie({resource:"topics",filters:n!=="all"?[{field:"course_id",operator:"eq",value:parseInt(n)}]:[],pagination:{mode:"off"},...o}),{data:h}=ie({resource:"activities",filters:[{field:"type",operator:"eq",value:"quiz"},{field:"is_published",operator:"eq",value:!0}],pagination:{mode:"off"},...o}),{data:p}=ie({resource:"activity_progress",filters:[{field:"started_at",operator:"gte",value:c.toISOString()}],pagination:{mode:"off"},meta:{query:v=>v.not("score","is",null)},...o}),b=g.useMemo(()=>{if(!h?.data||!u?.data||!m?.data)return[];const v=new Map(u.data.map(D=>[D.id,D])),z=new Map(m.data.map(D=>[D.id,D]));return h.data.map(D=>{const j=v.get(D.topic_id),C=j?z.get(j.course_id):void 0;return{...D,topicTitle:j?.title||"",courseId:C?.id,courseTitle:C?.title||""}})},[h?.data,u?.data,m?.data]),f=g.useMemo(()=>{let v=b;return n!=="all"&&(v=v.filter(z=>z.courseId===parseInt(n))),r!=="all"&&(v=v.filter(z=>z.topic_id===parseInt(r))),v},[b,n,r]),x=g.useMemo(()=>{if(!p?.data)return[];const v=f.map(z=>z.id);return p.data.filter(z=>v.includes(z.activity_id)&&z.score!==null&&z.score!==void 0)},[p?.data,f]),w=g.useMemo(()=>{const v=new Map;return f.forEach(z=>{const D=x.filter(j=>j.activity_id===z.id);if(D.length>0){const j=D.filter(E=>E.score!==null&&E.score!==void 0).map(E=>E.score);if(j.length===0)return;const C=Math.round(j.reduce((E,M)=>E+M,0)/j.length),T=Math.round(j.filter(E=>E>=(z.passing_score||70)).length/j.length*100);v.set(z.id,{activityId:z.id,activityTitle:z.title,topicTitle:z.topicTitle,courseTitle:z.courseTitle,attempts:D.length,avgScore:C,minScore:Math.min(...j),maxScore:Math.max(...j),passRate:T,passingScore:z.passing_score||70})}}),Array.from(v.values()).sort((z,D)=>z.avgScore-D.avgScore)},[f,x]),y=g.useMemo(()=>{const v=x.length,z=x.filter(M=>M.score!==null&&M.score!==void 0).map(M=>M.score),D=z.length>0?Math.round(z.reduce((M,F)=>M+F,0)/z.length):0,j=x.filter(M=>{if(M.score===null||M.score===void 0)return!1;const X=f.find(R=>R.id===M.activity_id)?.passing_score||70;return M.score>=X}).length,C=v>0?Math.round(j/v*100):0;return{totalAttempts:v,avgScore:D,avgScoreChange:3,passRate:C,passRateChange:5,uniqueStudents:new Set(x.map(M=>M.user_id)).size,totalQuizzes:f.length}},[x,f]),N=g.useMemo(()=>{const v=[{range:"0-20%",count:0,color:"#ef4444"},{range:"21-40%",count:0,color:"#f97316"},{range:"41-60%",count:0,color:"#eab308"},{range:"61-80%",count:0,color:"#84cc16"},{range:"81-100%",count:0,color:"#22c55e"}];return x.forEach(z=>{const D=z.score||0;D<=20?v[0].count++:D<=40?v[1].count++:D<=60?v[2].count++:D<=80?v[3].count++:v[4].count++}),v},[x]),A=g.useMemo(()=>{const v=new Map;return x.forEach(z=>{const D=f.find(j=>j.id===z.activity_id);if(D?.topicTitle&&z.score!==null&&z.score!==void 0){const j=v.get(D.topicTitle)||{scores:[],topic:D.topicTitle};j.scores.push(z.score),v.set(D.topicTitle,j)}}),Array.from(v.values()).map(({topic:z,scores:D})=>({topic:z.length>20?z.substring(0,20)+"...":z,avgScore:Math.round(D.reduce((j,C)=>j+C,0)/D.length),attempts:D.length})).slice(0,8)},[x,f]),S=g.useMemo(()=>{const v=new Map;return x.forEach(z=>{const D=new Date(z.started_at).toLocaleDateString("pl-PL"),j=v.get(D)||[];z.score!==null&&z.score!==void 0&&(j.push(z.score),v.set(D,j))}),Array.from(v.entries()).map(([z,D])=>({date:z,avgScore:Math.round(D.reduce((j,C)=>j+C,0)/D.length),attempts:D.length,minScore:Math.min(...D),maxScore:Math.max(...D)})).sort((z,D)=>new Date(z.date).getTime()-new Date(D.date).getTime()).slice(-14)},[x]),k=g.useMemo(()=>{if(!d?.data||!w.length)return[];const v=w.slice(0,5),z=[];return v.forEach(D=>{d.data.filter(C=>C.activity_id===D.activityId).sort((C,T)=>C.order_index-T.order_index).forEach((C,T)=>{let E="medium";D.avgScore<30?E="very-hard":D.avgScore<50?E="hard":D.avgScore<70?E="medium":E="easy",z.push({questionId:C.id,question:C.question,activityTitle:D.activityTitle,quizAttempts:D.attempts,avgQuizScore:D.avgScore,difficulty:E})})}),z.sort((D,j)=>D.avgQuizScore-j.avgQuizScore).slice(0,10)},[d?.data,w]);return e.jsxs(K,{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(zr,{to:"/teacher/reports/overview",children:e.jsxs(I,{variant:"ghost",size:"sm",children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),"Powrót do centrum raportów"]})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Raport wyników"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(me,{value:n,onValueChange:i,children:[e.jsx(ce,{className:"w-[200px]",children:e.jsx(he,{placeholder:"Wybierz kurs"})}),e.jsxs(de,{children:[e.jsx(B,{value:"all",children:"Wszystkie kursy"}),m?.data?.map(v=>e.jsx(B,{value:v.id.toString(),children:v.title},v.id))]})]}),e.jsxs(me,{value:r,onValueChange:a,disabled:n==="all",children:[e.jsx(ce,{className:"w-[200px]",children:e.jsx(he,{placeholder:"Wybierz temat"})}),e.jsxs(de,{children:[e.jsx(B,{value:"all",children:"Wszystkie tematy"}),u?.data?.map(v=>e.jsx(B,{value:v.id.toString(),children:v.title},v.id))]})]}),e.jsxs(me,{value:t,onValueChange:s,children:[e.jsx(ce,{className:"w-[150px]",children:e.jsx(he,{})}),e.jsxs(de,{children:[e.jsx(B,{value:"7d",children:"Ostatnie 7 dni"}),e.jsx(B,{value:"30d",children:"Ostatnie 30 dni"}),e.jsx(B,{value:"90d",children:"Ostatnie 90 dni"})]})]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(Lh,{className:"mr-2 h-4 w-4"}),"Eksportuj"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4 mb-6",children:[e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Średni wynik"}),e.jsx(ze,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[y.avgScore,"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsxs("span",{className:y.avgScoreChange>0?"text-green-600":"text-red-600",children:[y.avgScoreChange>0?e.jsx(It,{className:"inline h-3 w-3"}):e.jsx(Wy,{className:"inline h-3 w-3"})," ",Math.abs(y.avgScoreChange),"%"]})," ","vs. poprzedni okres"]})]})]}),e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Wskaźnik zdawalności"}),e.jsx(Ca,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[y.passRate,"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsxs("span",{className:y.passRateChange>0?"text-green-600":"text-red-600",children:[y.passRateChange>0?"+":"",y.passRateChange,"%"]})," ","vs. poprzedni okres"]})]})]}),e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Liczba podejść"}),e.jsx(dt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:y.totalAttempts}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[y.uniqueStudents," unikalnych uczniów"]})]})]}),e.jsxs(_,{children:[e.jsxs(O,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(L,{className:"text-sm font-medium",children:"Liczba quizów"}),e.jsx(ze,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(P,{children:[e.jsx("div",{className:"text-2xl font-bold",children:y.totalQuizzes}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"aktywnych w okresie"})]})]})]}),e.jsxs(uc,{defaultValue:"distribution",className:"space-y-4",children:[e.jsxs(ro,{children:[e.jsx(Ft,{value:"distribution",children:"Rozkład wyników"}),e.jsx(Ft,{value:"topics",children:"Wyniki według tematów"}),e.jsx(Ft,{value:"trend",children:"Trend w czasie"}),e.jsx(Ft,{value:"difficult",children:"Najtrudniejsze pytania"})]}),e.jsx(Bt,{value:"distribution",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Rozkład wyników"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:300,children:e.jsxs(Ir,{data:N,children:[e.jsx(Mt,{strokeDasharray:"3 3"}),e.jsx(wt,{dataKey:"range"}),e.jsx(ft,{}),e.jsx(Be,{}),e.jsx(li,{dataKey:"count",name:"Liczba wyników",isAnimationActive:!1,children:N.map((v,z)=>e.jsx(cs,{fill:v.color},`cell-${z}`))})]})})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"h-4 w-4 text-orange-600"}),"Quizy wymagające uwagi"]})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:w.slice(0,5).map(v=>e.jsxs("div",{className:"space-y-2 pb-3 border-b last:border-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:v.activityTitle}),e.jsx("p",{className:"text-xs text-muted-foreground",children:v.topicTitle})]}),e.jsxs(H,{variant:v.avgScore<50?"destructive":"secondary",children:[v.avgScore,"%"]})]}),e.jsxs("div",{className:"flex gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Zdawalność: ",v.passRate,"%"]}),e.jsxs("span",{children:["Próby: ",v.attempts]}),e.jsxs("span",{children:["Min/Max: ",v.minScore,"%/",v.maxScore,"%"]})]})]},v.activityId))})})]})]})}),e.jsx(Bt,{value:"topics",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Średnie wyniki według tematów"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:400,children:e.jsxs(ob,{data:A,children:[e.jsx(lb,{}),e.jsx(cb,{dataKey:"topic",tick:{fontSize:12}}),e.jsx(db,{domain:[0,100]}),e.jsx(ub,{name:"Średni wynik",dataKey:"avgScore",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.6,isAnimationActive:!1}),e.jsx(Be,{})]})})})]}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Szczegółowe wyniki"})}),e.jsx(P,{children:e.jsxs(so,{children:[e.jsx(no,{children:e.jsxs(Ys,{children:[e.jsx(Le,{children:"Temat"}),e.jsx(Le,{className:"text-right",children:"Średni wynik"}),e.jsx(Le,{className:"text-right",children:"Liczba prób"})]})}),e.jsx(io,{children:A.map(v=>e.jsxs(Ys,{children:[e.jsx(Oe,{className:"font-medium",children:v.topic}),e.jsx(Oe,{className:"text-right",children:e.jsxs(H,{variant:v.avgScore>=70?"default":"secondary",children:[v.avgScore,"%"]})}),e.jsx(Oe,{className:"text-right",children:v.attempts})]},v.topic))})]})})]})]})}),e.jsx(Bt,{value:"trend",className:"space-y-4",children:e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Trend wyników w czasie"})}),e.jsx(P,{children:e.jsx(Re,{width:"100%",height:400,children:e.jsxs(mb,{data:S,children:[e.jsx(Mt,{strokeDasharray:"3 3"}),e.jsx(wt,{dataKey:"date"}),e.jsx(ft,{}),e.jsx(Be,{}),e.jsx(Xn,{}),e.jsx(Zs,{type:"monotone",dataKey:"maxScore",fill:"#8884d8",stroke:"#8884d8",fillOpacity:.2,name:"Max",isAnimationActive:!1}),e.jsx(Zs,{type:"monotone",dataKey:"minScore",fill:"#82ca9d",stroke:"#82ca9d",fillOpacity:.2,name:"Min",isAnimationActive:!1}),e.jsx(cc,{type:"monotone",dataKey:"avgScore",stroke:"#ff7300",strokeWidth:3,name:"Średnia",dot:{fill:"#ff7300"},isAnimationActive:!1}),e.jsx(li,{dataKey:"attempts",fill:"#ffc658",name:"Liczba prób",yAxisId:"right",isAnimationActive:!1}),e.jsx(ft,{yAxisId:"right",orientation:"right"})]})})})]})}),e.jsx(Bt,{value:"difficult",className:"space-y-4",children:e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"h-5 w-5 text-red-600"}),"Najtrudniejsze pytania"]})}),e.jsxs(P,{children:[e.jsx("div",{className:"space-y-4",children:k.length>0?k.map((v,z)=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(H,{variant:"outline",children:["#",z+1]}),e.jsxs(H,{variant:v.difficulty==="very-hard"?"destructive":v.difficulty==="hard"?"secondary":"default",children:["Quiz: ",v.avgQuizScore,"% średnio"]})]}),e.jsx("p",{className:"text-sm font-medium",children:v.question}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Z quizu: ",v.activityTitle," • ",v.quizAttempts," podejść"]})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Średni wynik quizu"}),e.jsxs("p",{className:"font-medium",children:[v.avgQuizScore,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Liczba podejść"}),e.jsx("p",{className:"font-medium",children:v.quizAttempts})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Poziom trudności"}),e.jsx(H,{variant:v.difficulty==="very-hard"?"destructive":v.difficulty==="hard"?"secondary":v.difficulty==="medium"?"outline":"default",children:v.difficulty==="very-hard"?"Bardzo trudne":v.difficulty==="hard"?"Trudne":v.difficulty==="medium"?"Średnie":"Łatwe"})]})]})]},v.questionId)):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"Brak danych o pytaniach w wybranym okresie."}),e.jsx("p",{className:"text-sm mt-2",children:"Upewnij się, że wybrane quizy mają pytania."})]})}),e.jsx("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"Wskazówka:"})," Rozważ dodanie dodatkowych materiałów lub wyjaśnień do pytań z niskim wskaźnikiem poprawnych odpowiedzi."]})})]})]})})]})]})},x1={name:"reports",list:"/teacher/reports/overview",meta:{label:"Raporty",icon:e.jsx(Ca,{className:"h-4 w-4"})}},ju={name:"reports-engagement",list:"/teacher/reports/engagement",meta:{label:"Zaangażowanie"}},yu={name:"reports-progress",list:"/teacher/reports/progress",meta:{label:"Postępy"}},bu={name:"reports-performance",list:"/teacher/reports/performance",meta:{label:"Wyniki"}},wu={name:"reports-gamification",list:"/teacher/reports/gamification",meta:{label:"Gamifikacja"}},vu={name:"reports-summary",list:"/teacher/reports/summary",meta:{label:"Użytkownicy"}},g1=[e.jsx(V,{path:"reports",element:e.jsx(Qs,{to:"overview",replace:!0})},"reports-root-redirect"),e.jsx(V,{path:"reports/overview",element:e.jsx(d1,{})},"reports-overview"),e.jsx(V,{path:"reports/engagement",element:e.jsx(u1,{})},"reports-engagement"),e.jsx(V,{path:"reports/progress",element:e.jsx(m1,{})},"reports-progress"),e.jsx(V,{path:"reports/performance",element:e.jsx(f1,{})},"reports-performance"),e.jsx(V,{path:"reports/gamification",element:e.jsx(h1,{})},"reports-gamification"),e.jsx(V,{path:"reports/summary",element:e.jsx(p1,{})},"reports-summary")],j1={id:"course-structure-wizard",title:"Kreator struktury kursu",schema:{step1:{title:"Podstawowe informacje o kursie",type:"object",properties:{courseType:{type:"select",title:"Typ kursu",options:[{value:"matura",label:"Kurs maturalny"},{value:"academic",label:"Kurs akademicki"},{value:"professional",label:"Kurs zawodowy"},{value:"hobby",label:"Kurs hobbystyczny"},{value:"certification",label:"Kurs certyfikacyjny"}]},subject:{type:"text",title:"Przedmiot/Dziedzina",placeholder:"np. Matematyka, Programowanie Python, Język angielski"},level:{type:"select",title:"Poziom kursu",options:[{value:"basic",label:"Podstawowy"},{value:"extended",label:"Rozszerzony"},{value:"beginner",label:"Początkujący"},{value:"intermediate",label:"Średniozaawansowany"},{value:"advanced",label:"Zaawansowany"}]},duration:{type:"select",title:"Planowany czas trwania",options:[{value:"1month",label:"1 miesiąc"},{value:"3months",label:"3 miesiące"},{value:"6months",label:"6 miesięcy"},{value:"1year",label:"1 rok"},{value:"2years",label:"2 lata"}]},curriculum:{type:"textarea",title:"Podstawa programowa",placeholder:"Opcjonalnie - wklej podstawę programową"}},required:["courseType","subject","level","duration"]},step2:{title:"Analiza wymagań",type:"object",properties:{courseTitle:{type:"text",title:"Proponowany tytuł kursu",readOnly:!0},description:{type:"textarea",title:"Opis kursu",readOnly:!0},objectives:{type:"tags",title:"Cele kursu",readOnly:!0},targetAudience:{type:"text",title:"Grupa docelowa",readOnly:!0},prerequisites:{type:"tags",title:"Wymagania wstępne",readOnly:!0},estimatedHours:{type:"number",title:"Szacowana liczba godzin",readOnly:!0},topicsCount:{type:"number",title:"Liczba głównych tematów",readOnly:!0}}},step3:{title:"Dostosowanie struktury",type:"object",properties:{courseTitle:{type:"text",title:"Tytuł kursu",placeholder:"np. Matematyka - Przygotowanie do matury"},description:{type:"textarea",title:"Opis kursu",rows:4},topicsPerWeek:{type:"number",title:"Liczba tematów na tydzień",min:1,max:7}},required:["courseTitle","description","topicsPerWeek"]},step4:{title:"Podgląd struktury",type:"object",properties:{structure:{type:"array",title:"Struktura kursu",readOnly:!0}}},step5:{title:"Tworzenie kursu",type:"object",properties:{courseName:{type:"text",title:"Ostateczna nazwa kursu"},iconEmoji:{type:"text",title:"Emoji ikona",placeholder:"np. 📚 📐 🎓"},isPublished:{type:"checkbox",title:"Opublikuj od razu"}},required:["courseName"]}}},y1={id:"analyze-course-requirements",name:"Analiza wymagań kursu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od projektowania kursów edukacyjnych i programów nauczania.",user:`
Przeanalizuj wymagania dla kursu:
Typ: {{courseType}}
Przedmiot: {{subject}}
Poziom: {{level}}
Czas trwania: {{duration}}
{{#if curriculum}}
Podstawa programowa/Sylabus:
{{curriculum}}
{{/if}}

Wygeneruj JSON:
{
  "courseTitle": "<tytuł kursu odpowiedni do typu i poziomu>",
  "description": "<szczegółowy opis kursu 100-200 słów>",
  "objectives": ["cel1", "cel2", "cel3", "cel4", "cel5"],
  "targetAudience": "<opis grupy docelowej>",
  "prerequisites": ["wymaganie1", "wymaganie2"],
  "estimatedHours": <liczba godzin>,
  "topicsCount": <liczba głównych tematów>
}

Wymagania:
{{#if curriculum}}
- ŚCIŚLE przestrzegaj podanej podstawy programowej/sylabusa
- Uwzględnij wszystkie wymagania szczegółowe
{{/if}}
- Dla kursów maturalnych: zgodność z wymaganiami egzaminacyjnymi
- CourseTitle: profesjonalny i opisowy
- Description: zawiera zakres materiału i metodykę
- Objectives: 5-8 konkretnych, mierzalnych celów
- Prerequisites: realistyczne wymagania (może być pusta tablica)
- EstimatedHours: realistyczna liczba godzin
- TopicsCount: odpowiednia liczba tematów do czasu trwania
    `,responseFormat:"json"},inputMapping:t=>({courseType:t.courseType,subject:t.subject,level:t.level,duration:t.duration,curriculum:t.curriculum||""}),outputMapping:(t,s)=>({...s,courseTitle:t.courseTitle,description:t.description,objectives:t.objectives,targetAudience:t.targetAudience,prerequisites:t.prerequisites,estimatedHours:t.estimatedHours,topicsCount:t.topicsCount}),validation:t=>!!(t.courseTitle&&t.description&&t.objectives&&t.topicsCount)},b1={id:"generate-course-structure",name:"Generowanie struktury kursu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od tworzenia programów nauczania. Tworzysz TYLKO listę tematów z tytułami i krótkimi opisami.",user:`
    Stwórz listę tematów dla kursu:
    
    Tytuł: {{courseTitle}}
    Opis: {{description}}
    Przedmiot: {{subject}}
    Poziom: {{level}}
    Typ: {{courseType}}
    Tematy na tydzień: {{topicsPerWeek}}
    {{#if curriculum}}
    Podstawa programowa:
    {{curriculum}}
    {{/if}}
    
    Wygeneruj TYLKO TEMATY - sam tytuł i krótki opis. NIE dodawaj ćwiczeń, quizów, materiałów.
    {{#if curriculum}}
    MUSISZ uwzględnić wszystkie zagadnienia z podstawy programowej.
    {{/if}}
    
    Wygeneruj JSON:
    {
      "structure": [
        {
          "weekNumber": 1,
          "topics": [
            {
              "title": "<tytuł tematu>",
              "description": "<krótki opis tematu - max 2 zdania>"
            }
          ]
        }
      ],
      "summary": {
        "totalWeeks": <liczba>,
        "totalTopics": <liczba>
      }
    }
    
    Wygeneruj 4-8 tygodni w zależności od kursu. Każdy tydzień ma {{topicsPerWeek}} tematów.
    Tematy powinny tworzyć logiczną progresję od podstaw do zaawansowanych.
    `,responseFormat:"json"},inputMapping:t=>({courseTitle:t.courseTitle,description:t.description,subject:t.subject,level:t.level,courseType:t.courseType,topicsPerWeek:t.topicsPerWeek,curriculum:t.curriculum||""}),outputMapping:(t,s)=>({...s,structure:t.structure,summary:t.summary}),validation:t=>!!(t.structure&&Array.isArray(t.structure)&&t.structure.length>0)},Rt={subject:{minLength:3,errorMessage:"Przedmiot jest wymagany (3-100 znaków)"},courseTitle:{minLength:5,errorMessage:"Tytuł jest wymagany (5-200 znaków)"},description:{minLength:50,errorMessage:"Opis jest wymagany (50-1000 znaków)"},topicsPerWeek:{min:1,max:7,errorMessage:"Liczba tematów na tydzień musi być między 1 a 7"}},yi={steps:{1:{title:"Jaki kurs chcesz stworzyć?",description:"Określ typ, przedmiot i poziom - AI stworzy kompletną strukturę kursu",button:"Analizuj wymagania",loading:"Analizuję wymagania..."},2:{title:"Analiza wymagań kursu",description:"AI przeanalizowała wymagania i zaproponowała parametry kursu",success:"✓ Analiza zakończona pomyślnie"},3:{title:"Podstawowe informacje o kursie",description:"Podaj tytuł, opis i tempo nauki",button:"Generuj tematy",loading:"Generuję tematy...",loadingInfo:"⚡ AI tworzy listę tematów kursu..."},4:{title:"Edycja struktury kursu",description:"Możesz dodać lub usunąć tematy przed utworzeniem kursu"},5:{title:"Tworzenie kursu",description:"Ostatnie poprawki przed utworzeniem kursu",saveInfo:"💾 Zostanie utworzony kurs z listą tematów. Materiały i quizy możesz dodać później.",button:"Utwórz kurs",loading:"Tworzę kurs...",success:"✓ Kurs został utworzony pomyślnie! Przekierowuję..."}},dashboard:{title:"Generator struktury kursu",description:"Twórz kompletne kursy z pomocą AI"},errors:{subjectRequired:"Podaj przedmiot kursu",analysisError:"Błąd analizy wymagań:",generationError:"Błąd generowania struktury:",saveError:"Wystąpił błąd podczas tworzenia kursu",unexpectedError:"Wystąpił nieoczekiwany błąd"}},_t={dashboard:"/teacher/course-structure",step1:"/teacher/course-structure/step1",step2:"/teacher/course-structure/step2",step3:"/teacher/course-structure/step3",step4:"/teacher/course-structure/step4",step5:"/teacher/course-structure/step5",courses:"/teacher/courses"},w1=()=>{const t=J(),{getData:s}=Ke(),{data:n}=gt(),[i,r]=g.useState(!1),a=s("course-structure-wizard"),{dashboard:o}=yi,{data:l}=ie({resource:"courses",pagination:{mode:"off"},filters:n?.vendor_id?[{field:"vendor_id",operator:"eq",value:n.vendor_id}]:[],meta:{select:"*, topics(count)"}}),c=l?.data||[],d=a&&a.courseTitle;return e.jsxs(K,{children:[e.jsx(ve,{title:o.title,description:o.description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs(_,{className:"hover:shadow-lg transition-all cursor-pointer border-2 hover:border-purple-400 flex flex-col",onClick:()=>t(_t.step1),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(pi,{className:"w-8 h-8 text-purple-600"})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400"})]}),e.jsx(L,{children:"Stwórz nowy kurs"}),e.jsx(Me,{children:"Wygeneruj kompletną strukturę kursu od podstaw"})]}),e.jsxs(P,{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"15-20 minut"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"Pełna struktura"})]})]}),e.jsx("div",{className:"mt-auto pt-4",children:e.jsxs("div",{className:"inline-flex items-center text-sm font-medium text-purple-600",children:["Rozpocznij tworzenie",e.jsx(ae,{className:"w-4 h-4 ml-1"})]})})]})]}),e.jsxs(_,{className:"hover:shadow-lg transition-all cursor-pointer border-2 hover:border-blue-400 flex flex-col",onClick:()=>r(!i),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(Ta,{className:"w-8 h-8 text-blue-600"})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400"})]}),e.jsx(L,{children:"Rozwiń istniejący kurs"}),e.jsx(Me,{children:"Dodaj nowe tematy do istniejącego kursu z pomocą AI"})]}),e.jsxs(P,{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"Dodaj tematy"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Kt,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"Rozszerz program"})]})]}),e.jsx("div",{className:"mt-auto pt-4",children:e.jsxs("div",{className:"inline-flex items-center text-sm font-medium text-blue-600",children:["Wybierz kurs",e.jsx(ae,{className:"w-4 h-4 ml-1"})]})})]})]})]}),i&&c.length>0&&e.jsxs(_,{className:"border-2 border-blue-200",children:[e.jsxs(O,{children:[e.jsx(L,{children:"Wybierz kurs do rozszerzenia"}),e.jsx(Me,{children:"Kliknij na kurs, aby dodać nowe tematy z pomocą AI"})]}),e.jsx(P,{children:e.jsx("div",{className:"space-y-2",children:c.map(m=>e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-gray-50 cursor-pointer flex justify-between items-center",onClick:()=>t(`/teacher/course-structure/edit/${m.id}`),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:m.icon_emoji}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:m.title}),e.jsxs("p",{className:"text-sm text-gray-600",children:[m.topics?.[0]?.count||0," tematów"]})]})]}),e.jsx(ae,{className:"w-5 h-5 text-gray-400"})]},m.id))})})]}),d&&e.jsxs(_,{className:"hover:shadow-lg transition-shadow border-2 border-gray-200",children:[e.jsx(O,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-lg",children:"Ostatnia struktura"}),e.jsx(Me,{children:"Kontynuuj pracę nad swoim kursem"})]}),e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Wygenerowana"})]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tytuł kursu"}),e.jsx("p",{className:"font-medium text-gray-900",children:a.courseTitle})]}),a.subject&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Przedmiot"}),e.jsx("p",{className:"text-gray-900",children:a.subject})]}),a.summary&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-3 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:a.summary.totalWeeks}),e.jsx("div",{className:"text-sm text-gray-600",children:"tygodni"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:a.summary.totalTopics}),e.jsx("div",{className:"text-sm text-gray-600",children:"tematów"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsxs(I,{variant:"outline",onClick:()=>t(_t.step4),className:"flex-1",children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Podgląd"]}),e.jsxs(I,{variant:"outline",onClick:()=>t(_t.step3),className:"flex-1",children:[e.jsx(Ta,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),e.jsxs(I,{variant:"outline",onClick:()=>t(_t.step1),className:"flex-1",children:[e.jsx(ai,{className:"w-4 h-4 mr-2"}),"Nowa"]})]})]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(_,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-blue-200 group",onClick:()=>t("/teacher/courses"),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(xe,{className:"w-6 h-6 text-blue-600"})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(L,{className:"text-lg",children:"Kursy"}),e.jsx(Me,{children:"Zobacz wszystkie kursy"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-blue-600 transition-colors",children:"Kliknij aby przejść →"})})]}),e.jsxs(_,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-purple-200 group",onClick:()=>t("/teacher/educational-material"),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(bn,{className:"w-6 h-6 text-purple-600"})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(L,{className:"text-lg",children:"Materiały"}),e.jsx(Me,{children:"Kreator materiałów"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-purple-600 transition-colors",children:"Kliknij aby przejść →"})})]}),e.jsxs(_,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-green-200 group",onClick:()=>t("/teacher/quiz-wizard"),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(Kt,{className:"w-6 h-6 text-green-600"})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(L,{className:"text-lg",children:"Quizy"}),e.jsx(Me,{children:"Kreator quizów"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-green-600 transition-colors",children:"Kliknij aby przejść →"})})]})]})]})]})},$r=({step:t})=>{const s=J(),n=t/5*100;return e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>s("/teacher/course-structure"),children:e.jsx(vt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-violet-600 text-white p-8 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-4xl font-black tracking-tight",children:"GENERATOR KURSU"}),e.jsxs("h2",{className:"text-2xl font-light",children:["Zaprojektujmy ",e.jsx("span",{className:"font-bold",children:"strukturę kursu"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Krok ",t," z 5"]}),e.jsxs("span",{children:[n,"%"]})]}),e.jsx(ds,{value:n,className:"h-2 bg-purple-300"})]})]})]})},qr=({title:t,description:s})=>e.jsxs("header",{className:"mb-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:t}),e.jsx("p",{className:"text-gray-600",children:s})]}),v1=()=>{const t=J(),{register:s,setData:n}=Ke(),[i,r]=g.useState(""),[a,o]=g.useState(""),[l,c]=g.useState(""),[d,m]=g.useState(""),[u,h]=g.useState(""),[p,b]=g.useState({}),f=Tn("course-structure-wizard","analyze-course-requirements"),{steps:x,errors:w}=yi;g.useEffect(()=>(s(j1),f.registerOperation(y1),()=>{f.unregisterOperation()}),[]);const y=()=>{const S={};return i||(S.courseType="Wybierz typ kursu"),(!a.trim()||a.length<Rt.subject.minLength)&&(S.subject=Rt.subject.errorMessage),l||(S.level="Wybierz poziom kursu"),d||(S.duration="Wybierz czas trwania"),b(S),Object.keys(S).length===0},N=async()=>{if(y())try{const S={courseType:i,subject:a.trim(),level:l,duration:d,curriculum:u.trim()};n("course-structure-wizard",S),await f.executeOperation(S),t(_t.step2)}catch(S){console.error(w.analysisError,S)}},A=i==="matura"||i==="academic";return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx($r,{step:1}),e.jsxs(P,{className:"p-8",children:[e.jsx(qr,{title:x[1].title,description:x[1].description}),f.error&&e.jsxs(ge,{variant:"destructive",className:"mb-6",children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsxs(je,{children:[w.analysisError," ",f.error]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"courseType",children:"Typ kursu"}),e.jsxs(me,{value:i,onValueChange:r,disabled:f.loading,children:[e.jsx(ce,{className:p.courseType?"border-red-500":"",children:e.jsx(he,{placeholder:"Wybierz typ kursu..."})}),e.jsxs(de,{children:[e.jsx(B,{value:"matura",children:"Kurs maturalny"}),e.jsx(B,{value:"academic",children:"Kurs akademicki"}),e.jsx(B,{value:"professional",children:"Kurs zawodowy"}),e.jsx(B,{value:"hobby",children:"Kurs hobbystyczny"}),e.jsx(B,{value:"certification",children:"Kurs certyfikacyjny"})]})]}),p.courseType&&e.jsx("p",{className:"text-sm text-red-600",children:p.courseType})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"subject",children:"Przedmiot/Dziedzina"}),e.jsx(Q,{id:"subject",type:"text",value:a,onChange:S=>o(S.target.value),placeholder:"np. Matematyka, Programowanie Python, Język angielski",disabled:f.loading,className:p.subject?"border-red-500":""}),p.subject&&e.jsx("p",{className:"text-sm text-red-600",children:p.subject})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"level",children:"Poziom kursu"}),e.jsxs(me,{value:l,onValueChange:c,disabled:f.loading,children:[e.jsx(ce,{className:p.level?"border-red-500":"",children:e.jsx(he,{placeholder:"Wybierz poziom..."})}),e.jsx(de,{children:i==="matura"?e.jsxs(e.Fragment,{children:[e.jsx(B,{value:"basic",children:"Podstawowy"}),e.jsx(B,{value:"extended",children:"Rozszerzony"})]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{value:"beginner",children:"Początkujący"}),e.jsx(B,{value:"intermediate",children:"Średniozaawansowany"}),e.jsx(B,{value:"advanced",children:"Zaawansowany"})]})})]}),p.level&&e.jsx("p",{className:"text-sm text-red-600",children:p.level})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"duration",children:"Planowany czas trwania"}),e.jsxs(me,{value:d,onValueChange:m,disabled:f.loading,children:[e.jsx(ce,{className:p.duration?"border-red-500":"",children:e.jsx(he,{placeholder:"Wybierz czas trwania..."})}),e.jsxs(de,{children:[e.jsx(B,{value:"1month",children:"1 miesiąc"}),e.jsx(B,{value:"3months",children:"3 miesiące"}),e.jsx(B,{value:"6months",children:"6 miesięcy"}),e.jsx(B,{value:"1year",children:"1 rok"}),e.jsx(B,{value:"2years",children:"2 lata"})]})]}),p.duration&&e.jsx("p",{className:"text-sm text-red-600",children:p.duration})]}),A&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"curriculum",children:["Podstawa programowa",e.jsx("span",{className:"text-gray-500 text-sm ml-2",children:"(opcjonalnie [TODO] uzupełnij DB o zarządzanie podstawą programową)"})]}),e.jsx(Nt,{id:"curriculum",value:u,onChange:S=>h(S.target.value),placeholder:i==="matura"?"Wklej fragmenty podstawy programowej MEN, które chcesz uwzględnić w kursie...":"Wklej sylabus lub program nauczania...",disabled:f.loading,rows:4,className:"font-mono text-sm"}),e.jsxs(ge,{className:"bg-blue-50 border-blue-200",children:[e.jsx(es,{className:"h-4 w-4 text-blue-600"}),e.jsx(je,{className:"text-blue-800 text-sm",children:i==="matura"?"Dodanie podstawy programowej pomoże AI stworzyć kurs zgodny z wymaganiami egzaminacyjnymi.":"Dodanie sylabusa pomoże AI lepiej dopasować tematy do wymagań uczelni."})]})]}),e.jsx(I,{onClick:N,disabled:f.loading,className:"w-full bg-purple-600 hover:bg-purple-700 text-white",size:"lg",children:f.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),x[1].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),x[1].button]})})]})]})]})})},N1=()=>{const t=J(),{getData:s}=Ke(),n=s("course-structure-wizard"),{steps:i}=yi;return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx($r,{step:2}),e.jsxs(P,{className:"p-8",children:[e.jsx(qr,{title:i[2].title,description:i[2].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ge,{className:"bg-green-50 border-green-200",children:[e.jsx(st,{className:"h-4 w-4 text-green-600"}),e.jsx(je,{className:"text-green-800",children:i[2].success})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"bg-gray-50 border-gray-200",children:e.jsxs(P,{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Proponowany tytuł"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:n.courseTitle})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Opis kursu"}),e.jsx("div",{className:"text-gray-800 whitespace-pre-wrap",children:n.description})]})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(_,{className:"border-purple-200 bg-purple-50/50",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ze,{className:"w-5 h-5 text-purple-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Cele kursu"}),e.jsx("ul",{className:"space-y-1",children:n.objectives?.map((r,a)=>e.jsxs("li",{className:"text-sm text-gray-700",children:["• ",r]},a))})]})]})})}),e.jsx(_,{className:"border-blue-200 bg-blue-50/50",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Pe,{className:"w-5 h-5 text-blue-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Grupa docelowa"}),e.jsx("p",{className:"text-sm text-gray-700",children:n.targetAudience})]})]})})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsx(_,{children:e.jsxs(P,{className:"p-4 text-center",children:[e.jsx(Se,{className:"w-8 h-8 text-indigo-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.estimatedHours}),e.jsx("div",{className:"text-sm text-gray-600",children:"godzin"})]})}),e.jsx(_,{children:e.jsxs(P,{className:"p-4 text-center",children:[e.jsx(xe,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.topicsCount}),e.jsx("div",{className:"text-sm text-gray-600",children:"tematów"})]})}),e.jsx(_,{children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Wymagania"}),n.prerequisites?.length>0?e.jsx("ul",{className:"space-y-1",children:n.prerequisites.map((r,a)=>e.jsxs("li",{className:"text-sm text-gray-700",children:["• ",r]},a))}):e.jsx("span",{className:"text-sm text-gray-500",children:"Brak wymagań"})]})})]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(_t.step1),children:"Wstecz"}),e.jsx(I,{onClick:()=>t(_t.step3),className:"bg-purple-600 hover:bg-purple-700",children:"Kontynuuj"})]})]})]})]})})},k1=()=>{const t=J(),{getData:s,setData:n}=Ke(),i=s("course-structure-wizard"),[r,a]=g.useState(i.courseTitle||""),[o,l]=g.useState(i.description||""),[c,d]=g.useState(2),[m,u]=g.useState({}),h=Tn("course-structure-wizard","generate-course-structure"),{steps:p,errors:b}=yi;g.useEffect(()=>(h.registerOperation(b1),()=>{h.unregisterOperation()}),[]);const f=()=>{const w={};return(!r.trim()||r.length<Rt.courseTitle.minLength)&&(w.courseTitle=Rt.courseTitle.errorMessage),(!o.trim()||o.length<Rt.description.minLength)&&(w.description=Rt.description.errorMessage),(!c||c<Rt.topicsPerWeek.min||c>Rt.topicsPerWeek.max)&&(w.topicsPerWeek=Rt.topicsPerWeek.errorMessage),u(w),Object.keys(w).length===0},x=async()=>{if(f())try{const w={...i,courseTitle:r.trim(),description:o.trim(),topicsPerWeek:c};n("course-structure-wizard",w),await h.executeOperation(w),t(_t.step4)}catch(w){console.error(b.generationError,w)}};return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx($r,{step:3}),e.jsxs(P,{className:"p-8",children:[e.jsx(qr,{title:p[3].title,description:p[3].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"courseTitle",children:["Tytuł kursu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Q,{id:"courseTitle",value:r,onChange:w=>a(w.target.value),placeholder:"np. Matematyka - Przygotowanie do matury",className:m.courseTitle?"border-red-500":""}),m.courseTitle&&e.jsx("p",{className:"text-sm text-red-600",children:m.courseTitle})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"description",children:["Opis kursu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Nt,{id:"description",value:o,onChange:w=>l(w.target.value),placeholder:"Szczegółowy opis kursu...",rows:4,className:m.description?"border-red-500":""}),m.description&&e.jsx("p",{className:"text-sm text-red-600",children:m.description}),e.jsxs("p",{className:"text-sm text-gray-500",children:[o.length," / ",Rt.description.minLength," znaków minimum"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"topicsPerWeek",children:["Liczba tematów na tydzień ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Q,{id:"topicsPerWeek",type:"number",value:c,onChange:w=>d(parseInt(w.target.value)||0),min:Rt.topicsPerWeek.min,max:Rt.topicsPerWeek.max,className:m.topicsPerWeek?"border-red-500":""}),m.topicsPerWeek&&e.jsx("p",{className:"text-sm text-red-600",children:m.topicsPerWeek}),e.jsx("p",{className:"text-sm text-gray-500",children:"Określa tempo realizacji kursu"})]}),h.loading&&e.jsxs(ge,{className:"bg-purple-50 border-purple-200",children:[e.jsx(es,{className:"h-4 w-4 text-purple-600"}),e.jsx(je,{className:"text-purple-800",children:p[3].loadingInfo})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(_t.step2),children:"Wstecz"}),e.jsx(I,{onClick:x,disabled:h.loading,className:"bg-purple-600 hover:bg-purple-700",children:h.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),p[3].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),p[3].button]})})]})]})]})]})})},z1=()=>{const t=J(),{getData:s}=Ke(),n=s("course-structure-wizard"),{steps:i}=yi,r=n.structure||[];return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx($r,{step:4}),e.jsxs(P,{className:"p-8",children:[e.jsx(qr,{title:e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"w-8 h-8 text-purple-600"}),e.jsx("span",{children:i[4].title})]}),description:i[4].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"bg-gradient-to-r from-purple-50 to-violet-50 border-purple-200",children:e.jsxs(P,{className:"p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-3",children:n.courseTitle}),e.jsx("p",{className:"text-gray-600 mb-6",children:n.description}),n.summary&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Kt,{className:"w-8 h-8 text-indigo-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:r.length||n.summary.totalWeeks}),e.jsx("div",{className:"text-sm text-gray-600",children:"tygodni"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(xe,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:r.reduce((a,o)=>a+o.topics.length,0)}),e.jsx("div",{className:"text-sm text-gray-600",children:"tematów"})]})]})]})}),e.jsx("h4",{className:"font-semibold text-lg",children:"Struktura kursu - podgląd"}),e.jsx("div",{className:"space-y-4",children:r?.map((a,o)=>e.jsxs(_,{className:"overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Kt,{className:"w-5 h-5 text-indigo-600"}),e.jsxs("h5",{className:"font-medium",children:["Tydzień ",a.weekNumber]}),e.jsxs(H,{variant:"secondary",children:[a.topics.length," ",a.topics.length===1?"temat":"tematów"]})]})}),e.jsx(P,{className:"p-4 space-y-3",children:a.topics.map((l,c)=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border-l-4 border-purple-200",children:[e.jsx("h6",{className:"font-medium text-gray-900 mb-2",children:l.title}),l.description&&e.jsx("p",{className:"text-sm text-gray-600",children:l.description})]},c))})]},o))}),e.jsxs(ge,{className:"bg-blue-50 border-blue-200",children:[e.jsx(es,{className:"h-4 w-4 text-blue-600"}),e.jsx(je,{className:"text-blue-800",children:"Po utworzeniu kursu będziesz mógł dodawać nowe tematy w dowolnym momencie korzystając z generatora AI."})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(_t.step3),children:"Wstecz"}),e.jsx(I,{onClick:()=>t(_t.step5),className:"bg-purple-600 hover:bg-purple-700",children:"Przejdź do utworzenia kursu"})]})]})]})]})})},S1=()=>{const t=J(),{getData:s,setData:n}=Ke(),{mutate:i}=fs(),{mutate:r}=fs(),{data:a}=gt(),o=s("course-structure-wizard"),[l,c]=g.useState(o.courseTitle||""),[d,m]=g.useState("📚"),[u,h]=g.useState(!1),[p,b]=g.useState(!1),[f,x]=g.useState(!1),{steps:w,errors:y}=yi,N=async()=>{if(!l.trim()){W.error("Nazwa kursu jest wymagana");return}if(!a?.vendor_id){W.error("Brak informacji o vendor_id. Skontaktuj się z administratorem.");return}b(!0),x(!1);try{i({resource:"courses",values:{vendor_id:a.vendor_id,title:l.trim(),description:o.description,icon_emoji:d,is_published:u}},{onSuccess:async S=>{const k=S.data.id;let v=1;try{for(const z of o.structure)for(const D of z.topics)await new Promise((j,C)=>{r({resource:"topics",values:{course_id:k,title:D.title,position:v++,is_published:!1}},{onSuccess:j,onError:C})});n("course-structure-wizard",{...o,courseName:l.trim(),courseId:k,saved:!0}),b(!1),x(!0),setTimeout(()=>{t(`${_t.courses}/show/${k}`)},2e3)}catch(z){b(!1),console.error("Błąd podczas tworzenia tematów:",z),W.error("Wystąpił błąd podczas tworzenia struktury kursu")}},onError:S=>{b(!1),console.error(y.saveError,S),S?.code==="42501"?W.error("Brak uprawnień do tworzenia kursów. Sprawdź swoje uprawnienia."):S?.code==="23505"?W.error("Kurs o takiej nazwie już istnieje."):W.error(y.saveError)}})}catch(S){b(!1),console.error(y.unexpectedError,S),W.error(y.unexpectedError)}},A=()=>{switch(o.courseType){case"matura":return"🎓";case"academic":return"🏛️";case"professional":return"💼";case"hobby":return"🎨";case"certification":return"📜";default:return"📚"}};return te.useEffect(()=>{m(A())},[o.courseType]),e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx($r,{step:5}),e.jsxs(P,{className:"p-8",children:[e.jsx(qr,{title:e.jsxs(e.Fragment,{children:[e.jsx(ri,{className:"w-8 h-8 text-purple-600"}),e.jsx("span",{children:w[5].title})]}),description:w[5].description}),f&&e.jsxs(ge,{className:"mb-6 bg-green-50 border-green-200",children:[e.jsx(st,{className:"h-4 w-4 text-green-600"}),e.jsx(je,{className:"text-green-800",children:w[5].success})]}),e.jsxs("form",{className:"space-y-6",onSubmit:S=>{S.preventDefault(),N()},children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"courseName",children:["Nazwa kursu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Q,{id:"courseName",type:"text",value:l,onChange:S=>c(S.target.value),placeholder:"np. Matematyka - Kurs maturalny poziom rozszerzony"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"iconEmoji",children:"Emoji ikona"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Q,{id:"iconEmoji",type:"text",value:d,onChange:S=>m(S.target.value),placeholder:"np. 📚 📐 🎓",className:"flex-1",maxLength:5}),e.jsx("div",{className:"flex gap-1",children:["📚","🎓","📐","🏛️","💼","🎨","📜","🚀"].map(S=>e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:()=>m(S),className:"w-10 h-10 hover:bg-purple-50",children:S},S))})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Wybierz emoji z listy lub wpisz własne"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xt,{id:"isPublished",checked:u,onCheckedChange:S=>h(S)}),e.jsx("label",{htmlFor:"isPublished",className:"text-sm cursor-pointer",children:"Opublikuj kurs od razu (uczniowie będą mogli go zobaczyć)"})]}),e.jsx(_,{className:"bg-gradient-to-r from-purple-50 to-violet-50 border-purple-200",children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Co zostanie utworzone:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(st,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:['Kurs "',l||o.courseTitle,'" z pełnym opisem']})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(st,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[o.summary?.totalTopics||0," tematów rozłożonych na ",o.summary?.totalWeeks||0," tygodni"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(st,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsx("span",{children:"Struktura gotowa do wypełnienia materiałami i quizami"})]})]})]})}),e.jsx(ge,{className:"bg-purple-50 border-purple-200",children:e.jsx(je,{className:"text-purple-800",children:w[5].saveInfo})}),e.jsx(fi,{}),e.jsxs("footer",{className:"flex justify-between gap-4",children:[e.jsxs(I,{type:"button",variant:"outline",onClick:()=>t(_t.step4),disabled:p,className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"Wstecz"]}),e.jsx(I,{type:"submit",disabled:p||f,className:"flex items-center gap-2 min-w-[160px] bg-purple-600 hover:bg-purple-700",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),w[5].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(Dr,{className:"w-4 h-4"}),w[5].button]})})]})]})]})]})})},C1=()=>{const{id:t}=ut(),s=J(),[n,i]=g.useState(""),[r,a]=g.useState(1),[o,l]=g.useState([]),{data:c,isLoading:d}=Ue({resource:"courses",id:t}),{data:m,refetch:u}=ie({resource:"topics",filters:[{field:"course_id",operator:"eq",value:t}],sorters:[{field:"position",order:"asc"}]}),h=c?.data,p=m?.data||[],b=Tn("course-structure-edit","add-new-topics"),{mutate:f}=fs();g.useEffect(()=>(b.registerOperation({id:"add-new-topics",name:"Dodawanie nowych tematów",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od rozszerzania programów nauczania. Dodajesz nowe tematy zachowując spójność z istniejącym kursem.",user:`
Kurs: {{courseTitle}}
Opis: {{courseDescription}}
Istniejące tematy: {{existingTopics}}

Wymagania użytkownika: {{requirements}}
Numer tygodnia dla nowych tematów: {{weekNumber}}

Wygeneruj 2-5 nowych tematów które:
1. Są spójne z dotychczasowym programem
2. Rozszerzają kurs o nowe zagadnienia
3. Zachowują odpowiedni poziom trudności
4. Nie duplikują istniejących tematów

JSON:
{
  "newTopics": [
    {
      "title": "<tytuł tematu>",
      "description": "<opis 1-2 zdania>",
      "weekNumber": {{weekNumber}}
    }
  ],
  "reasoning": "<wyjaśnienie dlaczego te tematy są odpowiednie>"
}
        `,responseFormat:"json"},inputMapping:y=>{const N=c?.data,A=m?.data||[];return{courseTitle:N?.title||"",courseDescription:N?.description||"",existingTopics:A.map(S=>S.title).join(", "),requirements:y.requirements,weekNumber:y.weekNumber}},outputMapping:y=>y,validation:y=>!!(y.newTopics&&Array.isArray(y.newTopics))}),()=>{b.unregisterOperation()}),[]);const x=async()=>{if(!n.trim()){W.error("Opisz jakie tematy chcesz dodać");return}try{const y=await b.executeOperation({requirements:n,weekNumber:r});y?.newTopics&&(l(y.newTopics),W.success(`Wygenerowano ${y.newTopics.length} nowych tematów`))}catch(y){console.error("Błąd generowania tematów:",y),W.error("Wystąpił błąd podczas generowania tematów")}},w=async()=>{if(o.length!==0)try{let y=p.length+1;for(const N of o)await new Promise((A,S)=>{f({resource:"topics",values:{course_id:t,title:N.title,position:y++,is_published:!1}},{onSuccess:A,onError:S})});W.success("Tematy zostały dodane do kursu"),await u(),l([]),i("")}catch(y){console.error("Błąd zapisywania tematów:",y),W.error("Wystąpił błąd podczas zapisywania tematów")}};return d?e.jsx(K,{children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})})}):e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx(O,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:h?.icon_emoji}),"Rozszerzanie kursu: ",h?.title]}),e.jsxs(I,{variant:"ghost",onClick:()=>s(-1),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Powrót"]})]})}),e.jsxs(P,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium mb-3",children:["Obecna struktura kursu (",p.length," tematów)"]}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto border rounded-lg p-3",children:p.map((y,N)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm text-gray-500 font-mono",children:["#",N+1]}),e.jsx("span",{className:"font-medium",children:y.title})]},y.id))})]}),e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsx("h3",{className:"font-medium",children:"Dodaj nowe tematy z pomocą AI"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{children:"Opisz jakie tematy chcesz dodać"}),e.jsx(Nt,{value:n,onChange:y=>i(y.target.value),placeholder:"np. Dodaj zaawansowane tematy z analizy matematycznej, całki i pochodne, lub tematy związane z uczeniem maszynowym...",rows:4,className:"font-sans"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{children:"Tydzień dla nowych tematów"}),e.jsx(Q,{type:"number",value:r,onChange:y=>a(parseInt(y.target.value)||1),className:"w-24",min:"1"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Określ, w którym tygodniu mają się znaleźć nowe tematy"})]}),e.jsxs(ge,{className:"bg-blue-50 border-blue-200",children:[e.jsx(es,{className:"h-4 w-4 text-blue-600"}),e.jsx(je,{className:"text-blue-800",children:"AI przeanalizuje istniejący kurs i zaproponuje nowe tematy które naturalnie rozszerzają program"})]}),e.jsx(I,{onClick:x,disabled:b.loading||!n.trim(),className:"w-full bg-purple-600 hover:bg-purple-700",children:b.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Generuję tematy..."]}):e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),"Generuj tematy"]})})]}),o.length>0&&e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsxs("h3",{className:"font-medium",children:["Wygenerowane tematy (Tydzień ",r,")"]}),e.jsx("div",{className:"space-y-2",children:o.map((y,N)=>e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:[e.jsx("h4",{className:"font-medium text-purple-900",children:y.title}),y.description&&e.jsx("p",{className:"text-sm text-purple-700 mt-1",children:y.description})]},N))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(I,{variant:"outline",onClick:()=>l([]),className:"flex-1",children:"Anuluj"}),e.jsxs(I,{onClick:w,className:"flex-1 bg-green-600 hover:bg-green-700",children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Dodaj tematy do kursu"]})]})]})]})]})})},T1=[e.jsx(V,{path:"/course-structure",element:e.jsx(w1,{})},"course-dashboard"),e.jsx(V,{path:"/course-structure/step1",element:e.jsx(v1,{})},"course-step1"),e.jsx(V,{path:"/course-structure/step2",element:e.jsx(N1,{})},"course-step2"),e.jsx(V,{path:"/course-structure/step3",element:e.jsx(k1,{})},"course-step3"),e.jsx(V,{path:"/course-structure/step4",element:e.jsx(z1,{})},"course-step4"),e.jsx(V,{path:"/course-structure/step5",element:e.jsx(S1,{})},"course-step5"),e.jsx(V,{path:"/course-structure/edit/:id",element:e.jsx(C1,{})},"course-edit")],Nu={name:"course-structure",list:"/course-structure",create:"/course-structure/step1",meta:{canDelete:!1,label:"Generator kursów",icon:e.jsx(Pr,{className:"h-4 w-4"})}},A1={id:"educational-material-wizard",title:"Kreator materiałów edukacyjnych",schema:{step1:{title:"Podstawowe informacje",type:"object",properties:{subject:{type:"text",title:"Temat materiału",placeholder:"np. Wprowadzenie do programowania w Python"},targetLevel:{type:"select",title:"Poziom zaawansowania",options:[{value:"beginner",label:"Początkujący"},{value:"intermediate",label:"Średniozaawansowany"},{value:"advanced",label:"Zaawansowany"}]},ageGroup:{type:"select",title:"Grupa wiekowa",options:[{value:"7-10",label:"7-10 lat (szkoła podstawowa)"},{value:"11-14",label:"11-14 lat (klasy 4-8)"},{value:"15-18",label:"15-18 lat (szkoła średnia)"},{value:"18+",label:"18+ (dorośli)"}]}},required:["subject","targetLevel","ageGroup"]},step2:{title:"Analiza tematu",type:"object",properties:{keyTopics:{type:"tags",title:"Kluczowe zagadnienia",readOnly:!0},learningObjectives:{type:"textarea",title:"Cele nauczania",readOnly:!0},prerequisites:{type:"tags",title:"Wymagania wstępne",readOnly:!0},estimatedDuration:{type:"number",title:"Szacowany czas (min)",readOnly:!0}}},step3:{title:"Dostosowanie celów",type:"object",properties:{learningObjectives:{type:"textarea",title:"Cele nauczania (edytowalne)",placeholder:"Dostosuj cele nauczania...",rows:6},materialType:{type:"select",title:"Typ materiału",options:[{value:"lesson",label:"Lekcja z teorią"},{value:"exercise",label:"Ćwiczenia praktyczne"},{value:"mixed",label:"Teoria + ćwiczenia"}]}},required:["learningObjectives","materialType"]},step4:{title:"Podgląd materiału",type:"object",properties:{title:{type:"text",title:"Tytuł materiału",readOnly:!0},content:{type:"textarea",title:"Treść materiału",readOnly:!0},exercises:{type:"textarea",title:"Ćwiczenia",readOnly:!0},summary:{type:"textarea",title:"Podsumowanie",readOnly:!0}}},step5:{title:"Finalizacja",type:"object",properties:{courseId:{type:"select",title:"Wybierz kurs",placeholder:"Wybierz kurs..."},topicId:{type:"select",title:"Wybierz temat",placeholder:"Najpierw wybierz kurs..."},activityTitle:{type:"text",title:"Tytuł aktywności",placeholder:"np. Wprowadzenie do zmiennych"},activityType:{type:"select",title:"Typ aktywności",options:[{value:"material",label:"Materiał edukacyjny"},{value:"quiz",label:"Quiz sprawdzający"}]},content:{type:"textarea",title:"Treść materiału",placeholder:"Edytuj wygenerowaną treść...",rows:15},duration:{type:"number",title:"Czas trwania (min)",placeholder:"15"}},required:["courseId","topicId","activityTitle","activityType","content"]}}},_1={id:"analyze-topic",name:"Analiza tematu edukacyjnego",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od edukacji i tworzenia materiałów dydaktycznych.",user:`
Przeanalizuj temat edukacyjny:
Temat: {{subject}}
Poziom: {{targetLevel}}
Grupa wiekowa: {{ageGroup}}

Wygeneruj JSON:
{
  "keyTopics": ["temat1", "temat2", "temat3"],
  "learningObjectives": "<szczegółowe cele nauczania - czego uczeń się nauczy>",
  "prerequisites": ["wymaganie1", "wymaganie2"],
  "estimatedDuration": <liczba minut>
}

Wymagania:
- KeyTopics: 3-7 kluczowych zagadnień do omówienia
- LearningObjectives: konkretne, mierzalne cele (100-200 słów)
- Prerequisites: 2-5 wymagań wstępnych (może być puste dla początkujących)
- EstimatedDuration: realistyczny czas w minutach (15-90)
    `,responseFormat:"json"},inputMapping:t=>({subject:t.subject,targetLevel:t.targetLevel,ageGroup:t.ageGroup}),outputMapping:(t,s)=>({...s,keyTopics:t.keyTopics,learningObjectives:t.learningObjectives,prerequisites:t.prerequisites,estimatedDuration:t.estimatedDuration}),validation:t=>!!(t.keyTopics&&t.learningObjectives&&t.estimatedDuration)},P1={id:"generate-material",name:"Generowanie materiału edukacyjnego",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś doświadczonym nauczycielem tworzącym angażujące materiały edukacyjne.",user:`
Stwórz materiał edukacyjny:

Temat: {{subject}}
Poziom: {{targetLevel}}
Grupa wiekowa: {{ageGroup}}
Cele nauczania: {{learningObjectives}}
Typ materiału: {{materialType}}
Kluczowe zagadnienia: {{keyTopics}}

Wygeneruj JSON:
{
  "title": "<atrakcyjny tytuł materiału>",
  "content": "<treść materiału w formacie Markdown - teoria, przykłady, wyjaśnienia>",
  "exercises": "<ćwiczenia praktyczne w formacie Markdown>",
  "summary": "<podsumowanie najważniejszych punktów>"
}

Wymagania:
- Title: kreatywny i zachęcający do nauki
- Content: dostosowany do wieku, z przykładami, min. 500 słów
- Exercises: 3-5 ćwiczeń praktycznych z instrukcjami
- Summary: bullet points z najważniejszymi informacjami
- Używaj formatowania Markdown (nagłówki, listy, kod)
- Język dostosowany do grupy wiekowej
    `,responseFormat:"json"},inputMapping:t=>({subject:t.subject,targetLevel:t.targetLevel,ageGroup:t.ageGroup,learningObjectives:t.learningObjectives,materialType:t.materialType,keyTopics:Array.isArray(t.keyTopics)?t.keyTopics.join(", "):t.keyTopics}),outputMapping:(t,s)=>({...s,title:t.title,content:t.content,exercises:t.exercises,summary:t.summary}),validation:t=>!!(t.title&&t.content&&t.exercises&&t.summary)},Tt={subject:{minLength:5,errorMessage:"Temat jest wymagany (5-200 znaków)"},activityTitle:{minLength:3,maxLength:100,errorMessage:"Tytuł jest wymagany (3-100 znaków)"},content:{minLength:100,errorMessage:"Treść materiału jest wymagana (min. 100 znaków)"},duration:{min:5,max:180,errorMessage:"Czas trwania musi być między 5 a 180 minut"}},bi={steps:{1:{title:"O czym chcesz stworzyć materiał?",description:"Podaj temat, poziom zaawansowania i grupę docelową - AI pomoże stworzyć angażujący materiał edukacyjny",button:"Analizuj temat",loading:"Analizuję temat..."},2:{title:"Analiza tematu",description:"AI przeanalizowała temat i zaproponowała strukturę materiału",success:"✓ Analiza zakończona pomyślnie"},3:{title:"Dostosuj cele i typ materiału",description:"Możesz zmodyfikować cele nauczania i wybrać typ materiału do wygenerowania",button:"Generuj materiał",loading:"Generuję materiał...",loadingInfo:"⚡ AI tworzy spersonalizowany materiał edukacyjny..."},4:{title:"Podgląd wygenerowanego materiału",description:"AI przygotowała kompletny materiał edukacyjny",info:"💡 W następnym kroku wybierzesz kurs i temat, do którego dodasz materiał."},5:{title:"Zapisz materiał w kursie",description:"Wybierz kurs i temat, następnie dostosuj materiał przed zapisaniem",saveInfo:"💾 Materiał zostanie zapisany jako nowa aktywność w wybranym temacie",button:"Zapisz materiał",loading:"Zapisuję...",success:"✓ Materiał został zapisany pomyślnie! Przekierowuję do kursu..."}},dashboard:{title:"Kreator materiałów edukacyjnych",description:"Twórz angażujące materiały z pomocą AI",features:["Automatyczna analiza tematu","Dostosowanie do wieku uczniów","Generowanie celów nauczania","Tworzenie ćwiczeń praktycznych","Formatowanie Markdown","Integracja z kursami"]},errors:{subjectRequired:"Podaj temat materiału",analysisError:"Błąd analizy tematu:",generationError:"Błąd generowania materiału:",saveError:"Wystąpił błąd podczas zapisu",unexpectedError:"Wystąpił nieoczekiwany błąd",noCourses:"Nie znaleziono żadnych kursów",noTopics:"Wybierz najpierw kurs"}},Pt={dashboard:"/teacher/educational-material",step1:"/teacher/educational-material/step1",step2:"/teacher/educational-material/step2",step3:"/teacher/educational-material/step3",step4:"/teacher/educational-material/step4",step5:"/teacher/educational-material/step5",courses:"/teacher/courses"},D1=()=>{const t=J(),{getData:s}=Ke(),n=s("educational-material-wizard"),{dashboard:i}=bi,r=n&&n.title;return e.jsxs(K,{children:[e.jsx(ve,{title:i.title,description:i.description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs(_,{className:"hover:shadow-lg transition-all cursor-pointer border-2 hover:border-purple-400 flex flex-col",onClick:()=>t(Pt.step1),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(pi,{className:"w-8 h-8 text-purple-600"})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400"})]}),e.jsx(L,{children:"Stwórz nowy materiał"}),e.jsx(Me,{children:"Wygeneruj kompletny materiał edukacyjny z pomocą AI"})]}),e.jsxs(P,{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"5-10 minut"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(We,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"Pełna treść"})]})]}),e.jsx("div",{className:"mt-auto pt-4",children:e.jsxs("div",{className:"inline-flex items-center text-sm font-medium text-purple-600",children:["Rozpocznij tworzenie",e.jsx(ae,{className:"w-4 h-4 ml-1"})]})})]})]}),e.jsxs(_,{className:"hover:shadow-lg transition-all border-2 border-gray-200 flex flex-col",children:[e.jsxs(O,{children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(ze,{className:"w-8 h-8 text-blue-600"})})}),e.jsx(L,{children:"Funkcje AI"}),e.jsx(Me,{children:"Co potrafi kreator materiałów"})]}),e.jsx(P,{className:"flex-1",children:e.jsx("div",{className:"space-y-2",children:i.features.map((a,o)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ot,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{children:a})]},o))})})]})]}),r&&e.jsxs(_,{className:"hover:shadow-lg transition-shadow border-2 border-gray-200",children:[e.jsx(O,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-lg",children:"Ostatni materiał"}),e.jsx(Me,{children:"Kontynuuj pracę nad materiałem"})]}),e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Wygenerowany"})]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tytuł materiału"}),e.jsx("p",{className:"font-medium text-gray-900",children:n.title})]}),n.subject&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Temat"}),e.jsx("p",{className:"text-gray-900",children:n.subject})]}),n.targetLevel&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-3 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:n.targetLevel==="beginner"?"Początkujący":n.targetLevel==="intermediate"?"Średni":"Zaawansowany"}),e.jsx("div",{className:"text-sm text-gray-600",children:"poziom"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.estimatedDuration||30}),e.jsx("div",{className:"text-sm text-gray-600",children:"minut"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsxs(I,{variant:"outline",onClick:()=>t(Pt.step4),className:"flex-1",children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Podgląd"]}),e.jsxs(I,{variant:"outline",onClick:()=>t(Pt.step5),className:"flex-1",children:[e.jsx(Ta,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),e.jsxs(I,{variant:"outline",onClick:()=>t(Pt.step1),className:"flex-1",children:[e.jsx(ai,{className:"w-4 h-4 mr-2"}),"Nowy"]})]})]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(_,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-blue-200 group",onClick:()=>t("/teacher/courses"),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(xe,{className:"w-6 h-6 text-blue-600"})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(L,{className:"text-lg",children:"Kursy"}),e.jsx(Me,{children:"Zobacz wszystkie kursy"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-blue-600 transition-colors",children:"Kliknij aby przejść →"})})]}),e.jsxs(_,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-purple-200 group",onClick:()=>t("/teacher/course-structure"),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(bn,{className:"w-6 h-6 text-purple-600"})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(L,{className:"text-lg",children:"Generator kursów"}),e.jsx(Me,{children:"Kreator struktury"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-purple-600 transition-colors",children:"Kliknij aby przejść →"})})]}),e.jsxs(_,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-green-200 group",onClick:()=>t("/teacher/quiz-wizard"),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(Kt,{className:"w-6 h-6 text-green-600"})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(L,{className:"text-lg",children:"Quizy"}),e.jsx(Me,{children:"Kreator quizów"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-green-600 transition-colors",children:"Kliknij aby przejść →"})})]})]})]})]})},Fr=({step:t})=>{const s=J(),n=t/5*100;return e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>s("/teacher/educational-material"),children:e.jsx(vt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-violet-600 text-white p-8 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-4xl font-black tracking-tight",children:"KREATOR MATERIAŁÓW"}),e.jsxs("h2",{className:"text-2xl font-light",children:["Stwórzmy razem ",e.jsx("span",{className:"font-bold",children:"angażujący materiał"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Krok ",t," z 5"]}),e.jsxs("span",{children:[n,"%"]})]}),e.jsx(ds,{value:n,className:"h-2 bg-purple-300"})]})]})]})},Br=({title:t,description:s})=>e.jsxs("header",{className:"mb-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:t}),e.jsx("p",{className:"text-gray-600",children:s})]}),I1=()=>{const t=J(),{register:s,setData:n,getData:i}=Ke(),r=i("educational-material-wizard"),[a,o]=g.useState(""),[l,c]=g.useState(""),[d,m]=g.useState(""),[u,h]=g.useState(""),[p,b]=g.useState(""),[f,x]=g.useState({}),[w,y]=g.useState(null),[N,A]=g.useState(!1),S=Tn("educational-material-wizard","analyze-topic"),{steps:k,errors:v}=bi,{data:z,isLoading:D}=ie({resource:"courses",meta:{select:"*, topics(*)"},sorters:[{field:"created_at",order:"desc"}]}),j=z?.data?.find(M=>M.id.toString()===a),C=j?.topics||[];g.useEffect(()=>(s(A1),S.registerOperation(_1),()=>{S.unregisterOperation()}),[]),g.useEffect(()=>{if(!N&&z?.data){let M="",F="",X="";const R=sessionStorage.getItem("wizardContext");if(R)try{const G=JSON.parse(R);y(G),G.courseId&&(M=G.courseId.toString()),G.topicId&&(F=G.topicId.toString()),G.topicTitle&&(X=G.topicTitle)}catch(G){console.error("Error parsing wizard context:",G)}!M&&r&&(r.courseId&&(M=r.courseId.toString()),r.topicId&&(F=r.topicId.toString()),r.subject&&(X=r.subject),r.targetLevel&&h(r.targetLevel),r.ageGroup&&b(r.ageGroup)),M&&o(M),F&&c(F),X&&m(X),A(!0)}},[z,N,r]),g.useEffect(()=>{if(l&&C.length>0){const M=C.find(F=>F.id.toString()===l);M&&m(M.title)}},[l,C]);const T=()=>{const M={};return a||(M.courseId="Wybierz kurs"),l||(M.topicId="Wybierz temat z kursu"),(!d.trim()||d.length<Tt.subject.minLength)&&(M.subject=Tt.subject.errorMessage),u||(M.targetLevel="Wybierz poziom zaawansowania"),p||(M.ageGroup="Wybierz grupę wiekową"),x(M),Object.keys(M).length===0},E=async()=>{if(T())try{const M={courseId:parseInt(a),topicId:parseInt(l),subject:d.trim(),targetLevel:u,ageGroup:p,courseTitle:j?.title,topicTitle:C.find(F=>F.id.toString()===l)?.title};n("educational-material-wizard",M),await S.executeOperation(M),t(Pt.step2)}catch(M){console.error(v.analysisError,M)}};return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx(Fr,{step:1}),e.jsxs(P,{className:"p-8",children:[e.jsx(Br,{title:k[1].title,description:k[1].description}),w&&e.jsxs(ge,{className:"mb-6 bg-blue-50 border-blue-200",children:[e.jsx(es,{className:"h-4 w-4 text-blue-600"}),e.jsxs(je,{className:"text-blue-800",children:["Tworzysz materiał dla: ",e.jsx("strong",{children:w.courseTitle}),w.topicTitle&&e.jsxs(e.Fragment,{children:[" → ",e.jsx("strong",{children:w.topicTitle})]})]})]}),S.error&&e.jsxs(ge,{variant:"destructive",className:"mb-6",children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsxs(je,{children:[v.analysisError," ",S.error]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"border-2 border-purple-200 bg-purple-50/50",children:e.jsxs(P,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xe,{className:"w-5 h-5 text-purple-600"}),e.jsx("h3",{className:"font-semibold",children:"Wybierz miejsce w kursie"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"courseId",children:["Kurs ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(me,{value:a,onValueChange:M=>{o(M),c(""),m("")},disabled:S.loading||D,children:[e.jsx(ce,{className:f.courseId?"border-red-500":"",children:e.jsx(he,{placeholder:"Wybierz kurs..."})}),e.jsx(de,{children:z?.data?.map(M=>e.jsx(B,{value:M.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[M.icon_emoji&&e.jsx("span",{children:M.icon_emoji}),e.jsx("span",{children:M.title}),!M.is_published&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"(szkic)"})]})},M.id))})]}),f.courseId&&e.jsx("p",{className:"text-sm text-red-600",children:f.courseId})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"topicId",children:["Temat ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(me,{value:l,onValueChange:c,disabled:!a||S.loading,children:[e.jsx(ce,{className:f.topicId?"border-red-500":"",children:e.jsx(he,{placeholder:a?"Wybierz temat...":"Najpierw wybierz kurs..."})}),e.jsx(de,{children:C.sort((M,F)=>M.position-F.position).map(M=>e.jsx(B,{value:M.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:[M.position,". ",M.title]}),M.is_published===!1&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"(szkic)"})]})},M.id))})]}),f.topicId&&e.jsx("p",{className:"text-sm text-red-600",children:f.topicId})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"subject",children:"Temat materiału"}),e.jsx(Q,{id:"subject",type:"text",value:d,onChange:M=>m(M.target.value),placeholder:"np. Wprowadzenie do programowania w Python",disabled:S.loading,className:f.subject?"border-red-500":""}),f.subject&&e.jsx("p",{className:"text-sm text-red-600",children:f.subject}),e.jsx("p",{className:"text-sm text-gray-500",children:"Możesz dostosować temat materiału lub pozostawić sugerowany"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"targetLevel",children:"Poziom zaawansowania"}),e.jsxs(me,{value:u,onValueChange:h,disabled:S.loading,children:[e.jsx(ce,{className:f.targetLevel?"border-red-500":"",children:e.jsx(he,{placeholder:"Wybierz poziom..."})}),e.jsxs(de,{children:[e.jsx(B,{value:"beginner",children:"Początkujący"}),e.jsx(B,{value:"intermediate",children:"Średniozaawansowany"}),e.jsx(B,{value:"advanced",children:"Zaawansowany"})]})]}),f.targetLevel&&e.jsx("p",{className:"text-sm text-red-600",children:f.targetLevel})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"ageGroup",children:"Grupa wiekowa"}),e.jsxs(me,{value:p,onValueChange:b,disabled:S.loading,children:[e.jsx(ce,{className:f.ageGroup?"border-red-500":"",children:e.jsx(he,{placeholder:"Wybierz grupę wiekową..."})}),e.jsxs(de,{children:[e.jsx(B,{value:"7-10",children:"7-10 lat (szkoła podstawowa)"}),e.jsx(B,{value:"11-14",children:"11-14 lat (klasy 4-8)"}),e.jsx(B,{value:"15-18",children:"15-18 lat (szkoła średnia)"}),e.jsx(B,{value:"18+",children:"18+ (dorośli)"})]})]}),f.ageGroup&&e.jsx("p",{className:"text-sm text-red-600",children:f.ageGroup})]}),e.jsx(I,{onClick:E,disabled:S.loading,className:"w-full bg-purple-600 hover:bg-purple-700 text-white",size:"lg",children:S.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),k[1].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),k[1].button]})})]})]})]})})},M1=()=>{const t=J(),{getData:s}=Ke(),n=s("educational-material-wizard"),{steps:i}=bi;return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx(Fr,{step:2}),e.jsxs(P,{className:"p-8",children:[e.jsx(Br,{title:i[2].title,description:i[2].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ge,{className:"bg-green-50 border-green-200",children:[e.jsx(st,{className:"h-4 w-4 text-green-600"}),e.jsx(je,{className:"text-green-800",children:i[2].success})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"bg-gray-50 border-gray-200",children:e.jsxs(P,{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Temat"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:n.subject})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Cele nauczania"}),e.jsx("div",{className:"text-gray-800 whitespace-pre-wrap",children:n.learningObjectives})]})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(_,{className:"border-purple-200 bg-purple-50/50",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ze,{className:"w-5 h-5 text-purple-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Kluczowe zagadnienia"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.keyTopics?.map((r,a)=>e.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm",children:r},a))})]})]})})}),e.jsx(_,{className:"border-blue-200 bg-blue-50/50",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Se,{className:"w-5 h-5 text-blue-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Informacje"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Czas trwania:"})," ",n.estimatedDuration," minut"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Poziom:"})," ",n.targetLevel==="beginner"?"Początkujący":n.targetLevel==="intermediate"?"Średniozaawansowany":"Zaawansowany"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Grupa wiekowa:"})," ",n.ageGroup]})]})]})]})})})]}),e.jsx(_,{children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Wymagania wstępne"}),n.prerequisites?.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:n.prerequisites.map((r,a)=>e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:r},a))}):e.jsx("span",{className:"text-sm text-gray-500",children:"Brak wymagań wstępnych"})]})})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(Pt.step1),children:"Wstecz"}),e.jsx(I,{onClick:()=>t(Pt.step3),className:"bg-purple-600 hover:bg-purple-700",children:"Kontynuuj"})]})]})]})]})})},E1=()=>{const t=J(),{getData:s,setData:n}=Ke(),i=s("educational-material-wizard"),[r,a]=g.useState(i.learningObjectives||""),[o,l]=g.useState("mixed"),[c,d]=g.useState({}),m=Tn("educational-material-wizard","generate-material"),{steps:u,errors:h}=bi;g.useEffect(()=>(m.registerOperation(P1),()=>{m.unregisterOperation()}),[]);const p=()=>{const f={};return r.trim()||(f.learningObjectives="Cele nauczania są wymagane"),o||(f.materialType="Wybierz typ materiału"),d(f),Object.keys(f).length===0},b=async()=>{if(p())try{const f={...i,learningObjectives:r.trim(),materialType:o};n("educational-material-wizard",f),await m.executeOperation(f),t(Pt.step4)}catch(f){console.error(h.generationError,f)}};return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx(Fr,{step:3}),e.jsxs(P,{className:"p-8",children:[e.jsx(Br,{title:u[3].title,description:u[3].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"learningObjectives",children:["Cele nauczania ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Nt,{id:"learningObjectives",value:r,onChange:f=>a(f.target.value),placeholder:"Dostosuj cele nauczania...",rows:6,className:c.learningObjectives?"border-red-500":""}),c.learningObjectives&&e.jsx("p",{className:"text-sm text-red-600",children:c.learningObjectives}),e.jsx("p",{className:"text-sm text-gray-500",children:"Możesz edytować automatycznie wygenerowane cele"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"materialType",children:["Typ materiału ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(me,{value:o,onValueChange:l,children:[e.jsx(ce,{className:c.materialType?"border-red-500":"",children:e.jsx(he,{placeholder:"Wybierz typ materiału..."})}),e.jsxs(de,{children:[e.jsx(B,{value:"lesson",children:"Lekcja z teorią"}),e.jsx(B,{value:"exercise",children:"Ćwiczenia praktyczne"}),e.jsx(B,{value:"mixed",children:"Teoria + ćwiczenia"})]})]}),c.materialType&&e.jsx("p",{className:"text-sm text-red-600",children:c.materialType})]}),m.loading&&e.jsxs(ge,{className:"bg-purple-50 border-purple-200",children:[e.jsx(es,{className:"h-4 w-4 text-purple-600"}),e.jsx(je,{className:"text-purple-800",children:u[3].loadingInfo})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(Pt.step2),children:"Wstecz"}),e.jsx(I,{onClick:b,disabled:m.loading,className:"bg-purple-600 hover:bg-purple-700",children:m.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),u[3].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),u[3].button]})})]})]})]})]})})},L1=()=>{const t=J(),{getData:s}=Ke(),n=s("educational-material-wizard"),{steps:i}=bi;return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx(Fr,{step:4}),e.jsxs(P,{className:"p-8",children:[e.jsx(Br,{title:e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"w-8 h-8 text-purple-600"}),e.jsx("span",{children:i[4].title})]}),description:i[4].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"bg-gradient-to-r from-purple-50 to-violet-50 border-purple-200",children:e.jsxs(P,{className:"p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-3",children:n.title}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(We,{className:"w-8 h-8 text-indigo-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:n.materialType==="lesson"?"Lekcja":n.materialType==="exercise"?"Ćwiczenia":"Teoria + Ćwiczenia"}),e.jsx("div",{className:"text-sm text-gray-600",children:"typ materiału"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(xe,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.estimatedDuration}),e.jsx("div",{className:"text-sm text-gray-600",children:"minut"})]})]})]})}),e.jsx("h4",{className:"font-semibold text-lg",children:"Treść materiału - podgląd"}),e.jsxs(_,{className:"overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(We,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h5",{className:"font-medium",children:"Główna treść"}),e.jsxs(H,{variant:"secondary",children:[n.content?.length||0," znaków"]})]})}),e.jsx(P,{className:"p-4",children:e.jsx("div",{className:"prose prose-sm max-w-none max-h-96 overflow-y-auto",children:e.jsx(Jn,{children:n.content})})})]}),n.exercises&&e.jsxs(_,{className:"overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(We,{className:"w-5 h-5 text-green-600"}),e.jsx("h5",{className:"font-medium",children:"Ćwiczenia"})]})}),e.jsx(P,{className:"p-4",children:e.jsx("div",{className:"prose prose-sm max-w-none max-h-64 overflow-y-auto",children:e.jsx(Jn,{children:n.exercises})})})]}),n.summary&&e.jsxs(_,{className:"overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-sky-50 px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(We,{className:"w-5 h-5 text-blue-600"}),e.jsx("h5",{className:"font-medium",children:"Podsumowanie"})]})}),e.jsx(P,{className:"p-4",children:e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx(Jn,{children:n.summary})})})]}),e.jsxs(ge,{className:"bg-blue-50 border-blue-200",children:[e.jsx(es,{className:"h-4 w-4 text-blue-600"}),e.jsx(je,{className:"text-blue-800",children:i[4].info})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(Pt.step3),children:"Wstecz"}),e.jsx(I,{onClick:()=>t(Pt.step5),className:"bg-purple-600 hover:bg-purple-700",children:"Przejdź do zapisywania"})]})]})]})]})})},O1=()=>{const t=J(),{getData:s,setData:n}=Ke(),{mutate:i}=fs(),r=s("educational-material-wizard"),[a,o]=g.useState(r.title||""),[l,c]=g.useState(r.content+(r.exercises?`

## Ćwiczenia

${r.exercises}`:"")+(r.summary?`

## Podsumowanie

${r.summary}`:"")),[d,m]=g.useState(r.estimatedDuration||30),[u,h]=g.useState({}),[p,b]=g.useState(!1),[f,x]=g.useState(!1),{steps:w,errors:y}=bi,{data:N}=ie({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:r.topicId}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!r.topicId}}),A=N?.data?.[0]?.position?N.data[0].position+1:1,S=()=>{const v={};return(!a.trim()||a.length<Tt.activityTitle.minLength)&&(v.activityTitle=Tt.activityTitle.errorMessage),(!l.trim()||l.length<Tt.content.minLength)&&(v.content=Tt.content.errorMessage),(!d||d<Tt.duration.min||d>Tt.duration.max)&&(v.duration=Tt.duration.errorMessage),h(v),Object.keys(v).length===0},k=async()=>{if(S()){b(!0),x(!1);try{i({resource:"activities",values:{topic_id:r.topicId,type:"material",title:a.trim(),content:l.trim(),position:A,duration_min:d,is_published:!1}},{onSuccess:v=>{n("educational-material-wizard",{...r,activityTitle:a.trim(),content:l.trim(),activityId:v.data.id,saved:!0}),b(!1),x(!0);const z=sessionStorage.getItem("returnUrl");setTimeout(()=>{sessionStorage.removeItem("wizardContext"),z?(sessionStorage.removeItem("returnUrl"),t(z)):t(`${Pt.courses}/show/${r.courseId}?expanded=${r.topicId}`)},1e3)},onError:v=>{b(!1),console.error(y.saveError,v),v?.code==="42501"?W.error("Brak uprawnień do tworzenia materiałów. Sprawdź swoje uprawnienia."):v?.code==="23505"?W.error("Materiał o takiej nazwie już istnieje."):W.error(y.saveError)}})}catch(v){b(!1),console.error(y.unexpectedError,v),W.error(y.unexpectedError)}}};return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx(Fr,{step:5}),e.jsxs(P,{className:"p-8",children:[e.jsx(Br,{title:e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-8 h-8 text-purple-600"}),e.jsx("span",{children:w[5].title})]}),description:w[5].description}),f&&e.jsxs(ge,{className:"mb-6 bg-green-50 border-green-200",children:[e.jsx(st,{className:"h-4 w-4 text-green-600"}),e.jsx(je,{className:"text-green-800",children:w[5].success})]}),e.jsxs("form",{className:"space-y-6",onSubmit:v=>{v.preventDefault(),k()},children:[e.jsx(_,{className:"bg-gradient-to-r from-purple-50 to-violet-50 border-purple-200",children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Miejsce docelowe materiału:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(st,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Kurs:"})," ",r.courseTitle]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(st,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Temat:"})," ",r.topicTitle]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(st,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Pozycja:"})," ",A]})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"activityTitle",children:["Tytuł aktywności ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Q,{id:"activityTitle",type:"text",value:a,onChange:v=>o(v.target.value),placeholder:"np. Wprowadzenie do zmiennych",maxLength:Tt.activityTitle.maxLength,className:u.activityTitle?"border-red-500":""}),u.activityTitle&&e.jsx("p",{className:"text-sm text-red-600",children:u.activityTitle})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"duration",children:["Czas trwania (min) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Q,{id:"duration",type:"number",value:d,onChange:v=>m(parseInt(v.target.value)||0),min:Tt.duration.min,max:Tt.duration.max,className:`w-24 ${u.duration?"border-red-500":""}`}),u.duration&&e.jsx("p",{className:"text-sm text-red-600",children:u.duration}),e.jsx("p",{className:"text-sm text-gray-500",children:"Określ przewidywany czas realizacji materiału"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"content",children:["Treść materiału ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Nt,{id:"content",value:l,onChange:v=>c(v.target.value),placeholder:"Treść materiału w formacie Markdown...",rows:15,className:`font-mono text-sm ${u.content?"border-red-500":""}`}),u.content&&e.jsx("p",{className:"text-sm text-red-600",children:u.content}),e.jsxs("p",{className:"text-sm text-gray-500",children:[l.length," znaków (minimum ",Tt.content.minLength,")"]})]}),e.jsx(ge,{className:"bg-purple-50 border-purple-200",children:e.jsx(je,{className:"text-purple-800",children:w[5].saveInfo})}),e.jsx(fi,{}),e.jsxs("footer",{className:"flex justify-between gap-4",children:[e.jsxs(I,{type:"button",variant:"outline",onClick:()=>t(Pt.step4),disabled:p,className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"Wstecz"]}),e.jsx(I,{type:"submit",disabled:p||f,className:"flex items-center gap-2 min-w-[160px] bg-purple-600 hover:bg-purple-700",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),w[5].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(Dr,{className:"w-4 h-4"}),w[5].button]})})]})]})]})]})})},R1=[e.jsx(V,{path:"/educational-material",element:e.jsx(D1,{})},"material-dashboard"),e.jsx(V,{path:"/educational-material/step1",element:e.jsx(I1,{})},"material-step1"),e.jsx(V,{path:"/educational-material/step2",element:e.jsx(M1,{})},"material-step2"),e.jsx(V,{path:"/educational-material/step3",element:e.jsx(E1,{})},"material-step3"),e.jsx(V,{path:"/educational-material/step4",element:e.jsx(L1,{})},"material-step4"),e.jsx(V,{path:"/educational-material/step5",element:e.jsx(O1,{})},"material-step5")],ku={name:"educational-materials",list:"/educational-material",create:"/educational-material/step1",meta:{canDelete:!1,label:"Kreator materiałów",icon:e.jsx(Pr,{className:"h-4 w-4"})}},$1={id:"quiz-wizard",title:"Kreator quizów",schema:{step1:{title:"Podstawowe informacje o quizie",type:"object",properties:{topic:{type:"text",title:"Temat quizu",placeholder:"np. Podstawy programowania w Python"},difficulty:{type:"select",title:"Poziom trudności",options:[{value:"easy",label:"Łatwy"},{value:"medium",label:"Średni"},{value:"hard",label:"Trudny"}]},questionsCount:{type:"number",title:"Liczba pytań",placeholder:"10",min:5,max:30},questionTypes:{type:"multiselect",title:"Typy pytań",options:[{value:"single",label:"Jednokrotny wybór"},{value:"multiple",label:"Wielokrotny wybór"},{value:"truefalse",label:"Prawda/Fałsz"}]}},required:["topic","difficulty","questionsCount"]},step2:{title:"Analiza tematu",type:"object",properties:{keyTopics:{type:"tags",title:"Kluczowe zagadnienia",readOnly:!0},learningObjectives:{type:"textarea",title:"Cele sprawdzające",readOnly:!0},suggestedTime:{type:"number",title:"Sugerowany czas (min)",readOnly:!0},passingScore:{type:"number",title:"Próg zaliczenia (%)",readOnly:!0}}},step3:{title:"Parametry quizu",type:"object",properties:{quizTitle:{type:"text",title:"Tytuł quizu",placeholder:"np. Test wiedzy - Zmienne i typy danych"},passingScore:{type:"number",title:"Próg zaliczenia (%)",placeholder:"70",min:50,max:100},timeLimit:{type:"number",title:"Limit czasu (min)",placeholder:"Pozostaw puste dla braku limitu",min:5,max:180},maxAttempts:{type:"number",title:"Maksymalna liczba podejść",placeholder:"Pozostaw puste dla nieograniczonej liczby",min:1,max:10},shuffleQuestions:{type:"checkbox",title:"Losowa kolejność pytań"},showExplanations:{type:"checkbox",title:"Pokazuj wyjaśnienia po odpowiedzi"}},required:["quizTitle","passingScore"]},step4:{title:"Podgląd wygenerowanych pytań",type:"object",properties:{questions:{type:"array",title:"Lista pytań",readOnly:!0}}},step5:{title:"Finalizacja i zapis",type:"object",properties:{courseId:{type:"select",title:"Wybierz kurs",placeholder:"Wybierz kurs..."},topicId:{type:"select",title:"Wybierz temat",placeholder:"Najpierw wybierz kurs..."},finalTitle:{type:"text",title:"Ostateczny tytuł",placeholder:"Tytuł quizu"},questions:{type:"array",title:"Pytania do edycji"}},required:["courseId","topicId","finalTitle"]}}},q1={id:"analyze-quiz-topic",name:"Analiza tematu quizu",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od tworzenia testów i quizów edukacyjnych.",user:`
Przeanalizuj temat dla quizu:
Temat: {{topic}}
Poziom trudności: {{difficulty}}
Liczba pytań: {{questionsCount}}
{{#if basedOnMaterial}}
Quiz będzie generowany z materiału: {{materialTitle}}
{{/if}}

Wygeneruj JSON:
{
  "quizTitle": "<sugerowany tytuł quizu>",
  "keyTopics": ["zagadnienie1", "zagadnienie2", "zagadnienie3"],
  "learningObjectives": "<cele sprawdzające - co quiz ma zweryfikować>",
  "suggestedTime": <liczba minut>,
  "passingScore": <próg zaliczenia w %>
}

Wymagania:
- QuizTitle: krótki, opisowy tytuł quizu (max 80 znaków)
- KeyTopics: 5-10 kluczowych zagadnień do sprawdzenia
- LearningObjectives: konkretne umiejętności do weryfikacji (50-150 słów)
- SuggestedTime: 1-3 minuty na pytanie
- PassingScore: 60-80% w zależności od trudności
{{#if basedOnMaterial}}
- Dla quizu z materiału: tytuł powinien zawierać "Quiz: " + nazwa materiału
{{/if}}
    `,responseFormat:"json"},inputMapping:t=>({topic:t.topic,difficulty:t.difficulty,questionsCount:t.questionsCount,basedOnMaterial:t.basedOnMaterial||!1,materialTitle:t.materialTitle||""}),outputMapping:(t,s)=>({...s,quizTitle:t.quizTitle,keyTopics:t.keyTopics,learningObjectives:t.learningObjectives,suggestedTime:t.suggestedTime,passingScore:t.passingScore}),validation:t=>!!(t.quizTitle&&t.keyTopics&&t.learningObjectives&&t.suggestedTime&&t.passingScore)},F1={id:"generate-quiz-questions",name:"Generowanie pytań quizowych",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od tworzenia pytań testowych. Tworzysz rzetelne, dobrze sformułowane pytania sprawdzające wiedzę.",user:`
Stwórz pytania quizowe dla tematu: {{topic}}

Tytuł quizu: {{quizTitle}}
Poziom trudności: {{difficulty}}
Liczba pytań: {{questionsCount}}
Typy pytań: {{questionTypes}}
Kluczowe zagadnienia: {{keyTopics}}
Cele: {{learningObjectives}}

Wygeneruj JSON z tablicą pytań:
{
  "questions": [
    {
      "question": "<treść pytania>",
      "type": "single|multiple|truefalse",
      "options": [
        {"text": "<treść opcji>", "is_correct": true/false},
        {"text": "<treść opcji>", "is_correct": true/false}
      ],
      "explanation": "<wyjaśnienie poprawnej odpowiedzi>",
      "points": <liczba punktów 1-5>
    }
  ]
}

Wymagania:
- Pytania oparte na wiedzy ogólnej z danego tematu
- Pytania jasne i jednoznaczne  
- 4 opcje dla single/multiple, 2 dla true/false
- Dokładnie jedna poprawna dla single, 1-3 dla multiple
- Wyjaśnienia edukacyjne (30-100 słów)
- Punkty: łatwe=1-2, średnie=2-3, trudne=3-5
- Różnorodność typów pytań
- Pokrycie wszystkich kluczowych zagadnień
- GENERUJ PRAWDZIWE PYTANIA Z PODANEGO TEMATU
    `,responseFormat:"json"},inputMapping:t=>({topic:t.topic,quizTitle:t.quizTitle||"",difficulty:t.difficulty,questionsCount:t.questionsCount,questionTypes:Array.isArray(t.questionTypes)?t.questionTypes.join(", "):t.questionTypes||"single, multiple, truefalse",keyTopics:Array.isArray(t.keyTopics)?t.keyTopics.join(", "):t.keyTopics,learningObjectives:t.learningObjectives}),outputMapping:(t,s)=>({...s,questions:t.questions}),validation:t=>!!(t.questions&&Array.isArray(t.questions)&&t.questions.length>0)},B1={id:"generate-quiz-from-material",name:"Generowanie pytań z materiału",config:{endpoint:"https://diesel-power-backend.onrender.com/api/chat"},prompt:{system:"Jesteś ekspertem od tworzenia pytań testowych. Tworzysz pytania WYŁĄCZNIE na podstawie dostarczonego materiału.",user:`
Stwórz pytania quizowe TYLKO I WYŁĄCZNIE na podstawie poniższego materiału:

MATERIAŁ ŹRÓDŁOWY:
{{materialContent}}

PARAMETRY QUIZU:
Tytuł: {{quizTitle}}
Poziom trudności: {{difficulty}}
Liczba pytań: {{questionsCount}}
Typy pytań: {{questionTypes}}

Wygeneruj JSON z tablicą pytań:
{
  "questions": [
    {
      "question": "<treść pytania>",
      "type": "single|multiple|truefalse",
      "options": [
        {"text": "<treść opcji>", "is_correct": true/false},
        {"text": "<treść opcji>", "is_correct": true/false}
      ],
      "explanation": "<wyjaśnienie poprawnej odpowiedzi>",
      "points": <liczba punktów 1-5>
    }
  ]
}

WAŻNE WYMAGANIA:
- WSZYSTKIE pytania muszą być oparte WYŁĄCZNIE na treści materiału
- NIE dodawaj pytań o rzeczach nieopisanych w materiale
- Cytuj lub parafrazuj fragmenty materiału w pytaniach
- Wyjaśnienia muszą odwoływać się do konkretnych fragmentów materiału
- Jeśli materiał nie zawiera wystarczających informacji dla {{questionsCount}} pytań, wygeneruj mniej pytań
- Pytania muszą sprawdzać zrozumienie treści z materiału
- 4 opcje dla single/multiple, 2 dla true/false
- Dokładnie jedna poprawna dla single, 1-3 dla multiple
- Punkty: łatwe=1-2, średnie=2-3, trudne=3-5
    `,responseFormat:"json"},inputMapping:t=>({materialContent:t.materialContent,quizTitle:t.quizTitle||"",difficulty:t.difficulty,questionsCount:t.questionsCount,questionTypes:Array.isArray(t.questionTypes)?t.questionTypes.join(", "):t.questionTypes||"single, multiple, truefalse"}),outputMapping:(t,s)=>({...s,questions:t.questions}),validation:t=>!!(t.questions&&Array.isArray(t.questions)&&t.questions.length>0)},be={topic:{minLength:5,errorMessage:"Temat jest wymagany (5-200 znaków)"},quizTitle:{minLength:5,maxLength:100,errorMessage:"Tytuł jest wymagany (5-100 znaków)"},questionsCount:{min:5,max:30,errorMessage:"Liczba pytań musi być między 5 a 30"},passingScore:{min:50,max:100,errorMessage:"Próg zaliczenia musi być między 50% a 100%"},timeLimit:{min:5,max:180,errorMessage:"Limit czasu musi być między 5 a 180 minut"},maxAttempts:{min:1,max:10,errorMessage:"Liczba podejść musi być między 1 a 10"}},wi={steps:{1:{title:"Jaki quiz chcesz stworzyć?",description:"Podaj temat, poziom trudności i liczbę pytań - AI wygeneruje profesjonalny quiz",button:"Analizuj temat",loading:"Analizuję temat..."},2:{title:"Analiza tematu quizu",description:"AI przeanalizowała temat i zaproponowała parametry quizu",success:"✓ Analiza zakończona pomyślnie"},3:{title:"Skonfiguruj parametry quizu",description:"Dostosuj ustawienia quizu według swoich potrzeb",button:"Generuj pytania",loading:"Generuję pytania...",loadingInfo:"⚡ AI tworzy zestaw pytań dostosowanych do tematu..."},4:{title:"Podgląd wygenerowanych pytań",description:"AI przygotowała kompletny zestaw pytań",info:"💡 W następnym kroku będziesz mógł edytować pytania i wybrać kurs."},5:{title:"Zapisz quiz w kursie",description:"Wybierz kurs i temat, sprawdź pytania przed zapisaniem",saveInfo:"💾 Quiz zostanie zapisany jako nowa aktywność z wygenerowanymi pytaniami",button:"Zapisz quiz",loading:"Zapisuję...",success:"✓ Quiz został zapisany pomyślnie! Przekierowuję do zarządzania pytaniami..."}},dashboard:{title:"Kreator quizów",description:"Twórz profesjonalne testy sprawdzające z pomocą AI",features:["Automatyczna analiza tematu","Generowanie różnych typów pytań","Dostosowanie poziomu trudności","Inteligentne wyjaśnienia odpowiedzi","Konfiguracja parametrów quizu","Edycja i dostosowanie pytań"]},errors:{topicRequired:"Podaj temat quizu",analysisError:"Błąd analizy tematu:",generationError:"Błąd generowania pytań:",saveError:"Wystąpił błąd podczas zapisu",unexpectedError:"Wystąpił nieoczekiwany błąd",noCourses:"Nie znaleziono żadnych kursów",noTopics:"Wybierz najpierw kurs",noQuestions:"Brak pytań do zapisania",materialRequired:"Wybierz materiał źródłowy"}},Dt={dashboard:"/teacher/quiz-wizard",step1:"/teacher/quiz-wizard/step1",step2:"/teacher/quiz-wizard/step2",step3:"/teacher/quiz-wizard/step3",step4:"/teacher/quiz-wizard/step4",step5:"/teacher/quiz-wizard/step5",questions:"/teacher/questions/manage",courses:"/teacher/courses"},U1=()=>{const t=J(),{getData:s}=Ke(),n=s("quiz-wizard"),{dashboard:i}=wi,r=n&&n.quizTitle;return e.jsxs(K,{children:[e.jsx(ve,{title:i.title,description:i.description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsxs(_,{className:"hover:shadow-lg transition-all cursor-pointer border-2 hover:border-blue-400 flex flex-col",onClick:()=>t(Dt.step1),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(pi,{className:"w-8 h-8 text-blue-600"})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400"})]}),e.jsx(L,{children:"Stwórz nowy quiz"}),e.jsx(Me,{children:"Wygeneruj profesjonalny test sprawdzający z pomocą AI"})]}),e.jsxs(P,{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"5-10 minut"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ds,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"Inteligentne pytania"})]})]}),e.jsx("div",{className:"mt-auto pt-4",children:e.jsxs("div",{className:"inline-flex items-center text-sm font-medium text-blue-600",children:["Rozpocznij tworzenie",e.jsx(ae,{className:"w-4 h-4 ml-1"})]})})]})]}),e.jsxs(_,{className:"hover:shadow-lg transition-all border-2 border-gray-200 flex flex-col",children:[e.jsxs(O,{children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(ze,{className:"w-8 h-8 text-purple-600"})})}),e.jsx(L,{children:"Funkcje AI"}),e.jsx(Me,{children:"Co potrafi kreator quizów"})]}),e.jsx(P,{className:"flex-1",children:e.jsx("div",{className:"space-y-2",children:i.features.map((a,o)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(ot,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),e.jsx("span",{children:a})]},o))})})]})]}),r&&e.jsxs(_,{className:"hover:shadow-lg transition-shadow border-2 border-gray-200",children:[e.jsx(O,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-lg",children:"Ostatni quiz"}),e.jsx(Me,{children:"Kontynuuj pracę nad quizem"})]}),e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:"Wygenerowany"})]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tytuł quizu"}),e.jsx("p",{className:"font-medium text-gray-900",children:n.quizTitle})]}),n.topic&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Temat"}),e.jsx("p",{className:"text-gray-900",children:n.topic})]}),n.questions&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-3 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:n.questions.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"pytań"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[n.passingScore||70,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"próg zaliczenia"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsxs(I,{variant:"outline",onClick:()=>t(Dt.step4),className:"flex-1",children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Podgląd"]}),e.jsxs(I,{variant:"outline",onClick:()=>t(Dt.step5),className:"flex-1",children:[e.jsx(Ta,{className:"w-4 h-4 mr-2"}),"Edytuj"]}),e.jsxs(I,{variant:"outline",onClick:()=>t(Dt.step1),className:"flex-1",children:[e.jsx(ai,{className:"w-4 h-4 mr-2"}),"Nowy"]})]})]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(_,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-blue-200 group",onClick:()=>t("/teacher/activities"),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(dt,{className:"w-6 h-6 text-blue-600"})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(L,{className:"text-lg",children:"Aktywności"}),e.jsx(Me,{children:"Wszystkie quizy i materiały"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-blue-600 transition-colors",children:"Kliknij aby przejść →"})})]}),e.jsxs(_,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-purple-200 group",onClick:()=>t("/teacher/questions"),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(fn,{className:"w-6 h-6 text-purple-600"})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(L,{className:"text-lg",children:"Pytania"}),e.jsx(Me,{children:"Zarządzaj pytaniami"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-purple-600 transition-colors",children:"Kliknij aby przejść →"})})]}),e.jsxs(_,{className:"hover:shadow-lg transition-shadow cursor-pointer border-2 border-green-200 group",onClick:()=>t("/teacher/reports"),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx($e,{className:"w-6 h-6 text-green-600"})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),e.jsx(L,{className:"text-lg",children:"Wyniki"}),e.jsx(Me,{children:"Statystyki quizów"})]}),e.jsx(P,{children:e.jsx("p",{className:"text-xs text-gray-500 group-hover:text-green-600 transition-colors",children:"Kliknij aby przejść →"})})]})]})]})]})},Ur=({step:t})=>{const s=J(),n=t/5*100;return e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100",onClick:()=>s("/teacher/quiz-wizard"),children:e.jsx(vt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 text-white p-8 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-4xl font-black tracking-tight",children:"KREATOR QUIZÓW"}),e.jsxs("h2",{className:"text-2xl font-light",children:["Twórzmy razem ",e.jsx("span",{className:"font-bold",children:"sprawdzian wiedzy"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Krok ",t," z 5"]}),e.jsxs("span",{children:[n,"%"]})]}),e.jsx(ds,{value:n,className:"h-2 bg-blue-300"})]})]})]})},Vr=({title:t,description:s})=>e.jsxs("header",{className:"mb-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-3",children:t}),e.jsx("p",{className:"text-gray-600",children:s})]}),V1=()=>{const t=J(),{register:s,setData:n}=Ke(),[i,r]=g.useState(""),[a,o]=g.useState(""),[l,c]=g.useState(""),[d,m]=g.useState(""),[u,h]=g.useState(10),[p,b]=g.useState(["single","multiple"]),[f,x]=g.useState("general"),[w,y]=g.useState(""),[N,A]=g.useState({}),[S,k]=g.useState(null),v=Tn("quiz-wizard","analyze-quiz-topic"),{steps:z,errors:D}=wi,{data:j,isLoading:C}=ie({resource:"courses",meta:{select:"*, topics(*)"},sorters:[{field:"created_at",order:"desc"}]}),{data:T,isLoading:E}=Ue({resource:"activities",id:S?.materialId||0,queryOptions:{enabled:!!S?.materialId}}),{data:M,isLoading:F}=ie({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:a?parseInt(a):void 0},{field:"type",operator:"eq",value:"material"}],sorters:[{field:"position",order:"asc"}],queryOptions:{enabled:!!a}}),X=j?.data?.find(q=>q.id.toString()===i),R=X?.topics||[];g.useEffect(()=>{s($1),v.registerOperation(q1);const q=sessionStorage.getItem("wizardContext");if(q){const ee=JSON.parse(q);k(ee),ee.courseId&&r(ee.courseId.toString()),ee.topicId&&o(ee.topicId.toString()),ee.topicTitle&&c(ee.topicTitle),ee.materialId&&(x("material"),y(ee.materialId.toString()))}return()=>{v.unregisterOperation()}},[]),g.useEffect(()=>{if(a&&R.length>0){const q=R.find(ee=>ee.id.toString()===a);q&&!l&&c(q.title)}},[a,R]);const G=()=>{const q={};return i||(q.courseId="Wybierz kurs"),a||(q.topicId="Wybierz temat z kursu"),(!l.trim()||l.length<be.topic.minLength)&&(q.topic=be.topic.errorMessage),d||(q.difficulty="Wybierz poziom trudności"),(!u||u<be.questionsCount.min||u>be.questionsCount.max)&&(q.questionsCount=be.questionsCount.errorMessage),p.length===0&&(q.questionTypes="Wybierz przynajmniej jeden typ pytań"),f==="material"&&!w&&(q.materialId=D.materialRequired),A(q),Object.keys(q).length===0},U=async()=>{if(G())try{const q={courseId:parseInt(i),topicId:parseInt(a),topic:l.trim(),difficulty:d,questionsCount:u,questionTypes:p,courseTitle:X?.title,topicTitle:R.find(ee=>ee.id.toString()===a)?.title,quizSource:f};if(f==="material"&&w){const ee=M?.data?.find(Je=>Je.id.toString()===w);ee&&(q.materialContent=ee.content,q.materialTitle=ee.title,q.materialId=parseInt(w),q.basedOnMaterial=!0)}else S?.materialId&&T?.data&&(q.materialContent=T.data.content,q.materialTitle=T.data.title,q.materialId=S.materialId,q.basedOnMaterial=!0);n("quiz-wizard",q),await v.executeOperation(q),t(Dt.step2)}catch(q){console.error(D.analysisError,q)}},le=q=>{b(ee=>ee.includes(q)?ee.filter(Je=>Je!==q):[...ee,q])};return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx(Ur,{step:1}),e.jsxs(P,{className:"p-8",children:[e.jsx(Vr,{title:z[1].title,description:z[1].description}),S?.materialId&&T&&e.jsxs(ge,{className:"mb-6 bg-blue-50 border-blue-200",children:[e.jsx(We,{className:"h-4 w-4 text-blue-600"}),e.jsxs(je,{className:"text-blue-800",children:[e.jsx("strong",{children:"Generujesz quiz na podstawie materiału:"}),e.jsx("br",{}),e.jsx("span",{className:"text-sm",children:T.data.title}),e.jsx("br",{}),e.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:"Pytania będą generowane z treści tego materiału"})]})]}),S&&!S.materialId&&e.jsxs(ge,{className:"mb-6",children:[e.jsx(es,{className:"h-4 w-4"}),e.jsxs(je,{children:["Tworzysz quiz dla: ",e.jsx("strong",{children:S.courseTitle}),S.topicTitle&&e.jsxs(e.Fragment,{children:[" → ",e.jsx("strong",{children:S.topicTitle})]})]})]}),v.error&&e.jsxs(ge,{variant:"destructive",className:"mb-6",children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsxs(je,{children:[D.analysisError," ",v.error]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"border-2 border-blue-200 bg-blue-50/50",children:e.jsxs(P,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xe,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"font-semibold",children:"Wybierz miejsce w kursie"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"courseId",children:["Kurs ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(me,{value:i,onValueChange:q=>{r(q),o(""),y("")},disabled:v.loading||C||!!S?.courseId,children:[e.jsx(ce,{className:N.courseId?"border-red-500":"",children:e.jsx(he,{placeholder:"Wybierz kurs..."})}),e.jsx(de,{children:j?.data?.map(q=>e.jsx(B,{value:q.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[q.icon_emoji&&e.jsx("span",{children:q.icon_emoji}),q.title]})},q.id))})]}),N.courseId&&e.jsx("p",{className:"text-sm text-red-600",children:N.courseId})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"topicId",children:["Temat ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(me,{value:a,onValueChange:q=>{o(q),y("")},disabled:!i||v.loading||!!S?.topicId,children:[e.jsx(ce,{className:N.topicId?"border-red-500":"",children:e.jsx(he,{placeholder:i?"Wybierz temat...":"Najpierw wybierz kurs..."})}),e.jsx(de,{children:R.sort((q,ee)=>q.position-ee.position).map(q=>e.jsxs(B,{value:q.id.toString(),children:[q.position,". ",q.title]},q.id))})]}),N.topicId&&e.jsx("p",{className:"text-sm text-red-600",children:N.topicId})]})]})]})}),a&&!S?.materialId&&e.jsxs("div",{children:[e.jsx(re,{children:"Źródło pytań"}),e.jsxs(uc,{value:f,onValueChange:q=>x(q),children:[e.jsxs(ro,{className:"grid w-full grid-cols-2",children:[e.jsx(Ft,{value:"general",children:"Wiedza ogólna"}),e.jsx(Ft,{value:"material",children:"Z materiału"})]}),e.jsx(Bt,{value:"general",children:e.jsx(_,{children:e.jsx(P,{className:"pt-6",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pytania będą generowane na podstawie ogólnej wiedzy z wybranego tematu"})})})}),e.jsx(Bt,{value:"material",children:e.jsx(_,{children:e.jsx(P,{className:"pt-6",children:F?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}):M?.data?.length===0?e.jsxs(ge,{children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsx(je,{children:"Brak materiałów w tym temacie. Najpierw dodaj materiał edukacyjny."})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"materialId",children:["Wybierz materiał ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(me,{value:w,onValueChange:y,disabled:v.loading,children:[e.jsx(ce,{className:N.materialId?"border-red-500":"",children:e.jsx(he,{placeholder:"Wybierz materiał..."})}),e.jsx(de,{children:M?.data?.map(q=>e.jsx(B,{value:q.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(We,{className:"w-4 h-4"}),e.jsxs("span",{children:[q.position,". ",q.title]})]})},q.id))})]}),N.materialId&&e.jsx("p",{className:"text-sm text-red-600",children:N.materialId}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pytania będą tworzone WYŁĄCZNIE z treści wybranego materiału"})]})})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"topic",children:"Temat quizu"}),e.jsx(Q,{id:"topic",type:"text",value:l,onChange:q=>c(q.target.value),placeholder:"np. Podstawy programowania w Python",disabled:v.loading,className:N.topic?"border-red-500":""}),N.topic&&e.jsx("p",{className:"text-sm text-red-600",children:N.topic}),e.jsx("p",{className:"text-sm text-gray-500",children:S?.materialId||f==="material"?"Quiz będzie generowany z treści materiału":"Możesz dostosować temat quizu lub pozostawić sugerowany"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"difficulty",children:"Poziom trudności"}),e.jsxs(me,{value:d,onValueChange:m,disabled:v.loading,children:[e.jsx(ce,{className:N.difficulty?"border-red-500":"",children:e.jsx(he,{placeholder:"Wybierz poziom..."})}),e.jsxs(de,{children:[e.jsx(B,{value:"easy",children:"Łatwy"}),e.jsx(B,{value:"medium",children:"Średni"}),e.jsx(B,{value:"hard",children:"Trudny"})]})]}),N.difficulty&&e.jsx("p",{className:"text-sm text-red-600",children:N.difficulty})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"questionsCount",children:"Liczba pytań"}),e.jsx(Q,{id:"questionsCount",type:"number",value:u,onChange:q=>h(parseInt(q.target.value)||0),min:be.questionsCount.min,max:be.questionsCount.max,disabled:v.loading,className:N.questionsCount?"border-red-500":""}),N.questionsCount&&e.jsx("p",{className:"text-sm text-red-600",children:N.questionsCount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{children:"Typy pytań"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xt,{id:"single",checked:p.includes("single"),onCheckedChange:()=>le("single"),disabled:v.loading}),e.jsx("label",{htmlFor:"single",className:"text-sm cursor-pointer",children:"Jednokrotny wybór"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xt,{id:"multiple",checked:p.includes("multiple"),onCheckedChange:()=>le("multiple"),disabled:v.loading}),e.jsx("label",{htmlFor:"multiple",className:"text-sm cursor-pointer",children:"Wielokrotny wybór"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xt,{id:"truefalse",checked:p.includes("truefalse"),onCheckedChange:()=>le("truefalse"),disabled:v.loading}),e.jsx("label",{htmlFor:"truefalse",className:"text-sm cursor-pointer",children:"Prawda/Fałsz"})]})]}),N.questionTypes&&e.jsx("p",{className:"text-sm text-red-600",children:N.questionTypes})]}),e.jsx(I,{onClick:U,disabled:v.loading||E&&!!S?.materialId,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",size:"lg",children:v.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),S?.materialId||f==="material"?"Analizuję materiał...":z[1].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),z[1].button]})})]})]})]})})},W1=()=>{const t=J(),{getData:s}=Ke(),n=s("quiz-wizard"),{steps:i}=wi,r=o=>{switch(o){case"easy":return"Łatwy";case"medium":return"Średni";case"hard":return"Trudny";default:return o}},a=o=>{switch(o){case"single":return"Jednokrotny wybór";case"multiple":return"Wielokrotny wybór";case"truefalse":return"Prawda/Fałsz";default:return o}};return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx(Ur,{step:2}),e.jsxs(P,{className:"p-8",children:[e.jsx(Vr,{title:i[2].title,description:i[2].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ge,{className:"bg-green-50 border-green-200",children:[e.jsx(st,{className:"h-4 w-4 text-green-600"}),e.jsx(je,{className:"text-green-800",children:i[2].success})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"bg-gray-50 border-gray-200",children:e.jsxs(P,{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Temat"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:n.topic})]}),n.basedOnMaterial&&n.materialTitle&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Materiał źródłowy"}),e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[e.jsx(We,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:n.materialTitle})]}),e.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Pytania będą generowane wyłącznie z treści tego materiału"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Cele sprawdzające"}),e.jsx("div",{className:"text-gray-800 whitespace-pre-wrap",children:n.learningObjectives})]})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(_,{className:"border-purple-200 bg-purple-50/50",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ze,{className:"w-5 h-5 text-purple-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Kluczowe zagadnienia"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.keyTopics?.map((o,l)=>e.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm",children:o},l))}),n.basedOnMaterial&&e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"* Zagadnienia wyodrębnione z materiału źródłowego"})]})]})})}),e.jsx(_,{className:"border-blue-200 bg-blue-50/50",children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Se,{className:"w-5 h-5 text-blue-600 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Parametry quizu"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Poziom:"})," ",r(n.difficulty)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Liczba pytań:"})," ",n.questionsCount]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Typy pytań:"})," ",n.questionTypes?.map(o=>a(o)).join(", ")]})]})]})]})})})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsx(_,{children:e.jsxs(P,{className:"p-4 text-center",children:[e.jsx(Se,{className:"w-8 h-8 text-indigo-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.suggestedTime}),e.jsx("div",{className:"text-sm text-gray-600",children:"minut"})]})}),e.jsx(_,{children:e.jsxs(P,{className:"p-4 text-center",children:[e.jsx(ze,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[n.passingScore,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"próg zaliczenia"})]})}),e.jsx(_,{children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Lokalizacja"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("p",{children:n.courseTitle}),e.jsxs("p",{className:"text-xs",children:["→ ",n.topicTitle]})]})]})})]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(Dt.step1),children:"Wstecz"}),e.jsx(I,{onClick:()=>t(Dt.step3),className:"bg-blue-600 hover:bg-blue-700",children:"Kontynuuj"})]})]})]})]})})},K1=()=>{const t=J(),{getData:s,setData:n}=Ke(),i=s("quiz-wizard"),[r,a]=g.useState(i.quizTitle||""),[o,l]=g.useState(i.passingScore||70),[c,d]=g.useState(i.timeLimit||""),[m,u]=g.useState(i.maxAttempts||""),[h,p]=g.useState(!1),[b,f]=g.useState(!0),[x,w]=g.useState({}),y=Tn("quiz-wizard",i.basedOnMaterial?"generate-quiz-from-material":"generate-quiz-questions"),{steps:N,errors:A}=wi;g.useEffect(()=>{const v=i.basedOnMaterial?B1:F1;return y.registerOperation(v),()=>{y.unregisterOperation()}},[i.basedOnMaterial]);const S=()=>{const v={};return(!r.trim()||r.length<be.quizTitle.minLength)&&(v.quizTitle=be.quizTitle.errorMessage),(!o||o<be.passingScore.min||o>be.passingScore.max)&&(v.passingScore=be.passingScore.errorMessage),c&&(parseInt(c)<be.timeLimit.min||parseInt(c)>be.timeLimit.max)&&(v.timeLimit=be.timeLimit.errorMessage),m&&(parseInt(m)<be.maxAttempts.min||parseInt(m)>be.maxAttempts.max)&&(v.maxAttempts=be.maxAttempts.errorMessage),w(v),Object.keys(v).length===0},k=async()=>{if(S())try{const v={...i,quizTitle:r.trim(),passingScore:o,timeLimit:c?parseInt(c):null,maxAttempts:m?parseInt(m):null,shuffleQuestions:h,showExplanations:b};n("quiz-wizard",v),await y.executeOperation(v),t(Dt.step4)}catch(v){console.error(A.generationError,v)}};return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx(Ur,{step:3}),e.jsxs(P,{className:"p-8",children:[e.jsx(Vr,{title:N[3].title,description:N[3].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"quizTitle",children:["Tytuł quizu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Q,{id:"quizTitle",value:r,onChange:v=>a(v.target.value),placeholder:"np. Test wiedzy - Zmienne i typy danych",className:x.quizTitle?"border-red-500":""}),x.quizTitle&&e.jsx("p",{className:"text-sm text-red-600",children:x.quizTitle})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"passingScore",children:["Próg zaliczenia (%) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Q,{id:"passingScore",type:"number",value:o,onChange:v=>l(parseInt(v.target.value)||0),min:be.passingScore.min,max:be.passingScore.max,className:x.passingScore?"border-red-500":""}),x.passingScore&&e.jsx("p",{className:"text-sm text-red-600",children:x.passingScore})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"timeLimit",children:"Limit czasu (min)"}),e.jsx(Q,{id:"timeLimit",type:"number",value:c,onChange:v=>d(v.target.value),placeholder:"Pozostaw puste dla braku limitu",min:be.timeLimit.min,max:be.timeLimit.max,className:x.timeLimit?"border-red-500":""}),x.timeLimit&&e.jsx("p",{className:"text-sm text-red-600",children:x.timeLimit})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(re,{htmlFor:"maxAttempts",children:"Maksymalna liczba podejść"}),e.jsx(Q,{id:"maxAttempts",type:"number",value:m,onChange:v=>u(v.target.value),placeholder:"Pozostaw puste dla nieograniczonej liczby",min:be.maxAttempts.min,max:be.maxAttempts.max,className:x.maxAttempts?"border-red-500":""}),x.maxAttempts&&e.jsx("p",{className:"text-sm text-red-600",children:x.maxAttempts})]}),e.jsx(_,{className:"border-gray-200",children:e.jsxs(P,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xt,{id:"shuffleQuestions",checked:h,onCheckedChange:v=>p(v)}),e.jsx("label",{htmlFor:"shuffleQuestions",className:"text-sm cursor-pointer",children:"Losowa kolejność pytań"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Xt,{id:"showExplanations",checked:b,onCheckedChange:v=>f(v)}),e.jsx("label",{htmlFor:"showExplanations",className:"text-sm cursor-pointer",children:"Pokazuj wyjaśnienia po odpowiedzi"})]})]})}),i.basedOnMaterial&&e.jsxs(ge,{className:"bg-blue-50 border-blue-200",children:[e.jsx(es,{className:"h-4 w-4 text-blue-600"}),e.jsxs(je,{className:"text-blue-800",children:[e.jsx("strong",{children:"Uwaga:"}),' Pytania będą generowane wyłącznie z treści materiału "',i.materialTitle,'". AI utworzy tylko pytania, na które odpowiedzi znajdują się w materiale.']})]}),y.loading&&e.jsxs(ge,{className:"bg-purple-50 border-purple-200",children:[e.jsx(es,{className:"h-4 w-4 text-purple-600"}),e.jsx(je,{className:"text-purple-800",children:i.basedOnMaterial?"⚡ AI analizuje materiał i generuje pytania na podstawie jego treści...":N[3].loadingInfo})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(Dt.step2),children:"Wstecz"}),e.jsx(I,{onClick:k,disabled:y.loading,className:"bg-blue-600 hover:bg-blue-700",children:y.loading?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),N[3].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),N[3].button]})})]})]})]})]})})},G1=()=>{const t=J(),{getData:s}=Ke(),n=s("quiz-wizard"),{steps:i}=wi,r=o=>{switch(o){case"single":return"Jednokrotny wybór";case"multiple":return"Wielokrotny wybór";case"truefalse":return"Prawda/Fałsz";default:return o}},a=o=>{switch(o){case"single":return"default";case"multiple":return"secondary";case"truefalse":return"outline";default:return"default"}};return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx(Ur,{step:4}),e.jsxs(P,{className:"p-8",children:[e.jsx(Vr,{title:e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"w-8 h-8 text-blue-600"}),e.jsx("span",{children:i[4].title})]}),description:i[4].description}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(_,{className:"bg-gradient-to-r from-blue-50 to-cyan-50 border-blue-200",children:e.jsxs(P,{className:"p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-3",children:n.quizTitle}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(dt,{className:"w-8 h-8 text-indigo-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:n.questions?.length||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"pytań"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(ze,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[n.passingScore,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"próg zaliczenia"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(Se,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.timeLimit||"∞"}),e.jsx("div",{className:"text-sm text-gray-600",children:"minut"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Łącznie"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.questions?.reduce((o,l)=>o+l.points,0)||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"punktów"})]})]})]})}),e.jsx("h4",{className:"font-semibold text-lg",children:"Lista pytań - podgląd"}),e.jsx("div",{className:"space-y-4",children:n.questions?.map((o,l)=>e.jsxs(_,{className:"overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-4 py-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("h5",{className:"font-medium",children:["Pytanie ",l+1]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(H,{variant:a(o.type),children:r(o.type)}),e.jsxs(H,{variant:"outline",children:[o.points," pkt"]})]})]})}),e.jsxs(P,{className:"p-4 space-y-3",children:[e.jsx("p",{className:"text-gray-700",children:o.question}),e.jsx("div",{className:"space-y-2",children:o.options?.map((c,d)=>e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded ${c.is_correct?"bg-green-50 border border-green-200":"bg-gray-50"}`,children:[c.is_correct?e.jsx(ot,{className:"w-4 h-4 text-green-600 flex-shrink-0"}):e.jsx(vt,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:c.is_correct?"font-medium":"",children:c.text})]},d))}),o.explanation&&e.jsx("div",{className:"bg-blue-50 p-3 rounded border border-blue-200",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Wyjaśnienie:"})," ",o.explanation]})})]})]},l))}),e.jsxs(ge,{className:"bg-blue-50 border-blue-200",children:[e.jsx(es,{className:"h-4 w-4 text-blue-600"}),e.jsx(je,{className:"text-blue-800",children:i[4].info})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>t(Dt.step3),children:"Wstecz"}),e.jsx(I,{onClick:()=>t(Dt.step5),className:"bg-blue-600 hover:bg-blue-700",children:"Przejdź do zapisywania"})]})]})]})]})})},H1=()=>{const t=J(),{getData:s,setData:n}=Ke(),{mutate:i}=fs(),{mutate:r}=fs(),a=s("quiz-wizard"),[o,l]=g.useState(a.quizTitle||""),[c,d]=g.useState({}),[m,u]=g.useState(!1),[h,p]=g.useState(!1),{steps:b,errors:f}=wi,{data:x}=ie({resource:"activities",filters:[{field:"topic_id",operator:"eq",value:a.topicId}],sorters:[{field:"position",order:"desc"}],pagination:{pageSize:1},queryOptions:{enabled:!!a.topicId}}),w=x?.data?.[0]?.position?x.data[0].position+1:1;g.useEffect(()=>{(!a.courseId||!a.topicId||!a.questions)&&(W.error("Brak danych z poprzednich kroków. Wracam do początku..."),t(Dt.step1))},[a,t]);const y=()=>{const A={};return(!o.trim()||o.length<be.quizTitle.minLength)&&(A.finalTitle=be.quizTitle.errorMessage),(!a.questions||a.questions.length===0)&&(A.questions=f.noQuestions),d(A),Object.keys(A).length===0},N=async()=>{if(y()){u(!0),p(!1);try{i({resource:"activities",values:{topic_id:parseInt(a.topicId),type:"quiz",title:o.trim(),position:w,duration_min:a.suggestedTime||a.timeLimit||30,is_published:!1,passing_score:a.passingScore,time_limit:a.timeLimit||null,max_attempts:a.maxAttempts||null}},{onSuccess:async A=>{const S=A.data.id;try{for(let v=0;v<a.questions.length;v++){const z=a.questions[v];await new Promise((D,j)=>{r({resource:"questions",values:{activity_id:S,question:z.question,explanation:z.explanation,points:z.points,position:v+1,options:z.options.map((C,T)=>({id:T+1,text:C.text,is_correct:C.is_correct}))}},{onSuccess:D,onError:j})})}n("quiz-wizard",{...a,finalTitle:o.trim(),activityId:S,saved:!0}),u(!1),p(!0);const k=sessionStorage.getItem("returnUrl");setTimeout(()=>{sessionStorage.removeItem("wizardContext"),k?(sessionStorage.removeItem("returnUrl"),t(k)):t(`/teacher/courses/show/${a.courseId}?expanded=${a.topicId}`)},1e3)}catch(k){u(!1),p(!1),console.error("Błąd podczas zapisywania pytań:",k),W.error("Wystąpił błąd podczas zapisywania pytań. Spróbuj ponownie.")}},onError:A=>{u(!1),p(!1),console.error(f.saveError,A),A?.code==="42501"?W.error("Brak uprawnień do tworzenia quizów. Sprawdź swoje uprawnienia."):A?.code==="23505"?W.error("Quiz o takiej nazwie już istnieje."):W.error(f.saveError)}})}catch(A){u(!1),p(!1),console.error(f.unexpectedError,A),W.error(f.unexpectedError)}}};return e.jsx(K,{children:e.jsxs(_,{className:"border-2 shadow-lg",children:[e.jsx(Ur,{step:5}),e.jsxs(P,{className:"p-8",children:[e.jsx(Vr,{title:e.jsxs(e.Fragment,{children:[e.jsx(dt,{className:"w-8 h-8 text-blue-600"}),e.jsx("span",{children:b[5].title})]}),description:b[5].description}),h&&e.jsxs(ge,{className:"mb-6 bg-green-50 border-green-200",children:[e.jsx(st,{className:"h-4 w-4 text-green-600"}),e.jsx(je,{className:"text-green-800",children:b[5].success})]}),e.jsxs("form",{className:"space-y-6",onSubmit:A=>{A.preventDefault(),N()},children:[e.jsx(_,{className:"bg-gradient-to-r from-blue-50 to-cyan-50 border-blue-200",children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Lokalizacja quizu:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(st,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Kurs:"})," ",a.courseTitle]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(st,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Temat:"})," ",a.topicTitle]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(st,{className:"w-4 h-4 text-green-600 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Pozycja:"})," ",w]})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(re,{htmlFor:"finalTitle",children:["Tytuł quizu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Q,{id:"finalTitle",type:"text",value:o,onChange:A=>l(A.target.value),placeholder:"Tytuł quizu",maxLength:be.quizTitle.maxLength,className:c.finalTitle?"border-red-500":""}),c.finalTitle&&e.jsx("p",{className:"text-sm text-red-600",children:c.finalTitle}),e.jsx("p",{className:"text-sm text-gray-500",children:"Możesz dostosować tytuł quizu przed zapisaniem"})]}),e.jsx(_,{children:e.jsxs(P,{className:"p-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Podsumowanie quizu"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Liczba pytań:"}),e.jsx("span",{className:"ml-2 font-medium",children:a.questions?.length||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Próg zaliczenia:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[a.passingScore,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Limit czasu:"}),e.jsx("span",{className:"ml-2 font-medium",children:a.timeLimit?`${a.timeLimit} min`:"Brak"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Łączna liczba punktów:"}),e.jsx("span",{className:"ml-2 font-medium",children:a.questions?.reduce((A,S)=>A+S.points,0)||0})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-medium",children:["Pytania (",a.questions?.length||0,")"]}),e.jsx(_,{className:"max-h-64 overflow-hidden",children:e.jsx(P,{className:"p-0",children:e.jsx("div",{className:"overflow-y-auto max-h-64",children:a.questions?.map((A,S)=>e.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 border-b",children:[e.jsxs("span",{className:"text-sm truncate flex-1",children:[S+1,". ",A.question]}),e.jsxs(H,{variant:"outline",className:"ml-2",children:[A.points," pkt"]})]},S))})})})]}),e.jsxs(ge,{className:"bg-yellow-50 border-yellow-200",children:[e.jsx(Is,{className:"h-4 w-4 text-yellow-800"}),e.jsx(je,{className:"text-yellow-800",children:"Po zapisaniu będziesz mógł edytować pytania w panelu zarządzania quizem"})]}),e.jsx(ge,{className:"bg-blue-50 border-blue-200",children:e.jsx(je,{className:"text-blue-800",children:b[5].saveInfo})}),e.jsx(fi,{}),e.jsxs("footer",{className:"flex justify-between gap-4",children:[e.jsxs(I,{type:"button",variant:"outline",onClick:()=>t(Dt.step4),disabled:m,className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"Wstecz"]}),e.jsx(I,{type:"submit",disabled:m||h,className:"flex items-center gap-2 min-w-[160px] bg-blue-600 hover:bg-blue-700",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),b[5].loading]}):e.jsxs(e.Fragment,{children:[e.jsx(Dr,{className:"w-4 h-4"}),b[5].button]})})]})]})]})]})})},Q1=[e.jsx(V,{path:"/quiz-wizard",element:e.jsx(U1,{})},"quiz-dashboard"),e.jsx(V,{path:"/quiz-wizard/step1",element:e.jsx(V1,{})},"quiz-step1"),e.jsx(V,{path:"/quiz-wizard/step2",element:e.jsx(W1,{})},"quiz-step2"),e.jsx(V,{path:"/quiz-wizard/step3",element:e.jsx(K1,{})},"quiz-step3"),e.jsx(V,{path:"/quiz-wizard/step4",element:e.jsx(G1,{})},"quiz-step4"),e.jsx(V,{path:"/quiz-wizard/step5",element:e.jsx(H1,{})},"quiz-step5")],zu={name:"quiz-wizard",list:"/quiz-wizard",create:"/quiz-wizard/step1",meta:{canDelete:!1,label:"Kreator quizów",icon:e.jsx(Pr,{className:"h-4 w-4"})}},Z1=()=>{const{activityId:t}=ut();J();const[s,n]=g.useState(null),[i,r]=g.useState(!1),{data:a,isLoading:o}=Ue({resource:"activities",id:t,meta:{select:"*, topics(*, courses(*))"}}),{data:l,isLoading:c,refetch:d}=ie({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(t)}],sorters:[{field:"position",order:"asc"}],pagination:{mode:"off"}}),{mutate:m}=fs(),{mutate:u}=Qa(),{mutate:h}=jn();if(o||c)return e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const p=a?.data,b=l?.data||[];return e.jsxs(K,{children:[e.jsx(kn,{}),e.jsxs(Z,{children:[e.jsx(ve,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"w-6 h-6 text-blue-500"}),"Pytania quizu"]}),description:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-medium",children:p?.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[p?.topics?.courses?.title," → Temat"," ",p?.topics?.position,": ",p?.topics?.title]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(H,{variant:"outline",className:"text-base px-3 py-1",children:[b.length," ",b.length===1?"pytanie":"pytań"]}),e.jsxs(I,{onClick:()=>r(!0),disabled:i,children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Dodaj pytanie"]})]})]}),e.jsx(_,{className:"bg-muted/50",children:e.jsx(P,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Próg zaliczenia:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[p?.passing_score||70,"%"]})]}),p?.time_limit&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Limit czasu:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[p.time_limit," min"]})]}),p?.max_attempts&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Max. prób:"}),e.jsx("span",{className:"ml-2 font-medium",children:p.max_attempts})]})]})})}),i&&e.jsx(Su,{activityId:parseInt(t),position:b.length+1,onSave:f=>{m({resource:"questions",values:f},{onSuccess:()=>{W.success("Pytanie zostało dodane"),r(!1),d()}})},onCancel:()=>r(!1)}),e.jsx("div",{className:"space-y-4",children:b.map(f=>e.jsx("div",{children:s===f.id?e.jsx(Su,{question:f,activityId:parseInt(t),position:f.position,onSave:x=>{u({resource:"questions",id:f.id,values:x},{onSuccess:()=>{W.success("Pytanie zostało zaktualizowane"),n(null),d()}})},onCancel:()=>n(null)}):e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(Z,{children:[e.jsxs(L,{className:"text-base",children:[e.jsxs("span",{className:"text-muted-foreground mr-2",children:["#",f.position]}),f.question]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(H,{variant:"outline",children:[f.points," pkt"]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>n(f.id),children:e.jsx(Ht,{className:"w-3 h-3"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{confirm("Czy na pewno chcesz usunąć to pytanie?")&&h({resource:"questions",id:f.id},{onSuccess:()=>{W.success("Pytanie zostało usunięte"),d()}})},children:e.jsx(xs,{className:"w-3 h-3 text-red-600"})})]})]})}),e.jsxs(P,{children:[e.jsx("div",{className:"space-y-2",children:f.options.map((x,w)=>e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded ${x.is_correct?"bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800":""}`,children:[x.is_correct?e.jsx(ot,{className:"w-4 h-4 text-green-600"}):e.jsx(vt,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:x.is_correct?"font-medium":"",children:x.text})]},x.id||w))}),f.explanation&&e.jsxs("div",{className:"mt-4 p-3 bg-muted rounded",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Wyjaśnienie:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.explanation})]})]})]})},f.id))}),b.length===0&&!i&&e.jsx(_,{children:e.jsxs(P,{className:"text-center py-12",children:[e.jsx(dt,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground/50"}),e.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-4",children:"Quiz nie ma jeszcze żadnych pytań"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Dodaj pierwsze pytanie, aby uczniowie mogli rozwiązać quiz"}),e.jsxs(I,{onClick:()=>r(!0),children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),"Dodaj pierwsze pytanie"]})]})}),b.length>0&&e.jsxs("div",{className:"flex justify-between items-center pt-6 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Łącznie punktów: ",b.reduce((f,x)=>f+x.points,0)]}),e.jsx(kn,{variant:"outline",children:"Zakończ edycję"})]})]})},Su=({question:t,activityId:s,position:n,onSave:i,onCancel:r})=>{const[a,o]=g.useState({question:t?.question||"",explanation:t?.explanation||"",points:t?.points||1,position:n,options:t?.options||[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]}),l=()=>{if(!a.question.trim()){W.error("Pytanie jest wymagane");return}const m=a.options.filter(h=>h.text.trim());if(m.length<2){W.error("Dodaj przynajmniej 2 odpowiedzi");return}if(m.filter(h=>h.is_correct).length===0){W.error("Zaznacz przynajmniej jedną poprawną odpowiedź");return}i({activity_id:s,question:a.question,explanation:a.explanation||null,points:a.points,position:a.position,options:m.map((h,p)=>({...h,position:p+1}))})},c=()=>{a.options.length<6&&o({...a,options:[...a.options,{text:"",is_correct:!1}]})},d=m=>{if(a.options.length>2){const u=a.options.filter((h,p)=>p!==m);o({...a,options:u})}};return e.jsxs(_,{className:"border-primary",children:[e.jsx(O,{children:e.jsx(L,{children:t?"Edytuj pytanie":"Nowe pytanie"})}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Treść pytania"}),e.jsx(Nt,{placeholder:"Wprowadź treść pytania...",value:a.question,onChange:m=>o({...a,question:m.target.value}),className:"mt-1",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Liczba punktów"}),e.jsx(Q,{type:"number",min:"1",value:a.points,onChange:m=>o({...a,points:parseInt(m.target.value)||1}),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Pozycja"}),e.jsx(Q,{type:"number",min:"1",value:a.position,onChange:m=>o({...a,position:parseInt(m.target.value)||1}),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Odpowiedzi"}),a.options.length<6&&e.jsxs(I,{type:"button",size:"sm",variant:"outline",onClick:c,children:[e.jsx(qe,{className:"w-3 h-3 mr-1"}),"Dodaj opcję"]})]}),e.jsx("div",{className:"space-y-2",children:a.options.map((m,u)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Xt,{checked:m.is_correct,onCheckedChange:h=>{const p=[...a.options];p[u].is_correct=h,o({...a,options:p})}}),e.jsx(Q,{placeholder:`Odpowiedź ${u+1}`,value:m.text,onChange:h=>{const p=[...a.options];p[u].text=h.target.value,o({...a,options:p})},className:"flex-1"}),a.options.length>2&&e.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:()=>d(u),children:e.jsx(vt,{className:"w-4 h-4"})})]},u))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Zaznacz checkbox przy poprawnych odpowiedziach. Możesz zaznaczyć więcej niż jedną."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Wyjaśnienie (opcjonalne)"}),e.jsx(Nt,{placeholder:"Wyjaśnienie poprawnej odpowiedzi...",value:a.explanation,onChange:m=>o({...a,explanation:m.target.value}),className:"mt-1",rows:3})]}),e.jsxs(Z,{children:[e.jsxs(I,{variant:"outline",onClick:r,children:[e.jsx(vt,{className:"w-4 h-4 mr-2"}),"Anuluj"]}),e.jsxs(I,{onClick:l,children:[e.jsx(Dr,{className:"w-4 h-4 mr-2"}),"Zapisz pytanie"]})]})]})]})},Y1=()=>{const[t]=Ha(),s=J(),n=t.get("activity_id"),{data:i,isLoading:r}=ie({resource:"questions",filters:[{field:"activity_id",operator:"eq",value:parseInt(n)}],sorters:[{field:"position",order:"desc"}],pagination:{mode:"off"}}),[a,o]=g.useState({question:"",explanation:"",points:1,position:1,options:[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]});g.useEffect(()=>{if(i?.data){const f=i.data.reduce((x,w)=>Math.max(x,w.position||0),0);o(x=>({...x,position:f+1}))}},[i]);const{data:l,isLoading:c}=Ue({resource:"activities",id:n,meta:{select:"*, topics(*, courses(*))"}}),{mutate:d,isLoading:m}=fs();if(!n)return e.jsx(K,{children:e.jsx(_,{children:e.jsx(P,{className:"text-center py-12",children:e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"Brak ID aktywności"})})})});if(c||r)return e.jsx(K,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})});const u=l?.data;if(!u||u.type!=="quiz")return e.jsx(K,{children:e.jsx(_,{children:e.jsx(P,{className:"text-center py-12",children:e.jsx("p",{className:"text-lg font-medium text-muted-foreground",children:"Nieprawidłowa aktywność lub aktywność nie jest quizem"})})})});const h=()=>{if(!a.question.trim()){W.error("Pytanie jest wymagane");return}const f=a.options.filter(w=>w.text.trim());if(f.length<2){W.error("Dodaj przynajmniej 2 odpowiedzi");return}if(f.filter(w=>w.is_correct).length===0){W.error("Zaznacz przynajmniej jedną poprawną odpowiedź");return}d({resource:"questions",values:{activity_id:parseInt(n),question:a.question,explanation:a.explanation||null,points:a.points,position:a.position,options:f.map((w,y)=>({id:y+1,text:w.text,is_correct:w.is_correct}))}},{onSuccess:()=>{W.success("Pytanie zostało dodane"),s(`/teacher/questions/manage/${n}`)},onError:w=>{console.error("Błąd podczas dodawania pytania:",w);const y=w?.code||w?.statusCode,N=w?.message||w?.error?.message;y==="23505"||y===23505?N?.includes("position")?W.error("Pytanie o tej pozycji już istnieje. Zmień pozycję na inną wartość."):W.error("Wystąpił konflikt z istniejącymi danymi. Sprawdź pozycję pytania."):y==="23503"||y===23503?W.error("Nieprawidłowe powiązanie z aktywnością."):y==="22P02"||y===22002?W.error("Nieprawidłowy format danych."):N?W.error(`Błąd: ${N}`):W.error("Wystąpił nieoczekiwany błąd. Spróbuj ponownie.")}})},p=()=>{a.options.length<6&&o({...a,options:[...a.options,{text:"",is_correct:!1}]})},b=f=>{if(a.options.length>2){const x=a.options.filter((w,y)=>y!==f);o({...a,options:x})}};return e.jsxs(K,{children:[e.jsx(kn,{}),e.jsx(Z,{children:e.jsx(ve,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"w-6 h-6 text-blue-500"}),"Dodaj pytanie do quizu"]}),description:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-medium",children:u?.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[u?.topics?.courses?.title," → Temat"," ",u?.topics?.position,": ",u?.topics?.title]})]})})}),e.jsxs(_,{children:[e.jsx(O,{children:e.jsx(L,{children:"Nowe pytanie"})}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Treść pytania"}),e.jsx(Nt,{placeholder:"Wprowadź treść pytania...",value:a.question,onChange:f=>o({...a,question:f.target.value}),className:"mt-1",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Liczba punktów"}),e.jsx(Q,{type:"number",min:"1",value:a.points,onChange:f=>o({...a,points:parseInt(f.target.value)||1}),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Pozycja"}),e.jsx(Q,{type:"number",min:"1",value:a.position,onChange:f=>o({...a,position:parseInt(f.target.value)||1}),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Odpowiedzi"}),a.options.length<6&&e.jsxs(I,{type:"button",size:"sm",variant:"outline",onClick:p,children:[e.jsx(qe,{className:"w-3 h-3 mr-1"}),"Dodaj opcję"]})]}),e.jsx("div",{className:"space-y-2",children:a.options.map((f,x)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Xt,{checked:f.is_correct,onCheckedChange:w=>{const y=[...a.options];y[x].is_correct=w,o({...a,options:y})}}),e.jsx(Q,{placeholder:`Odpowiedź ${x+1}`,value:f.text,onChange:w=>{const y=[...a.options];y[x].text=w.target.value,o({...a,options:y})},className:"flex-1"}),a.options.length>2&&e.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:()=>b(x),children:e.jsx(vt,{className:"w-4 h-4"})})]},x))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Zaznacz checkbox przy poprawnych odpowiedziach. Możesz zaznaczyć więcej niż jedną."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Wyjaśnienie (opcjonalne)"}),e.jsx(Nt,{placeholder:"Wyjaśnienie poprawnej odpowiedzi...",value:a.explanation,onChange:f=>o({...a,explanation:f.target.value}),className:"mt-1",rows:3})]}),e.jsxs(Z,{children:[e.jsxs(I,{variant:"outline",onClick:()=>s(`/teacher/questions/manage/${n}`),children:[e.jsx(vt,{className:"w-4 h-4 mr-2"}),"Anuluj"]}),e.jsxs(I,{onClick:h,disabled:m,children:[e.jsx(Dr,{className:"w-4 h-4 mr-2"}),m?"Zapisywanie...":"Zapisz pytanie"]})]})]})]})]})},J1=[e.jsx(V,{path:"/questions/manage/:activityId",element:e.jsx(Z1,{})},"questions-manage"),e.jsx(V,{path:"/questions/create",element:e.jsx(Y1,{})},"questions-create")],X1=[{id:"course-structure",title:"Generator struktury kursu",description:"Stwórz kompletną strukturę kursu z harmonogramem i tematami",icon:ri,path:"/teacher/course-structure",color:"from-indigo-50 to-blue-50",borderColor:"border-indigo-200",iconBg:"bg-indigo-100",iconColor:"text-indigo-600",buttonBg:"bg-indigo-600 hover:bg-indigo-700",features:["Automatyczna analiza wymagań","Generowanie harmonogramu","Podział na tygodnie i tematy","Zgodność z podstawą programową"],estimatedTime:"15-20 min",targetAudience:"Twórcy nowych kursów"},{id:"educational-material",title:"Kreator materiałów edukacyjnych",description:"Generuj angażujące materiały dydaktyczne dostosowane do wieku uczniów",icon:xe,path:"/teacher/educational-material",color:"from-purple-50 to-pink-50",borderColor:"border-purple-200",iconBg:"bg-purple-100",iconColor:"text-purple-600",buttonBg:"bg-purple-600 hover:bg-purple-700",features:["Materiały dostosowane do wieku","Ćwiczenia praktyczne","Formatowanie Markdown","Integracja z istniejącymi kursami"],estimatedTime:"10-15 min",targetAudience:"Nauczyciele wszystkich poziomów"},{id:"quiz-wizard",title:"Kreator quizów",description:"Twórz profesjonalne testy sprawdzające z różnymi typami pytań",icon:Ds,path:"/teacher/quiz-wizard",color:"from-blue-50 to-cyan-50",borderColor:"border-blue-200",iconBg:"bg-blue-100",iconColor:"text-blue-600",buttonBg:"bg-blue-600 hover:bg-blue-700",features:["Różne typy pytań","Automatyczne wyjaśnienia","Konfiguracja parametrów","Inteligentne punktowanie"],estimatedTime:"10-15 min",targetAudience:"Do sprawdzania wiedzy"}],eS=()=>{const t=J();return e.jsxs(K,{children:[e.jsx(ve,{title:"Narzędzia AI dla nauczycieli",description:"Wykorzystaj sztuczną inteligencję do tworzenia wysokiej jakości materiałów edukacyjnych"}),e.jsx("div",{className:"mb-8 p-6 bg-gradient-to-r from-violet-50 to-purple-50 rounded-lg border border-purple-200",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(lt,{className:"w-8 h-8 text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Przyspiesz tworzenie materiałów z AI"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Nasze narzędzia AI pomagają tworzyć spersonalizowane materiały edukacyjne w ułamku czasu potrzebnego na tradycyjne przygotowanie. Każdy kreator prowadzi Cię krok po kroku przez proces tworzenia."}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"Oszczędność czasu do 80%"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"Dostosowane do programu nauczania"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"Personalizacja dla różnych grup"})]})]})]})]})}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:X1.map(s=>{const n=s.icon;return e.jsxs(_,{className:`hover:shadow-lg transition-shadow cursor-pointer border-2 ${s.borderColor}`,onClick:()=>t(s.path),children:[e.jsxs(O,{children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${s.iconBg}`,children:e.jsx(n,{className:`w-6 h-6 ${s.iconColor}`})}),e.jsx(ae,{className:"w-5 h-5 text-gray-400"})]}),e.jsx(L,{className:"text-lg",children:s.title}),e.jsx(Me,{children:s.description})]}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"Główne funkcje:"}),e.jsx("ul",{className:"space-y-1",children:s.features.slice(0,3).map((i,r)=>e.jsxs("li",{className:"text-xs text-gray-600 flex items-start gap-1",children:[e.jsx("span",{className:"text-green-500 mt-0.5",children:"•"}),e.jsx("span",{children:i})]},r))})]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx(Se,{className:"w-3 h-3 inline mr-1"}),s.estimatedTime]}),e.jsxs(I,{size:"sm",className:`${s.buttonBg} text-white`,children:[e.jsx(Pr,{className:"w-3 h-3 mr-1"}),"Rozpocznij"]})]})]})})]},s.id)})}),e.jsxs("div",{className:"mt-8 p-6 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(dt,{className:"w-5 h-5 text-blue-600"}),"Wskazówki dla najlepszych rezultatów"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-1",children:"Przed rozpoczęciem:"}),e.jsxs("ul",{className:"space-y-1 text-gray-600",children:[e.jsx("li",{children:"• Przygotuj podstawowe informacje o kursie"}),e.jsx("li",{children:"• Określ grupę docelową i poziom"}),e.jsx("li",{children:"• Zaplanuj cele edukacyjne"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-1",children:"Podczas tworzenia:"}),e.jsxs("ul",{className:"space-y-1 text-gray-600",children:[e.jsx("li",{children:"• Sprawdzaj podglądy na każdym etapie"}),e.jsx("li",{children:"• Dostosuj wygenerowane treści do potrzeb"}),e.jsx("li",{children:"• Zapisuj regularnie postępy"})]})]})]})]})]})},tS=[e.jsx(V,{path:"ai-tools",element:e.jsx(eS,{})},"ai-tools")],sS=[...h0,...TN,...DN,...tS,...Kz,...J1,...T1,...R1,...Q1,...Xz,...r1,...l1,...g1],nS=()=>e.jsx(sc,{children:e.jsxs(V,{element:e.jsx(l0,{children:e.jsx(Ch,{})}),children:[e.jsx(V,{index:!0,element:e.jsx(Qs,{to:"dashboard/overview",replace:!0})}),e.jsx(V,{path:"dashboard",element:e.jsx(Qs,{to:"dashboard/overview",replace:!0})}),sS]})}),iS=g.lazy(()=>Promise.resolve({default:nS})),Wf=({text:t,colorClass:s})=>e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`inline-block h-12 w-12 animate-spin rounded-full border-4 border-current border-r-transparent ${s}`}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:t})]})}),rS=({children:t})=>{const{data:s,isLoading:n}=gt();return n||!s?e.jsx(Wf,{text:"Sprawdzanie uprawnień...",colorClass:"border-indigo-600"}):["teacher","admin"].includes(s.role)?e.jsx(e.Fragment,{children:t}):e.jsx(Qs,{to:"/student/dashboard",replace:!0})},aS=e.jsx(V,{path:"/teacher/*",element:e.jsx(Ph,{fallback:e.jsx(Dh,{to:"/login"}),children:e.jsx(rS,{children:e.jsx(g.Suspense,{fallback:e.jsx(Wf,{text:"Ładowanie panelu nauczyciela...",colorClass:"border-indigo-600"}),children:e.jsx(iS,{})})})},"teacher-auth")}),Wr=()=>{const[t,s]=g.useState({points:0,level:1,streak:0,idle_rate:1,next_level_points:200,quizzes_completed:0,perfect_scores:0,total_time:0,rank:0}),[n,i]=g.useState(!0),r=g.useCallback(async()=>{try{i(!0);const{data:a,error:o}=await ue.rpc("get_my_stats");if(o)throw o;a&&s({points:a.points||0,level:a.level||1,streak:a.streak||0,idle_rate:a.idle_rate||1,next_level_points:a.next_level_points||200,quizzes_completed:a.quizzes_completed||0,perfect_scores:a.perfect_scores||0,total_time:a.total_time||0,rank:a.rank||0})}catch(a){console.error("Error fetching stats:",a)}finally{i(!1)}},[]);return g.useEffect(()=>{r()},[r]),{stats:t,setStats:s,isLoading:n,refetch:r}},Ss=new Map,Kr=(t,s,n)=>{const i=n?.cacheKey||`${t}-${JSON.stringify(s)}`,[r,a]=g.useState(()=>Ss.get(i)||null),[o,l]=g.useState(!Ss.has(i)),[c,d]=g.useState(null),m=g.useCallback(async(h=!1)=>{if(n?.enabled!==!1){if(!h&&Ss.has(i)){a(Ss.get(i)),l(!1);return}try{l(!0),d(null);const{data:p,error:b}=await ue.rpc(t,s);if(b)throw b;Ss.set(i,p),a(p),n?.onSuccess?.(p)}catch(p){d(p),n?.onError?.(p)}finally{l(!1)}}},[t,i,JSON.stringify(s),n?.enabled]);g.useEffect(()=>{m()},[m]);const u=g.useCallback(()=>{Ss.delete(i)},[i]);return{data:r,isLoading:o,error:c,refetch:()=>m(!0),invalidate:u}},Cu=t=>{t?Array.from(Ss.keys()).forEach(s=>{s.includes(t)&&Ss.delete(s)}):Ss.clear()},oS=(t,s)=>{const[n,i]=g.useState([]),[r,a]=g.useState(!0),[o,l]=g.useState(null),c=g.useCallback(async()=>{if(s?.enabled!==!1)try{a(!0),l(null);let d=ue.from(t).select(s?.select||"*");s?.filters?.forEach(h=>{switch(h.operator){case"eq":d=d.eq(h.field,h.value);break;case"in":d=d.in(h.field,h.value);break;case"contains":d=d.ilike(h.field,`%${h.value}%`);break}}),s?.sorts?.forEach(h=>{d=d.order(h.field,{ascending:h.order==="asc"})}),s?.limit&&(d=d.limit(s.limit));const{data:m,error:u}=await d;if(u)throw u;i(m||[])}catch(d){l(d)}finally{a(!1)}},[t,JSON.stringify(s)]);return g.useEffect(()=>{c()},[c]),{data:n,isLoading:r,error:o,refetch:c}},Tu=({onClose:t,variant:s="sidebar"})=>{const{mutate:n}=rc(),{data:i}=gt(),r=kr(),{stats:a}=Wr(),o=[{path:"/student/dashboard",label:"Główna",icon:Ky},{path:"/student/gamification",label:"Ulepszenia",icon:xl},{path:"/student/leaderboard",label:"Ranking",icon:$e},{path:"/student/achievements",label:"Osiągnięcia",icon:yn},{path:"/student/profile",label:"Profil",icon:ir}],l=()=>{t&&t()};return s==="bottom"?e.jsx("div",{className:"grid grid-cols-5 gap-1 p-1.5",children:o.map(c=>{const d=r.pathname===c.path;return e.jsxs(za,{to:c.path,className:({isActive:m})=>$("relative flex flex-col items-center justify-center gap-1 rounded-lg p-3 transition-colors",m?"text-primary":"text-muted-foreground hover:text-foreground hover:bg-muted/50"),children:[e.jsx(c.icon,{className:"h-5 w-5"}),e.jsx("span",{className:"text-[11px] font-medium",children:c.label}),d&&e.jsx("i",{"aria-hidden":!0,className:"pointer-events-none absolute inset-x-6 -bottom-[3px] h-1 rounded-full bg-primary/70"})]},c.path)})}):e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"h-16 px-6 border-b relative grid place-items-center justify-start overflow-hidden",children:[e.jsx("i",{"aria-hidden":!0,className:"absolute -right-10 -top-10 w-28 h-28 rounded-3xl bg-gradient-to-br from-primary/10 via-secondary/10 to-accent/10 rotate-45"}),e.jsxs("div",{className:"flex items-center gap-3 relative z-10",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-secondary text-white grid place-items-center shadow",children:e.jsx(bn,{className:"w-5 h-5"})}),e.jsx("strong",{className:"text-lg",children:"Smart Up"})]}),t&&e.jsx(I,{variant:"ghost",size:"sm",onClick:t,className:"absolute right-4 lg:hidden",children:e.jsx(vt,{className:"h-4 w-4"})})]}),e.jsx("section",{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-primary/10 to-secondary/10 text-primary grid place-items-center font-bold",children:i?.full_name?.charAt(0)||"U"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 rounded-full bg-secondary text-white text-xs grid place-items-center font-bold",children:a.level})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-semibold truncate",children:i?.full_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Poziom ",a.level," • ",a.streak," dni"]})]})]})}),e.jsx("section",{className:"px-6 -mt-2 mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("article",{className:"rounded-xl border p-3 bg-primary/5 border-primary/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(nt,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Punkty"})]}),e.jsx("p",{className:"text-lg font-bold",children:a.points}),e.jsxs("p",{className:"text-xs text-primary",children:["+",a.idle_rate,"/h"]})]}),e.jsxs("article",{className:"rounded-xl border p-3 bg-destructive/5 border-destructive/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ls,{className:"w-4 h-4 text-destructive"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Seria"})]}),e.jsx("p",{className:"text-lg font-bold",children:a.streak}),e.jsx("p",{className:"text-xs text-destructive",children:"dni z rzędu"})]})]})}),e.jsx(dc,{className:"flex-1 px-4",children:e.jsx("nav",{className:"space-y-1",children:o.map(c=>e.jsxs(za,{to:c.path,onClick:l,className:({isActive:d})=>$("relative w-full flex items-center gap-3 px-4 h-11 rounded-xl transition-colors",d?"bg-primary text-primary-foreground":"hover:bg-muted/50 text-muted-foreground hover:text-foreground"),children:[e.jsx(c.icon,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:c.label})]},c.path))})}),e.jsx(fi,{}),e.jsxs("footer",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"px-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-2",children:[e.jsxs("span",{children:["Poziom ",a.level]}),e.jsxs("span",{children:["Poziom ",a.level+1]})]}),e.jsx("div",{className:"h-1.5 rounded-full bg-muted overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-primary via-secondary to-accent",style:{width:`${Math.max(0,Math.min(100,a.points%100))}%`}})})]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{n(),t&&t()},className:"w-full justify-center text-destructive border-destructive/30 bg-destructive/5 hover:bg-destructive/10",children:[e.jsx(lc,{className:"mr-2 h-4 w-4"}),"Wyloguj"]})]})]})},lS=()=>e.jsx("div",{"aria-hidden":!0,className:"pointer-events-none fixed inset-0 z-0 overflow-hidden p-0 lg:p-2.5 lg:pb-28 pt-0",children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{className:"absolute inset-0 bg-background rounded-3xl"}),e.jsxs("div",{className:"absolute inset-0 rounded-3xl overflow-hidden",children:[e.jsx("div",{className:"absolute w-[50vw] h-[50vh] bottom-0 left-0 translate-y-[25%] -translate-x-[25%] bg-orange rounded-full blur-[150px] opacity-70 dark:opacity-40"}),e.jsx("div",{className:"absolute w-[30vw] h-[30vh] bottom-0 left-1/2 -translate-x-1/2 translate-y-[20%] bg-yellow rounded-full blur-[100px] opacity-60 dark:opacity-30"}),e.jsx("div",{className:"absolute w-[50vw] h-[50vh] bottom-0 right-0 translate-y-[25%] translate-x-[25%] bg-purple rounded-full blur-[150px] opacity-70 dark:opacity-40"})]})]})}),cS=({stats:t,theme:s,onToggleTheme:n})=>{const[i,r]=g.useState(!1),{data:a}=gt(),{mutate:o}=rc();return e.jsx("header",{className:"sticky top-0 z-30 h-16 bg-card/80 backdrop-blur supports-[backdrop-filter]:bg-card/60 border-b shadow-sm hidden lg:block",children:e.jsxs("div",{className:"mx-auto max-w-6xl h-full px-4 lg:px-8 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3 min-w-0",children:e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:"Dashboard"}),e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["Witaj, ",a?.full_name?.split(" ")[0],"!"]})]})}),e.jsxs("div",{className:"flex items-center gap-2 lg:gap-3",children:[e.jsxs("button",{className:"relative p-2.5 rounded-xl hover:bg-muted focus-ring h-11 w-11 grid place-items-center","aria-label":"Powiadomienia",children:[e.jsx(Rh,{className:"w-5 h-5 text-muted-foreground"}),e.jsx("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-destructive rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 lg:px-4 h-11 rounded-xl border bg-primary/10 border-primary/20",children:[e.jsx(nt,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-semibold text-sm lg:text-base tabular-nums",children:t.points}),e.jsxs("span",{className:"hidden md:block text-xs text-primary",children:["+",t.idle_rate,"/h"]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>r(!i),className:"flex items-center gap-2 px-1.5 h-11 rounded-xl hover:bg-muted focus-ring","aria-haspopup":"menu","aria-expanded":i,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-9 h-9 lg:w-10 lg:h-10 rounded-xl bg-gradient-to-br from-primary to-secondary text-white grid place-items-center font-bold",children:a?.full_name?.charAt(0)||"U"}),e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-4 h-4 lg:w-5 lg:h-5 rounded-full bg-accent text-white text-[10px] lg:text-xs grid place-items-center border-2 border-card",children:t.level})]}),e.jsx(Tr,{className:"w-4 h-4 text-muted-foreground"})]}),i&&e.jsxs("menu",{className:"absolute right-0 mt-2 w-64 bg-card rounded-xl border shadow-soft-lg z-50 overflow-hidden",children:[e.jsxs("section",{className:"p-4 border-b",children:[e.jsx("p",{className:"font-semibold truncate",children:a?.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:a?.email})]}),e.jsxs("ul",{className:"p-2",children:[e.jsx("li",{children:e.jsxs("button",{onClick:()=>{n(),r(!1)},className:"w-full flex items-center gap-3 px-3 h-11 rounded-lg text-foreground/80 hover:text-foreground hover:bg-muted",children:[s==="dark"?e.jsx(Gy,{className:"w-4 h-4"}):e.jsx(Hy,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:s==="dark"?"Tryb jasny":"Tryb ciemny"})]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{window.location.href="/student/profile",r(!1)},className:"w-full flex items-center gap-3 px-3 h-11 rounded-lg text-foreground/80 hover:text-foreground hover:bg-muted",children:[e.jsx(ir,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Profil"})]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{window.location.href="/student/settings",r(!1)},className:"w-full flex items-center gap-3 px-3 h-11 rounded-lg text-foreground/80 hover:text-foreground hover:bg-muted",children:[e.jsx(Qy,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Ustawienia"})]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{window.location.href="/student/help",r(!1)},className:"w-full flex items-center gap-3 px-3 h-11 rounded-lg text-foreground/80 hover:text-foreground hover:bg-muted",children:[e.jsx(dt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Pomoc"})]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>{o(),r(!1)},className:"w-full flex items-center gap-3 px-3 h-11 rounded-lg text-destructive hover:bg-destructive/10",children:[e.jsx(lc,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Wyloguj"})]})})]})]})]})]})]})})},dS=({children:t})=>{const[s,n]=g.useState(!1),[i,r]=g.useState(()=>{const c=localStorage.getItem("theme");return c==="light"||c==="dark"?c:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}),{stats:a}=Wr();g.useEffect(()=>{document.documentElement.classList.toggle("dark",i==="dark"),localStorage.setItem("theme",i)},[i]);const o=()=>{r(i==="dark"?"light":"dark")},l=()=>{n(!s)};return e.jsxs("div",{className:"min-h-screen bg-background relative overflow-x-hidden",children:[e.jsx(lS,{}),e.jsxs("div",{className:"flex relative",children:[s&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/30 dark:bg-black/50 backdrop-blur-sm lg:hidden",onClick:()=>n(!1)}),e.jsx("aside",{className:`
            h-screen w-80 transform transition-transform duration-300 ease-in-out
            fixed left-0 top-0 z-50
            ${s?"translate-x-0":"-translate-x-full"}
            lg:translate-x-0 lg:w-72
            bg-card/95 backdrop-blur-xl border-r
          `,children:e.jsx(Tu,{onClose:()=>n(!1)})}),e.jsxs("main",{className:"flex-1 lg:ml-72 min-w-0 relative z-10",children:[e.jsx(cS,{stats:a,theme:i,onToggleTheme:o}),e.jsxs("div",{className:"sticky top-0 z-30 flex h-16 items-center border-b bg-card/80 backdrop-blur supports-[backdrop-filter]:bg-card/60 px-4 lg:hidden",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:l,className:"mr-2",children:e.jsx(oc,{className:"h-6 w-6"})}),e.jsx("span",{className:"font-semibold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"Smart Up"})]}),e.jsx("div",{className:"min-h-[calc(100vh-4rem)] pb-32 lg:pb-24",children:t})]})]}),e.jsx("nav",{"aria-label":"Nawigacja dolna",className:"fixed py-3.5 bottom-0 z-40 left-0 right-0 lg:left-72 bg-card/95 backdrop-blur-xl border-t",children:e.jsx(Tu,{variant:"bottom"})})]})},Pc=g.createContext({});function Dc(t){const s=g.useRef(null);return s.current===null&&(s.current=t()),s.current}const Ic=typeof window<"u",Kf=Ic?g.useLayoutEffect:g.useEffect,xo=g.createContext(null);function Mc(t,s){t.indexOf(s)===-1&&t.push(s)}function Ec(t,s){const n=t.indexOf(s);n>-1&&t.splice(n,1)}const Ms=(t,s,n)=>n>s?s:n<t?t:n;let Lc=()=>{};const Es={},Gf=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function Hf(t){return typeof t=="object"&&t!==null}const Qf=t=>/^0[^.\s]+$/u.test(t);function Oc(t){let s;return()=>(s===void 0&&(s=t()),s)}const Vt=t=>t,uS=(t,s)=>n=>s(t(n)),Gr=(...t)=>t.reduce(uS),fr=(t,s,n)=>{const i=s-t;return i===0?1:(n-t)/i};class Rc{constructor(){this.subscriptions=[]}add(s){return Mc(this.subscriptions,s),()=>Ec(this.subscriptions,s)}notify(s,n,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](s,n,i);else for(let a=0;a<r;a++){const o=this.subscriptions[a];o&&o(s,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const us=t=>t*1e3,ms=t=>t/1e3;function Zf(t,s){return s?t*(1e3/s):0}const Yf=(t,s,n)=>(((1-3*n+3*s)*t+(3*n-6*s))*t+3*s)*t,mS=1e-7,hS=12;function pS(t,s,n,i,r){let a,o,l=0;do o=s+(n-s)/2,a=Yf(o,i,r)-t,a>0?n=o:s=o;while(Math.abs(a)>mS&&++l<hS);return o}function Hr(t,s,n,i){if(t===s&&n===i)return Vt;const r=a=>pS(a,0,1,t,n);return a=>a===0||a===1?a:Yf(r(a),s,i)}const Jf=t=>s=>s<=.5?t(2*s)/2:(2-t(2*(1-s)))/2,Xf=t=>s=>1-t(1-s),ex=Hr(.33,1.53,.69,.99),$c=Xf(ex),tx=Jf($c),sx=t=>(t*=2)<1?.5*$c(t):.5*(2-Math.pow(2,-10*(t-1))),qc=t=>1-Math.sin(Math.acos(t)),nx=Xf(qc),ix=Jf(qc),fS=Hr(.42,0,1,1),xS=Hr(0,0,.58,1),rx=Hr(.42,0,.58,1),gS=t=>Array.isArray(t)&&typeof t[0]!="number",ax=t=>Array.isArray(t)&&typeof t[0]=="number",jS={linear:Vt,easeIn:fS,easeInOut:rx,easeOut:xS,circIn:qc,circInOut:ix,circOut:nx,backIn:$c,backInOut:tx,backOut:ex,anticipate:sx},yS=t=>typeof t=="string",Au=t=>{if(ax(t)){Lc(t.length===4);const[s,n,i,r]=t;return Hr(s,n,i,r)}else if(yS(t))return jS[t];return t},aa=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function bS(t,s){let n=new Set,i=new Set,r=!1,a=!1;const o=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(m){o.has(m)&&(d.schedule(m),t()),m(l)}const d={schedule:(m,u=!1,h=!1)=>{const b=h&&r?n:i;return u&&o.add(m),b.has(m)||b.add(m),m},cancel:m=>{i.delete(m),o.delete(m)},process:m=>{if(l=m,r){a=!0;return}r=!0,[n,i]=[i,n],n.forEach(c),n.clear(),r=!1,a&&(a=!1,d.process(m))}};return d}const wS=40;function ox(t,s){let n=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},a=()=>n=!0,o=aa.reduce((N,A)=>(N[A]=bS(a),N),{}),{setup:l,read:c,resolveKeyframes:d,preUpdate:m,update:u,preRender:h,render:p,postRender:b}=o,f=()=>{const N=Es.useManualTiming?r.timestamp:performance.now();n=!1,Es.useManualTiming||(r.delta=i?1e3/60:Math.max(Math.min(N-r.timestamp,wS),1)),r.timestamp=N,r.isProcessing=!0,l.process(r),c.process(r),d.process(r),m.process(r),u.process(r),h.process(r),p.process(r),b.process(r),r.isProcessing=!1,n&&s&&(i=!1,t(f))},x=()=>{n=!0,i=!0,r.isProcessing||t(f)};return{schedule:aa.reduce((N,A)=>{const S=o[A];return N[A]=(k,v=!1,z=!1)=>(n||x(),S.schedule(k,v,z)),N},{}),cancel:N=>{for(let A=0;A<aa.length;A++)o[aa[A]].cancel(N)},state:r,steps:o}}const{schedule:Ce,cancel:Xs,state:et,steps:Ho}=ox(typeof requestAnimationFrame<"u"?requestAnimationFrame:Vt,!0);let ga;function vS(){ga=void 0}const bt={now:()=>(ga===void 0&&bt.set(et.isProcessing||Es.useManualTiming?et.timestamp:performance.now()),ga),set:t=>{ga=t,queueMicrotask(vS)}},lx=t=>s=>typeof s=="string"&&s.startsWith(t),Fc=lx("--"),NS=lx("var(--"),Bc=t=>NS(t)?kS.test(t.split("/*")[0].trim()):!1,kS=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,vi={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},xr={...vi,transform:t=>Ms(0,1,t)},oa={...vi,default:1},Zi=t=>Math.round(t*1e5)/1e5,Uc=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function zS(t){return t==null}const SS=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Vc=(t,s)=>n=>!!(typeof n=="string"&&SS.test(n)&&n.startsWith(t)||s&&!zS(n)&&Object.prototype.hasOwnProperty.call(n,s)),cx=(t,s,n)=>i=>{if(typeof i!="string")return i;const[r,a,o,l]=i.match(Uc);return{[t]:parseFloat(r),[s]:parseFloat(a),[n]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},CS=t=>Ms(0,255,t),Qo={...vi,transform:t=>Math.round(CS(t))},dn={test:Vc("rgb","red"),parse:cx("red","green","blue"),transform:({red:t,green:s,blue:n,alpha:i=1})=>"rgba("+Qo.transform(t)+", "+Qo.transform(s)+", "+Qo.transform(n)+", "+Zi(xr.transform(i))+")"};function TS(t){let s="",n="",i="",r="";return t.length>5?(s=t.substring(1,3),n=t.substring(3,5),i=t.substring(5,7),r=t.substring(7,9)):(s=t.substring(1,2),n=t.substring(2,3),i=t.substring(3,4),r=t.substring(4,5),s+=s,n+=n,i+=i,r+=r),{red:parseInt(s,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const Cl={test:Vc("#"),parse:TS,transform:dn.transform},Qr=t=>({test:s=>typeof s=="string"&&s.endsWith(t)&&s.split(" ").length===1,parse:parseFloat,transform:s=>`${s}${t}`}),Us=Qr("deg"),hs=Qr("%"),Y=Qr("px"),AS=Qr("vh"),_S=Qr("vw"),_u={...hs,parse:t=>hs.parse(t)/100,transform:t=>hs.transform(t*100)},Un={test:Vc("hsl","hue"),parse:cx("hue","saturation","lightness"),transform:({hue:t,saturation:s,lightness:n,alpha:i=1})=>"hsla("+Math.round(t)+", "+hs.transform(Zi(s))+", "+hs.transform(Zi(n))+", "+Zi(xr.transform(i))+")"},Fe={test:t=>dn.test(t)||Cl.test(t)||Un.test(t),parse:t=>dn.test(t)?dn.parse(t):Un.test(t)?Un.parse(t):Cl.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?dn.transform(t):Un.transform(t),getAnimatableNone:t=>{const s=Fe.parse(t);return s.alpha=0,Fe.transform(s)}},PS=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function DS(t){return isNaN(t)&&typeof t=="string"&&(t.match(Uc)?.length||0)+(t.match(PS)?.length||0)>0}const dx="number",ux="color",IS="var",MS="var(",Pu="${}",ES=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function gr(t){const s=t.toString(),n=[],i={color:[],number:[],var:[]},r=[];let a=0;const l=s.replace(ES,c=>(Fe.test(c)?(i.color.push(a),r.push(ux),n.push(Fe.parse(c))):c.startsWith(MS)?(i.var.push(a),r.push(IS),n.push(c)):(i.number.push(a),r.push(dx),n.push(parseFloat(c))),++a,Pu)).split(Pu);return{values:n,split:l,indexes:i,types:r}}function mx(t){return gr(t).values}function hx(t){const{split:s,types:n}=gr(t),i=s.length;return r=>{let a="";for(let o=0;o<i;o++)if(a+=s[o],r[o]!==void 0){const l=n[o];l===dx?a+=Zi(r[o]):l===ux?a+=Fe.transform(r[o]):a+=r[o]}return a}}const LS=t=>typeof t=="number"?0:Fe.test(t)?Fe.getAnimatableNone(t):t;function OS(t){const s=mx(t);return hx(t)(s.map(LS))}const en={test:DS,parse:mx,createTransformer:hx,getAnimatableNone:OS};function Zo(t,s,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(s-t)*6*n:n<1/2?s:n<2/3?t+(s-t)*(2/3-n)*6:t}function RS({hue:t,saturation:s,lightness:n,alpha:i}){t/=360,s/=100,n/=100;let r=0,a=0,o=0;if(!s)r=a=o=n;else{const l=n<.5?n*(1+s):n+s-n*s,c=2*n-l;r=Zo(c,l,t+1/3),a=Zo(c,l,t),o=Zo(c,l,t-1/3)}return{red:Math.round(r*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:i}}function Ra(t,s){return n=>n>0?s:t}const Ae=(t,s,n)=>t+(s-t)*n,Yo=(t,s,n)=>{const i=t*t,r=n*(s*s-i)+i;return r<0?0:Math.sqrt(r)},$S=[Cl,dn,Un],qS=t=>$S.find(s=>s.test(t));function Du(t){const s=qS(t);if(!s)return!1;let n=s.parse(t);return s===Un&&(n=RS(n)),n}const Iu=(t,s)=>{const n=Du(t),i=Du(s);if(!n||!i)return Ra(t,s);const r={...n};return a=>(r.red=Yo(n.red,i.red,a),r.green=Yo(n.green,i.green,a),r.blue=Yo(n.blue,i.blue,a),r.alpha=Ae(n.alpha,i.alpha,a),dn.transform(r))},Tl=new Set(["none","hidden"]);function FS(t,s){return Tl.has(t)?n=>n<=0?t:s:n=>n>=1?s:t}function BS(t,s){return n=>Ae(t,s,n)}function Wc(t){return typeof t=="number"?BS:typeof t=="string"?Bc(t)?Ra:Fe.test(t)?Iu:WS:Array.isArray(t)?px:typeof t=="object"?Fe.test(t)?Iu:US:Ra}function px(t,s){const n=[...t],i=n.length,r=t.map((a,o)=>Wc(a)(a,s[o]));return a=>{for(let o=0;o<i;o++)n[o]=r[o](a);return n}}function US(t,s){const n={...t,...s},i={};for(const r in n)t[r]!==void 0&&s[r]!==void 0&&(i[r]=Wc(t[r])(t[r],s[r]));return r=>{for(const a in i)n[a]=i[a](r);return n}}function VS(t,s){const n=[],i={color:0,var:0,number:0};for(let r=0;r<s.values.length;r++){const a=s.types[r],o=t.indexes[a][i[a]],l=t.values[o]??0;n[r]=l,i[a]++}return n}const WS=(t,s)=>{const n=en.createTransformer(s),i=gr(t),r=gr(s);return i.indexes.var.length===r.indexes.var.length&&i.indexes.color.length===r.indexes.color.length&&i.indexes.number.length>=r.indexes.number.length?Tl.has(t)&&!r.values.length||Tl.has(s)&&!i.values.length?FS(t,s):Gr(px(VS(i,r),r.values),n):Ra(t,s)};function fx(t,s,n){return typeof t=="number"&&typeof s=="number"&&typeof n=="number"?Ae(t,s,n):Wc(t)(t,s)}const KS=t=>{const s=({timestamp:n})=>t(n);return{start:(n=!0)=>Ce.update(s,n),stop:()=>Xs(s),now:()=>et.isProcessing?et.timestamp:bt.now()}},xx=(t,s,n=10)=>{let i="";const r=Math.max(Math.round(s/n),2);for(let a=0;a<r;a++)i+=Math.round(t(a/(r-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},$a=2e4;function Kc(t){let s=0;const n=50;let i=t.next(s);for(;!i.done&&s<$a;)s+=n,i=t.next(s);return s>=$a?1/0:s}function GS(t,s=100,n){const i=n({...t,keyframes:[0,s]}),r=Math.min(Kc(i),$a);return{type:"keyframes",ease:a=>i.next(r*a).value/s,duration:ms(r)}}const HS=5;function gx(t,s,n){const i=Math.max(s-HS,0);return Zf(n-t(i),s-i)}const Ie={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Jo=.001;function QS({duration:t=Ie.duration,bounce:s=Ie.bounce,velocity:n=Ie.velocity,mass:i=Ie.mass}){let r,a,o=1-s;o=Ms(Ie.minDamping,Ie.maxDamping,o),t=Ms(Ie.minDuration,Ie.maxDuration,ms(t)),o<1?(r=d=>{const m=d*o,u=m*t,h=m-n,p=Al(d,o),b=Math.exp(-u);return Jo-h/p*b},a=d=>{const u=d*o*t,h=u*n+n,p=Math.pow(o,2)*Math.pow(d,2)*t,b=Math.exp(-u),f=Al(Math.pow(d,2),o);return(-r(d)+Jo>0?-1:1)*((h-p)*b)/f}):(r=d=>{const m=Math.exp(-d*t),u=(d-n)*t+1;return-Jo+m*u},a=d=>{const m=Math.exp(-d*t),u=(n-d)*(t*t);return m*u});const l=5/t,c=YS(r,a,l);if(t=us(t),isNaN(c))return{stiffness:Ie.stiffness,damping:Ie.damping,duration:t};{const d=Math.pow(c,2)*i;return{stiffness:d,damping:o*2*Math.sqrt(i*d),duration:t}}}const ZS=12;function YS(t,s,n){let i=n;for(let r=1;r<ZS;r++)i=i-t(i)/s(i);return i}function Al(t,s){return t*Math.sqrt(1-s*s)}const JS=["duration","bounce"],XS=["stiffness","damping","mass"];function Mu(t,s){return s.some(n=>t[n]!==void 0)}function e2(t){let s={velocity:Ie.velocity,stiffness:Ie.stiffness,damping:Ie.damping,mass:Ie.mass,isResolvedFromDuration:!1,...t};if(!Mu(t,XS)&&Mu(t,JS))if(t.visualDuration){const n=t.visualDuration,i=2*Math.PI/(n*1.2),r=i*i,a=2*Ms(.05,1,1-(t.bounce||0))*Math.sqrt(r);s={...s,mass:Ie.mass,stiffness:r,damping:a}}else{const n=QS(t);s={...s,...n,mass:Ie.mass},s.isResolvedFromDuration=!0}return s}function qa(t=Ie.visualDuration,s=Ie.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:s}:t;let{restSpeed:i,restDelta:r}=n;const a=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],l={done:!1,value:a},{stiffness:c,damping:d,mass:m,duration:u,velocity:h,isResolvedFromDuration:p}=e2({...n,velocity:-ms(n.velocity||0)}),b=h||0,f=d/(2*Math.sqrt(c*m)),x=o-a,w=ms(Math.sqrt(c/m)),y=Math.abs(x)<5;i||(i=y?Ie.restSpeed.granular:Ie.restSpeed.default),r||(r=y?Ie.restDelta.granular:Ie.restDelta.default);let N;if(f<1){const S=Al(w,f);N=k=>{const v=Math.exp(-f*w*k);return o-v*((b+f*w*x)/S*Math.sin(S*k)+x*Math.cos(S*k))}}else if(f===1)N=S=>o-Math.exp(-w*S)*(x+(b+w*x)*S);else{const S=w*Math.sqrt(f*f-1);N=k=>{const v=Math.exp(-f*w*k),z=Math.min(S*k,300);return o-v*((b+f*w*x)*Math.sinh(z)+S*x*Math.cosh(z))/S}}const A={calculatedDuration:p&&u||null,next:S=>{const k=N(S);if(p)l.done=S>=u;else{let v=S===0?b:0;f<1&&(v=S===0?us(b):gx(N,S,k));const z=Math.abs(v)<=i,D=Math.abs(o-k)<=r;l.done=z&&D}return l.value=l.done?o:k,l},toString:()=>{const S=Math.min(Kc(A),$a),k=xx(v=>A.next(S*v).value,S,30);return S+"ms "+k},toTransition:()=>{}};return A}qa.applyToOptions=t=>{const s=GS(t,100,qa);return t.ease=s.ease,t.duration=us(s.duration),t.type="keyframes",t};function _l({keyframes:t,velocity:s=0,power:n=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:a=500,modifyTarget:o,min:l,max:c,restDelta:d=.5,restSpeed:m}){const u=t[0],h={done:!1,value:u},p=z=>l!==void 0&&z<l||c!==void 0&&z>c,b=z=>l===void 0?c:c===void 0||Math.abs(l-z)<Math.abs(c-z)?l:c;let f=n*s;const x=u+f,w=o===void 0?x:o(x);w!==x&&(f=w-u);const y=z=>-f*Math.exp(-z/i),N=z=>w+y(z),A=z=>{const D=y(z),j=N(z);h.done=Math.abs(D)<=d,h.value=h.done?w:j};let S,k;const v=z=>{p(h.value)&&(S=z,k=qa({keyframes:[h.value,b(h.value)],velocity:gx(N,z,h.value),damping:r,stiffness:a,restDelta:d,restSpeed:m}))};return v(0),{calculatedDuration:null,next:z=>{let D=!1;return!k&&S===void 0&&(D=!0,A(z),v(z)),S!==void 0&&z>=S?k.next(z-S):(!D&&A(z),h)}}}function t2(t,s,n){const i=[],r=n||Es.mix||fx,a=t.length-1;for(let o=0;o<a;o++){let l=r(t[o],t[o+1]);if(s){const c=Array.isArray(s)?s[o]||Vt:s;l=Gr(c,l)}i.push(l)}return i}function s2(t,s,{clamp:n=!0,ease:i,mixer:r}={}){const a=t.length;if(Lc(a===s.length),a===1)return()=>s[0];if(a===2&&s[0]===s[1])return()=>s[1];const o=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),s=[...s].reverse());const l=t2(s,i,r),c=l.length,d=m=>{if(o&&m<t[0])return s[0];let u=0;if(c>1)for(;u<t.length-2&&!(m<t[u+1]);u++);const h=fr(t[u],t[u+1],m);return l[u](h)};return n?m=>d(Ms(t[0],t[a-1],m)):d}function n2(t,s){const n=t[t.length-1];for(let i=1;i<=s;i++){const r=fr(0,s,i);t.push(Ae(n,1,r))}}function i2(t){const s=[0];return n2(s,t.length-1),s}function r2(t,s){return t.map(n=>n*s)}function a2(t,s){return t.map(()=>s||rx).splice(0,t.length-1)}function Yi({duration:t=300,keyframes:s,times:n,ease:i="easeInOut"}){const r=gS(i)?i.map(Au):Au(i),a={done:!1,value:s[0]},o=r2(n&&n.length===s.length?n:i2(s),t),l=s2(o,s,{ease:Array.isArray(r)?r:a2(s,r)});return{calculatedDuration:t,next:c=>(a.value=l(c),a.done=c>=t,a)}}const o2=t=>t!==null;function Gc(t,{repeat:s,repeatType:n="loop"},i,r=1){const a=t.filter(o2),l=r<0||s&&n!=="loop"&&s%2===1?0:a.length-1;return!l||i===void 0?a[l]:i}const l2={decay:_l,inertia:_l,tween:Yi,keyframes:Yi,spring:qa};function jx(t){typeof t.type=="string"&&(t.type=l2[t.type])}class Hc{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(s=>{this.resolve=s})}notifyFinished(){this.resolve()}then(s,n){return this.finished.then(s,n)}}const c2=t=>t/100;class Qc extends Hc{constructor(s){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;n&&n.updatedAt!==bt.now()&&this.tick(bt.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=s,this.initAnimation(),this.play(),s.autoplay===!1&&this.pause()}initAnimation(){const{options:s}=this;jx(s);const{type:n=Yi,repeat:i=0,repeatDelay:r=0,repeatType:a,velocity:o=0}=s;let{keyframes:l}=s;const c=n||Yi;c!==Yi&&typeof l[0]!="number"&&(this.mixKeyframes=Gr(c2,fx(l[0],l[1])),l=[0,100]);const d=c({...s,keyframes:l});a==="mirror"&&(this.mirroredGenerator=c({...s,keyframes:[...l].reverse(),velocity:-o})),d.calculatedDuration===null&&(d.calculatedDuration=Kc(d));const{calculatedDuration:m}=d;this.calculatedDuration=m,this.resolvedDuration=m+r,this.totalDuration=this.resolvedDuration*(i+1)-r,this.generator=d}updateTime(s){const n=Math.round(s-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(s,n=!1){const{generator:i,totalDuration:r,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:l,calculatedDuration:c}=this;if(this.startTime===null)return i.next(0);const{delay:d=0,keyframes:m,repeat:u,repeatType:h,repeatDelay:p,type:b,onUpdate:f,finalKeyframe:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,s):this.speed<0&&(this.startTime=Math.min(s-r/this.speed,this.startTime)),n?this.currentTime=s:this.updateTime(s);const w=this.currentTime-d*(this.playbackSpeed>=0?1:-1),y=this.playbackSpeed>=0?w<0:w>r;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let N=this.currentTime,A=i;if(u){const z=Math.min(this.currentTime,r)/l;let D=Math.floor(z),j=z%1;!j&&z>=1&&(j=1),j===1&&D--,D=Math.min(D,u+1),!!(D%2)&&(h==="reverse"?(j=1-j,p&&(j-=p/l)):h==="mirror"&&(A=o)),N=Ms(0,1,j)*l}const S=y?{done:!1,value:m[0]}:A.next(N);a&&(S.value=a(S.value));let{done:k}=S;!y&&c!==null&&(k=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const v=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&k);return v&&b!==_l&&(S.value=Gc(m,this.options,x,this.speed)),f&&f(S.value),v&&this.finish(),S}then(s,n){return this.finished.then(s,n)}get duration(){return ms(this.calculatedDuration)}get time(){return ms(this.currentTime)}set time(s){s=us(s),this.currentTime=s,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=s:this.driver&&(this.startTime=this.driver.now()-s/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(s){this.updateTime(bt.now());const n=this.playbackSpeed!==s;this.playbackSpeed=s,n&&(this.time=ms(this.currentTime))}play(){if(this.isStopped)return;const{driver:s=KS,startTime:n}=this.options;this.driver||(this.driver=s(r=>this.tick(r))),this.options.onPlay?.();const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=n??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(bt.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(s){return this.startTime=0,this.tick(s,!0)}attachTimeline(s){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),s.observe(this)}}function d2(t){for(let s=1;s<t.length;s++)t[s]??(t[s]=t[s-1])}const un=t=>t*180/Math.PI,Pl=t=>{const s=un(Math.atan2(t[1],t[0]));return Dl(s)},u2={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Pl,rotateZ:Pl,skewX:t=>un(Math.atan(t[1])),skewY:t=>un(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Dl=t=>(t=t%360,t<0&&(t+=360),t),Eu=Pl,Lu=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),Ou=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),m2={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Lu,scaleY:Ou,scale:t=>(Lu(t)+Ou(t))/2,rotateX:t=>Dl(un(Math.atan2(t[6],t[5]))),rotateY:t=>Dl(un(Math.atan2(-t[2],t[0]))),rotateZ:Eu,rotate:Eu,skewX:t=>un(Math.atan(t[4])),skewY:t=>un(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Il(t){return t.includes("scale")?1:0}function Ml(t,s){if(!t||t==="none")return Il(s);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,r;if(n)i=m2,r=n;else{const l=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=u2,r=l}if(!r)return Il(s);const a=i[s],o=r[1].split(",").map(p2);return typeof a=="function"?a(o):o[a]}const h2=(t,s)=>{const{transform:n="none"}=getComputedStyle(t);return Ml(n,s)};function p2(t){return parseFloat(t.trim())}const Ni=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ki=new Set(Ni),Ru=t=>t===vi||t===Y,f2=new Set(["x","y","z"]),x2=Ni.filter(t=>!f2.has(t));function g2(t){const s=[];return x2.forEach(n=>{const i=t.getValue(n);i!==void 0&&(s.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),s}const xn={width:({x:t},{paddingLeft:s="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(s)-parseFloat(n),height:({y:t},{paddingTop:s="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(s)-parseFloat(n),top:(t,{top:s})=>parseFloat(s),left:(t,{left:s})=>parseFloat(s),bottom:({y:t},{top:s})=>parseFloat(s)+(t.max-t.min),right:({x:t},{left:s})=>parseFloat(s)+(t.max-t.min),x:(t,{transform:s})=>Ml(s,"x"),y:(t,{transform:s})=>Ml(s,"y")};xn.translateX=xn.x;xn.translateY=xn.y;const gn=new Set;let El=!1,Ll=!1,Ol=!1;function yx(){if(Ll){const t=Array.from(gn).filter(i=>i.needsMeasurement),s=new Set(t.map(i=>i.element)),n=new Map;s.forEach(i=>{const r=g2(i);r.length&&(n.set(i,r),i.render())}),t.forEach(i=>i.measureInitialState()),s.forEach(i=>{i.render();const r=n.get(i);r&&r.forEach(([a,o])=>{i.getValue(a)?.set(o)})}),t.forEach(i=>i.measureEndState()),t.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}Ll=!1,El=!1,gn.forEach(t=>t.complete(Ol)),gn.clear()}function bx(){gn.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Ll=!0)})}function j2(){Ol=!0,bx(),yx(),Ol=!1}class Zc{constructor(s,n,i,r,a,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...s],this.onComplete=n,this.name=i,this.motionValue=r,this.element=a,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(gn.add(this),El||(El=!0,Ce.read(bx),Ce.resolveKeyframes(yx))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:s,name:n,element:i,motionValue:r}=this;if(s[0]===null){const a=r?.get(),o=s[s.length-1];if(a!==void 0)s[0]=a;else if(i&&n){const l=i.readValue(n,o);l!=null&&(s[0]=l)}s[0]===void 0&&(s[0]=o),r&&a===void 0&&r.set(s[0])}d2(s)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(s=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,s),gn.delete(this)}cancel(){this.state==="scheduled"&&(gn.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const y2=t=>t.startsWith("--");function b2(t,s,n){y2(s)?t.style.setProperty(s,n):t.style[s]=n}const w2=Oc(()=>window.ScrollTimeline!==void 0),v2={};function N2(t,s){const n=Oc(t);return()=>v2[s]??n()}const wx=N2(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Wi=([t,s,n,i])=>`cubic-bezier(${t}, ${s}, ${n}, ${i})`,$u={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Wi([0,.65,.55,1]),circOut:Wi([.55,0,1,.45]),backIn:Wi([.31,.01,.66,-.59]),backOut:Wi([.33,1.53,.69,.99])};function vx(t,s){if(t)return typeof t=="function"?wx()?xx(t,s):"ease-out":ax(t)?Wi(t):Array.isArray(t)?t.map(n=>vx(n,s)||$u.easeOut):$u[t]}function k2(t,s,n,{delay:i=0,duration:r=300,repeat:a=0,repeatType:o="loop",ease:l="easeOut",times:c}={},d=void 0){const m={[s]:n};c&&(m.offset=c);const u=vx(l,r);Array.isArray(u)&&(m.easing=u);const h={delay:i,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};return d&&(h.pseudoElement=d),t.animate(m,h)}function Nx(t){return typeof t=="function"&&"applyToOptions"in t}function z2({type:t,...s}){return Nx(t)&&wx()?t.applyToOptions(s):(s.duration??(s.duration=300),s.ease??(s.ease="easeOut"),s)}class S2 extends Hc{constructor(s){if(super(),this.finishedTime=null,this.isStopped=!1,!s)return;const{element:n,name:i,keyframes:r,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:l,onComplete:c}=s;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=s,Lc(typeof s.type!="string");const d=z2(s);this.animation=k2(n,i,r,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const m=Gc(r,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(m):b2(n,i,m),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:s}=this;s==="idle"||s==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const s=this.animation.effect?.getComputedTiming?.().duration||0;return ms(Number(s))}get time(){return ms(Number(this.animation.currentTime)||0)}set time(s){this.finishedTime=null,this.animation.currentTime=us(s)}get speed(){return this.animation.playbackRate}set speed(s){s<0&&(this.finishedTime=null),this.animation.playbackRate=s}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(s){this.animation.startTime=s}attachTimeline({timeline:s,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,s&&w2()?(this.animation.timeline=s,Vt):n(this)}}const kx={anticipate:sx,backInOut:tx,circInOut:ix};function C2(t){return t in kx}function T2(t){typeof t.ease=="string"&&C2(t.ease)&&(t.ease=kx[t.ease])}const qu=10;class A2 extends S2{constructor(s){T2(s),jx(s),super(s),s.startTime&&(this.startTime=s.startTime),this.options=s}updateMotionValue(s){const{motionValue:n,onUpdate:i,onComplete:r,element:a,...o}=this.options;if(!n)return;if(s!==void 0){n.set(s);return}const l=new Qc({...o,autoplay:!1}),c=us(this.finishedTime??this.time);n.setWithVelocity(l.sample(c-qu).value,l.sample(c).value,qu),l.stop()}}const Fu=(t,s)=>s==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(en.test(t)||t==="0")&&!t.startsWith("url("));function _2(t){const s=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==s)return!0}function P2(t,s,n,i){const r=t[0];if(r===null)return!1;if(s==="display"||s==="visibility")return!0;const a=t[t.length-1],o=Fu(r,s),l=Fu(a,s);return!o||!l?!1:_2(t)||(n==="spring"||Nx(n))&&i}function Rl(t){t.duration=0,t.type}const D2=new Set(["opacity","clipPath","filter","transform"]),I2=Oc(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function M2(t){const{motionValue:s,name:n,repeatDelay:i,repeatType:r,damping:a,type:o}=t;if(!(s?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=s.owner.getProps();return I2()&&n&&D2.has(n)&&(n!=="transform"||!d)&&!c&&!i&&r!=="mirror"&&a!==0&&o!=="inertia"}const E2=40;class L2 extends Hc{constructor({autoplay:s=!0,delay:n=0,type:i="keyframes",repeat:r=0,repeatDelay:a=0,repeatType:o="loop",keyframes:l,name:c,motionValue:d,element:m,...u}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=bt.now();const h={autoplay:s,delay:n,type:i,repeat:r,repeatDelay:a,repeatType:o,name:c,motionValue:d,element:m,...u},p=m?.KeyframeResolver||Zc;this.keyframeResolver=new p(l,(b,f,x)=>this.onKeyframesResolved(b,f,h,!x),c,d,m),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(s,n,i,r){this.keyframeResolver=void 0;const{name:a,type:o,velocity:l,delay:c,isHandoff:d,onUpdate:m}=i;this.resolvedAt=bt.now(),P2(s,a,o,l)||((Es.instantAnimations||!c)&&m?.(Gc(s,i,n)),s[0]=s[s.length-1],Rl(i),i.repeat=0);const h={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>E2?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...i,keyframes:s},p=!d&&M2(h)?new A2({...h,element:h.motionValue.owner.current}):new Qc(h);p.finished.then(()=>this.notifyFinished()).catch(Vt),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(s,n){return this.finished.finally(s).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),j2()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(s){this.animation.time=s}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(s){this.animation.speed=s}get startTime(){return this.animation.startTime}attachTimeline(s){return this._animation?this.stopTimeline=this.animation.attachTimeline(s):this.pendingTimeline=s,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const O2=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function R2(t){const s=O2.exec(t);if(!s)return[,];const[,n,i,r]=s;return[`--${n??i}`,r]}function zx(t,s,n=1){const[i,r]=R2(t);if(!i)return;const a=window.getComputedStyle(s).getPropertyValue(i);if(a){const o=a.trim();return Gf(o)?parseFloat(o):o}return Bc(r)?zx(r,s,n+1):r}function Yc(t,s){return t?.[s]??t?.default??t}const Sx=new Set(["width","height","top","left","right","bottom",...Ni]),$2={test:t=>t==="auto",parse:t=>t},Cx=t=>s=>s.test(t),Tx=[vi,Y,hs,Us,_S,AS,$2],Bu=t=>Tx.find(Cx(t));function q2(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||Qf(t):!0}const F2=new Set(["brightness","contrast","saturate","opacity"]);function B2(t){const[s,n]=t.slice(0,-1).split("(");if(s==="drop-shadow")return t;const[i]=n.match(Uc)||[];if(!i)return t;const r=n.replace(i,"");let a=F2.has(s)?1:0;return i!==n&&(a*=100),s+"("+a+r+")"}const U2=/\b([a-z-]*)\(.*?\)/gu,$l={...en,getAnimatableNone:t=>{const s=t.match(U2);return s?s.map(B2).join(" "):t}},Uu={...vi,transform:Math.round},V2={rotate:Us,rotateX:Us,rotateY:Us,rotateZ:Us,scale:oa,scaleX:oa,scaleY:oa,scaleZ:oa,skew:Us,skewX:Us,skewY:Us,distance:Y,translateX:Y,translateY:Y,translateZ:Y,x:Y,y:Y,z:Y,perspective:Y,transformPerspective:Y,opacity:xr,originX:_u,originY:_u,originZ:Y},Jc={borderWidth:Y,borderTopWidth:Y,borderRightWidth:Y,borderBottomWidth:Y,borderLeftWidth:Y,borderRadius:Y,radius:Y,borderTopLeftRadius:Y,borderTopRightRadius:Y,borderBottomRightRadius:Y,borderBottomLeftRadius:Y,width:Y,maxWidth:Y,height:Y,maxHeight:Y,top:Y,right:Y,bottom:Y,left:Y,padding:Y,paddingTop:Y,paddingRight:Y,paddingBottom:Y,paddingLeft:Y,margin:Y,marginTop:Y,marginRight:Y,marginBottom:Y,marginLeft:Y,backgroundPositionX:Y,backgroundPositionY:Y,...V2,zIndex:Uu,fillOpacity:xr,strokeOpacity:xr,numOctaves:Uu},W2={...Jc,color:Fe,backgroundColor:Fe,outlineColor:Fe,fill:Fe,stroke:Fe,borderColor:Fe,borderTopColor:Fe,borderRightColor:Fe,borderBottomColor:Fe,borderLeftColor:Fe,filter:$l,WebkitFilter:$l},Ax=t=>W2[t];function _x(t,s){let n=Ax(t);return n!==$l&&(n=en),n.getAnimatableNone?n.getAnimatableNone(s):void 0}const K2=new Set(["auto","none","0"]);function G2(t,s,n){let i=0,r;for(;i<t.length&&!r;){const a=t[i];typeof a=="string"&&!K2.has(a)&&gr(a).values.length&&(r=t[i]),i++}if(r&&n)for(const a of s)t[a]=_x(n,r)}class H2 extends Zc{constructor(s,n,i,r,a){super(s,n,i,r,a,!0)}readKeyframes(){const{unresolvedKeyframes:s,element:n,name:i}=this;if(!n||!n.current)return;super.readKeyframes();for(let c=0;c<s.length;c++){let d=s[c];if(typeof d=="string"&&(d=d.trim(),Bc(d))){const m=zx(d,n.current);m!==void 0&&(s[c]=m),c===s.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!Sx.has(i)||s.length!==2)return;const[r,a]=s,o=Bu(r),l=Bu(a);if(o!==l)if(Ru(o)&&Ru(l))for(let c=0;c<s.length;c++){const d=s[c];typeof d=="string"&&(s[c]=parseFloat(d))}else xn[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:s,name:n}=this,i=[];for(let r=0;r<s.length;r++)(s[r]===null||q2(s[r]))&&i.push(r);i.length&&G2(s,i,n)}measureInitialState(){const{element:s,unresolvedKeyframes:n,name:i}=this;if(!s||!s.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=xn[i](s.measureViewportBox(),window.getComputedStyle(s.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&s.getValue(i,r).jump(r,!1)}measureEndState(){const{element:s,name:n,unresolvedKeyframes:i}=this;if(!s||!s.current)return;const r=s.getValue(n);r&&r.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=xn[n](s.measureViewportBox(),window.getComputedStyle(s.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),this.removedTransforms?.length&&this.removedTransforms.forEach(([l,c])=>{s.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function Q2(t,s,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let i=document;const r=n?.[t]??i.querySelectorAll(t);return r?Array.from(r):[]}return Array.from(t)}const Px=(t,s)=>s&&typeof t=="number"?s.transform(t):t;function Dx(t){return Hf(t)&&"offsetHeight"in t}const Vu=30,Z2=t=>!isNaN(parseFloat(t));class Y2{constructor(s,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{const r=bt.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(s),this.owner=n.owner}setCurrent(s){this.current=s,this.updatedAt=bt.now(),this.canTrackVelocity===null&&s!==void 0&&(this.canTrackVelocity=Z2(this.current))}setPrevFrameValue(s=this.current){this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt}onChange(s){return this.on("change",s)}on(s,n){this.events[s]||(this.events[s]=new Rc);const i=this.events[s].add(n);return s==="change"?()=>{i(),Ce.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const s in this.events)this.events[s].clear()}attach(s,n){this.passiveEffect=s,this.stopPassiveEffect=n}set(s){this.passiveEffect?this.passiveEffect(s,this.updateAndNotify):this.updateAndNotify(s)}setWithVelocity(s,n,i){this.set(n),this.prev=void 0,this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt-i}jump(s,n=!0){this.updateAndNotify(s),this.prev=s,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(s){this.dependents||(this.dependents=new Set),this.dependents.add(s)}removeDependent(s){this.dependents&&this.dependents.delete(s)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const s=bt.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||s-this.updatedAt>Vu)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Vu);return Zf(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(s){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=s(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ci(t,s){return new Y2(t,s)}const{schedule:Xc}=ox(queueMicrotask,!1),Jt={x:!1,y:!1};function Ix(){return Jt.x||Jt.y}function J2(t){return t==="x"||t==="y"?Jt[t]?null:(Jt[t]=!0,()=>{Jt[t]=!1}):Jt.x||Jt.y?null:(Jt.x=Jt.y=!0,()=>{Jt.x=Jt.y=!1})}function Mx(t,s){const n=Q2(t),i=new AbortController,r={passive:!0,...s,signal:i.signal};return[n,r,()=>i.abort()]}function Wu(t){return!(t.pointerType==="touch"||Ix())}function X2(t,s,n={}){const[i,r,a]=Mx(t,n),o=l=>{if(!Wu(l))return;const{target:c}=l,d=s(c,l);if(typeof d!="function"||!c)return;const m=u=>{Wu(u)&&(d(u),c.removeEventListener("pointerleave",m))};c.addEventListener("pointerleave",m,r)};return i.forEach(l=>{l.addEventListener("pointerenter",o,r)}),a}const Ex=(t,s)=>s?t===s?!0:Ex(t,s.parentElement):!1,ed=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,eC=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function tC(t){return eC.has(t.tagName)||t.tabIndex!==-1}const ja=new WeakSet;function Ku(t){return s=>{s.key==="Enter"&&t(s)}}function Xo(t,s){t.dispatchEvent(new PointerEvent("pointer"+s,{isPrimary:!0,bubbles:!0}))}const sC=(t,s)=>{const n=t.currentTarget;if(!n)return;const i=Ku(()=>{if(ja.has(n))return;Xo(n,"down");const r=Ku(()=>{Xo(n,"up")}),a=()=>Xo(n,"cancel");n.addEventListener("keyup",r,s),n.addEventListener("blur",a,s)});n.addEventListener("keydown",i,s),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),s)};function Gu(t){return ed(t)&&!Ix()}function nC(t,s,n={}){const[i,r,a]=Mx(t,n),o=l=>{const c=l.currentTarget;if(!Gu(l))return;ja.add(c);const d=s(c,l),m=(p,b)=>{window.removeEventListener("pointerup",u),window.removeEventListener("pointercancel",h),ja.has(c)&&ja.delete(c),Gu(p)&&typeof d=="function"&&d(p,{success:b})},u=p=>{m(p,c===window||c===document||n.useGlobalTarget||Ex(c,p.target))},h=p=>{m(p,!1)};window.addEventListener("pointerup",u,r),window.addEventListener("pointercancel",h,r)};return i.forEach(l=>{(n.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),Dx(l)&&(l.addEventListener("focus",d=>sC(d,r)),!tC(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),a}function Lx(t){return Hf(t)&&"ownerSVGElement"in t}function iC(t){return Lx(t)&&t.tagName==="svg"}const at=t=>!!(t&&t.getVelocity),rC=[...Tx,Fe,en],aC=t=>rC.find(Cx(t)),td=g.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class oC extends g.Component{getSnapshotBeforeUpdate(s){const n=this.props.childRef.current;if(n&&s.isPresent&&!this.props.isPresent){const i=n.offsetParent,r=Dx(i)&&i.offsetWidth||0,a=this.props.sizeRef.current;a.height=n.offsetHeight||0,a.width=n.offsetWidth||0,a.top=n.offsetTop,a.left=n.offsetLeft,a.right=r-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function lC({children:t,isPresent:s,anchorX:n,root:i}){const r=g.useId(),a=g.useRef(null),o=g.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=g.useContext(td);return g.useInsertionEffect(()=>{const{width:c,height:d,top:m,left:u,right:h}=o.current;if(s||!a.current||!c||!d)return;const p=n==="left"?`left: ${u}`:`right: ${h}`;a.current.dataset.motionPopId=r;const b=document.createElement("style");l&&(b.nonce=l);const f=i??document.head;return f.appendChild(b),b.sheet&&b.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${d}px !important;
            ${p}px !important;
            top: ${m}px !important;
          }
        `),()=>{f.contains(b)&&f.removeChild(b)}},[s]),e.jsx(oC,{isPresent:s,childRef:a,sizeRef:o,children:g.cloneElement(t,{ref:a})})}const cC=({children:t,initial:s,isPresent:n,onExitComplete:i,custom:r,presenceAffectsLayout:a,mode:o,anchorX:l,root:c})=>{const d=Dc(dC),m=g.useId();let u=!0,h=g.useMemo(()=>(u=!1,{id:m,initial:s,isPresent:n,custom:r,onExitComplete:p=>{d.set(p,!0);for(const b of d.values())if(!b)return;i&&i()},register:p=>(d.set(p,!1),()=>d.delete(p))}),[n,d,i]);return a&&u&&(h={...h}),g.useMemo(()=>{d.forEach((p,b)=>d.set(b,!1))},[n]),g.useEffect(()=>{!n&&!d.size&&i&&i()},[n]),o==="popLayout"&&(t=e.jsx(lC,{isPresent:n,anchorX:l,root:c,children:t})),e.jsx(xo.Provider,{value:h,children:t})};function dC(){return new Map}function Ox(t=!0){const s=g.useContext(xo);if(s===null)return[!0,null];const{isPresent:n,onExitComplete:i,register:r}=s,a=g.useId();g.useEffect(()=>{if(t)return r(a)},[t]);const o=g.useCallback(()=>t&&i&&i(a),[a,i,t]);return!n&&i?[!1,o]:[!0]}const la=t=>t.key||"";function Hu(t){const s=[];return g.Children.forEach(t,n=>{g.isValidElement(n)&&s.push(n)}),s}const uC=({children:t,custom:s,initial:n=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:a="sync",propagate:o=!1,anchorX:l="left",root:c})=>{const[d,m]=Ox(o),u=g.useMemo(()=>Hu(t),[t]),h=o&&!d?[]:u.map(la),p=g.useRef(!0),b=g.useRef(u),f=Dc(()=>new Map),[x,w]=g.useState(u),[y,N]=g.useState(u);Kf(()=>{p.current=!1,b.current=u;for(let k=0;k<y.length;k++){const v=la(y[k]);h.includes(v)?f.delete(v):f.get(v)!==!0&&f.set(v,!1)}},[y,h.length,h.join("-")]);const A=[];if(u!==x){let k=[...u];for(let v=0;v<y.length;v++){const z=y[v],D=la(z);h.includes(D)||(k.splice(v,0,z),A.push(z))}return a==="wait"&&A.length&&(k=A),N(Hu(k)),w(u),null}const{forceRender:S}=g.useContext(Pc);return e.jsx(e.Fragment,{children:y.map(k=>{const v=la(k),z=o&&!d?!1:u===y||h.includes(v),D=()=>{if(f.has(v))f.set(v,!0);else return;let j=!0;f.forEach(C=>{C||(j=!1)}),j&&(S?.(),N(b.current),o&&m?.(),i&&i())};return e.jsx(cC,{isPresent:z,initial:!p.current||n?void 0:!1,custom:s,presenceAffectsLayout:r,mode:a,root:c,onExitComplete:z?void 0:D,anchorX:l,children:k},v)})})},Rx=g.createContext({strict:!1}),Qu={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},di={};for(const t in Qu)di[t]={isEnabled:s=>Qu[t].some(n=>!!s[n])};function mC(t){for(const s in t)di[s]={...di[s],...t[s]}}const hC=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Fa(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||hC.has(t)}let $x=t=>!Fa(t);function pC(t){typeof t=="function"&&($x=s=>s.startsWith("on")?!Fa(s):t(s))}try{pC(require("@emotion/is-prop-valid").default)}catch{}function fC(t,s,n){const i={};for(const r in t)r==="values"&&typeof t.values=="object"||($x(r)||n===!0&&Fa(r)||!s&&!Fa(r)||t.draggable&&r.startsWith("onDrag"))&&(i[r]=t[r]);return i}const go=g.createContext({});function jo(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function jr(t){return typeof t=="string"||Array.isArray(t)}const sd=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],nd=["initial",...sd];function yo(t){return jo(t.animate)||nd.some(s=>jr(t[s]))}function qx(t){return!!(yo(t)||t.variants)}function xC(t,s){if(yo(t)){const{initial:n,animate:i}=t;return{initial:n===!1||jr(n)?n:void 0,animate:jr(i)?i:void 0}}return t.inherit!==!1?s:{}}function gC(t){const{initial:s,animate:n}=xC(t,g.useContext(go));return g.useMemo(()=>({initial:s,animate:n}),[Zu(s),Zu(n)])}function Zu(t){return Array.isArray(t)?t.join(" "):t}const yr={};function jC(t){for(const s in t)yr[s]=t[s],Fc(s)&&(yr[s].isCSSVariable=!0)}function Fx(t,{layout:s,layoutId:n}){return ki.has(t)||t.startsWith("origin")||(s||n!==void 0)&&(!!yr[t]||t==="opacity")}const yC={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},bC=Ni.length;function wC(t,s,n){let i="",r=!0;for(let a=0;a<bC;a++){const o=Ni[a],l=t[o];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(o.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||n){const d=Px(l,Jc[o]);if(!c){r=!1;const m=yC[o]||o;i+=`${m}(${d}) `}n&&(s[o]=d)}}return i=i.trim(),n?i=n(s,r?"":i):r&&(i="none"),i}function id(t,s,n){const{style:i,vars:r,transformOrigin:a}=t;let o=!1,l=!1;for(const c in s){const d=s[c];if(ki.has(c)){o=!0;continue}else if(Fc(c)){r[c]=d;continue}else{const m=Px(d,Jc[c]);c.startsWith("origin")?(l=!0,a[c]=m):i[c]=m}}if(s.transform||(o||n?i.transform=wC(s,t.transform,n):i.transform&&(i.transform="none")),l){const{originX:c="50%",originY:d="50%",originZ:m=0}=a;i.transformOrigin=`${c} ${d} ${m}`}}const rd=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Bx(t,s,n){for(const i in s)!at(s[i])&&!Fx(i,n)&&(t[i]=s[i])}function vC({transformTemplate:t},s){return g.useMemo(()=>{const n=rd();return id(n,s,t),Object.assign({},n.vars,n.style)},[s])}function NC(t,s){const n=t.style||{},i={};return Bx(i,n,t),Object.assign(i,vC(t,s)),i}function kC(t,s){const n={},i=NC(t,s);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=i,n}const zC={offset:"stroke-dashoffset",array:"stroke-dasharray"},SC={offset:"strokeDashoffset",array:"strokeDasharray"};function CC(t,s,n=1,i=0,r=!0){t.pathLength=1;const a=r?zC:SC;t[a.offset]=Y.transform(-i);const o=Y.transform(s),l=Y.transform(n);t[a.array]=`${o} ${l}`}function Ux(t,{attrX:s,attrY:n,attrScale:i,pathLength:r,pathSpacing:a=1,pathOffset:o=0,...l},c,d,m){if(id(t,l,d),c){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:u,style:h}=t;u.transform&&(h.transform=u.transform,delete u.transform),(h.transform||u.transformOrigin)&&(h.transformOrigin=u.transformOrigin??"50% 50%",delete u.transformOrigin),h.transform&&(h.transformBox=m?.transformBox??"fill-box",delete u.transformBox),s!==void 0&&(u.x=s),n!==void 0&&(u.y=n),i!==void 0&&(u.scale=i),r!==void 0&&CC(u,r,a,o,!1)}const Vx=()=>({...rd(),attrs:{}}),Wx=t=>typeof t=="string"&&t.toLowerCase()==="svg";function TC(t,s,n,i){const r=g.useMemo(()=>{const a=Vx();return Ux(a,s,Wx(i),t.transformTemplate,t.style),{...a.attrs,style:{...a.style}}},[s]);if(t.style){const a={};Bx(a,t.style,t),r.style={...a,...r.style}}return r}const AC=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ad(t){return typeof t!="string"||t.includes("-")?!1:!!(AC.indexOf(t)>-1||/[A-Z]/u.test(t))}function _C(t,s,n,{latestValues:i},r,a=!1){const l=(ad(t)?TC:kC)(s,i,r,t),c=fC(s,typeof t=="string",a),d=t!==g.Fragment?{...c,...l,ref:n}:{},{children:m}=s,u=g.useMemo(()=>at(m)?m.get():m,[m]);return g.createElement(t,{...d,children:u})}function Yu(t){const s=[{},{}];return t?.values.forEach((n,i)=>{s[0][i]=n.get(),s[1][i]=n.getVelocity()}),s}function od(t,s,n,i){if(typeof s=="function"){const[r,a]=Yu(i);s=s(n!==void 0?n:t.custom,r,a)}if(typeof s=="string"&&(s=t.variants&&t.variants[s]),typeof s=="function"){const[r,a]=Yu(i);s=s(n!==void 0?n:t.custom,r,a)}return s}function ya(t){return at(t)?t.get():t}function PC({scrapeMotionValuesFromProps:t,createRenderState:s},n,i,r){return{latestValues:DC(n,i,r,t),renderState:s()}}function DC(t,s,n,i){const r={},a=i(t,{});for(const h in a)r[h]=ya(a[h]);let{initial:o,animate:l}=t;const c=yo(t),d=qx(t);s&&d&&!c&&t.inherit!==!1&&(o===void 0&&(o=s.initial),l===void 0&&(l=s.animate));let m=n?n.initial===!1:!1;m=m||o===!1;const u=m?l:o;if(u&&typeof u!="boolean"&&!jo(u)){const h=Array.isArray(u)?u:[u];for(let p=0;p<h.length;p++){const b=od(t,h[p]);if(b){const{transitionEnd:f,transition:x,...w}=b;for(const y in w){let N=w[y];if(Array.isArray(N)){const A=m?N.length-1:0;N=N[A]}N!==null&&(r[y]=N)}for(const y in f)r[y]=f[y]}}}return r}const Kx=t=>(s,n)=>{const i=g.useContext(go),r=g.useContext(xo),a=()=>PC(t,s,i,r);return n?a():Dc(a)};function ld(t,s,n){const{style:i}=t,r={};for(const a in i)(at(i[a])||s.style&&at(s.style[a])||Fx(a,t)||n?.getValue(a)?.liveStyle!==void 0)&&(r[a]=i[a]);return r}const IC=Kx({scrapeMotionValuesFromProps:ld,createRenderState:rd});function Gx(t,s,n){const i=ld(t,s,n);for(const r in t)if(at(t[r])||at(s[r])){const a=Ni.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;i[a]=t[r]}return i}const MC=Kx({scrapeMotionValuesFromProps:Gx,createRenderState:Vx}),EC=Symbol.for("motionComponentSymbol");function Vn(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function LC(t,s,n){return g.useCallback(i=>{i&&t.onMount&&t.onMount(i),s&&(i?s.mount(i):s.unmount()),n&&(typeof n=="function"?n(i):Vn(n)&&(n.current=i))},[s])}const cd=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),OC="framerAppearId",Hx="data-"+cd(OC),Qx=g.createContext({});function RC(t,s,n,i,r){const{visualElement:a}=g.useContext(go),o=g.useContext(Rx),l=g.useContext(xo),c=g.useContext(td).reducedMotion,d=g.useRef(null);i=i||o.renderer,!d.current&&i&&(d.current=i(t,{visualState:s,parent:a,props:n,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:c}));const m=d.current,u=g.useContext(Qx);m&&!m.projection&&r&&(m.type==="html"||m.type==="svg")&&$C(d.current,n,r,u);const h=g.useRef(!1);g.useInsertionEffect(()=>{m&&h.current&&m.update(n,l)});const p=n[Hx],b=g.useRef(!!p&&!window.MotionHandoffIsComplete?.(p)&&window.MotionHasOptimisedAnimation?.(p));return Kf(()=>{m&&(h.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),b.current&&m.animationState&&m.animationState.animateChanges())}),g.useEffect(()=>{m&&(!b.current&&m.animationState&&m.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(p)}),b.current=!1),m.enteringChildren=void 0)}),m}function $C(t,s,n,i){const{layoutId:r,layout:a,drag:o,dragConstraints:l,layoutScroll:c,layoutRoot:d,layoutCrossfade:m}=s;t.projection=new n(t.latestValues,s["data-framer-portal-id"]?void 0:Zx(t.parent)),t.projection.setOptions({layoutId:r,layout:a,alwaysMeasureLayout:!!o||l&&Vn(l),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:i,crossfade:m,layoutScroll:c,layoutRoot:d})}function Zx(t){if(t)return t.options.allowProjection!==!1?t.projection:Zx(t.parent)}function el(t,{forwardMotionProps:s=!1}={},n,i){n&&mC(n);const r=ad(t)?MC:IC;function a(l,c){let d;const m={...g.useContext(td),...l,layoutId:qC(l)},{isStatic:u}=m,h=gC(l),p=r(l,u);if(!u&&Ic){FC();const b=BC(m);d=b.MeasureLayout,h.visualElement=RC(t,p,m,i,b.ProjectionNode)}return e.jsxs(go.Provider,{value:h,children:[d&&h.visualElement?e.jsx(d,{visualElement:h.visualElement,...m}):null,_C(t,l,LC(p,h.visualElement,c),p,u,s)]})}a.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=g.forwardRef(a);return o[EC]=t,o}function qC({layoutId:t}){const s=g.useContext(Pc).id;return s&&t!==void 0?s+"-"+t:t}function FC(t,s){g.useContext(Rx).strict}function BC(t){const{drag:s,layout:n}=di;if(!s&&!n)return{};const i={...s,...n};return{MeasureLayout:s?.isEnabled(t)||n?.isEnabled(t)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}function UC(t,s){if(typeof Proxy>"u")return el;const n=new Map,i=(a,o)=>el(a,o,t,s),r=(a,o)=>i(a,o);return new Proxy(r,{get:(a,o)=>o==="create"?i:(n.has(o)||n.set(o,el(o,void 0,t,s)),n.get(o))})}function Yx({top:t,left:s,right:n,bottom:i}){return{x:{min:s,max:n},y:{min:t,max:i}}}function VC({x:t,y:s}){return{top:s.min,right:t.max,bottom:s.max,left:t.min}}function WC(t,s){if(!s)return t;const n=s({x:t.left,y:t.top}),i=s({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function tl(t){return t===void 0||t===1}function ql({scale:t,scaleX:s,scaleY:n}){return!tl(t)||!tl(s)||!tl(n)}function ln(t){return ql(t)||Jx(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function Jx(t){return Ju(t.x)||Ju(t.y)}function Ju(t){return t&&t!=="0%"}function Ba(t,s,n){const i=t-n,r=s*i;return n+r}function Xu(t,s,n,i,r){return r!==void 0&&(t=Ba(t,r,i)),Ba(t,n,i)+s}function Fl(t,s=0,n=1,i,r){t.min=Xu(t.min,s,n,i,r),t.max=Xu(t.max,s,n,i,r)}function Xx(t,{x:s,y:n}){Fl(t.x,s.translate,s.scale,s.originPoint),Fl(t.y,n.translate,n.scale,n.originPoint)}const em=.999999999999,tm=1.0000000000001;function KC(t,s,n,i=!1){const r=n.length;if(!r)return;s.x=s.y=1;let a,o;for(let l=0;l<r;l++){a=n[l],o=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(i&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Kn(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(s.x*=o.x.scale,s.y*=o.y.scale,Xx(t,o)),i&&ln(a.latestValues)&&Kn(t,a.latestValues))}s.x<tm&&s.x>em&&(s.x=1),s.y<tm&&s.y>em&&(s.y=1)}function Wn(t,s){t.min=t.min+s,t.max=t.max+s}function sm(t,s,n,i,r=.5){const a=Ae(t.min,t.max,r);Fl(t,s,n,a,i)}function Kn(t,s){sm(t.x,s.x,s.scaleX,s.scale,s.originX),sm(t.y,s.y,s.scaleY,s.scale,s.originY)}function eg(t,s){return Yx(WC(t.getBoundingClientRect(),s))}function GC(t,s,n){const i=eg(t,n),{scroll:r}=s;return r&&(Wn(i.x,r.offset.x),Wn(i.y,r.offset.y)),i}const nm=()=>({translate:0,scale:1,origin:0,originPoint:0}),Gn=()=>({x:nm(),y:nm()}),im=()=>({min:0,max:0}),Ee=()=>({x:im(),y:im()}),Bl={current:null},tg={current:!1};function HC(){if(tg.current=!0,!!Ic)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),s=()=>Bl.current=t.matches;t.addEventListener("change",s),s()}else Bl.current=!1}const QC=new WeakMap;function ZC(t,s,n){for(const i in s){const r=s[i],a=n[i];if(at(r))t.addValue(i,r);else if(at(a))t.addValue(i,ci(r,{owner:t}));else if(a!==r)if(t.hasValue(i)){const o=t.getValue(i);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=t.getStaticValue(i);t.addValue(i,ci(o!==void 0?o:r,{owner:t}))}}for(const i in n)s[i]===void 0&&t.removeValue(i);return s}const rm=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class YC{scrapeMotionValuesFromProps(s,n,i){return{}}constructor({parent:s,props:n,presenceContext:i,reducedMotionConfig:r,blockInitialAnimation:a,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Zc,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=bt.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,Ce.render(this.render,!1,!0))};const{latestValues:c,renderState:d}=o;this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=d,this.parent=s,this.props=n,this.presenceContext=i,this.depth=s?s.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!a,this.isControllingVariants=yo(n),this.isVariantNode=qx(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(s&&s.current);const{willChange:m,...u}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in u){const p=u[h];c[h]!==void 0&&at(p)&&p.set(c[h])}}mount(s){this.current=s,QC.set(s,this),this.projection&&!this.projection.instance&&this.projection.mount(s),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,i)=>this.bindToMotionValue(i,n)),tg.current||HC(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Bl.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Xs(this.notifyUpdate),Xs(this.render),this.valueSubscriptions.forEach(s=>s()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const s in this.events)this.events[s].clear();for(const s in this.features){const n=this.features[s];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(s){this.children.add(s),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(s)}removeChild(s){this.children.delete(s),this.enteringChildren&&this.enteringChildren.delete(s)}bindToMotionValue(s,n){this.valueSubscriptions.has(s)&&this.valueSubscriptions.get(s)();const i=ki.has(s);i&&this.onBindTransform&&this.onBindTransform();const r=n.on("change",o=>{this.latestValues[s]=o,this.props.onUpdate&&Ce.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,s,n)),this.valueSubscriptions.set(s,()=>{r(),a&&a(),n.owner&&n.stop()})}sortNodePosition(s){return!this.current||!this.sortInstanceNodePosition||this.type!==s.type?0:this.sortInstanceNodePosition(this.current,s.current)}updateFeatures(){let s="animation";for(s in di){const n=di[s];if(!n)continue;const{isEnabled:i,Feature:r}=n;if(!this.features[s]&&r&&i(this.props)&&(this.features[s]=new r(this)),this.features[s]){const a=this.features[s];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ee()}getStaticValue(s){return this.latestValues[s]}setStaticValue(s,n){this.latestValues[s]=n}update(s,n){(s.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=s,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<rm.length;i++){const r=rm[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const a="on"+r,o=s[a];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=ZC(this,this.scrapeMotionValuesFromProps(s,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(s){return this.props.variants?this.props.variants[s]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(s){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(s),()=>n.variantChildren.delete(s)}addValue(s,n){const i=this.values.get(s);n!==i&&(i&&this.removeValue(s),this.bindToMotionValue(s,n),this.values.set(s,n),this.latestValues[s]=n.get())}removeValue(s){this.values.delete(s);const n=this.valueSubscriptions.get(s);n&&(n(),this.valueSubscriptions.delete(s)),delete this.latestValues[s],this.removeValueFromRenderState(s,this.renderState)}hasValue(s){return this.values.has(s)}getValue(s,n){if(this.props.values&&this.props.values[s])return this.props.values[s];let i=this.values.get(s);return i===void 0&&n!==void 0&&(i=ci(n===null?void 0:n,{owner:this}),this.addValue(s,i)),i}readValue(s,n){let i=this.latestValues[s]!==void 0||!this.current?this.latestValues[s]:this.getBaseTargetFromProps(this.props,s)??this.readValueFromInstance(this.current,s,this.options);return i!=null&&(typeof i=="string"&&(Gf(i)||Qf(i))?i=parseFloat(i):!aC(i)&&en.test(n)&&(i=_x(s,n)),this.setBaseTarget(s,at(i)?i.get():i)),at(i)?i.get():i}setBaseTarget(s,n){this.baseTarget[s]=n}getBaseTarget(s){const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const a=od(this.props,n,this.presenceContext?.custom);a&&(i=a[s])}if(n&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,s);return r!==void 0&&!at(r)?r:this.initialValues[s]!==void 0&&i===void 0?void 0:this.baseTarget[s]}on(s,n){return this.events[s]||(this.events[s]=new Rc),this.events[s].add(n)}notify(s,...n){this.events[s]&&this.events[s].notify(...n)}scheduleRenderMicrotask(){Xc.render(this.render)}}class sg extends YC{constructor(){super(...arguments),this.KeyframeResolver=H2}sortInstanceNodePosition(s,n){return s.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(s,n){return s.style?s.style[n]:void 0}removeValueFromRenderState(s,{vars:n,style:i}){delete n[s],delete i[s]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:s}=this.props;at(s)&&(this.childSubscription=s.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function ng(t,{style:s,vars:n},i,r){const a=t.style;let o;for(o in s)a[o]=s[o];r?.applyProjectionStyles(a,i);for(o in n)a.setProperty(o,n[o])}function JC(t){return window.getComputedStyle(t)}class XC extends sg{constructor(){super(...arguments),this.type="html",this.renderInstance=ng}readValueFromInstance(s,n){if(ki.has(n))return this.projection?.isProjecting?Il(n):h2(s,n);{const i=JC(s),r=(Fc(n)?i.getPropertyValue(n):i[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(s,{transformPagePoint:n}){return eg(s,n)}build(s,n,i){id(s,n,i.transformTemplate)}scrapeMotionValuesFromProps(s,n,i){return ld(s,n,i)}}const ig=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function eT(t,s,n,i){ng(t,s,void 0,i);for(const r in s.attrs)t.setAttribute(ig.has(r)?r:cd(r),s.attrs[r])}class tT extends sg{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ee}getBaseTargetFromProps(s,n){return s[n]}readValueFromInstance(s,n){if(ki.has(n)){const i=Ax(n);return i&&i.default||0}return n=ig.has(n)?n:cd(n),s.getAttribute(n)}scrapeMotionValuesFromProps(s,n,i){return Gx(s,n,i)}build(s,n,i){Ux(s,n,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(s,n,i,r){eT(s,n,i,r)}mount(s){this.isSVGTag=Wx(s.tagName),super.mount(s)}}const sT=(t,s)=>ad(t)?new tT(s):new XC(s,{allowProjection:t!==g.Fragment});function ti(t,s,n){const i=t.getProps();return od(i,s,n!==void 0?n:i.custom,t)}const Ul=t=>Array.isArray(t);function nT(t,s,n){t.hasValue(s)?t.getValue(s).set(n):t.addValue(s,ci(n))}function iT(t){return Ul(t)?t[t.length-1]||0:t}function rT(t,s){const n=ti(t,s);let{transitionEnd:i={},transition:r={},...a}=n||{};a={...a,...i};for(const o in a){const l=iT(a[o]);nT(t,o,l)}}function aT(t){return!!(at(t)&&t.add)}function Vl(t,s){const n=t.getValue("willChange");if(aT(n))return n.add(s);if(!n&&Es.WillChange){const i=new Es.WillChange("auto");t.addValue("willChange",i),i.add(s)}}function rg(t){return t.props[Hx]}const oT=t=>t!==null;function lT(t,{repeat:s,repeatType:n="loop"},i){const r=t.filter(oT),a=s&&n!=="loop"&&s%2===1?0:r.length-1;return r[a]}const cT={type:"spring",stiffness:500,damping:25,restSpeed:10},dT=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),uT={type:"keyframes",duration:.8},mT={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},hT=(t,{keyframes:s})=>s.length>2?uT:ki.has(t)?t.startsWith("scale")?dT(s[1]):cT:mT;function pT({when:t,delay:s,delayChildren:n,staggerChildren:i,staggerDirection:r,repeat:a,repeatType:o,repeatDelay:l,from:c,elapsed:d,...m}){return!!Object.keys(m).length}const dd=(t,s,n,i={},r,a)=>o=>{const l=Yc(i,t)||{},c=l.delay||i.delay||0;let{elapsed:d=0}=i;d=d-us(c);const m={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:s.getVelocity(),...l,delay:-d,onUpdate:h=>{s.set(h),l.onUpdate&&l.onUpdate(h)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:t,motionValue:s,element:a?void 0:r};pT(l)||Object.assign(m,hT(t,m)),m.duration&&(m.duration=us(m.duration)),m.repeatDelay&&(m.repeatDelay=us(m.repeatDelay)),m.from!==void 0&&(m.keyframes[0]=m.from);let u=!1;if((m.type===!1||m.duration===0&&!m.repeatDelay)&&(Rl(m),m.delay===0&&(u=!0)),(Es.instantAnimations||Es.skipAnimations)&&(u=!0,Rl(m),m.delay=0),m.allowFlatten=!l.type&&!l.ease,u&&!a&&s.get()!==void 0){const h=lT(m.keyframes,l);if(h!==void 0){Ce.update(()=>{m.onUpdate(h),m.onComplete()});return}}return l.isSync?new Qc(m):new L2(m)};function fT({protectedKeys:t,needsAnimating:s},n){const i=t.hasOwnProperty(n)&&s[n]!==!0;return s[n]=!1,i}function ag(t,s,{delay:n=0,transitionOverride:i,type:r}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:o,...l}=s;i&&(a=i);const c=[],d=r&&t.animationState&&t.animationState.getState()[r];for(const m in l){const u=t.getValue(m,t.latestValues[m]??null),h=l[m];if(h===void 0||d&&fT(d,m))continue;const p={delay:n,...Yc(a||{},m)},b=u.get();if(b!==void 0&&!u.isAnimating&&!Array.isArray(h)&&h===b&&!p.velocity)continue;let f=!1;if(window.MotionHandoffAnimation){const w=rg(t);if(w){const y=window.MotionHandoffAnimation(w,m,Ce);y!==null&&(p.startTime=y,f=!0)}}Vl(t,m),u.start(dd(m,u,h,t.shouldReduceMotion&&Sx.has(m)?{type:!1}:p,t,f));const x=u.animation;x&&c.push(x)}return o&&Promise.all(c).then(()=>{Ce.update(()=>{o&&rT(t,o)})}),c}function og(t,s,n,i=0,r=1){const a=Array.from(t).sort((d,m)=>d.sortNodePosition(m)).indexOf(s),o=t.size,l=(o-1)*i;return typeof n=="function"?n(a,o):r===1?a*i:l-a*i}function Wl(t,s,n={}){const i=ti(t,s,n.type==="exit"?t.presenceContext?.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const a=i?()=>Promise.all(ag(t,i,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:m,staggerDirection:u}=r;return xT(t,s,c,d,m,u,n)}:()=>Promise.resolve(),{when:l}=r;if(l){const[c,d]=l==="beforeChildren"?[a,o]:[o,a];return c().then(()=>d())}else return Promise.all([a(),o(n.delay)])}function xT(t,s,n=0,i=0,r=0,a=1,o){const l=[];for(const c of t.variantChildren)c.notify("AnimationStart",s),l.push(Wl(c,s,{...o,delay:n+(typeof i=="function"?0:i)+og(t.variantChildren,c,i,r,a)}).then(()=>c.notify("AnimationComplete",s)));return Promise.all(l)}function gT(t,s,n={}){t.notify("AnimationStart",s);let i;if(Array.isArray(s)){const r=s.map(a=>Wl(t,a,n));i=Promise.all(r)}else if(typeof s=="string")i=Wl(t,s,n);else{const r=typeof s=="function"?ti(t,s,n.custom):s;i=Promise.all(ag(t,r,n))}return i.then(()=>{t.notify("AnimationComplete",s)})}function lg(t,s){if(!Array.isArray(s))return!1;const n=s.length;if(n!==t.length)return!1;for(let i=0;i<n;i++)if(s[i]!==t[i])return!1;return!0}const jT=nd.length;function cg(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?cg(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const s={};for(let n=0;n<jT;n++){const i=nd[n],r=t.props[i];(jr(r)||r===!1)&&(s[i]=r)}return s}const yT=[...sd].reverse(),bT=sd.length;function wT(t){return s=>Promise.all(s.map(({animation:n,options:i})=>gT(t,n,i)))}function vT(t){let s=wT(t),n=am(),i=!0;const r=c=>(d,m)=>{const u=ti(t,m,c==="exit"?t.presenceContext?.custom:void 0);if(u){const{transition:h,transitionEnd:p,...b}=u;d={...d,...b,...p}}return d};function a(c){s=c(t)}function o(c){const{props:d}=t,m=cg(t.parent)||{},u=[],h=new Set;let p={},b=1/0;for(let x=0;x<bT;x++){const w=yT[x],y=n[w],N=d[w]!==void 0?d[w]:m[w],A=jr(N),S=w===c?y.isActive:null;S===!1&&(b=x);let k=N===m[w]&&N!==d[w]&&A;if(k&&i&&t.manuallyAnimateOnMount&&(k=!1),y.protectedKeys={...p},!y.isActive&&S===null||!N&&!y.prevProp||jo(N)||typeof N=="boolean")continue;const v=NT(y.prevProp,N);let z=v||w===c&&y.isActive&&!k&&A||x>b&&A,D=!1;const j=Array.isArray(N)?N:[N];let C=j.reduce(r(w),{});S===!1&&(C={});const{prevResolvedValues:T={}}=y,E={...T,...C},M=R=>{z=!0,h.has(R)&&(D=!0,h.delete(R)),y.needsAnimating[R]=!0;const G=t.getValue(R);G&&(G.liveStyle=!1)};for(const R in E){const G=C[R],U=T[R];if(p.hasOwnProperty(R))continue;let le=!1;Ul(G)&&Ul(U)?le=!lg(G,U):le=G!==U,le?G!=null?M(R):h.add(R):G!==void 0&&h.has(R)?M(R):y.protectedKeys[R]=!0}y.prevProp=N,y.prevResolvedValues=C,y.isActive&&(p={...p,...C}),i&&t.blockInitialAnimation&&(z=!1);const F=k&&v;z&&(!F||D)&&u.push(...j.map(R=>{const G={type:w};if(typeof R=="string"&&i&&!F&&t.manuallyAnimateOnMount&&t.parent){const{parent:U}=t,le=ti(U,R);if(U.enteringChildren&&le){const{delayChildren:q}=le.transition||{};G.delay=og(U.enteringChildren,t,q)}}return{animation:R,options:G}}))}if(h.size){const x={};if(typeof d.initial!="boolean"){const w=ti(t,Array.isArray(d.initial)?d.initial[0]:d.initial);w&&w.transition&&(x.transition=w.transition)}h.forEach(w=>{const y=t.getBaseTarget(w),N=t.getValue(w);N&&(N.liveStyle=!0),x[w]=y??null}),u.push({animation:x})}let f=!!u.length;return i&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(f=!1),i=!1,f?s(u):Promise.resolve()}function l(c,d){if(n[c].isActive===d)return Promise.resolve();t.variantChildren?.forEach(u=>u.animationState?.setActive(c,d)),n[c].isActive=d;const m=o(c);for(const u in n)n[u].protectedKeys={};return m}return{animateChanges:o,setActive:l,setAnimateFunction:a,getState:()=>n,reset:()=>{n=am(),i=!0}}}function NT(t,s){return typeof s=="string"?s!==t:Array.isArray(s)?!lg(s,t):!1}function on(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function am(){return{animate:on(!0),whileInView:on(),whileHover:on(),whileTap:on(),whileDrag:on(),whileFocus:on(),exit:on()}}class nn{constructor(s){this.isMounted=!1,this.node=s}update(){}}class kT extends nn{constructor(s){super(s),s.animationState||(s.animationState=vT(s))}updateAnimationControlsSubscription(){const{animate:s}=this.node.getProps();jo(s)&&(this.unmountControls=s.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:s}=this.node.getProps(),{animate:n}=this.node.prevProps||{};s!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let zT=0;class ST extends nn{constructor(){super(...arguments),this.id=zT++}update(){if(!this.node.presenceContext)return;const{isPresent:s,onExitComplete:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||s===i)return;const r=this.node.animationState.setActive("exit",!s);n&&!s&&r.then(()=>{n(this.id)})}mount(){const{register:s,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),s&&(this.unmount=s(this.id))}unmount(){}}const CT={animation:{Feature:kT},exit:{Feature:ST}};function br(t,s,n,i={passive:!0}){return t.addEventListener(s,n,i),()=>t.removeEventListener(s,n)}function Zr(t){return{point:{x:t.pageX,y:t.pageY}}}const TT=t=>s=>ed(s)&&t(s,Zr(s));function Ji(t,s,n,i){return br(t,s,TT(n),i)}const dg=1e-4,AT=1-dg,_T=1+dg,ug=.01,PT=0-ug,DT=0+ug;function pt(t){return t.max-t.min}function IT(t,s,n){return Math.abs(t-s)<=n}function om(t,s,n,i=.5){t.origin=i,t.originPoint=Ae(s.min,s.max,t.origin),t.scale=pt(n)/pt(s),t.translate=Ae(n.min,n.max,t.origin)-t.originPoint,(t.scale>=AT&&t.scale<=_T||isNaN(t.scale))&&(t.scale=1),(t.translate>=PT&&t.translate<=DT||isNaN(t.translate))&&(t.translate=0)}function Xi(t,s,n,i){om(t.x,s.x,n.x,i?i.originX:void 0),om(t.y,s.y,n.y,i?i.originY:void 0)}function lm(t,s,n){t.min=n.min+s.min,t.max=t.min+pt(s)}function MT(t,s,n){lm(t.x,s.x,n.x),lm(t.y,s.y,n.y)}function cm(t,s,n){t.min=s.min-n.min,t.max=t.min+pt(s)}function er(t,s,n){cm(t.x,s.x,n.x),cm(t.y,s.y,n.y)}function $t(t){return[t("x"),t("y")]}const mg=({current:t})=>t?t.ownerDocument.defaultView:null,dm=(t,s)=>Math.abs(t-s);function ET(t,s){const n=dm(t.x,s.x),i=dm(t.y,s.y);return Math.sqrt(n**2+i**2)}class hg{constructor(s,n,{transformPagePoint:i,contextWindow:r=window,dragSnapToOrigin:a=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=nl(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,b=ET(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!b)return;const{point:f}=h,{timestamp:x}=et;this.history.push({...f,timestamp:x});const{onStart:w,onMove:y}=this.handlers;p||(w&&w(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),y&&y(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=sl(p,this.transformPagePoint),Ce.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:b,onSessionEnd:f,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=nl(h.type==="pointercancel"?this.lastMoveEventInfo:sl(p,this.transformPagePoint),this.history);this.startEvent&&b&&b(h,w),f&&f(h,w)},!ed(s))return;this.dragSnapToOrigin=a,this.handlers=n,this.transformPagePoint=i,this.distanceThreshold=o,this.contextWindow=r||window;const l=Zr(s),c=sl(l,this.transformPagePoint),{point:d}=c,{timestamp:m}=et;this.history=[{...d,timestamp:m}];const{onSessionStart:u}=n;u&&u(s,nl(c,this.history)),this.removeListeners=Gr(Ji(this.contextWindow,"pointermove",this.handlePointerMove),Ji(this.contextWindow,"pointerup",this.handlePointerUp),Ji(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(s){this.handlers=s}end(){this.removeListeners&&this.removeListeners(),Xs(this.updatePoint)}}function sl(t,s){return s?{point:s(t.point)}:t}function um(t,s){return{x:t.x-s.x,y:t.y-s.y}}function nl({point:t},s){return{point:t,delta:um(t,pg(s)),offset:um(t,LT(s)),velocity:OT(s,.1)}}function LT(t){return t[0]}function pg(t){return t[t.length-1]}function OT(t,s){if(t.length<2)return{x:0,y:0};let n=t.length-1,i=null;const r=pg(t);for(;n>=0&&(i=t[n],!(r.timestamp-i.timestamp>us(s)));)n--;if(!i)return{x:0,y:0};const a=ms(r.timestamp-i.timestamp);if(a===0)return{x:0,y:0};const o={x:(r.x-i.x)/a,y:(r.y-i.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function RT(t,{min:s,max:n},i){return s!==void 0&&t<s?t=i?Ae(s,t,i.min):Math.max(t,s):n!==void 0&&t>n&&(t=i?Ae(n,t,i.max):Math.min(t,n)),t}function mm(t,s,n){return{min:s!==void 0?t.min+s:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function $T(t,{top:s,left:n,bottom:i,right:r}){return{x:mm(t.x,n,r),y:mm(t.y,s,i)}}function hm(t,s){let n=s.min-t.min,i=s.max-t.max;return s.max-s.min<t.max-t.min&&([n,i]=[i,n]),{min:n,max:i}}function qT(t,s){return{x:hm(t.x,s.x),y:hm(t.y,s.y)}}function FT(t,s){let n=.5;const i=pt(t),r=pt(s);return r>i?n=fr(s.min,s.max-i,t.min):i>r&&(n=fr(t.min,t.max-r,s.min)),Ms(0,1,n)}function BT(t,s){const n={};return s.min!==void 0&&(n.min=s.min-t.min),s.max!==void 0&&(n.max=s.max-t.min),n}const Kl=.35;function UT(t=Kl){return t===!1?t=0:t===!0&&(t=Kl),{x:pm(t,"left","right"),y:pm(t,"top","bottom")}}function pm(t,s,n){return{min:fm(t,s),max:fm(t,n)}}function fm(t,s){return typeof t=="number"?t:t[s]||0}const VT=new WeakMap;class WT{constructor(s){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ee(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=s}start(s,{snapToCursor:n=!1,distanceThreshold:i}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const a=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Zr(u).point)},o=(u,h)=>{const{drag:p,dragPropagation:b,onDragStart:f}=this.getProps();if(p&&!b&&(this.openDragLock&&this.openDragLock(),this.openDragLock=J2(p),!this.openDragLock))return;this.latestPointerEvent=u,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),$t(w=>{let y=this.getAxisMotionValue(w).get()||0;if(hs.test(y)){const{projection:N}=this.visualElement;if(N&&N.layout){const A=N.layout.layoutBox[w];A&&(y=pt(A)*(parseFloat(y)/100))}}this.originPoint[w]=y}),f&&Ce.postRender(()=>f(u,h)),Vl(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},l=(u,h)=>{this.latestPointerEvent=u,this.latestPanInfo=h;const{dragPropagation:p,dragDirectionLock:b,onDirectionLock:f,onDrag:x}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:w}=h;if(b&&this.currentDirection===null){this.currentDirection=KT(w),this.currentDirection!==null&&f&&f(this.currentDirection);return}this.updateAxis("x",h.point,w),this.updateAxis("y",h.point,w),this.visualElement.render(),x&&x(u,h)},c=(u,h)=>{this.latestPointerEvent=u,this.latestPanInfo=h,this.stop(u,h),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>$t(u=>this.getAnimationState(u)==="paused"&&this.getAxisMotionValue(u).animation?.play()),{dragSnapToOrigin:m}=this.getProps();this.panSession=new hg(s,{onSessionStart:a,onStart:o,onMove:l,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:m,distanceThreshold:i,contextWindow:mg(this.visualElement)})}stop(s,n){const i=s||this.latestPointerEvent,r=n||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!r||!i)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:l}=this.getProps();l&&Ce.postRender(()=>l(i,r))}cancel(){this.isDragging=!1;const{projection:s,animationState:n}=this.visualElement;s&&(s.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(s,n,i){const{drag:r}=this.getProps();if(!i||!ca(s,r,this.currentDirection))return;const a=this.getAxisMotionValue(s);let o=this.originPoint[s]+i[s];this.constraints&&this.constraints[s]&&(o=RT(o,this.constraints[s],this.elastic[s])),a.set(o)}resolveConstraints(){const{dragConstraints:s,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,r=this.constraints;s&&Vn(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&i?this.constraints=$T(i.layoutBox,s):this.constraints=!1,this.elastic=UT(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&$t(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=BT(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:s,onMeasureDragConstraints:n}=this.getProps();if(!s||!Vn(s))return!1;const i=s.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const a=GC(i,r.root,this.visualElement.getTransformPagePoint());let o=qT(r.layout.layoutBox,a);if(n){const l=n(VC(o));this.hasMutatedConstraints=!!l,l&&(o=Yx(l))}return o}startAnimation(s){const{drag:n,dragMomentum:i,dragElastic:r,dragTransition:a,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=$t(m=>{if(!ca(m,n,this.currentDirection))return;let u=c&&c[m]||{};o&&(u={min:0,max:0});const h=r?200:1e6,p=r?40:1e7,b={type:"inertia",velocity:i?s[m]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...a,...u};return this.startAxisValueAnimation(m,b)});return Promise.all(d).then(l)}startAxisValueAnimation(s,n){const i=this.getAxisMotionValue(s);return Vl(this.visualElement,s),i.start(dd(s,i,0,n,this.visualElement,!1))}stopAnimation(){$t(s=>this.getAxisMotionValue(s).stop())}pauseAnimation(){$t(s=>this.getAxisMotionValue(s).animation?.pause())}getAnimationState(s){return this.getAxisMotionValue(s).animation?.state}getAxisMotionValue(s){const n=`_drag${s.toUpperCase()}`,i=this.visualElement.getProps(),r=i[n];return r||this.visualElement.getValue(s,(i.initial?i.initial[s]:void 0)||0)}snapToCursor(s){$t(n=>{const{drag:i}=this.getProps();if(!ca(n,i,this.currentDirection))return;const{projection:r}=this.visualElement,a=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[n];a.set(s[n]-Ae(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:s,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!Vn(n)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};$t(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const c=l.get();r[o]=FT({min:c,max:c},this.constraints[o])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),$t(o=>{if(!ca(o,s,null))return;const l=this.getAxisMotionValue(o),{min:c,max:d}=this.constraints[o];l.set(Ae(c,d,r[o]))})}addListeners(){if(!this.visualElement.current)return;VT.set(this.visualElement,this);const s=this.visualElement.current,n=Ji(s,"pointerdown",c=>{const{drag:d,dragListener:m=!0}=this.getProps();d&&m&&this.start(c)}),i=()=>{const{dragConstraints:c}=this.getProps();Vn(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,a=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Ce.read(i);const o=br(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&($t(m=>{const u=this.getAxisMotionValue(m);u&&(this.originPoint[m]+=c[m].translate,u.set(u.get()+c[m].translate))}),this.visualElement.render())});return()=>{o(),n(),a(),l&&l()}}getProps(){const s=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:a=!1,dragElastic:o=Kl,dragMomentum:l=!0}=s;return{...s,drag:n,dragDirectionLock:i,dragPropagation:r,dragConstraints:a,dragElastic:o,dragMomentum:l}}}function ca(t,s,n){return(s===!0||s===t)&&(n===null||n===t)}function KT(t,s=10){let n=null;return Math.abs(t.y)>s?n="y":Math.abs(t.x)>s&&(n="x"),n}class GT extends nn{constructor(s){super(s),this.removeGroupControls=Vt,this.removeListeners=Vt,this.controls=new WT(s)}mount(){const{dragControls:s}=this.node.getProps();s&&(this.removeGroupControls=s.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Vt}unmount(){this.removeGroupControls(),this.removeListeners()}}const xm=t=>(s,n)=>{t&&Ce.postRender(()=>t(s,n))};class HT extends nn{constructor(){super(...arguments),this.removePointerDownListener=Vt}onPointerDown(s){this.session=new hg(s,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:mg(this.node)})}createPanHandlers(){const{onPanSessionStart:s,onPanStart:n,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:xm(s),onStart:xm(n),onMove:i,onEnd:(a,o)=>{delete this.session,r&&Ce.postRender(()=>r(a,o))}}}mount(){this.removePointerDownListener=Ji(this.node.current,"pointerdown",s=>this.onPointerDown(s))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const ba={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function gm(t,s){return s.max===s.min?0:t/(s.max-s.min)*100}const $i={correct:(t,s)=>{if(!s.target)return t;if(typeof t=="string")if(Y.test(t))t=parseFloat(t);else return t;const n=gm(t,s.target.x),i=gm(t,s.target.y);return`${n}% ${i}%`}},QT={correct:(t,{treeScale:s,projectionDelta:n})=>{const i=t,r=en.parse(t);if(r.length>5)return i;const a=en.createTransformer(t),o=typeof r[0]!="number"?1:0,l=n.x.scale*s.x,c=n.y.scale*s.y;r[0+o]/=l,r[1+o]/=c;const d=Ae(l,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=d),typeof r[3+o]=="number"&&(r[3+o]/=d),a(r)}};let il=!1;class ZT extends g.Component{componentDidMount(){const{visualElement:s,layoutGroup:n,switchLayoutGroup:i,layoutId:r}=this.props,{projection:a}=s;jC(YT),a&&(n.group&&n.group.add(a),i&&i.register&&r&&i.register(a),il&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),ba.hasEverUpdated=!0}getSnapshotBeforeUpdate(s){const{layoutDependency:n,visualElement:i,drag:r,isPresent:a}=this.props,{projection:o}=i;return o&&(o.isPresent=a,il=!0,r||s.layoutDependency!==n||n===void 0||s.isPresent!==a?o.willUpdate():this.safeToRemove(),s.isPresent!==a&&(a?o.promote():o.relegate()||Ce.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:s}=this.props.visualElement;s&&(s.root.didUpdate(),Xc.postRender(()=>{!s.currentAnimation&&s.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:s,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:r}=s;il=!0,r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:s}=this.props;s&&s()}render(){return null}}function fg(t){const[s,n]=Ox(),i=g.useContext(Pc);return e.jsx(ZT,{...t,layoutGroup:i,switchLayoutGroup:g.useContext(Qx),isPresent:s,safeToRemove:n})}const YT={borderRadius:{...$i,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:$i,borderTopRightRadius:$i,borderBottomLeftRadius:$i,borderBottomRightRadius:$i,boxShadow:QT};function JT(t,s,n){const i=at(t)?t:ci(t);return i.start(dd("",i,s,n)),i.animation}const XT=(t,s)=>t.depth-s.depth;class e4{constructor(){this.children=[],this.isDirty=!1}add(s){Mc(this.children,s),this.isDirty=!0}remove(s){Ec(this.children,s),this.isDirty=!0}forEach(s){this.isDirty&&this.children.sort(XT),this.isDirty=!1,this.children.forEach(s)}}function t4(t,s){const n=bt.now(),i=({timestamp:r})=>{const a=r-n;a>=s&&(Xs(i),t(a-s))};return Ce.setup(i,!0),()=>Xs(i)}const xg=["TopLeft","TopRight","BottomLeft","BottomRight"],s4=xg.length,jm=t=>typeof t=="string"?parseFloat(t):t,ym=t=>typeof t=="number"||Y.test(t);function n4(t,s,n,i,r,a){r?(t.opacity=Ae(0,n.opacity??1,i4(i)),t.opacityExit=Ae(s.opacity??1,0,r4(i))):a&&(t.opacity=Ae(s.opacity??1,n.opacity??1,i));for(let o=0;o<s4;o++){const l=`border${xg[o]}Radius`;let c=bm(s,l),d=bm(n,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||ym(c)===ym(d)?(t[l]=Math.max(Ae(jm(c),jm(d),i),0),(hs.test(d)||hs.test(c))&&(t[l]+="%")):t[l]=d}(s.rotate||n.rotate)&&(t.rotate=Ae(s.rotate||0,n.rotate||0,i))}function bm(t,s){return t[s]!==void 0?t[s]:t.borderRadius}const i4=gg(0,.5,nx),r4=gg(.5,.95,Vt);function gg(t,s,n){return i=>i<t?0:i>s?1:n(fr(t,s,i))}function wm(t,s){t.min=s.min,t.max=s.max}function Ot(t,s){wm(t.x,s.x),wm(t.y,s.y)}function vm(t,s){t.translate=s.translate,t.scale=s.scale,t.originPoint=s.originPoint,t.origin=s.origin}function Nm(t,s,n,i,r){return t-=s,t=Ba(t,1/n,i),r!==void 0&&(t=Ba(t,1/r,i)),t}function a4(t,s=0,n=1,i=.5,r,a=t,o=t){if(hs.test(s)&&(s=parseFloat(s),s=Ae(o.min,o.max,s/100)-o.min),typeof s!="number")return;let l=Ae(a.min,a.max,i);t===a&&(l-=s),t.min=Nm(t.min,s,n,l,r),t.max=Nm(t.max,s,n,l,r)}function km(t,s,[n,i,r],a,o){a4(t,s[n],s[i],s[r],s.scale,a,o)}const o4=["x","scaleX","originX"],l4=["y","scaleY","originY"];function zm(t,s,n,i){km(t.x,s,o4,n?n.x:void 0,i?i.x:void 0),km(t.y,s,l4,n?n.y:void 0,i?i.y:void 0)}function Sm(t){return t.translate===0&&t.scale===1}function jg(t){return Sm(t.x)&&Sm(t.y)}function Cm(t,s){return t.min===s.min&&t.max===s.max}function c4(t,s){return Cm(t.x,s.x)&&Cm(t.y,s.y)}function Tm(t,s){return Math.round(t.min)===Math.round(s.min)&&Math.round(t.max)===Math.round(s.max)}function yg(t,s){return Tm(t.x,s.x)&&Tm(t.y,s.y)}function Am(t){return pt(t.x)/pt(t.y)}function _m(t,s){return t.translate===s.translate&&t.scale===s.scale&&t.originPoint===s.originPoint}class d4{constructor(){this.members=[]}add(s){Mc(this.members,s),s.scheduleRender()}remove(s){if(Ec(this.members,s),s===this.prevLead&&(this.prevLead=void 0),s===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(s){const n=this.members.findIndex(r=>s===r);if(n===0)return!1;let i;for(let r=n;r>=0;r--){const a=this.members[r];if(a.isPresent!==!1){i=a;break}}return i?(this.promote(i),!0):!1}promote(s,n){const i=this.lead;if(s!==i&&(this.prevLead=i,this.lead=s,s.show(),i)){i.instance&&i.scheduleRender(),s.scheduleRender(),s.resumeFrom=i,n&&(s.resumeFrom.preserveOpacity=!0),i.snapshot&&(s.snapshot=i.snapshot,s.snapshot.latestValues=i.animationValues||i.latestValues),s.root&&s.root.isUpdating&&(s.isLayoutDirty=!0);const{crossfade:r}=s.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(s=>{const{options:n,resumingFrom:i}=s;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(s=>{s.instance&&s.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function u4(t,s,n){let i="";const r=t.x.translate/s.x,a=t.y.translate/s.y,o=n?.z||0;if((r||a||o)&&(i=`translate3d(${r}px, ${a}px, ${o}px) `),(s.x!==1||s.y!==1)&&(i+=`scale(${1/s.x}, ${1/s.y}) `),n){const{transformPerspective:d,rotate:m,rotateX:u,rotateY:h,skewX:p,skewY:b}=n;d&&(i=`perspective(${d}px) ${i}`),m&&(i+=`rotate(${m}deg) `),u&&(i+=`rotateX(${u}deg) `),h&&(i+=`rotateY(${h}deg) `),p&&(i+=`skewX(${p}deg) `),b&&(i+=`skewY(${b}deg) `)}const l=t.x.scale*s.x,c=t.y.scale*s.y;return(l!==1||c!==1)&&(i+=`scale(${l}, ${c})`),i||"none"}const rl=["","X","Y","Z"],m4=1e3;let h4=0;function al(t,s,n,i){const{latestValues:r}=s;r[t]&&(n[t]=r[t],s.setStaticValue(t,0),i&&(i[t]=0))}function bg(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:s}=t.options;if(!s)return;const n=rg(s);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Ce,!(r||a))}const{parent:i}=t;i&&!i.hasCheckedOptimisedAppear&&bg(i)}function wg({attachResizeListener:t,defaultParent:s,measureScroll:n,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},l=s?.()){this.id=h4++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(x4),this.nodes.forEach(b4),this.nodes.forEach(w4),this.nodes.forEach(g4)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new e4)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Rc),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=Lx(o)&&!iC(o),this.instance=o;const{layoutId:l,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||l)&&(this.isLayoutDirty=!0),t){let m,u=0;const h=()=>this.root.updateBlockedByResize=!1;Ce.read(()=>{u=window.innerWidth}),t(o,()=>{const p=window.innerWidth;p!==u&&(u=p,this.root.updateBlockedByResize=!0,m&&m(),m=t4(h,250),ba.hasAnimatedSinceResize&&(ba.hasAnimatedSinceResize=!1,this.nodes.forEach(Im)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&d&&(l||c)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:u,hasRelativeLayoutChanged:h,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||d.getDefaultTransition()||S4,{onLayoutAnimationStart:f,onLayoutAnimationComplete:x}=d.getProps(),w=!this.targetLayout||!yg(this.targetLayout,p),y=!u&&h;if(this.options.layoutRoot||this.resumeFrom||y||u&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const N={...Yc(b,"layout"),onPlay:f,onComplete:x};(d.shouldReduceMotion||this.options.layoutRoot)&&(N.delay=0,N.type=!1),this.startAnimation(N),this.setAnimationOrigin(m,y)}else u||Im(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Xs(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(v4),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&bg(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let m=0;m<this.path.length;m++){const u=this.path[m];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Pm);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Dm);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(y4),this.nodes.forEach(p4),this.nodes.forEach(f4)):this.nodes.forEach(Dm),this.clearAllSnapshots();const l=bt.now();et.delta=Ms(0,1e3/60,l-et.timestamp),et.timestamp=l,et.isProcessing=!0,Ho.update.process(et),Ho.preRender.process(et),Ho.render.process(et),et.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Xc.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(j4),this.sharedNodes.forEach(N4)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ce.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ce.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!pt(this.snapshot.measuredBox.x)&&!pt(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ee(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&this.instance){const c=i(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!jg(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,m=d!==this.prevTransformTemplateValue;o&&this.instance&&(l||ln(this.latestValues)||m)&&(r(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),C4(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Ee();const l=o.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(T4))){const{scroll:d}=this.root;d&&(Wn(l.x,d.offset.x),Wn(l.y,d.offset.y))}return l}removeElementScroll(o){const l=Ee();if(Ot(l,o),this.scroll?.wasRoot)return l;for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:m,options:u}=d;d!==this.root&&m&&u.layoutScroll&&(m.wasRoot&&Ot(l,o),Wn(l.x,m.offset.x),Wn(l.y,m.offset.y))}return l}applyTransform(o,l=!1){const c=Ee();Ot(c,o);for(let d=0;d<this.path.length;d++){const m=this.path[d];!l&&m.options.layoutScroll&&m.scroll&&m!==m.root&&Kn(c,{x:-m.scroll.offset.x,y:-m.scroll.offset.y}),ln(m.latestValues)&&Kn(c,m.latestValues)}return ln(this.latestValues)&&Kn(c,this.latestValues),c}removeTransform(o){const l=Ee();Ot(l,o);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!ln(d.latestValues))continue;ql(d.latestValues)&&d.updateSnapshot();const m=Ee(),u=d.measurePageBox();Ot(m,u),zm(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,m)}return ln(this.latestValues)&&zm(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==et.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:u}=this.options;if(!(!this.layout||!(m||u))){if(this.resolvedRelativeTargetAt=et.timestamp,!this.targetDelta&&!this.relativeTarget){const h=this.getClosestProjectingParent();h&&h.layout&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ee(),this.relativeTargetOrigin=Ee(),er(this.relativeTargetOrigin,this.layout.layoutBox,h.layout.layoutBox),Ot(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Ee(),this.targetWithTransforms=Ee()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),MT(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ot(this.target,this.layout.layoutBox),Xx(this.target,this.targetDelta)):Ot(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const h=this.getClosestProjectingParent();h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ee(),this.relativeTargetOrigin=Ee(),er(this.relativeTargetOrigin,this.target,h.target),Ot(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||ql(this.parent.latestValues)||Jx(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===et.timestamp&&(c=!1),c)return;const{layout:d,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||m))return;Ot(this.layoutCorrected,this.layout.layoutBox);const u=this.treeScale.x,h=this.treeScale.y;KC(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Ee());const{target:p}=o;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(vm(this.prevProjectionDelta.x,this.projectionDelta.x),vm(this.prevProjectionDelta.y,this.projectionDelta.y)),Xi(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==u||this.treeScale.y!==h||!_m(this.projectionDelta.x,this.prevProjectionDelta.x)||!_m(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.visualElement?.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Gn(),this.projectionDelta=Gn(),this.projectionDeltaWithTransform=Gn()}setAnimationOrigin(o,l=!1){const c=this.snapshot,d=c?c.latestValues:{},m={...this.latestValues},u=Gn();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=Ee(),p=c?c.source:void 0,b=this.layout?this.layout.source:void 0,f=p!==b,x=this.getStack(),w=!x||x.members.length<=1,y=!!(f&&!w&&this.options.crossfade===!0&&!this.path.some(z4));this.animationProgress=0;let N;this.mixTargetDelta=A=>{const S=A/1e3;Mm(u.x,o.x,S),Mm(u.y,o.y,S),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(er(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),k4(this.relativeTarget,this.relativeTargetOrigin,h,S),N&&c4(this.relativeTarget,N)&&(this.isProjectionDirty=!1),N||(N=Ee()),Ot(N,this.relativeTarget)),f&&(this.animationValues=m,n4(m,d,this.latestValues,S,y,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Xs(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ce.update(()=>{ba.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=ci(0)),this.currentAnimation=JT(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(m4),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:m}=o;if(!(!l||!c||!d)){if(this!==o&&this.layout&&d&&vg(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||Ee();const u=pt(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+u;const h=pt(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+h}Ot(l,c),Kn(l,m),Xi(this.projectionDeltaWithTransform,this.layoutCorrected,l,m)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new d4),this.sharedNodes.get(o).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){const{layoutId:o}=this.options;return o?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:o}=this.options;return o?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const d={};c.z&&al("z",o,d,this.animationValues);for(let m=0;m<rl.length;m++)al(`rotate${rl[m]}`,o,d,this.animationValues),al(`skew${rl[m]}`,o,d,this.animationValues);o.render();for(const m in d)o.setStaticValue(m,d[m]),this.animationValues&&(this.animationValues[m]=d[m]);o.scheduleRender()}applyProjectionStyles(o,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=ya(l?.pointerEvents)||"",o.transform=c?c(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=ya(l?.pointerEvents)||""),this.hasProjected&&!ln(this.latestValues)&&(o.transform=c?c({},""):"none",this.hasProjected=!1);return}o.visibility="";const m=d.animationValues||d.latestValues;this.applyTransformsToTarget();let u=u4(this.projectionDeltaWithTransform,this.treeScale,m);c&&(u=c(m,u)),o.transform=u;const{x:h,y:p}=this.projectionDelta;o.transformOrigin=`${h.origin*100}% ${p.origin*100}% 0`,d.animationValues?o.opacity=d===this?m.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:o.opacity=d===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const b in yr){if(m[b]===void 0)continue;const{correct:f,applyTo:x,isCSSVariable:w}=yr[b],y=u==="none"?m[b]:f(m[b],d);if(x){const N=x.length;for(let A=0;A<N;A++)o[x[A]]=y}else w?this.options.visualElement.renderState.vars[b]=y:o[b]=y}this.options.layoutId&&(o.pointerEvents=d===this?ya(l?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>o.currentAnimation?.stop()),this.root.nodes.forEach(Pm),this.root.sharedNodes.clear()}}}function p4(t){t.updateLayout()}function f4(t){const s=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&s&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=t.layout,{animationType:r}=t.options,a=s.source!==t.layout.source;r==="size"?$t(m=>{const u=a?s.measuredBox[m]:s.layoutBox[m],h=pt(u);u.min=n[m].min,u.max=u.min+h}):vg(r,s.layoutBox,n)&&$t(m=>{const u=a?s.measuredBox[m]:s.layoutBox[m],h=pt(n[m]);u.max=u.min+h,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[m].max=t.relativeTarget[m].min+h)});const o=Gn();Xi(o,n,s.layoutBox);const l=Gn();a?Xi(l,t.applyTransform(i,!0),s.measuredBox):Xi(l,n,s.layoutBox);const c=!jg(o);let d=!1;if(!t.resumeFrom){const m=t.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:u,layout:h}=m;if(u&&h){const p=Ee();er(p,s.layoutBox,u.layoutBox);const b=Ee();er(b,n,h.layoutBox),yg(p,b)||(d=!0),m.options.layoutRoot&&(t.relativeTarget=b,t.relativeTargetOrigin=p,t.relativeParent=m)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:s,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function x4(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function g4(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function j4(t){t.clearSnapshot()}function Pm(t){t.clearMeasurements()}function Dm(t){t.isLayoutDirty=!1}function y4(t){const{visualElement:s}=t.options;s&&s.getProps().onBeforeLayoutMeasure&&s.notify("BeforeLayoutMeasure"),t.resetTransform()}function Im(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function b4(t){t.resolveTargetDelta()}function w4(t){t.calcProjection()}function v4(t){t.resetSkewAndRotation()}function N4(t){t.removeLeadSnapshot()}function Mm(t,s,n){t.translate=Ae(s.translate,0,n),t.scale=Ae(s.scale,1,n),t.origin=s.origin,t.originPoint=s.originPoint}function Em(t,s,n,i){t.min=Ae(s.min,n.min,i),t.max=Ae(s.max,n.max,i)}function k4(t,s,n,i){Em(t.x,s.x,n.x,i),Em(t.y,s.y,n.y,i)}function z4(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const S4={duration:.45,ease:[.4,0,.1,1]},Lm=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Om=Lm("applewebkit/")&&!Lm("chrome/")?Math.round:Vt;function Rm(t){t.min=Om(t.min),t.max=Om(t.max)}function C4(t){Rm(t.x),Rm(t.y)}function vg(t,s,n){return t==="position"||t==="preserve-aspect"&&!IT(Am(s),Am(n),.2)}function T4(t){return t!==t.root&&t.scroll?.wasRoot}const A4=wg({attachResizeListener:(t,s)=>br(t,"resize",s),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),ol={current:void 0},Ng=wg({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!ol.current){const t=new A4({});t.mount(window),t.setOptions({layoutScroll:!0}),ol.current=t}return ol.current},resetTransform:(t,s)=>{t.style.transform=s!==void 0?s:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),_4={pan:{Feature:HT},drag:{Feature:GT,ProjectionNode:Ng,MeasureLayout:fg}};function $m(t,s,n){const{props:i}=t;t.animationState&&i.whileHover&&t.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,a=i[r];a&&Ce.postRender(()=>a(s,Zr(s)))}class P4 extends nn{mount(){const{current:s}=this.node;s&&(this.unmount=X2(s,(n,i)=>($m(this.node,i,"Start"),r=>$m(this.node,r,"End"))))}unmount(){}}class D4 extends nn{constructor(){super(...arguments),this.isActive=!1}onFocus(){let s=!1;try{s=this.node.current.matches(":focus-visible")}catch{s=!0}!s||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Gr(br(this.node.current,"focus",()=>this.onFocus()),br(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function qm(t,s,n){const{props:i}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&i.whileTap&&t.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),a=i[r];a&&Ce.postRender(()=>a(s,Zr(s)))}class I4 extends nn{mount(){const{current:s}=this.node;s&&(this.unmount=nC(s,(n,i)=>(qm(this.node,i,"Start"),(r,{success:a})=>qm(this.node,r,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Gl=new WeakMap,ll=new WeakMap,M4=t=>{const s=Gl.get(t.target);s&&s(t)},E4=t=>{t.forEach(M4)};function L4({root:t,...s}){const n=t||document;ll.has(n)||ll.set(n,{});const i=ll.get(n),r=JSON.stringify(s);return i[r]||(i[r]=new IntersectionObserver(E4,{root:t,...s})),i[r]}function O4(t,s,n){const i=L4(s);return Gl.set(t,n),i.observe(t),()=>{Gl.delete(t),i.unobserve(t)}}const R4={some:0,all:1};class $4 extends nn{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:s={}}=this.node.getProps(),{root:n,margin:i,amount:r="some",once:a}=s,o={root:n?n.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:R4[r]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:m,onViewportLeave:u}=this.node.getProps(),h=d?m:u;h&&h(c)};return O4(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:s,prevProps:n}=this.node;["amount","margin","root"].some(q4(s,n))&&this.startObserver()}unmount(){}}function q4({viewport:t={}},{viewport:s={}}={}){return n=>t[n]!==s[n]}const F4={inView:{Feature:$4},tap:{Feature:I4},focus:{Feature:D4},hover:{Feature:P4}},B4={layout:{ProjectionNode:Ng,MeasureLayout:fg}},U4={...CT,...F4,..._4,...B4},ke=UC(U4,sT),bo={normal:.3,slow:.5},V4={stagger:.05},W4={default:[.4,0,.2,1]},K4={hidden:{opacity:0,y:20},visible:(t=0)=>({opacity:1,y:0,transition:{delay:t*V4.stagger,duration:bo.normal,ease:W4.default}})},G4=(t,s=bo.slow)=>{const[n,i]=te.useState(0),r=te.useRef(0);return te.useEffect(()=>{const a=r.current,o=t,l=Date.now(),c=()=>{const d=(Date.now()-l)/1e3,m=Math.min(d/s,1),u=1-Math.pow(1-m,3),h=Math.floor(a+(o-a)*u);i(h),m<1?requestAnimationFrame(c):r.current=o};requestAnimationFrame(c)},[t,s]),n},zi=({children:t,index:s=0,className:n="",...i})=>e.jsx(ke.div,{variants:K4,initial:"hidden",animate:"visible",custom:s,className:n,...i,children:t}),zn=({value:t,className:s="bg-gray-100 rounded-full overflow-hidden",barClassName:n="h-full bg-gray-900",height:i="h-2"})=>e.jsx("div",{className:`${i} ${s}`,children:e.jsx(ke.div,{initial:{width:0},animate:{width:`${t}%`},transition:{duration:bo.slow,ease:"easeOut"},className:n})}),tt=({value:t,className:s="",duration:n=bo.slow,prefix:i="",suffix:r=""})=>{const a=G4(t,n);return e.jsxs("span",{className:s,children:[i,a.toLocaleString("pl-PL"),r]})},H4=()=>e.jsxs("div",{className:"rounded-2xl border bg-card p-5 shadow-soft animate-pulse",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"h-8 w-8 rounded-md bg-muted/70"}),e.jsx("div",{className:"h-4 w-40 rounded bg-muted/70"})]}),e.jsx("div",{className:"h-5 w-16 rounded-full bg-muted/70"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"h-2 w-full rounded-full bg-muted/60"}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx("div",{className:"h-3 w-16 rounded bg-muted/60"}),e.jsx("div",{className:"h-3 w-20 rounded bg-muted/60"})]})]}),e.jsx("div",{className:"mt-4 h-9 w-2/3 rounded-lg bg-muted/60"}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("div",{className:"h-6 w-16 rounded bg-muted/60"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-9 w-24 rounded-lg bg-muted/60"}),e.jsx("div",{className:"h-9 w-10 rounded-lg bg-muted/60"})]})]})]}),Q4=()=>{const t=J(),{data:s}=gt(),{stats:n,refetch:i}=Wr(),{data:r,isLoading:a}=Kr("get_my_courses"),[o,l]=te.useState(0),c=r||[],d=!a&&c.length===0;te.useEffect(()=>{const u=async()=>{try{const{data:p}=await ue.rpc("check_claimable_rewards");l(p?.claimable_points||0)}catch{}};u();const h=setInterval(u,3e4);return()=>clearInterval(h)},[]);const m=async()=>{try{const{data:u,error:h}=await ue.rpc("claim_daily_rewards");if(h)throw h;u&&(W.success(`Odebrano ${u.total_earned} punktów`),i(),l(0))}catch{W.error("Nie można odebrać nagród")}};return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),e.jsxs("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:[e.jsxs("div",{className:"space-y-6 md:hidden",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-xl font-bold tracking-tight",children:"Twoje tempo nauki"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.streak>0&&e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border bg-background/60 px-3 py-1.5 shadow-soft",children:[e.jsx(ls,{className:"h-4 w-4 text-destructive"}),e.jsxs("span",{className:"text-sm font-medium",children:["Seria: ",e.jsx("span",{className:"tabular-nums",children:n.streak})," ","dni"]})]}),o>0&&e.jsxs("button",{onClick:m,className:"inline-flex items-center gap-2 rounded-lg bg-primary px-3 py-1.5 text-sm text-primary-foreground hover:bg-primary/90 focus-ring",children:[e.jsx(Rd,{className:"h-4 w-4"}),"Odbierz ",o," pkt"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{className:"rounded-xl border bg-card p-4 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Punkty"}),e.jsx(nt,{className:"h-4 w-4 text-primary"})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("span",{className:"text-3xl font-semibold tabular-nums text-primary leading-none",children:e.jsx(tt,{value:n.points})}),e.jsx("span",{className:"mb-1 text-sm text-muted-foreground",children:"pkt"})]}),e.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["+",e.jsx(tt,{value:n.idle_rate}),"/h"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-xl border bg-card p-4 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Poziom"}),e.jsx(wn,{className:"h-4 w-4 text-secondary"})]}),e.jsx("span",{className:"text-2xl font-semibold text-secondary",children:n.level}),e.jsx("div",{className:"mt-2 h-1.5 w-full rounded-full bg-muted",children:e.jsx("div",{className:"h-full rounded-full bg-secondary transition-all",style:{width:`${n.points%100}%`}})})]}),e.jsxs("div",{className:"rounded-xl border bg-card p-4 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Tempo"}),e.jsx(It,{className:"h-4 w-4 text-accent"})]}),e.jsxs("span",{className:"text-2xl font-semibold text-accent",children:["+",e.jsx(tt,{value:n.idle_rate})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"pkt/h"})]})]})]})]}),e.jsxs("div",{className:"hidden md:grid gap-8 md:grid-cols-12 md:items-center",children:[e.jsxs("div",{className:"md:col-span-4 space-y-4",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Twoje tempo nauki"}),n.streak>0&&e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border bg-background/60 px-3 py-1.5 shadow-soft",children:[e.jsx(ls,{className:"h-4 w-4 text-destructive"}),e.jsxs("span",{className:"text-sm font-medium",children:["Seria: ",e.jsx("span",{className:"tabular-nums",children:n.streak})," ","dni"]})]}),o>0&&e.jsxs("button",{onClick:m,className:"inline-flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90 focus-ring",children:[e.jsx(Rd,{className:"h-4 w-4"}),"Odbierz ",o," pkt"]})]}),e.jsx("div",{className:"md:col-span-8",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Punkty"}),e.jsx(nt,{className:"h-4 w-4 text-primary"})]}),e.jsxs("div",{className:"mt-2 flex items-end gap-2",children:[e.jsx("span",{className:"text-4xl md:text-5xl font-semibold tabular-nums text-primary leading-none",children:e.jsx(tt,{value:n.points})}),e.jsx("span",{className:"mb-[2px] text-sm text-muted-foreground",children:"pkt"})]}),e.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["+",e.jsx(tt,{value:n.idle_rate}),"/h"]})]}),e.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Poziom"}),e.jsx(wn,{className:"h-4 w-4 text-secondary"})]}),e.jsx("div",{className:"mt-2 flex items-center gap-2",children:e.jsx("span",{className:"text-4xl md:text-5xl font-semibold text-secondary leading-none",children:n.level})}),e.jsx("div",{className:"mt-3 h-2 w-full rounded-full bg-muted",children:e.jsx("div",{className:"h-full rounded-full bg-secondary transition-all",style:{width:`${n.points%100}%`}})}),e.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["Do kolejnego: ",100-n.points%100," pkt"]})]}),e.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Tempo"}),e.jsx(It,{className:"h-4 w-4 text-accent"})]}),e.jsxs("div",{className:"mt-2 flex items-end gap-2",children:[e.jsxs("span",{className:"text-4xl md:text-5xl font-semibold text-accent leading-none",children:["+",e.jsx(tt,{value:n.idle_rate})]}),e.jsx("span",{className:"mb-[2px] text-sm text-muted-foreground",children:"pkt/h"})]}),e.jsx("button",{onClick:()=>t("/student/gamification"),className:"mt-3 w-full rounded-lg border px-3 py-2 hover:bg-primary/5 focus-ring",children:"Gamifikacja"})]})]})})]})]})]}),e.jsxs(ke.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-semibold tracking-tight",children:"Twoje kursy"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"To jest Twoja główna ścieżka — kontynuuj naukę tam, gdzie skończyłeś."})]}),e.jsxs("button",{onClick:()=>t("/student/courses"),className:"inline-flex items-center gap-1 sm:gap-2 rounded-lg border px-2 sm:px-3 py-1.5 sm:py-2 text-sm hover:bg-primary/5 focus-ring whitespace-nowrap",children:[e.jsx("span",{className:"hidden sm:inline",children:"Zobacz wszystkie"}),e.jsx("span",{className:"sm:hidden",children:"Wszystkie"}),e.jsx(ae,{className:"h-4 w-4"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-5",children:[a&&Array.from({length:6}).map((u,h)=>e.jsx(H4,{},h)),!a&&c.slice(0,9).map(u=>{const h=u.progress_percent===100;return e.jsxs("div",{className:"group relative rounded-2xl border bg-card p-4 sm:p-5 shadow-soft hover:bg-muted/40 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("span",{className:"text-2xl sm:text-3xl shrink-0 leading-none",children:u.icon_emoji||"📚"}),e.jsx("h4",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:u.title})]}),h?e.jsx("span",{className:"inline-flex items-center gap-1 rounded-full border border-green-600/30 bg-green-500/10 text-green-700 dark:text-green-400 px-2 sm:px-2.5 py-0.5 sm:py-1 text-[10px] sm:text-[11px] font-semibold",children:"Ukończono"}):e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-primary/30 text-primary px-2 sm:px-2.5 py-0.5 sm:py-1 text-[10px] sm:text-[11px] font-semibold",children:[u.progress_percent,"%"]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"h-2 w-full rounded-full bg-muted",children:e.jsx("div",{className:`h-full rounded-full transition-all ${h?"bg-green-600":"bg-primary"}`,style:{width:`${u.progress_percent||0}%`}})}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"Ukończono"}),e.jsxs("span",{className:"font-medium text-foreground",children:[u.completed_lessons||0,"/",u.total_lessons||10," lekcji"]})]})]}),u.next_activity&&e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center gap-2 rounded-lg border bg-background/60 px-2.5 sm:px-3 py-1.5 sm:py-2",children:[e.jsx(Zy,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-primary"}),e.jsx("p",{className:"text-xs sm:text-sm font-medium truncate",children:u.next_activity})]}),e.jsxs("div",{className:"mt-3 sm:mt-4 flex items-center justify-between",children:[u.points_available?e.jsxs("span",{className:"inline-flex rounded-md bg-orange-500/10 text-[10px] sm:text-[11px] font-semibold px-2 py-0.5 sm:py-1 text-orange-600",children:["+",u.points_available," pkt"]}):e.jsx("span",{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t(`/student/courses/${u.course_id}`),className:"rounded-lg bg-primary px-3 sm:px-4 py-1.5 sm:py-2 text-sm text-primary-foreground hover:bg-primary/90 focus-ring",children:"Kontynuuj"}),e.jsx("button",{onClick:()=>t(`/student/courses/${u.course_id}`),className:"rounded-lg border px-2.5 sm:px-3 py-1.5 sm:py-2 hover:bg-primary/5 focus-ring",title:"Szczegóły",children:e.jsx(ae,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4"})})]})]})]},u.course_id)}),d&&e.jsxs("div",{className:"col-span-full rounded-2xl border bg-card p-8 sm:p-10 text-center shadow-soft",children:[e.jsx("div",{className:"text-4xl sm:text-5xl",children:"🚀"}),e.jsx("h4",{className:"mt-3 sm:mt-4 text-base sm:text-lg font-semibold",children:"Zacznij swoją przygodę"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:"Dołącz do kursu i odkryj nowy sposób nauki."}),e.jsx("button",{onClick:()=>t("/student/courses"),className:"mt-4 sm:mt-6 rounded-lg bg-secondary px-4 sm:px-5 py-2 sm:py-2.5 text-sm text-white hover:opacity-95 focus-ring",children:"Odkryj kursy"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Punkty"}),e.jsx(nt,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-primary"})]}),e.jsx("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold tabular-nums text-foreground",children:e.jsx(tt,{value:n.points})}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:["+",e.jsx(tt,{value:n.idle_rate}),"/h"]})]}),e.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Poziom"}),e.jsx($e,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-secondary"})]}),e.jsx("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold text-foreground",children:n.level}),e.jsx("div",{className:"mt-2 sm:mt-3",children:e.jsx(zn,{value:n.points%100})})]}),e.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Seria dni"}),e.jsx(ls,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-destructive"})]}),e.jsx("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold text-foreground",children:e.jsx(tt,{value:n.streak})}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"dni z rzędu"})]}),e.jsxs("div",{className:"rounded-xl border bg-card/70 backdrop-blur-sm p-4 sm:p-5 shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("span",{className:"text-xs sm:text-sm text-muted-foreground font-medium",children:"Tempo"}),e.jsx(It,{className:"h-3.5 sm:h-4 w-3.5 sm:w-4 text-accent"})]}),e.jsxs("p",{className:"mt-1.5 text-xl sm:text-2xl font-semibold text-foreground",children:["+",e.jsx(tt,{value:n.idle_rate})]}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"punktów/h"})]})]})]})},Z4=[e.jsx(V,{path:"dashboard",element:e.jsx(Q4,{})},"dashboard")],Y4=()=>{const t=J(),{data:s}=Kr("get_my_courses"),n=s||[];return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"})}),e.jsxs("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Twoje kursy"}),e.jsx("p",{className:"mt-2 text-sm md:text-base text-muted-foreground",children:"Wybierz kurs i kontynuuj naukę w swoim tempie."})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-5",children:n.map((i,r)=>e.jsxs(zi,{index:r,className:"group relative rounded-2xl border bg-card p-4 sm:p-5 shadow-soft hover:bg-muted/40 transition-colors cursor-pointer",onClick:()=>t(`/student/courses/${i.course_id}`),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("span",{className:"text-2xl sm:text-3xl shrink-0 leading-none",children:i.icon_emoji||"📚"}),e.jsx("h4",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:i.title})]}),e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-primary/30 text-primary px-2 sm:px-2.5 py-0.5 sm:py-1 text-[10px] sm:text-[11px] font-semibold",children:[i.progress_percent,"%"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(zn,{value:i.progress_percent})}),e.jsxs("button",{className:"mt-4 inline-flex items-center gap-1 text-sm font-medium text-primary",children:["Kontynuuj",e.jsx(ae,{className:"h-4 w-4"})]})]},i.course_id))})]})},J4=[e.jsx(V,{path:"/courses",element:e.jsx(Y4,{})},"courses-list")],X4=()=>e.jsxs("div",{className:"rounded-2xl border bg-card p-5 md:p-6 shadow-soft animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-xl bg-muted/60"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-5 w-1/2 rounded bg-muted/60"}),e.jsx("div",{className:"h-4 w-3/4 rounded bg-muted/60"})]}),e.jsx("div",{className:"h-9 w-36 rounded-lg bg-muted/60"})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("div",{className:"h-2 w-full rounded-full bg-muted/60"}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx("div",{className:"h-3 w-16 rounded bg-muted/60"}),e.jsx("div",{className:"h-3 w-10 rounded bg-muted/60"})]})]})]}),eA=()=>e.jsxs("div",{className:"rounded-2xl border bg-card p-4 md:p-5 shadow-soft animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-muted/60"}),e.jsx("div",{className:"h-4 w-2/5 rounded bg-muted/60"})]}),e.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((t,s)=>e.jsx("div",{className:"h-14 rounded-xl border bg-muted/40"},s))})]}),tA=()=>{const{courseId:t}=ut(),s=J(),{data:n,isLoading:i}=Kr("get_course_structure",{p_course_id:parseInt(t)},{enabled:!!t}),{data:r}=oS("courses",{filters:[{field:"id",operator:"eq",value:parseInt(t)}],enabled:!!t}),a=te.useMemo(()=>{if(!n)return[];const d=n.reduce((u,h)=>{const p=`${h.topic_id}-${h.topic_title}`;return u[p]||(u[p]={id:h.topic_id,title:h.topic_title,position:h.topic_position,activities:[]}),h.activity_id&&u[p].activities.push({id:h.activity_id,title:h.activity_title,type:h.activity_type,position:h.activity_position,completed:h.is_completed,score:h.score}),u},{}),m=Object.values(d).sort((u,h)=>u.position-h.position);return m.map((u,h)=>{const p=u.activities.length>0&&u.activities.every(f=>f.completed),b=h===0||m[h-1].activities.length>0&&m[h-1].activities.every(f=>f.completed);return u.activities.sort((f,x)=>f.position-x.position),{...u,isCompleted:p,isUnlocked:b}})},[n]),o=te.useMemo(()=>{const d=a.flatMap(h=>h.activities),m=d.filter(h=>h.completed).length,u=d.length;return{totalActivities:u,completedActivities:m,progress:u>0?Math.round(m/u*100):0}},[a]),l=r?.[0],c=te.useMemo(()=>{for(const d of a){if(!d.isUnlocked)break;const m=d.activities.find(u=>!u.completed);if(m)return{topicId:d.id,activity:m,path:m.type==="quiz"?`/student/courses/${t}/quiz/${m.id}`:`/student/courses/${t}/lesson/${m.id}`}}return null},[a,t]);return i?e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8",children:[e.jsxs("button",{className:"inline-flex items-center gap-2 text-muted-foreground cursor-default",disabled:!0,children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Powrót"})]}),e.jsx(X4,{}),e.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((d,m)=>e.jsx(eA,{},m))})]}):l?e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs("button",{onClick:()=>s("/student/dashboard#courses"),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Powrót"})]}),e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),e.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:e.jsxs("div",{className:"grid md:grid-cols-12 gap-6 md:items-center",children:[e.jsxs("div",{className:"md:col-span-7 flex items-start gap-4 min-w-0",children:[e.jsx("div",{className:"text-5xl md:text-6xl leading-none shrink-0",children:l.icon_emoji||"📚"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-xl md:text-3xl font-bold tracking-tight",children:l.title}),l.description&&e.jsx("p",{className:"mt-2 text-sm md:text-base text-muted-foreground line-clamp-3",children:l.description}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border bg-background/60 px-3 py-1.5 shadow-soft",children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsxs("span",{className:"text-sm font-medium",children:["Ukończone:"," ",e.jsx("span",{className:"tabular-nums",children:e.jsx(tt,{value:o.completedActivities})}),"/",o.totalActivities]})]}),o.progress===100&&e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full border border-green-600/30 bg-green-500/10 text-green-700 dark:text-green-400 px-3 py-1.5 shadow-soft text-sm font-semibold",children:[e.jsx(ot,{className:"h-4 w-4"}),"Kurs ukończony"]})]})]})]}),e.jsx("div",{className:"md:col-span-5",children:e.jsxs("div",{className:"rounded-xl border bg-card p-4 md:p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Postęp kursu"}),e.jsxs("span",{className:"text-sm font-semibold",children:[o.progress,"%"]})]}),e.jsx("div",{className:"mt-2",children:e.jsx(zn,{value:o.progress})}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[c?e.jsxs("button",{onClick:()=>s(c.path),className:"flex-1 inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90 focus-ring",children:["Kontynuuj",e.jsx(ae,{className:"h-4 w-4"})]}):e.jsx("button",{disabled:!0,className:"flex-1 rounded-lg border px-4 py-2 text-muted-foreground cursor-default",title:"Brak kolejnej aktywności",children:"Wszystko ukończone"}),e.jsx("button",{onClick:()=>s("/student/courses"),className:"rounded-lg border px-3 py-2 hover:bg-primary/5 focus-ring",title:"Wróć do listy",children:e.jsx(ye,{className:"h-4 w-4"})})]})]})})]})})]}),e.jsx("div",{className:"space-y-6",children:a.map((d,m)=>e.jsxs(zi,{index:m,className:$("relative rounded-2xl border bg-card p-4 md:p-5 shadow-soft",!d.isUnlocked&&"opacity-60"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-3 md:mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:$("w-10 h-10 rounded-full flex items-center justify-center",d.isCompleted?"bg-green-600 text-white":d.isUnlocked?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),"aria-label":d.isCompleted?"Temat ukończony":d.isUnlocked?"Temat odblokowany":"Temat zablokowany",children:d.isCompleted?e.jsx(ot,{className:"w-5 h-5"}):d.isUnlocked?e.jsx("span",{className:"font-semibold",children:d.position}):e.jsx(rr,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-base md:text-lg font-semibold text-foreground",children:d.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[d.activities.filter(u=>u.completed).length," ","z ",d.activities.length," ukończonych"]})]})]}),e.jsx("div",{className:"hidden md:block w-40",children:e.jsx(zn,{value:d.activities.length?Math.round(d.activities.filter(u=>u.completed).length/d.activities.length*100):0})})]}),e.jsx("div",{className:"mt-3 md:mt-4 space-y-3",children:d.activities.map(u=>{const h=u.type==="quiz",p=u.type==="quiz"?`/student/courses/${t}/quiz/${u.id}`:`/student/courses/${t}/lesson/${u.id}`;return e.jsxs(ke.button,{whileHover:d.isUnlocked?{x:2}:{},whileTap:d.isUnlocked?{scale:.98}:{},onClick:()=>{d.isUnlocked&&s(p)},disabled:!d.isUnlocked,className:$("w-full flex items-center justify-between p-4 rounded-xl border transition-colors focus-ring",d.isUnlocked?"bg-background/60 hover:bg-primary/5":"bg-muted/40 cursor-not-allowed"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:$("w-8 h-8 rounded-lg flex items-center justify-center shrink-0",h?"bg-purple-100":"bg-blue-100"),children:h?e.jsx(nt,{className:"w-4 h-4 text-purple-600"}):e.jsx(Se,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-foreground",children:u.title}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[h?"Quiz":"Materiał",u.score!==null&&` • ${u.score}%`]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[!u.completed&&d.isUnlocked&&e.jsx("span",{className:"hidden sm:inline text-xs text-muted-foreground",children:"Przejdź"}),u.completed?e.jsx(ot,{className:"w-5 h-5 text-green-600"}):e.jsx(ae,{className:"w-5 h-5 text-muted-foreground"})]})]},u.id)})})]},d.id))})]}):e.jsxs("div",{className:"container mx-auto px-4 py-12 text-center",children:[e.jsx("div",{className:"text-5xl",children:"🤷‍♂️"}),e.jsx("h2",{className:"mt-3 text-xl font-semibold",children:"Nie znaleziono kursu"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Spróbuj wrócić do listy kursów i wybrać ponownie."}),e.jsx("button",{onClick:()=>s("/student/courses"),className:"mt-6 rounded-lg bg-primary px-4 py-2 text-primary-foreground hover:bg-primary/90 focus-ring",children:"Przejdź do kursów"})]})},sA=[e.jsx(V,{path:"/courses/:courseId",element:e.jsx(tA,{})},"course-detail")],ud=Symbol.for("yaml.alias"),Hl=Symbol.for("yaml.document"),Hs=Symbol.for("yaml.map"),kg=Symbol.for("yaml.pair"),js=Symbol.for("yaml.scalar"),Si=Symbol.for("yaml.seq"),Gt=Symbol.for("yaml.node.type"),rn=t=>!!t&&typeof t=="object"&&t[Gt]===ud,Pn=t=>!!t&&typeof t=="object"&&t[Gt]===Hl,Ci=t=>!!t&&typeof t=="object"&&t[Gt]===Hs,Te=t=>!!t&&typeof t=="object"&&t[Gt]===kg,we=t=>!!t&&typeof t=="object"&&t[Gt]===js,Ti=t=>!!t&&typeof t=="object"&&t[Gt]===Si;function _e(t){if(t&&typeof t=="object")switch(t[Gt]){case Hs:case Si:return!0}return!1}function De(t){if(t&&typeof t=="object")switch(t[Gt]){case ud:case Hs:case js:case Si:return!0}return!1}const zg=t=>(we(t)||_e(t))&&!!t.anchor,yt=Symbol("break visit"),Sg=Symbol("skip children"),ps=Symbol("remove node");function Dn(t,s){const n=Cg(s);Pn(t)?Hn(null,t.contents,n,Object.freeze([t]))===ps&&(t.contents=null):Hn(null,t,n,Object.freeze([]))}Dn.BREAK=yt;Dn.SKIP=Sg;Dn.REMOVE=ps;function Hn(t,s,n,i){const r=Tg(t,s,n,i);if(De(r)||Te(r))return Ag(t,i,r),Hn(t,r,n,i);if(typeof r!="symbol"){if(_e(s)){i=Object.freeze(i.concat(s));for(let a=0;a<s.items.length;++a){const o=Hn(a,s.items[a],n,i);if(typeof o=="number")a=o-1;else{if(o===yt)return yt;o===ps&&(s.items.splice(a,1),a-=1)}}}else if(Te(s)){i=Object.freeze(i.concat(s));const a=Hn("key",s.key,n,i);if(a===yt)return yt;a===ps&&(s.key=null);const o=Hn("value",s.value,n,i);if(o===yt)return yt;o===ps&&(s.value=null)}}return r}async function wo(t,s){const n=Cg(s);Pn(t)?await Qn(null,t.contents,n,Object.freeze([t]))===ps&&(t.contents=null):await Qn(null,t,n,Object.freeze([]))}wo.BREAK=yt;wo.SKIP=Sg;wo.REMOVE=ps;async function Qn(t,s,n,i){const r=await Tg(t,s,n,i);if(De(r)||Te(r))return Ag(t,i,r),Qn(t,r,n,i);if(typeof r!="symbol"){if(_e(s)){i=Object.freeze(i.concat(s));for(let a=0;a<s.items.length;++a){const o=await Qn(a,s.items[a],n,i);if(typeof o=="number")a=o-1;else{if(o===yt)return yt;o===ps&&(s.items.splice(a,1),a-=1)}}}else if(Te(s)){i=Object.freeze(i.concat(s));const a=await Qn("key",s.key,n,i);if(a===yt)return yt;a===ps&&(s.key=null);const o=await Qn("value",s.value,n,i);if(o===yt)return yt;o===ps&&(s.value=null)}}return r}function Cg(t){return typeof t=="object"&&(t.Collection||t.Node||t.Value)?Object.assign({Alias:t.Node,Map:t.Node,Scalar:t.Node,Seq:t.Node},t.Value&&{Map:t.Value,Scalar:t.Value,Seq:t.Value},t.Collection&&{Map:t.Collection,Seq:t.Collection},t):t}function Tg(t,s,n,i){if(typeof n=="function")return n(t,s,i);if(Ci(s))return n.Map?.(t,s,i);if(Ti(s))return n.Seq?.(t,s,i);if(Te(s))return n.Pair?.(t,s,i);if(we(s))return n.Scalar?.(t,s,i);if(rn(s))return n.Alias?.(t,s,i)}function Ag(t,s,n){const i=s[s.length-1];if(_e(i))i.items[t]=n;else if(Te(i))t==="key"?i.key=n:i.value=n;else if(Pn(i))i.contents=n;else{const r=rn(i)?"alias":"scalar";throw new Error(`Cannot replace node with ${r} parent`)}}const nA={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},iA=t=>t.replace(/[!,[\]{}]/g,s=>nA[s]);class ht{constructor(s,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},ht.defaultYaml,s),this.tags=Object.assign({},ht.defaultTags,n)}clone(){const s=new ht(this.yaml,this.tags);return s.docStart=this.docStart,s}atDocument(){const s=new ht(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:ht.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},ht.defaultTags);break}return s}add(s,n){this.atNextDocument&&(this.yaml={explicit:ht.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},ht.defaultTags),this.atNextDocument=!1);const i=s.trim().split(/[ \t]+/),r=i.shift();switch(r){case"%TAG":{if(i.length!==2&&(n(0,"%TAG directive should contain exactly two parts"),i.length<2))return!1;const[a,o]=i;return this.tags[a]=o,!0}case"%YAML":{if(this.yaml.explicit=!0,i.length!==1)return n(0,"%YAML directive should contain exactly one part"),!1;const[a]=i;if(a==="1.1"||a==="1.2")return this.yaml.version=a,!0;{const o=/^\d+\.\d+$/.test(a);return n(6,`Unsupported YAML version ${a}`,o),!1}}default:return n(0,`Unknown directive ${r}`,!0),!1}}tagName(s,n){if(s==="!")return"!";if(s[0]!=="!")return n(`Not a valid tag: ${s}`),null;if(s[1]==="<"){const o=s.slice(2,-1);return o==="!"||o==="!!"?(n(`Verbatim tags aren't resolved, so ${s} is invalid.`),null):(s[s.length-1]!==">"&&n("Verbatim tags must end with a >"),o)}const[,i,r]=s.match(/^(.*!)([^!]*)$/s);r||n(`The ${s} tag has no suffix`);const a=this.tags[i];if(a)try{return a+decodeURIComponent(r)}catch(o){return n(String(o)),null}return i==="!"?s:(n(`Could not resolve tag: ${s}`),null)}tagString(s){for(const[n,i]of Object.entries(this.tags))if(s.startsWith(i))return n+iA(s.substring(i.length));return s[0]==="!"?s:`!<${s}>`}toString(s){const n=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],i=Object.entries(this.tags);let r;if(s&&i.length>0&&De(s.contents)){const a={};Dn(s.contents,(o,l)=>{De(l)&&l.tag&&(a[l.tag]=!0)}),r=Object.keys(a)}else r=[];for(const[a,o]of i)a==="!!"&&o==="tag:yaml.org,2002:"||(!s||r.some(l=>l.startsWith(o)))&&n.push(`%TAG ${a} ${o}`);return n.join(`
`)}}ht.defaultYaml={explicit:!1,version:"1.2"};ht.defaultTags={"!!":"tag:yaml.org,2002:"};function _g(t){if(/[\x00-\x19\s,[\]{}]/.test(t)){const n=`Anchor must not contain whitespace or control characters: ${JSON.stringify(t)}`;throw new Error(n)}return!0}function Pg(t){const s=new Set;return Dn(t,{Value(n,i){i.anchor&&s.add(i.anchor)}}),s}function Dg(t,s){for(let n=1;;++n){const i=`${t}${n}`;if(!s.has(i))return i}}function rA(t,s){const n=[],i=new Map;let r=null;return{onAnchor:a=>{n.push(a),r??(r=Pg(t));const o=Dg(s,r);return r.add(o),o},setAnchors:()=>{for(const a of n){const o=i.get(a);if(typeof o=="object"&&o.anchor&&(we(o.node)||_e(o.node)))o.node.anchor=o.anchor;else{const l=new Error("Failed to resolve repeated object (this should not happen)");throw l.source=a,l}}},sourceObjects:i}}function Zn(t,s,n,i){if(i&&typeof i=="object")if(Array.isArray(i))for(let r=0,a=i.length;r<a;++r){const o=i[r],l=Zn(t,i,String(r),o);l===void 0?delete i[r]:l!==o&&(i[r]=l)}else if(i instanceof Map)for(const r of Array.from(i.keys())){const a=i.get(r),o=Zn(t,i,r,a);o===void 0?i.delete(r):o!==a&&i.set(r,o)}else if(i instanceof Set)for(const r of Array.from(i)){const a=Zn(t,i,r,r);a===void 0?i.delete(r):a!==r&&(i.delete(r),i.add(a))}else for(const[r,a]of Object.entries(i)){const o=Zn(t,i,r,a);o===void 0?delete i[r]:o!==a&&(i[r]=o)}return t.call(s,n,i)}function Wt(t,s,n){if(Array.isArray(t))return t.map((i,r)=>Wt(i,String(r),n));if(t&&typeof t.toJSON=="function"){if(!n||!zg(t))return t.toJSON(s,n);const i={aliasCount:0,count:1,res:void 0};n.anchors.set(t,i),n.onCreate=a=>{i.res=a,delete n.onCreate};const r=t.toJSON(s,n);return n.onCreate&&n.onCreate(r),r}return typeof t=="bigint"&&!n?.keep?Number(t):t}class md{constructor(s){Object.defineProperty(this,Gt,{value:s})}clone(){const s=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(s.range=this.range.slice()),s}toJS(s,{mapAsMap:n,maxAliasCount:i,onAnchor:r,reviver:a}={}){if(!Pn(s))throw new TypeError("A document argument is required");const o={anchors:new Map,doc:s,keep:!0,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},l=Wt(this,"",o);if(typeof r=="function")for(const{count:c,res:d}of o.anchors.values())r(d,c);return typeof a=="function"?Zn(a,{"":l},"",l):l}}class vo extends md{constructor(s){super(ud),this.source=s,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(s,n){let i;n?.aliasResolveCache?i=n.aliasResolveCache:(i=[],Dn(s,{Node:(a,o)=>{(rn(o)||zg(o))&&i.push(o)}}),n&&(n.aliasResolveCache=i));let r;for(const a of i){if(a===this)break;a.anchor===this.source&&(r=a)}return r}toJSON(s,n){if(!n)return{source:this.source};const{anchors:i,doc:r,maxAliasCount:a}=n,o=this.resolve(r,n);if(!o){const c=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(c)}let l=i.get(o);if(l||(Wt(o,null,n),l=i.get(o)),!l||l.res===void 0){const c="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(c)}if(a>=0&&(l.count+=1,l.aliasCount===0&&(l.aliasCount=wa(r,o,i)),l.count*l.aliasCount>a)){const c="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(c)}return l.res}toString(s,n,i){const r=`*${this.source}`;if(s){if(_g(this.source),s.options.verifyAliasOrder&&!s.anchors.has(this.source)){const a=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(a)}if(s.implicitKey)return`${r} `}return r}}function wa(t,s,n){if(rn(s)){const i=s.resolve(t),r=n&&i&&n.get(i);return r?r.count*r.aliasCount:0}else if(_e(s)){let i=0;for(const r of s.items){const a=wa(t,r,n);a>i&&(i=a)}return i}else if(Te(s)){const i=wa(t,s.key,n),r=wa(t,s.value,n);return Math.max(i,r)}return 1}const Ig=t=>!t||typeof t!="function"&&typeof t!="object";class ne extends md{constructor(s){super(js),this.value=s}toJSON(s,n){return n?.keep?this.value:Wt(this.value,s,n)}toString(){return String(this.value)}}ne.BLOCK_FOLDED="BLOCK_FOLDED";ne.BLOCK_LITERAL="BLOCK_LITERAL";ne.PLAIN="PLAIN";ne.QUOTE_DOUBLE="QUOTE_DOUBLE";ne.QUOTE_SINGLE="QUOTE_SINGLE";const aA="tag:yaml.org,2002:";function oA(t,s,n){if(s){const i=n.filter(a=>a.tag===s),r=i.find(a=>!a.format)??i[0];if(!r)throw new Error(`Tag ${s} not found`);return r}return n.find(i=>i.identify?.(t)&&!i.format)}function wr(t,s,n){if(Pn(t)&&(t=t.contents),De(t))return t;if(Te(t)){const u=n.schema[Hs].createNode?.(n.schema,null,n);return u.items.push(t),u}(t instanceof String||t instanceof Number||t instanceof Boolean||typeof BigInt<"u"&&t instanceof BigInt)&&(t=t.valueOf());const{aliasDuplicateObjects:i,onAnchor:r,onTagObj:a,schema:o,sourceObjects:l}=n;let c;if(i&&t&&typeof t=="object"){if(c=l.get(t),c)return c.anchor??(c.anchor=r(t)),new vo(c.anchor);c={anchor:null,node:null},l.set(t,c)}s?.startsWith("!!")&&(s=aA+s.slice(2));let d=oA(t,s,o.tags);if(!d){if(t&&typeof t.toJSON=="function"&&(t=t.toJSON()),!t||typeof t!="object"){const u=new ne(t);return c&&(c.node=u),u}d=t instanceof Map?o[Hs]:Symbol.iterator in Object(t)?o[Si]:o[Hs]}a&&(a(d),delete n.onTagObj);const m=d?.createNode?d.createNode(n.schema,t,n):typeof d?.nodeClass?.from=="function"?d.nodeClass.from(n.schema,t,n):new ne(t);return s?m.tag=s:d.default||(m.tag=d.tag),c&&(c.node=m),m}function Ua(t,s,n){let i=n;for(let r=s.length-1;r>=0;--r){const a=s[r];if(typeof a=="number"&&Number.isInteger(a)&&a>=0){const o=[];o[a]=i,i=o}else i=new Map([[a,i]])}return wr(i,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:t,sourceObjects:new Map})}const Ki=t=>t==null||typeof t=="object"&&!!t[Symbol.iterator]().next().done;class Mg extends md{constructor(s,n){super(s),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(s){const n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return s&&(n.schema=s),n.items=n.items.map(i=>De(i)||Te(i)?i.clone(s):i),this.range&&(n.range=this.range.slice()),n}addIn(s,n){if(Ki(s))this.add(n);else{const[i,...r]=s,a=this.get(i,!0);if(_e(a))a.addIn(r,n);else if(a===void 0&&this.schema)this.set(i,Ua(this.schema,r,n));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${r}`)}}deleteIn(s){const[n,...i]=s;if(i.length===0)return this.delete(n);const r=this.get(n,!0);if(_e(r))return r.deleteIn(i);throw new Error(`Expected YAML collection at ${n}. Remaining path: ${i}`)}getIn(s,n){const[i,...r]=s,a=this.get(i,!0);return r.length===0?!n&&we(a)?a.value:a:_e(a)?a.getIn(r,n):void 0}hasAllNullValues(s){return this.items.every(n=>{if(!Te(n))return!1;const i=n.value;return i==null||s&&we(i)&&i.value==null&&!i.commentBefore&&!i.comment&&!i.tag})}hasIn(s){const[n,...i]=s;if(i.length===0)return this.has(n);const r=this.get(n,!0);return _e(r)?r.hasIn(i):!1}setIn(s,n){const[i,...r]=s;if(r.length===0)this.set(i,n);else{const a=this.get(i,!0);if(_e(a))a.setIn(r,n);else if(a===void 0&&this.schema)this.set(i,Ua(this.schema,r,n));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${r}`)}}}const lA=t=>t.replace(/^(?!$)(?: $)?/gm,"#");function _s(t,s){return/^\n+$/.test(t)?t.substring(1):s?t.replace(/^(?! *$)/gm,s):t}const mn=(t,s,n)=>t.endsWith(`
`)?_s(n,s):n.includes(`
`)?`
`+_s(n,s):(t.endsWith(" ")?"":" ")+n,Eg="flow",Ql="block",va="quoted";function No(t,s,n="flow",{indentAtStart:i,lineWidth:r=80,minContentWidth:a=20,onFold:o,onOverflow:l}={}){if(!r||r<0)return t;r<a&&(a=0);const c=Math.max(1+a,1+r-s.length);if(t.length<=c)return t;const d=[],m={};let u=r-s.length;typeof i=="number"&&(i>r-Math.max(2,a)?d.push(0):u=r-i);let h,p,b=!1,f=-1,x=-1,w=-1;n===Ql&&(f=Fm(t,f,s.length),f!==-1&&(u=f+c));for(let N;N=t[f+=1];){if(n===va&&N==="\\"){switch(x=f,t[f+1]){case"x":f+=3;break;case"u":f+=5;break;case"U":f+=9;break;default:f+=1}w=f}if(N===`
`)n===Ql&&(f=Fm(t,f,s.length)),u=f+s.length+c,h=void 0;else{if(N===" "&&p&&p!==" "&&p!==`
`&&p!=="	"){const A=t[f+1];A&&A!==" "&&A!==`
`&&A!=="	"&&(h=f)}if(f>=u)if(h)d.push(h),u=h+c,h=void 0;else if(n===va){for(;p===" "||p==="	";)p=N,N=t[f+=1],b=!0;const A=f>w+1?f-2:x-1;if(m[A])return t;d.push(A),m[A]=!0,u=A+c,h=void 0}else b=!0}p=N}if(b&&l&&l(),d.length===0)return t;o&&o();let y=t.slice(0,d[0]);for(let N=0;N<d.length;++N){const A=d[N],S=d[N+1]||t.length;A===0?y=`
${s}${t.slice(0,S)}`:(n===va&&m[A]&&(y+=`${t[A]}\\`),y+=`
${s}${t.slice(A+1,S)}`)}return y}function Fm(t,s,n){let i=s,r=s+1,a=t[r];for(;a===" "||a==="	";)if(s<r+n)a=t[++s];else{do a=t[++s];while(a&&a!==`
`);i=s,r=s+1,a=t[r]}return i}const ko=(t,s)=>({indentAtStart:s?t.indent.length:t.indentAtStart,lineWidth:t.options.lineWidth,minContentWidth:t.options.minContentWidth}),zo=t=>/^(%|---|\.\.\.)/m.test(t);function cA(t,s,n){if(!s||s<0)return!1;const i=s-n,r=t.length;if(r<=i)return!1;for(let a=0,o=0;a<r;++a)if(t[a]===`
`){if(a-o>i)return!0;if(o=a+1,r-o<=i)return!1}return!0}function tr(t,s){const n=JSON.stringify(t);if(s.options.doubleQuotedAsJSON)return n;const{implicitKey:i}=s,r=s.options.doubleQuotedMinMultiLineLength,a=s.indent||(zo(t)?"  ":"");let o="",l=0;for(let c=0,d=n[c];d;d=n[++c])if(d===" "&&n[c+1]==="\\"&&n[c+2]==="n"&&(o+=n.slice(l,c)+"\\ ",c+=1,l=c,d="\\"),d==="\\")switch(n[c+1]){case"u":{o+=n.slice(l,c);const m=n.substr(c+2,4);switch(m){case"0000":o+="\\0";break;case"0007":o+="\\a";break;case"000b":o+="\\v";break;case"001b":o+="\\e";break;case"0085":o+="\\N";break;case"00a0":o+="\\_";break;case"2028":o+="\\L";break;case"2029":o+="\\P";break;default:m.substr(0,2)==="00"?o+="\\x"+m.substr(2):o+=n.substr(c,6)}c+=5,l=c+1}break;case"n":if(i||n[c+2]==='"'||n.length<r)c+=1;else{for(o+=n.slice(l,c)+`

`;n[c+2]==="\\"&&n[c+3]==="n"&&n[c+4]!=='"';)o+=`
`,c+=2;o+=a,n[c+2]===" "&&(o+="\\"),c+=1,l=c+1}break;default:c+=1}return o=l?o+n.slice(l):n,i?o:No(o,a,va,ko(s,!1))}function Zl(t,s){if(s.options.singleQuote===!1||s.implicitKey&&t.includes(`
`)||/[ \t]\n|\n[ \t]/.test(t))return tr(t,s);const n=s.indent||(zo(t)?"  ":""),i="'"+t.replace(/'/g,"''").replace(/\n+/g,`$&
${n}`)+"'";return s.implicitKey?i:No(i,n,Eg,ko(s,!1))}function Yn(t,s){const{singleQuote:n}=s.options;let i;if(n===!1)i=tr;else{const r=t.includes('"'),a=t.includes("'");r&&!a?i=Zl:a&&!r?i=tr:i=n?Zl:tr}return i(t,s)}let Yl;try{Yl=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{Yl=/\n+(?!\n|$)/g}function Na({comment:t,type:s,value:n},i,r,a){const{blockQuote:o,commentString:l,lineWidth:c}=i.options;if(!o||/\n[\t ]+$/.test(n)||/^\s*$/.test(n))return Yn(n,i);const d=i.indent||(i.forceBlockIndent||zo(n)?"  ":""),m=o==="literal"?!0:o==="folded"||s===ne.BLOCK_FOLDED?!1:s===ne.BLOCK_LITERAL?!0:!cA(n,c,d.length);if(!n)return m?`|
`:`>
`;let u,h;for(h=n.length;h>0;--h){const S=n[h-1];if(S!==`
`&&S!=="	"&&S!==" ")break}let p=n.substring(h);const b=p.indexOf(`
`);b===-1?u="-":n===p||b!==p.length-1?(u="+",a&&a()):u="",p&&(n=n.slice(0,-p.length),p[p.length-1]===`
`&&(p=p.slice(0,-1)),p=p.replace(Yl,`$&${d}`));let f=!1,x,w=-1;for(x=0;x<n.length;++x){const S=n[x];if(S===" ")f=!0;else if(S===`
`)w=x;else break}let y=n.substring(0,w<x?w+1:x);y&&(n=n.substring(y.length),y=y.replace(/\n+/g,`$&${d}`));let A=(f?d?"2":"1":"")+u;if(t&&(A+=" "+l(t.replace(/ ?[\r\n]+/g," ")),r&&r()),!m){const S=n.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${d}`);let k=!1;const v=ko(i,!0);o!=="folded"&&s!==ne.BLOCK_FOLDED&&(v.onOverflow=()=>{k=!0});const z=No(`${y}${S}${p}`,d,Ql,v);if(!k)return`>${A}
${d}${z}`}return n=n.replace(/\n+/g,`$&${d}`),`|${A}
${d}${y}${n}${p}`}function dA(t,s,n,i){const{type:r,value:a}=t,{actualString:o,implicitKey:l,indent:c,indentStep:d,inFlow:m}=s;if(l&&a.includes(`
`)||m&&/[[\]{},]/.test(a))return Yn(a,s);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(a))return l||m||!a.includes(`
`)?Yn(a,s):Na(t,s,n,i);if(!l&&!m&&r!==ne.PLAIN&&a.includes(`
`))return Na(t,s,n,i);if(zo(a)){if(c==="")return s.forceBlockIndent=!0,Na(t,s,n,i);if(l&&c===d)return Yn(a,s)}const u=a.replace(/\n+/g,`$&
${c}`);if(o){const h=f=>f.default&&f.tag!=="tag:yaml.org,2002:str"&&f.test?.test(u),{compat:p,tags:b}=s.doc.schema;if(b.some(h)||p?.some(h))return Yn(a,s)}return l?u:No(u,c,Eg,ko(s,!1))}function Yr(t,s,n,i){const{implicitKey:r,inFlow:a}=s,o=typeof t.value=="string"?t:Object.assign({},t,{value:String(t.value)});let{type:l}=t;l!==ne.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(o.value)&&(l=ne.QUOTE_DOUBLE);const c=m=>{switch(m){case ne.BLOCK_FOLDED:case ne.BLOCK_LITERAL:return r||a?Yn(o.value,s):Na(o,s,n,i);case ne.QUOTE_DOUBLE:return tr(o.value,s);case ne.QUOTE_SINGLE:return Zl(o.value,s);case ne.PLAIN:return dA(o,s,n,i);default:return null}};let d=c(l);if(d===null){const{defaultKeyType:m,defaultStringType:u}=s.options,h=r&&m||u;if(d=c(h),d===null)throw new Error(`Unsupported default string type ${h}`)}return d}function Lg(t,s){const n=Object.assign({blockQuote:!0,commentString:lA,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},t.schema.toStringOptions,s);let i;switch(n.collectionStyle){case"block":i=!1;break;case"flow":i=!0;break;default:i=null}return{anchors:new Set,doc:t,flowCollectionPadding:n.flowCollectionPadding?" ":"",indent:"",indentStep:typeof n.indent=="number"?" ".repeat(n.indent):"  ",inFlow:i,options:n}}function uA(t,s){if(s.tag){const r=t.filter(a=>a.tag===s.tag);if(r.length>0)return r.find(a=>a.format===s.format)??r[0]}let n,i;if(we(s)){i=s.value;let r=t.filter(a=>a.identify?.(i));if(r.length>1){const a=r.filter(o=>o.test);a.length>0&&(r=a)}n=r.find(a=>a.format===s.format)??r.find(a=>!a.format)}else i=s,n=t.find(r=>r.nodeClass&&i instanceof r.nodeClass);if(!n){const r=i?.constructor?.name??(i===null?"null":typeof i);throw new Error(`Tag not resolved for ${r} value`)}return n}function mA(t,s,{anchors:n,doc:i}){if(!i.directives)return"";const r=[],a=(we(t)||_e(t))&&t.anchor;a&&_g(a)&&(n.add(a),r.push(`&${a}`));const o=t.tag??(s.default?null:s.tag);return o&&r.push(i.directives.tagString(o)),r.join(" ")}function ui(t,s,n,i){if(Te(t))return t.toString(s,n,i);if(rn(t)){if(s.doc.directives)return t.toString(s);if(s.resolvedAliases?.has(t))throw new TypeError("Cannot stringify circular structure without alias nodes");s.resolvedAliases?s.resolvedAliases.add(t):s.resolvedAliases=new Set([t]),t=t.resolve(s.doc)}let r;const a=De(t)?t:s.doc.createNode(t,{onTagObj:c=>r=c});r??(r=uA(s.doc.schema.tags,a));const o=mA(a,r,s);o.length>0&&(s.indentAtStart=(s.indentAtStart??0)+o.length+1);const l=typeof r.stringify=="function"?r.stringify(a,s,n,i):we(a)?Yr(a,s,n,i):a.toString(s,n,i);return o?we(a)||l[0]==="{"||l[0]==="["?`${o} ${l}`:`${o}
${s.indent}${l}`:l}function hA({key:t,value:s},n,i,r){const{allNullValues:a,doc:o,indent:l,indentStep:c,options:{commentString:d,indentSeq:m,simpleKeys:u}}=n;let h=De(t)&&t.comment||null;if(u){if(h)throw new Error("With simple keys, key nodes cannot have comments");if(_e(t)||!De(t)&&typeof t=="object"){const v="With simple keys, collection cannot be used as a key value";throw new Error(v)}}let p=!u&&(!t||h&&s==null&&!n.inFlow||_e(t)||(we(t)?t.type===ne.BLOCK_FOLDED||t.type===ne.BLOCK_LITERAL:typeof t=="object"));n=Object.assign({},n,{allNullValues:!1,implicitKey:!p&&(u||!a),indent:l+c});let b=!1,f=!1,x=ui(t,n,()=>b=!0,()=>f=!0);if(!p&&!n.inFlow&&x.length>1024){if(u)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");p=!0}if(n.inFlow){if(a||s==null)return b&&i&&i(),x===""?"?":p?`? ${x}`:x}else if(a&&!u||s==null&&p)return x=`? ${x}`,h&&!b?x+=mn(x,n.indent,d(h)):f&&r&&r(),x;b&&(h=null),p?(h&&(x+=mn(x,n.indent,d(h))),x=`? ${x}
${l}:`):(x=`${x}:`,h&&(x+=mn(x,n.indent,d(h))));let w,y,N;De(s)?(w=!!s.spaceBefore,y=s.commentBefore,N=s.comment):(w=!1,y=null,N=null,s&&typeof s=="object"&&(s=o.createNode(s))),n.implicitKey=!1,!p&&!h&&we(s)&&(n.indentAtStart=x.length+1),f=!1,!m&&c.length>=2&&!n.inFlow&&!p&&Ti(s)&&!s.flow&&!s.tag&&!s.anchor&&(n.indent=n.indent.substring(2));let A=!1;const S=ui(s,n,()=>A=!0,()=>f=!0);let k=" ";if(h||w||y){if(k=w?`
`:"",y){const v=d(y);k+=`
${_s(v,n.indent)}`}S===""&&!n.inFlow?k===`
`&&(k=`

`):k+=`
${n.indent}`}else if(!p&&_e(s)){const v=S[0],z=S.indexOf(`
`),D=z!==-1,j=n.inFlow??s.flow??s.items.length===0;if(D||!j){let C=!1;if(D&&(v==="&"||v==="!")){let T=S.indexOf(" ");v==="&"&&T!==-1&&T<z&&S[T+1]==="!"&&(T=S.indexOf(" ",T+1)),(T===-1||z<T)&&(C=!0)}C||(k=`
${n.indent}`)}}else(S===""||S[0]===`
`)&&(k="");return x+=k+S,n.inFlow?A&&i&&i():N&&!A?x+=mn(x,n.indent,d(N)):f&&r&&r(),x}function Og(t,s){(t==="debug"||t==="warn")&&console.warn(s)}const da="<<",Ps={identify:t=>t===da||typeof t=="symbol"&&t.description===da,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new ne(Symbol(da)),{addToJSMap:Rg}),stringify:()=>da},pA=(t,s)=>(Ps.identify(s)||we(s)&&(!s.type||s.type===ne.PLAIN)&&Ps.identify(s.value))&&t?.doc.schema.tags.some(n=>n.tag===Ps.tag&&n.default);function Rg(t,s,n){if(n=t&&rn(n)?n.resolve(t.doc):n,Ti(n))for(const i of n.items)cl(t,s,i);else if(Array.isArray(n))for(const i of n)cl(t,s,i);else cl(t,s,n)}function cl(t,s,n){const i=t&&rn(n)?n.resolve(t.doc):n;if(!Ci(i))throw new Error("Merge sources must be maps or map aliases");const r=i.toJSON(null,t,Map);for(const[a,o]of r)s instanceof Map?s.has(a)||s.set(a,o):s instanceof Set?s.add(a):Object.prototype.hasOwnProperty.call(s,a)||Object.defineProperty(s,a,{value:o,writable:!0,enumerable:!0,configurable:!0});return s}function $g(t,s,{key:n,value:i}){if(De(n)&&n.addToJSMap)n.addToJSMap(t,s,i);else if(pA(t,n))Rg(t,s,i);else{const r=Wt(n,"",t);if(s instanceof Map)s.set(r,Wt(i,r,t));else if(s instanceof Set)s.add(r);else{const a=fA(n,r,t),o=Wt(i,a,t);a in s?Object.defineProperty(s,a,{value:o,writable:!0,enumerable:!0,configurable:!0}):s[a]=o}}return s}function fA(t,s,n){if(s===null)return"";if(typeof s!="object")return String(s);if(De(t)&&n?.doc){const i=Lg(n.doc,{});i.anchors=new Set;for(const a of n.anchors.keys())i.anchors.add(a.anchor);i.inFlow=!0,i.inStringifyKey=!0;const r=t.toString(i);if(!n.mapKeyWarned){let a=JSON.stringify(r);a.length>40&&(a=a.substring(0,36)+'..."'),Og(n.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${a}. Set mapAsMap: true to use object keys.`),n.mapKeyWarned=!0}return r}return JSON.stringify(s)}function hd(t,s,n){const i=wr(t,void 0,n),r=wr(s,void 0,n);return new ct(i,r)}class ct{constructor(s,n=null){Object.defineProperty(this,Gt,{value:kg}),this.key=s,this.value=n}clone(s){let{key:n,value:i}=this;return De(n)&&(n=n.clone(s)),De(i)&&(i=i.clone(s)),new ct(n,i)}toJSON(s,n){const i=n?.mapAsMap?new Map:{};return $g(n,i,this)}toString(s,n,i){return s?.doc?hA(this,s,n,i):JSON.stringify(this)}}function qg(t,s,n){return(s.inFlow??t.flow?gA:xA)(t,s,n)}function xA({comment:t,items:s},n,{blockItemPrefix:i,flowChars:r,itemIndent:a,onChompKeep:o,onComment:l}){const{indent:c,options:{commentString:d}}=n,m=Object.assign({},n,{indent:a,type:null});let u=!1;const h=[];for(let b=0;b<s.length;++b){const f=s[b];let x=null;if(De(f))!u&&f.spaceBefore&&h.push(""),Va(n,h,f.commentBefore,u),f.comment&&(x=f.comment);else if(Te(f)){const y=De(f.key)?f.key:null;y&&(!u&&y.spaceBefore&&h.push(""),Va(n,h,y.commentBefore,u))}u=!1;let w=ui(f,m,()=>x=null,()=>u=!0);x&&(w+=mn(w,a,d(x))),u&&x&&(u=!1),h.push(i+w)}let p;if(h.length===0)p=r.start+r.end;else{p=h[0];for(let b=1;b<h.length;++b){const f=h[b];p+=f?`
${c}${f}`:`
`}}return t?(p+=`
`+_s(d(t),c),l&&l()):u&&o&&o(),p}function gA({items:t},s,{flowChars:n,itemIndent:i}){const{indent:r,indentStep:a,flowCollectionPadding:o,options:{commentString:l}}=s;i+=a;const c=Object.assign({},s,{indent:i,inFlow:!0,type:null});let d=!1,m=0;const u=[];for(let b=0;b<t.length;++b){const f=t[b];let x=null;if(De(f))f.spaceBefore&&u.push(""),Va(s,u,f.commentBefore,!1),f.comment&&(x=f.comment);else if(Te(f)){const y=De(f.key)?f.key:null;y&&(y.spaceBefore&&u.push(""),Va(s,u,y.commentBefore,!1),y.comment&&(d=!0));const N=De(f.value)?f.value:null;N?(N.comment&&(x=N.comment),N.commentBefore&&(d=!0)):f.value==null&&y?.comment&&(x=y.comment)}x&&(d=!0);let w=ui(f,c,()=>x=null);b<t.length-1&&(w+=","),x&&(w+=mn(w,i,l(x))),!d&&(u.length>m||w.includes(`
`))&&(d=!0),u.push(w),m=u.length}const{start:h,end:p}=n;if(u.length===0)return h+p;if(!d){const b=u.reduce((f,x)=>f+x.length+2,2);d=s.options.lineWidth>0&&b>s.options.lineWidth}if(d){let b=h;for(const f of u)b+=f?`
${a}${r}${f}`:`
`;return`${b}
${r}${p}`}else return`${h}${o}${u.join(" ")}${o}${p}`}function Va({indent:t,options:{commentString:s}},n,i,r){if(i&&r&&(i=i.replace(/^\n+/,"")),i){const a=_s(s(i),t);n.push(a.trimStart())}}function hn(t,s){const n=we(s)?s.value:s;for(const i of t)if(Te(i)&&(i.key===s||i.key===n||we(i.key)&&i.key.value===n))return i}class At extends Mg{static get tagName(){return"tag:yaml.org,2002:map"}constructor(s){super(Hs,s),this.items=[]}static from(s,n,i){const{keepUndefined:r,replacer:a}=i,o=new this(s),l=(c,d)=>{if(typeof a=="function")d=a.call(n,c,d);else if(Array.isArray(a)&&!a.includes(c))return;(d!==void 0||r)&&o.items.push(hd(c,d,i))};if(n instanceof Map)for(const[c,d]of n)l(c,d);else if(n&&typeof n=="object")for(const c of Object.keys(n))l(c,n[c]);return typeof s.sortMapEntries=="function"&&o.items.sort(s.sortMapEntries),o}add(s,n){let i;Te(s)?i=s:!s||typeof s!="object"||!("key"in s)?i=new ct(s,s?.value):i=new ct(s.key,s.value);const r=hn(this.items,i.key),a=this.schema?.sortMapEntries;if(r){if(!n)throw new Error(`Key ${i.key} already set`);we(r.value)&&Ig(i.value)?r.value.value=i.value:r.value=i.value}else if(a){const o=this.items.findIndex(l=>a(i,l)<0);o===-1?this.items.push(i):this.items.splice(o,0,i)}else this.items.push(i)}delete(s){const n=hn(this.items,s);return n?this.items.splice(this.items.indexOf(n),1).length>0:!1}get(s,n){const r=hn(this.items,s)?.value;return(!n&&we(r)?r.value:r)??void 0}has(s){return!!hn(this.items,s)}set(s,n){this.add(new ct(s,n),!0)}toJSON(s,n,i){const r=i?new i:n?.mapAsMap?new Map:{};n?.onCreate&&n.onCreate(r);for(const a of this.items)$g(n,r,a);return r}toString(s,n,i){if(!s)return JSON.stringify(this);for(const r of this.items)if(!Te(r))throw new Error(`Map items must all be pairs; found ${JSON.stringify(r)} instead`);return!s.allNullValues&&this.hasAllNullValues(!1)&&(s=Object.assign({},s,{allNullValues:!0})),qg(this,s,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:s.indent||"",onChompKeep:i,onComment:n})}}const Ai={collection:"map",default:!0,nodeClass:At,tag:"tag:yaml.org,2002:map",resolve(t,s){return Ci(t)||s("Expected a mapping for this tag"),t},createNode:(t,s,n)=>At.from(t,s,n)};class tn extends Mg{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(s){super(Si,s),this.items=[]}add(s){this.items.push(s)}delete(s){const n=ua(s);return typeof n!="number"?!1:this.items.splice(n,1).length>0}get(s,n){const i=ua(s);if(typeof i!="number")return;const r=this.items[i];return!n&&we(r)?r.value:r}has(s){const n=ua(s);return typeof n=="number"&&n<this.items.length}set(s,n){const i=ua(s);if(typeof i!="number")throw new Error(`Expected a valid index, not ${s}.`);const r=this.items[i];we(r)&&Ig(n)?r.value=n:this.items[i]=n}toJSON(s,n){const i=[];n?.onCreate&&n.onCreate(i);let r=0;for(const a of this.items)i.push(Wt(a,String(r++),n));return i}toString(s,n,i){return s?qg(this,s,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(s.indent||"")+"  ",onChompKeep:i,onComment:n}):JSON.stringify(this)}static from(s,n,i){const{replacer:r}=i,a=new this(s);if(n&&Symbol.iterator in Object(n)){let o=0;for(let l of n){if(typeof r=="function"){const c=n instanceof Set?l:String(o++);l=r.call(n,c,l)}a.items.push(wr(l,void 0,i))}}return a}}function ua(t){let s=we(t)?t.value:t;return s&&typeof s=="string"&&(s=Number(s)),typeof s=="number"&&Number.isInteger(s)&&s>=0?s:null}const _i={collection:"seq",default:!0,nodeClass:tn,tag:"tag:yaml.org,2002:seq",resolve(t,s){return Ti(t)||s("Expected a sequence for this tag"),t},createNode:(t,s,n)=>tn.from(t,s,n)},So={identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify(t,s,n,i){return s=Object.assign({actualString:!0},s),Yr(t,s,n,i)}},Co={identify:t=>t==null,createNode:()=>new ne(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new ne(null),stringify:({source:t},s)=>typeof t=="string"&&Co.test.test(t)?t:s.options.nullStr},pd={identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:t=>new ne(t[0]==="t"||t[0]==="T"),stringify({source:t,value:s},n){if(t&&pd.test.test(t)){const i=t[0]==="t"||t[0]==="T";if(s===i)return t}return s?n.options.trueStr:n.options.falseStr}};function ns({format:t,minFractionDigits:s,tag:n,value:i}){if(typeof i=="bigint")return String(i);const r=typeof i=="number"?i:Number(i);if(!isFinite(r))return isNaN(r)?".nan":r<0?"-.inf":".inf";let a=JSON.stringify(i);if(!t&&s&&(!n||n==="tag:yaml.org,2002:float")&&/^\d/.test(a)){let o=a.indexOf(".");o<0&&(o=a.length,a+=".");let l=s-(a.length-o-1);for(;l-- >0;)a+="0"}return a}const Fg={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ns},Bg={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t),stringify(t){const s=Number(t.value);return isFinite(s)?s.toExponential():ns(t)}},Ug={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(t){const s=new ne(parseFloat(t)),n=t.indexOf(".");return n!==-1&&t[t.length-1]==="0"&&(s.minFractionDigits=t.length-n-1),s},stringify:ns},To=t=>typeof t=="bigint"||Number.isInteger(t),fd=(t,s,n,{intAsBigInt:i})=>i?BigInt(t):parseInt(t.substring(s),n);function Vg(t,s,n){const{value:i}=t;return To(i)&&i>=0?n+i.toString(s):ns(t)}const Wg={identify:t=>To(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(t,s,n)=>fd(t,2,8,n),stringify:t=>Vg(t,8,"0o")},Kg={identify:To,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(t,s,n)=>fd(t,0,10,n),stringify:ns},Gg={identify:t=>To(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(t,s,n)=>fd(t,2,16,n),stringify:t=>Vg(t,16,"0x")},jA=[Ai,_i,So,Co,pd,Wg,Kg,Gg,Fg,Bg,Ug];function Bm(t){return typeof t=="bigint"||Number.isInteger(t)}const ma=({value:t})=>JSON.stringify(t),yA=[{identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify:ma},{identify:t=>t==null,createNode:()=>new ne(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:ma},{identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:t=>t==="true",stringify:ma},{identify:Bm,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(t,s,{intAsBigInt:n})=>n?BigInt(t):parseInt(t,10),stringify:({value:t})=>Bm(t)?t.toString():JSON.stringify(t)},{identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:t=>parseFloat(t),stringify:ma}],bA={default:!0,tag:"",test:/^/,resolve(t,s){return s(`Unresolved plain scalar ${JSON.stringify(t)}`),t}},wA=[Ai,_i].concat(yA,bA),xd={identify:t=>t instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(t,s){if(typeof atob=="function"){const n=atob(t.replace(/[\n\r]/g,"")),i=new Uint8Array(n.length);for(let r=0;r<n.length;++r)i[r]=n.charCodeAt(r);return i}else return s("This environment does not support reading binary tags; either Buffer or atob is required"),t},stringify({comment:t,type:s,value:n},i,r,a){if(!n)return"";const o=n;let l;if(typeof btoa=="function"){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);l=btoa(c)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(s??(s=ne.BLOCK_LITERAL),s!==ne.QUOTE_DOUBLE){const c=Math.max(i.options.lineWidth-i.indent.length,i.options.minContentWidth),d=Math.ceil(l.length/c),m=new Array(d);for(let u=0,h=0;u<d;++u,h+=c)m[u]=l.substr(h,c);l=m.join(s===ne.BLOCK_LITERAL?`
`:" ")}return Yr({comment:t,type:s,value:l},i,r,a)}};function Hg(t,s){if(Ti(t))for(let n=0;n<t.items.length;++n){let i=t.items[n];if(!Te(i)){if(Ci(i)){i.items.length>1&&s("Each pair must have its own sequence indicator");const r=i.items[0]||new ct(new ne(null));if(i.commentBefore&&(r.key.commentBefore=r.key.commentBefore?`${i.commentBefore}
${r.key.commentBefore}`:i.commentBefore),i.comment){const a=r.value??r.key;a.comment=a.comment?`${i.comment}
${a.comment}`:i.comment}i=r}t.items[n]=Te(i)?i:new ct(i)}}else s("Expected a sequence for this tag");return t}function Qg(t,s,n){const{replacer:i}=n,r=new tn(t);r.tag="tag:yaml.org,2002:pairs";let a=0;if(s&&Symbol.iterator in Object(s))for(let o of s){typeof i=="function"&&(o=i.call(s,String(a++),o));let l,c;if(Array.isArray(o))if(o.length===2)l=o[0],c=o[1];else throw new TypeError(`Expected [key, value] tuple: ${o}`);else if(o&&o instanceof Object){const d=Object.keys(o);if(d.length===1)l=d[0],c=o[l];else throw new TypeError(`Expected tuple with one key, not ${d.length} keys`)}else l=o;r.items.push(hd(l,c,n))}return r}const gd={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:Hg,createNode:Qg};class si extends tn{constructor(){super(),this.add=At.prototype.add.bind(this),this.delete=At.prototype.delete.bind(this),this.get=At.prototype.get.bind(this),this.has=At.prototype.has.bind(this),this.set=At.prototype.set.bind(this),this.tag=si.tag}toJSON(s,n){if(!n)return super.toJSON(s);const i=new Map;n?.onCreate&&n.onCreate(i);for(const r of this.items){let a,o;if(Te(r)?(a=Wt(r.key,"",n),o=Wt(r.value,a,n)):a=Wt(r,"",n),i.has(a))throw new Error("Ordered maps must not include duplicate keys");i.set(a,o)}return i}static from(s,n,i){const r=Qg(s,n,i),a=new this;return a.items=r.items,a}}si.tag="tag:yaml.org,2002:omap";const jd={collection:"seq",identify:t=>t instanceof Map,nodeClass:si,default:!1,tag:"tag:yaml.org,2002:omap",resolve(t,s){const n=Hg(t,s),i=[];for(const{key:r}of n.items)we(r)&&(i.includes(r.value)?s(`Ordered maps must not include duplicate keys: ${r.value}`):i.push(r.value));return Object.assign(new si,n)},createNode:(t,s,n)=>si.from(t,s,n)};function Zg({value:t,source:s},n){return s&&(t?Yg:Jg).test.test(s)?s:t?n.options.trueStr:n.options.falseStr}const Yg={identify:t=>t===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new ne(!0),stringify:Zg},Jg={identify:t=>t===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new ne(!1),stringify:Zg},vA={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ns},NA={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t.replace(/_/g,"")),stringify(t){const s=Number(t.value);return isFinite(s)?s.toExponential():ns(t)}},kA={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(t){const s=new ne(parseFloat(t.replace(/_/g,""))),n=t.indexOf(".");if(n!==-1){const i=t.substring(n+1).replace(/_/g,"");i[i.length-1]==="0"&&(s.minFractionDigits=i.length)}return s},stringify:ns},Jr=t=>typeof t=="bigint"||Number.isInteger(t);function Ao(t,s,n,{intAsBigInt:i}){const r=t[0];if((r==="-"||r==="+")&&(s+=1),t=t.substring(s).replace(/_/g,""),i){switch(n){case 2:t=`0b${t}`;break;case 8:t=`0o${t}`;break;case 16:t=`0x${t}`;break}const o=BigInt(t);return r==="-"?BigInt(-1)*o:o}const a=parseInt(t,n);return r==="-"?-1*a:a}function yd(t,s,n){const{value:i}=t;if(Jr(i)){const r=i.toString(s);return i<0?"-"+n+r.substr(1):n+r}return ns(t)}const zA={identify:Jr,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(t,s,n)=>Ao(t,2,2,n),stringify:t=>yd(t,2,"0b")},SA={identify:Jr,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(t,s,n)=>Ao(t,1,8,n),stringify:t=>yd(t,8,"0")},CA={identify:Jr,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(t,s,n)=>Ao(t,0,10,n),stringify:ns},TA={identify:Jr,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(t,s,n)=>Ao(t,2,16,n),stringify:t=>yd(t,16,"0x")};class ni extends At{constructor(s){super(s),this.tag=ni.tag}add(s){let n;Te(s)?n=s:s&&typeof s=="object"&&"key"in s&&"value"in s&&s.value===null?n=new ct(s.key,null):n=new ct(s,null),hn(this.items,n.key)||this.items.push(n)}get(s,n){const i=hn(this.items,s);return!n&&Te(i)?we(i.key)?i.key.value:i.key:i}set(s,n){if(typeof n!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof n}`);const i=hn(this.items,s);i&&!n?this.items.splice(this.items.indexOf(i),1):!i&&n&&this.items.push(new ct(s))}toJSON(s,n){return super.toJSON(s,n,Set)}toString(s,n,i){if(!s)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},s,{allNullValues:!0}),n,i);throw new Error("Set items must all have null values")}static from(s,n,i){const{replacer:r}=i,a=new this(s);if(n&&Symbol.iterator in Object(n))for(let o of n)typeof r=="function"&&(o=r.call(n,o,o)),a.items.push(hd(o,null,i));return a}}ni.tag="tag:yaml.org,2002:set";const bd={collection:"map",identify:t=>t instanceof Set,nodeClass:ni,default:!1,tag:"tag:yaml.org,2002:set",createNode:(t,s,n)=>ni.from(t,s,n),resolve(t,s){if(Ci(t)){if(t.hasAllNullValues(!0))return Object.assign(new ni,t);s("Set items must all have null values")}else s("Expected a mapping for this tag");return t}};function wd(t,s){const n=t[0],i=n==="-"||n==="+"?t.substring(1):t,r=o=>s?BigInt(o):Number(o),a=i.replace(/_/g,"").split(":").reduce((o,l)=>o*r(60)+r(l),r(0));return n==="-"?r(-1)*a:a}function Xg(t){let{value:s}=t,n=o=>o;if(typeof s=="bigint")n=o=>BigInt(o);else if(isNaN(s)||!isFinite(s))return ns(t);let i="";s<0&&(i="-",s*=n(-1));const r=n(60),a=[s%r];return s<60?a.unshift(0):(s=(s-a[0])/r,a.unshift(s%r),s>=60&&(s=(s-a[0])/r,a.unshift(s))),i+a.map(o=>String(o).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const ej={identify:t=>typeof t=="bigint"||Number.isInteger(t),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(t,s,{intAsBigInt:n})=>wd(t,n),stringify:Xg},tj={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:t=>wd(t,!1),stringify:Xg},_o={identify:t=>t instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(t){const s=t.match(_o.test);if(!s)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,n,i,r,a,o,l]=s.map(Number),c=s[7]?Number((s[7]+"00").substr(1,3)):0;let d=Date.UTC(n,i-1,r,a||0,o||0,l||0,c);const m=s[8];if(m&&m!=="Z"){let u=wd(m,!1);Math.abs(u)<30&&(u*=60),d-=6e4*u}return new Date(d)},stringify:({value:t})=>t?.toISOString().replace(/(T00:00:00)?\.000Z$/,"")??""},Um=[Ai,_i,So,Co,Yg,Jg,zA,SA,CA,TA,vA,NA,kA,xd,Ps,jd,gd,bd,ej,tj,_o],Vm=new Map([["core",jA],["failsafe",[Ai,_i,So]],["json",wA],["yaml11",Um],["yaml-1.1",Um]]),Wm={binary:xd,bool:pd,float:Ug,floatExp:Bg,floatNaN:Fg,floatTime:tj,int:Kg,intHex:Gg,intOct:Wg,intTime:ej,map:Ai,merge:Ps,null:Co,omap:jd,pairs:gd,seq:_i,set:bd,timestamp:_o},AA={"tag:yaml.org,2002:binary":xd,"tag:yaml.org,2002:merge":Ps,"tag:yaml.org,2002:omap":jd,"tag:yaml.org,2002:pairs":gd,"tag:yaml.org,2002:set":bd,"tag:yaml.org,2002:timestamp":_o};function dl(t,s,n){const i=Vm.get(s);if(i&&!t)return n&&!i.includes(Ps)?i.concat(Ps):i.slice();let r=i;if(!r)if(Array.isArray(t))r=[];else{const a=Array.from(Vm.keys()).filter(o=>o!=="yaml11").map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown schema "${s}"; use one of ${a} or define customTags array`)}if(Array.isArray(t))for(const a of t)r=r.concat(a);else typeof t=="function"&&(r=t(r.slice()));return n&&(r=r.concat(Ps)),r.reduce((a,o)=>{const l=typeof o=="string"?Wm[o]:o;if(!l){const c=JSON.stringify(o),d=Object.keys(Wm).map(m=>JSON.stringify(m)).join(", ");throw new Error(`Unknown custom tag ${c}; use one of ${d}`)}return a.includes(l)||a.push(l),a},[])}const _A=(t,s)=>t.key<s.key?-1:t.key>s.key?1:0;class Po{constructor({compat:s,customTags:n,merge:i,resolveKnownTags:r,schema:a,sortMapEntries:o,toStringDefaults:l}){this.compat=Array.isArray(s)?dl(s,"compat"):s?dl(null,s):null,this.name=typeof a=="string"&&a||"core",this.knownTags=r?AA:{},this.tags=dl(n,this.name,i),this.toStringOptions=l??null,Object.defineProperty(this,Hs,{value:Ai}),Object.defineProperty(this,js,{value:So}),Object.defineProperty(this,Si,{value:_i}),this.sortMapEntries=typeof o=="function"?o:o===!0?_A:null}clone(){const s=Object.create(Po.prototype,Object.getOwnPropertyDescriptors(this));return s.tags=this.tags.slice(),s}}function PA(t,s){const n=[];let i=s.directives===!0;if(s.directives!==!1&&t.directives){const c=t.directives.toString(t);c?(n.push(c),i=!0):t.directives.docStart&&(i=!0)}i&&n.push("---");const r=Lg(t,s),{commentString:a}=r.options;if(t.commentBefore){n.length!==1&&n.unshift("");const c=a(t.commentBefore);n.unshift(_s(c,""))}let o=!1,l=null;if(t.contents){if(De(t.contents)){if(t.contents.spaceBefore&&i&&n.push(""),t.contents.commentBefore){const m=a(t.contents.commentBefore);n.push(_s(m,""))}r.forceBlockIndent=!!t.comment,l=t.contents.comment}const c=l?void 0:()=>o=!0;let d=ui(t.contents,r,()=>l=null,c);l&&(d+=mn(d,"",a(l))),(d[0]==="|"||d[0]===">")&&n[n.length-1]==="---"?n[n.length-1]=`--- ${d}`:n.push(d)}else n.push(ui(t.contents,r));if(t.directives?.docEnd)if(t.comment){const c=a(t.comment);c.includes(`
`)?(n.push("..."),n.push(_s(c,""))):n.push(`... ${c}`)}else n.push("...");else{let c=t.comment;c&&o&&(c=c.replace(/^\n+/,"")),c&&((!o||l)&&n[n.length-1]!==""&&n.push(""),n.push(_s(a(c),"")))}return n.join(`
`)+`
`}class Pi{constructor(s,n,i){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,Gt,{value:Hl});let r=null;typeof n=="function"||Array.isArray(n)?r=n:i===void 0&&n&&(i=n,n=void 0);const a=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},i);this.options=a;let{version:o}=a;i?._directives?(this.directives=i._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new ht({version:o}),this.setSchema(o,i),this.contents=s===void 0?null:this.createNode(s,r,i)}clone(){const s=Object.create(Pi.prototype,{[Gt]:{value:Hl}});return s.commentBefore=this.commentBefore,s.comment=this.comment,s.errors=this.errors.slice(),s.warnings=this.warnings.slice(),s.options=Object.assign({},this.options),this.directives&&(s.directives=this.directives.clone()),s.schema=this.schema.clone(),s.contents=De(this.contents)?this.contents.clone(s.schema):this.contents,this.range&&(s.range=this.range.slice()),s}add(s){$n(this.contents)&&this.contents.add(s)}addIn(s,n){$n(this.contents)&&this.contents.addIn(s,n)}createAlias(s,n){if(!s.anchor){const i=Pg(this);s.anchor=!n||i.has(n)?Dg(n||"a",i):n}return new vo(s.anchor)}createNode(s,n,i){let r;if(typeof n=="function")s=n.call({"":s},"",s),r=n;else if(Array.isArray(n)){const x=y=>typeof y=="number"||y instanceof String||y instanceof Number,w=n.filter(x).map(String);w.length>0&&(n=n.concat(w)),r=n}else i===void 0&&n&&(i=n,n=void 0);const{aliasDuplicateObjects:a,anchorPrefix:o,flow:l,keepUndefined:c,onTagObj:d,tag:m}=i??{},{onAnchor:u,setAnchors:h,sourceObjects:p}=rA(this,o||"a"),b={aliasDuplicateObjects:a??!0,keepUndefined:c??!1,onAnchor:u,onTagObj:d,replacer:r,schema:this.schema,sourceObjects:p},f=wr(s,m,b);return l&&_e(f)&&(f.flow=!0),h(),f}createPair(s,n,i={}){const r=this.createNode(s,null,i),a=this.createNode(n,null,i);return new ct(r,a)}delete(s){return $n(this.contents)?this.contents.delete(s):!1}deleteIn(s){return Ki(s)?this.contents==null?!1:(this.contents=null,!0):$n(this.contents)?this.contents.deleteIn(s):!1}get(s,n){return _e(this.contents)?this.contents.get(s,n):void 0}getIn(s,n){return Ki(s)?!n&&we(this.contents)?this.contents.value:this.contents:_e(this.contents)?this.contents.getIn(s,n):void 0}has(s){return _e(this.contents)?this.contents.has(s):!1}hasIn(s){return Ki(s)?this.contents!==void 0:_e(this.contents)?this.contents.hasIn(s):!1}set(s,n){this.contents==null?this.contents=Ua(this.schema,[s],n):$n(this.contents)&&this.contents.set(s,n)}setIn(s,n){Ki(s)?this.contents=n:this.contents==null?this.contents=Ua(this.schema,Array.from(s),n):$n(this.contents)&&this.contents.setIn(s,n)}setSchema(s,n={}){typeof s=="number"&&(s=String(s));let i;switch(s){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new ht({version:"1.1"}),i={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=s:this.directives=new ht({version:s}),i={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,i=null;break;default:{const r=JSON.stringify(s);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${r}`)}}if(n.schema instanceof Object)this.schema=n.schema;else if(i)this.schema=new Po(Object.assign(i,n));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:s,jsonArg:n,mapAsMap:i,maxAliasCount:r,onAnchor:a,reviver:o}={}){const l={anchors:new Map,doc:this,keep:!s,mapAsMap:i===!0,mapKeyWarned:!1,maxAliasCount:typeof r=="number"?r:100},c=Wt(this.contents,n??"",l);if(typeof a=="function")for(const{count:d,res:m}of l.anchors.values())a(m,d);return typeof o=="function"?Zn(o,{"":c},"",c):c}toJSON(s,n){return this.toJS({json:!0,jsonArg:s,mapAsMap:!1,onAnchor:n})}toString(s={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in s&&(!Number.isInteger(s.indent)||Number(s.indent)<=0)){const n=JSON.stringify(s.indent);throw new Error(`"indent" option must be a positive integer, not ${n}`)}return PA(this,s)}}function $n(t){if(_e(t))return!0;throw new Error("Expected a YAML collection as document contents")}class vd extends Error{constructor(s,n,i,r){super(),this.name=s,this.code=i,this.message=r,this.pos=n}}class pn extends vd{constructor(s,n,i){super("YAMLParseError",s,n,i)}}class sj extends vd{constructor(s,n,i){super("YAMLWarning",s,n,i)}}const Wa=(t,s)=>n=>{if(n.pos[0]===-1)return;n.linePos=n.pos.map(l=>s.linePos(l));const{line:i,col:r}=n.linePos[0];n.message+=` at line ${i}, column ${r}`;let a=r-1,o=t.substring(s.lineStarts[i-1],s.lineStarts[i]).replace(/[\n\r]+$/,"");if(a>=60&&o.length>80){const l=Math.min(a-39,o.length-79);o="…"+o.substring(l),a-=l-1}if(o.length>80&&(o=o.substring(0,79)+"…"),i>1&&/^ *$/.test(o.substring(0,a))){let l=t.substring(s.lineStarts[i-2],s.lineStarts[i-1]);l.length>80&&(l=l.substring(0,79)+`…
`),o=l+o}if(/[^ ]/.test(o)){let l=1;const c=n.linePos[1];c&&c.line===i&&c.col>r&&(l=Math.max(1,Math.min(c.col-r,80-a)));const d=" ".repeat(a)+"^".repeat(l);n.message+=`:

${o}
${d}
`}};function mi(t,{flow:s,indicator:n,next:i,offset:r,onError:a,parentIndent:o,startOnNewline:l}){let c=!1,d=l,m=l,u="",h="",p=!1,b=!1,f=null,x=null,w=null,y=null,N=null,A=null,S=null;for(const z of t)switch(b&&(z.type!=="space"&&z.type!=="newline"&&z.type!=="comma"&&a(z.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),b=!1),f&&(d&&z.type!=="comment"&&z.type!=="newline"&&a(f,"TAB_AS_INDENT","Tabs are not allowed as indentation"),f=null),z.type){case"space":!s&&(n!=="doc-start"||i?.type!=="flow-collection")&&z.source.includes("	")&&(f=z),m=!0;break;case"comment":{m||a(z,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const D=z.source.substring(1)||" ";u?u+=h+D:u=D,h="",d=!1;break}case"newline":d?u?u+=z.source:(!A||n!=="seq-item-ind")&&(c=!0):h+=z.source,d=!0,p=!0,(x||w)&&(y=z),m=!0;break;case"anchor":x&&a(z,"MULTIPLE_ANCHORS","A node can have at most one anchor"),z.source.endsWith(":")&&a(z.offset+z.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),x=z,S??(S=z.offset),d=!1,m=!1,b=!0;break;case"tag":{w&&a(z,"MULTIPLE_TAGS","A node can have at most one tag"),w=z,S??(S=z.offset),d=!1,m=!1,b=!0;break}case n:(x||w)&&a(z,"BAD_PROP_ORDER",`Anchors and tags must be after the ${z.source} indicator`),A&&a(z,"UNEXPECTED_TOKEN",`Unexpected ${z.source} in ${s??"collection"}`),A=z,d=n==="seq-item-ind"||n==="explicit-key-ind",m=!1;break;case"comma":if(s){N&&a(z,"UNEXPECTED_TOKEN",`Unexpected , in ${s}`),N=z,d=!1,m=!1;break}default:a(z,"UNEXPECTED_TOKEN",`Unexpected ${z.type} token`),d=!1,m=!1}const k=t[t.length-1],v=k?k.offset+k.source.length:r;return b&&i&&i.type!=="space"&&i.type!=="newline"&&i.type!=="comma"&&(i.type!=="scalar"||i.source!=="")&&a(i.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),f&&(d&&f.indent<=o||i?.type==="block-map"||i?.type==="block-seq")&&a(f,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:N,found:A,spaceBefore:c,comment:u,hasNewline:p,anchor:x,tag:w,newlineAfterProp:y,end:v,start:S??v}}function vr(t){if(!t)return null;switch(t.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(t.source.includes(`
`))return!0;if(t.end){for(const s of t.end)if(s.type==="newline")return!0}return!1;case"flow-collection":for(const s of t.items){for(const n of s.start)if(n.type==="newline")return!0;if(s.sep){for(const n of s.sep)if(n.type==="newline")return!0}if(vr(s.key)||vr(s.value))return!0}return!1;default:return!0}}function Jl(t,s,n){if(s?.type==="flow-collection"){const i=s.end[0];i.indent===t&&(i.source==="]"||i.source==="}")&&vr(s)&&n(i,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function nj(t,s,n){const{uniqueKeys:i}=t.options;if(i===!1)return!1;const r=typeof i=="function"?i:(a,o)=>a===o||we(a)&&we(o)&&a.value===o.value;return s.some(a=>r(a.key,n))}const Km="All mapping items must start at the same column";function DA({composeNode:t,composeEmptyNode:s},n,i,r,a){const o=a?.nodeClass??At,l=new o(n.schema);n.atRoot&&(n.atRoot=!1);let c=i.offset,d=null;for(const m of i.items){const{start:u,key:h,sep:p,value:b}=m,f=mi(u,{indicator:"explicit-key-ind",next:h??p?.[0],offset:c,onError:r,parentIndent:i.indent,startOnNewline:!0}),x=!f.found;if(x){if(h&&(h.type==="block-seq"?r(c,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in h&&h.indent!==i.indent&&r(c,"BAD_INDENT",Km)),!f.anchor&&!f.tag&&!p){d=f.end,f.comment&&(l.comment?l.comment+=`
`+f.comment:l.comment=f.comment);continue}(f.newlineAfterProp||vr(h))&&r(h??u[u.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else f.found?.indent!==i.indent&&r(c,"BAD_INDENT",Km);n.atKey=!0;const w=f.end,y=h?t(n,h,f,r):s(n,w,u,null,f,r);n.schema.compat&&Jl(i.indent,h,r),n.atKey=!1,nj(n,l.items,y)&&r(w,"DUPLICATE_KEY","Map keys must be unique");const N=mi(p??[],{indicator:"map-value-ind",next:b,offset:y.range[2],onError:r,parentIndent:i.indent,startOnNewline:!h||h.type==="block-scalar"});if(c=N.end,N.found){x&&(b?.type==="block-map"&&!N.hasNewline&&r(c,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),n.options.strict&&f.start<N.found.offset-1024&&r(y.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const A=b?t(n,b,N,r):s(n,c,p,null,N,r);n.schema.compat&&Jl(i.indent,b,r),c=A.range[2];const S=new ct(y,A);n.options.keepSourceTokens&&(S.srcToken=m),l.items.push(S)}else{x&&r(y.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),N.comment&&(y.comment?y.comment+=`
`+N.comment:y.comment=N.comment);const A=new ct(y);n.options.keepSourceTokens&&(A.srcToken=m),l.items.push(A)}}return d&&d<c&&r(d,"IMPOSSIBLE","Map comment with trailing content"),l.range=[i.offset,c,d??c],l}function IA({composeNode:t,composeEmptyNode:s},n,i,r,a){const o=a?.nodeClass??tn,l=new o(n.schema);n.atRoot&&(n.atRoot=!1),n.atKey&&(n.atKey=!1);let c=i.offset,d=null;for(const{start:m,value:u}of i.items){const h=mi(m,{indicator:"seq-item-ind",next:u,offset:c,onError:r,parentIndent:i.indent,startOnNewline:!0});if(!h.found)if(h.anchor||h.tag||u)u&&u.type==="block-seq"?r(h.end,"BAD_INDENT","All sequence items must start at the same column"):r(c,"MISSING_CHAR","Sequence item without - indicator");else{d=h.end,h.comment&&(l.comment=h.comment);continue}const p=u?t(n,u,h,r):s(n,h.end,m,null,h,r);n.schema.compat&&Jl(i.indent,u,r),c=p.range[2],l.items.push(p)}return l.range=[i.offset,c,d??c],l}function Xr(t,s,n,i){let r="";if(t){let a=!1,o="";for(const l of t){const{source:c,type:d}=l;switch(d){case"space":a=!0;break;case"comment":{n&&!a&&i(l,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const m=c.substring(1)||" ";r?r+=o+m:r=m,o="";break}case"newline":r&&(o+=c),a=!0;break;default:i(l,"UNEXPECTED_TOKEN",`Unexpected ${d} at node end`)}s+=c.length}}return{comment:r,offset:s}}const ul="Block collections are not allowed within flow collections",ml=t=>t&&(t.type==="block-map"||t.type==="block-seq");function MA({composeNode:t,composeEmptyNode:s},n,i,r,a){const o=i.start.source==="{",l=o?"flow map":"flow sequence",c=a?.nodeClass??(o?At:tn),d=new c(n.schema);d.flow=!0;const m=n.atRoot;m&&(n.atRoot=!1),n.atKey&&(n.atKey=!1);let u=i.offset+i.start.source.length;for(let x=0;x<i.items.length;++x){const w=i.items[x],{start:y,key:N,sep:A,value:S}=w,k=mi(y,{flow:l,indicator:"explicit-key-ind",next:N??A?.[0],offset:u,onError:r,parentIndent:i.indent,startOnNewline:!1});if(!k.found){if(!k.anchor&&!k.tag&&!A&&!S){x===0&&k.comma?r(k.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${l}`):x<i.items.length-1&&r(k.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${l}`),k.comment&&(d.comment?d.comment+=`
`+k.comment:d.comment=k.comment),u=k.end;continue}!o&&n.options.strict&&vr(N)&&r(N,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(x===0)k.comma&&r(k.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${l}`);else if(k.comma||r(k.start,"MISSING_CHAR",`Missing , between ${l} items`),k.comment){let v="";e:for(const z of y)switch(z.type){case"comma":case"space":break;case"comment":v=z.source.substring(1);break e;default:break e}if(v){let z=d.items[d.items.length-1];Te(z)&&(z=z.value??z.key),z.comment?z.comment+=`
`+v:z.comment=v,k.comment=k.comment.substring(v.length+1)}}if(!o&&!A&&!k.found){const v=S?t(n,S,k,r):s(n,k.end,A,null,k,r);d.items.push(v),u=v.range[2],ml(S)&&r(v.range,"BLOCK_IN_FLOW",ul)}else{n.atKey=!0;const v=k.end,z=N?t(n,N,k,r):s(n,v,y,null,k,r);ml(N)&&r(z.range,"BLOCK_IN_FLOW",ul),n.atKey=!1;const D=mi(A??[],{flow:l,indicator:"map-value-ind",next:S,offset:z.range[2],onError:r,parentIndent:i.indent,startOnNewline:!1});if(D.found){if(!o&&!k.found&&n.options.strict){if(A)for(const T of A){if(T===D.found)break;if(T.type==="newline"){r(T,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}k.start<D.found.offset-1024&&r(D.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else S&&("source"in S&&S.source&&S.source[0]===":"?r(S,"MISSING_CHAR",`Missing space after : in ${l}`):r(D.start,"MISSING_CHAR",`Missing , or : between ${l} items`));const j=S?t(n,S,D,r):D.found?s(n,D.end,A,null,D,r):null;j?ml(S)&&r(j.range,"BLOCK_IN_FLOW",ul):D.comment&&(z.comment?z.comment+=`
`+D.comment:z.comment=D.comment);const C=new ct(z,j);if(n.options.keepSourceTokens&&(C.srcToken=w),o){const T=d;nj(n,T.items,z)&&r(v,"DUPLICATE_KEY","Map keys must be unique"),T.items.push(C)}else{const T=new At(n.schema);T.flow=!0,T.items.push(C);const E=(j??z).range;T.range=[z.range[0],E[1],E[2]],d.items.push(T)}u=j?j.range[2]:D.end}}const h=o?"}":"]",[p,...b]=i.end;let f=u;if(p&&p.source===h)f=p.offset+p.source.length;else{const x=l[0].toUpperCase()+l.substring(1),w=m?`${x} must end with a ${h}`:`${x} in block collection must be sufficiently indented and end with a ${h}`;r(u,m?"MISSING_CHAR":"BAD_INDENT",w),p&&p.source.length!==1&&b.unshift(p)}if(b.length>0){const x=Xr(b,f,n.options.strict,r);x.comment&&(d.comment?d.comment+=`
`+x.comment:d.comment=x.comment),d.range=[i.offset,f,x.offset]}else d.range=[i.offset,f,f];return d}function hl(t,s,n,i,r,a){const o=n.type==="block-map"?DA(t,s,n,i,a):n.type==="block-seq"?IA(t,s,n,i,a):MA(t,s,n,i,a),l=o.constructor;return r==="!"||r===l.tagName?(o.tag=l.tagName,o):(r&&(o.tag=r),o)}function EA(t,s,n,i,r){const a=i.tag,o=a?s.directives.tagName(a.source,h=>r(a,"TAG_RESOLVE_FAILED",h)):null;if(n.type==="block-seq"){const{anchor:h,newlineAfterProp:p}=i,b=h&&a?h.offset>a.offset?h:a:h??a;b&&(!p||p.offset<b.offset)&&r(b,"MISSING_CHAR","Missing newline after block sequence props")}const l=n.type==="block-map"?"map":n.type==="block-seq"?"seq":n.start.source==="{"?"map":"seq";if(!a||!o||o==="!"||o===At.tagName&&l==="map"||o===tn.tagName&&l==="seq")return hl(t,s,n,r,o);let c=s.schema.tags.find(h=>h.tag===o&&h.collection===l);if(!c){const h=s.schema.knownTags[o];if(h&&h.collection===l)s.schema.tags.push(Object.assign({},h,{default:!1})),c=h;else return h?r(a,"BAD_COLLECTION_TYPE",`${h.tag} used for ${l} collection, but expects ${h.collection??"scalar"}`,!0):r(a,"TAG_RESOLVE_FAILED",`Unresolved tag: ${o}`,!0),hl(t,s,n,r,o)}const d=hl(t,s,n,r,o,c),m=c.resolve?.(d,h=>r(a,"TAG_RESOLVE_FAILED",h),s.options)??d,u=De(m)?m:new ne(m);return u.range=d.range,u.tag=o,c?.format&&(u.format=c.format),u}function ij(t,s,n){const i=s.offset,r=LA(s,t.options.strict,n);if(!r)return{value:"",type:null,comment:"",range:[i,i,i]};const a=r.mode===">"?ne.BLOCK_FOLDED:ne.BLOCK_LITERAL,o=s.source?OA(s.source):[];let l=o.length;for(let f=o.length-1;f>=0;--f){const x=o[f][1];if(x===""||x==="\r")l=f;else break}if(l===0){const f=r.chomp==="+"&&o.length>0?`
`.repeat(Math.max(1,o.length-1)):"";let x=i+r.length;return s.source&&(x+=s.source.length),{value:f,type:a,comment:r.comment,range:[i,x,x]}}let c=s.indent+r.indent,d=s.offset+r.length,m=0;for(let f=0;f<l;++f){const[x,w]=o[f];if(w===""||w==="\r")r.indent===0&&x.length>c&&(c=x.length);else{x.length<c&&n(d+x.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),r.indent===0&&(c=x.length),m=f,c===0&&!t.atRoot&&n(d,"BAD_INDENT","Block scalar values in collections must be indented");break}d+=x.length+w.length+1}for(let f=o.length-1;f>=l;--f)o[f][0].length>c&&(l=f+1);let u="",h="",p=!1;for(let f=0;f<m;++f)u+=o[f][0].slice(c)+`
`;for(let f=m;f<l;++f){let[x,w]=o[f];d+=x.length+w.length+1;const y=w[w.length-1]==="\r";if(y&&(w=w.slice(0,-1)),w&&x.length<c){const A=`Block scalar lines must not be less indented than their ${r.indent?"explicit indentation indicator":"first line"}`;n(d-w.length-(y?2:1),"BAD_INDENT",A),x=""}a===ne.BLOCK_LITERAL?(u+=h+x.slice(c)+w,h=`
`):x.length>c||w[0]==="	"?(h===" "?h=`
`:!p&&h===`
`&&(h=`

`),u+=h+x.slice(c)+w,h=`
`,p=!0):w===""?h===`
`?u+=`
`:h=`
`:(u+=h+w,h=" ",p=!1)}switch(r.chomp){case"-":break;case"+":for(let f=l;f<o.length;++f)u+=`
`+o[f][0].slice(c);u[u.length-1]!==`
`&&(u+=`
`);break;default:u+=`
`}const b=i+r.length+s.source.length;return{value:u,type:a,comment:r.comment,range:[i,b,b]}}function LA({offset:t,props:s},n,i){if(s[0].type!=="block-scalar-header")return i(s[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:r}=s[0],a=r[0];let o=0,l="",c=-1;for(let h=1;h<r.length;++h){const p=r[h];if(!l&&(p==="-"||p==="+"))l=p;else{const b=Number(p);!o&&b?o=b:c===-1&&(c=t+h)}}c!==-1&&i(c,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${r}`);let d=!1,m="",u=r.length;for(let h=1;h<s.length;++h){const p=s[h];switch(p.type){case"space":d=!0;case"newline":u+=p.source.length;break;case"comment":n&&!d&&i(p,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),u+=p.source.length,m=p.source.substring(1);break;case"error":i(p,"UNEXPECTED_TOKEN",p.message),u+=p.source.length;break;default:{const b=`Unexpected token in block scalar header: ${p.type}`;i(p,"UNEXPECTED_TOKEN",b);const f=p.source;f&&typeof f=="string"&&(u+=f.length)}}}return{mode:a,indent:o,chomp:l,comment:m,length:u}}function OA(t){const s=t.split(/\n( *)/),n=s[0],i=n.match(/^( *)/),a=[i?.[1]?[i[1],n.slice(i[1].length)]:["",n]];for(let o=1;o<s.length;o+=2)a.push([s[o],s[o+1]]);return a}function rj(t,s,n){const{offset:i,type:r,source:a,end:o}=t;let l,c;const d=(h,p,b)=>n(i+h,p,b);switch(r){case"scalar":l=ne.PLAIN,c=RA(a,d);break;case"single-quoted-scalar":l=ne.QUOTE_SINGLE,c=$A(a,d);break;case"double-quoted-scalar":l=ne.QUOTE_DOUBLE,c=qA(a,d);break;default:return n(t,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${r}`),{value:"",type:null,comment:"",range:[i,i+a.length,i+a.length]}}const m=i+a.length,u=Xr(o,m,s,n);return{value:c,type:l,comment:u.comment,range:[i,m,u.offset]}}function RA(t,s){let n="";switch(t[0]){case"	":n="a tab character";break;case",":n="flow indicator character ,";break;case"%":n="directive indicator character %";break;case"|":case">":{n=`block scalar indicator ${t[0]}`;break}case"@":case"`":{n=`reserved character ${t[0]}`;break}}return n&&s(0,"BAD_SCALAR_START",`Plain value cannot start with ${n}`),aj(t)}function $A(t,s){return(t[t.length-1]!=="'"||t.length===1)&&s(t.length,"MISSING_CHAR","Missing closing 'quote"),aj(t.slice(1,-1)).replace(/''/g,"'")}function aj(t){let s,n;try{s=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),n=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{s=/(.*?)[ \t]*\r?\n/sy,n=/[ \t]*(.*?)[ \t]*\r?\n/sy}let i=s.exec(t);if(!i)return t;let r=i[1],a=" ",o=s.lastIndex;for(n.lastIndex=o;i=n.exec(t);)i[1]===""?a===`
`?r+=a:a=`
`:(r+=a+i[1],a=" "),o=n.lastIndex;const l=/[ \t]*(.*)/sy;return l.lastIndex=o,i=l.exec(t),r+a+(i?.[1]??"")}function qA(t,s){let n="";for(let i=1;i<t.length-1;++i){const r=t[i];if(!(r==="\r"&&t[i+1]===`
`))if(r===`
`){const{fold:a,offset:o}=FA(t,i);n+=a,i=o}else if(r==="\\"){let a=t[++i];const o=BA[a];if(o)n+=o;else if(a===`
`)for(a=t[i+1];a===" "||a==="	";)a=t[++i+1];else if(a==="\r"&&t[i+1]===`
`)for(a=t[++i+1];a===" "||a==="	";)a=t[++i+1];else if(a==="x"||a==="u"||a==="U"){const l={x:2,u:4,U:8}[a];n+=UA(t,i+1,l,s),i+=l}else{const l=t.substr(i-1,2);s(i-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${l}`),n+=l}}else if(r===" "||r==="	"){const a=i;let o=t[i+1];for(;o===" "||o==="	";)o=t[++i+1];o!==`
`&&!(o==="\r"&&t[i+2]===`
`)&&(n+=i>a?t.slice(a,i+1):r)}else n+=r}return(t[t.length-1]!=='"'||t.length===1)&&s(t.length,"MISSING_CHAR",'Missing closing "quote'),n}function FA(t,s){let n="",i=t[s+1];for(;(i===" "||i==="	"||i===`
`||i==="\r")&&!(i==="\r"&&t[s+2]!==`
`);)i===`
`&&(n+=`
`),s+=1,i=t[s+1];return n||(n=" "),{fold:n,offset:s}}const BA={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function UA(t,s,n,i){const r=t.substr(s,n),o=r.length===n&&/^[0-9a-fA-F]+$/.test(r)?parseInt(r,16):NaN;if(isNaN(o)){const l=t.substr(s-2,n+2);return i(s-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${l}`),l}return String.fromCodePoint(o)}function oj(t,s,n,i){const{value:r,type:a,comment:o,range:l}=s.type==="block-scalar"?ij(t,s,i):rj(s,t.options.strict,i),c=n?t.directives.tagName(n.source,u=>i(n,"TAG_RESOLVE_FAILED",u)):null;let d;t.options.stringKeys&&t.atKey?d=t.schema[js]:c?d=VA(t.schema,r,c,n,i):s.type==="scalar"?d=WA(t,r,s,i):d=t.schema[js];let m;try{const u=d.resolve(r,h=>i(n??s,"TAG_RESOLVE_FAILED",h),t.options);m=we(u)?u:new ne(u)}catch(u){const h=u instanceof Error?u.message:String(u);i(n??s,"TAG_RESOLVE_FAILED",h),m=new ne(r)}return m.range=l,m.source=r,a&&(m.type=a),c&&(m.tag=c),d.format&&(m.format=d.format),o&&(m.comment=o),m}function VA(t,s,n,i,r){if(n==="!")return t[js];const a=[];for(const l of t.tags)if(!l.collection&&l.tag===n)if(l.default&&l.test)a.push(l);else return l;for(const l of a)if(l.test?.test(s))return l;const o=t.knownTags[n];return o&&!o.collection?(t.tags.push(Object.assign({},o,{default:!1,test:void 0})),o):(r(i,"TAG_RESOLVE_FAILED",`Unresolved tag: ${n}`,n!=="tag:yaml.org,2002:str"),t[js])}function WA({atKey:t,directives:s,schema:n},i,r,a){const o=n.tags.find(l=>(l.default===!0||t&&l.default==="key")&&l.test?.test(i))||n[js];if(n.compat){const l=n.compat.find(c=>c.default&&c.test?.test(i))??n[js];if(o.tag!==l.tag){const c=s.tagString(o.tag),d=s.tagString(l.tag),m=`Value may be parsed as either ${c} or ${d}`;a(r,"TAG_RESOLVE_FAILED",m,!0)}}return o}function KA(t,s,n){if(s){n??(n=s.length);for(let i=n-1;i>=0;--i){let r=s[i];switch(r.type){case"space":case"comment":case"newline":t-=r.source.length;continue}for(r=s[++i];r?.type==="space";)t+=r.source.length,r=s[++i];break}}return t}const GA={composeNode:lj,composeEmptyNode:Nd};function lj(t,s,n,i){const r=t.atKey,{spaceBefore:a,comment:o,anchor:l,tag:c}=n;let d,m=!0;switch(s.type){case"alias":d=HA(t,s,i),(l||c)&&i(s,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":d=oj(t,s,c,i),l&&(d.anchor=l.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":d=EA(GA,t,s,n,i),l&&(d.anchor=l.source.substring(1));break;default:{const u=s.type==="error"?s.message:`Unsupported token (type: ${s.type})`;i(s,"UNEXPECTED_TOKEN",u),d=Nd(t,s.offset,void 0,null,n,i),m=!1}}return l&&d.anchor===""&&i(l,"BAD_ALIAS","Anchor cannot be an empty string"),r&&t.options.stringKeys&&(!we(d)||typeof d.value!="string"||d.tag&&d.tag!=="tag:yaml.org,2002:str")&&i(c??s,"NON_STRING_KEY","With stringKeys, all keys must be strings"),a&&(d.spaceBefore=!0),o&&(s.type==="scalar"&&s.source===""?d.comment=o:d.commentBefore=o),t.options.keepSourceTokens&&m&&(d.srcToken=s),d}function Nd(t,s,n,i,{spaceBefore:r,comment:a,anchor:o,tag:l,end:c},d){const m={type:"scalar",offset:KA(s,n,i),indent:-1,source:""},u=oj(t,m,l,d);return o&&(u.anchor=o.source.substring(1),u.anchor===""&&d(o,"BAD_ALIAS","Anchor cannot be an empty string")),r&&(u.spaceBefore=!0),a&&(u.comment=a,u.range[2]=c),u}function HA({options:t},{offset:s,source:n,end:i},r){const a=new vo(n.substring(1));a.source===""&&r(s,"BAD_ALIAS","Alias cannot be an empty string"),a.source.endsWith(":")&&r(s+n.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const o=s+n.length,l=Xr(i,o,t.strict,r);return a.range=[s,o,l.offset],l.comment&&(a.comment=l.comment),a}function QA(t,s,{offset:n,start:i,value:r,end:a},o){const l=Object.assign({_directives:s},t),c=new Pi(void 0,l),d={atKey:!1,atRoot:!0,directives:c.directives,options:c.options,schema:c.schema},m=mi(i,{indicator:"doc-start",next:r??a?.[0],offset:n,onError:o,parentIndent:0,startOnNewline:!0});m.found&&(c.directives.docStart=!0,r&&(r.type==="block-map"||r.type==="block-seq")&&!m.hasNewline&&o(m.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),c.contents=r?lj(d,r,m,o):Nd(d,m.end,i,null,m,o);const u=c.contents.range[2],h=Xr(a,u,!1,o);return h.comment&&(c.comment=h.comment),c.range=[n,u,h.offset],c}function qi(t){if(typeof t=="number")return[t,t+1];if(Array.isArray(t))return t.length===2?t:[t[0],t[1]];const{offset:s,source:n}=t;return[s,s+(typeof n=="string"?n.length:1)]}function Gm(t){let s="",n=!1,i=!1;for(let r=0;r<t.length;++r){const a=t[r];switch(a[0]){case"#":s+=(s===""?"":i?`

`:`
`)+(a.substring(1)||" "),n=!0,i=!1;break;case"%":t[r+1]?.[0]!=="#"&&(r+=1),n=!1;break;default:n||(i=!0),n=!1}}return{comment:s,afterEmptyLine:i}}class kd{constructor(s={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(n,i,r,a)=>{const o=qi(n);a?this.warnings.push(new sj(o,i,r)):this.errors.push(new pn(o,i,r))},this.directives=new ht({version:s.version||"1.2"}),this.options=s}decorate(s,n){const{comment:i,afterEmptyLine:r}=Gm(this.prelude);if(i){const a=s.contents;if(n)s.comment=s.comment?`${s.comment}
${i}`:i;else if(r||s.directives.docStart||!a)s.commentBefore=i;else if(_e(a)&&!a.flow&&a.items.length>0){let o=a.items[0];Te(o)&&(o=o.key);const l=o.commentBefore;o.commentBefore=l?`${i}
${l}`:i}else{const o=a.commentBefore;a.commentBefore=o?`${i}
${o}`:i}}n?(Array.prototype.push.apply(s.errors,this.errors),Array.prototype.push.apply(s.warnings,this.warnings)):(s.errors=this.errors,s.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:Gm(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(s,n=!1,i=-1){for(const r of s)yield*this.next(r);yield*this.end(n,i)}*next(s){switch(s.type){case"directive":this.directives.add(s.source,(n,i,r)=>{const a=qi(s);a[0]+=n,this.onError(a,"BAD_DIRECTIVE",i,r)}),this.prelude.push(s.source),this.atDirectives=!0;break;case"document":{const n=QA(this.options,this.directives,s,this.onError);this.atDirectives&&!n.directives.docStart&&this.onError(s,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(n,!1),this.doc&&(yield this.doc),this.doc=n,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(s.source);break;case"error":{const n=s.source?`${s.message}: ${JSON.stringify(s.source)}`:s.message,i=new pn(qi(s),"UNEXPECTED_TOKEN",n);this.atDirectives||!this.doc?this.errors.push(i):this.doc.errors.push(i);break}case"doc-end":{if(!this.doc){const i="Unexpected doc-end without preceding document";this.errors.push(new pn(qi(s),"UNEXPECTED_TOKEN",i));break}this.doc.directives.docEnd=!0;const n=Xr(s.end,s.offset+s.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),n.comment){const i=this.doc.comment;this.doc.comment=i?`${i}
${n.comment}`:n.comment}this.doc.range[2]=n.offset;break}default:this.errors.push(new pn(qi(s),"UNEXPECTED_TOKEN",`Unsupported token ${s.type}`))}}*end(s=!1,n=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(s){const i=Object.assign({_directives:this.directives},this.options),r=new Pi(void 0,i);this.atDirectives&&this.onError(n,"MISSING_CHAR","Missing directives-end indicator line"),r.range=[0,n,n],this.decorate(r,!1),yield r}}}function ZA(t,s=!0,n){if(t){const i=(r,a,o)=>{const l=typeof r=="number"?r:Array.isArray(r)?r[0]:r.offset;if(n)n(l,a,o);else throw new pn([l,l+1],a,o)};switch(t.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return rj(t,s,i);case"block-scalar":return ij({options:{strict:s}},t,i)}}return null}function YA(t,s){const{implicitKey:n=!1,indent:i,inFlow:r=!1,offset:a=-1,type:o="PLAIN"}=s,l=Yr({type:o,value:t},{implicitKey:n,indent:i>0?" ".repeat(i):"",inFlow:r,options:{blockQuote:!0,lineWidth:-1}}),c=s.end??[{type:"newline",offset:-1,indent:i,source:`
`}];switch(l[0]){case"|":case">":{const d=l.indexOf(`
`),m=l.substring(0,d),u=l.substring(d+1)+`
`,h=[{type:"block-scalar-header",offset:a,indent:i,source:m}];return cj(h,c)||h.push({type:"newline",offset:-1,indent:i,source:`
`}),{type:"block-scalar",offset:a,indent:i,props:h,source:u}}case'"':return{type:"double-quoted-scalar",offset:a,indent:i,source:l,end:c};case"'":return{type:"single-quoted-scalar",offset:a,indent:i,source:l,end:c};default:return{type:"scalar",offset:a,indent:i,source:l,end:c}}}function JA(t,s,n={}){let{afterKey:i=!1,implicitKey:r=!1,inFlow:a=!1,type:o}=n,l="indent"in t?t.indent:null;if(i&&typeof l=="number"&&(l+=2),!o)switch(t.type){case"single-quoted-scalar":o="QUOTE_SINGLE";break;case"double-quoted-scalar":o="QUOTE_DOUBLE";break;case"block-scalar":{const d=t.props[0];if(d.type!=="block-scalar-header")throw new Error("Invalid block scalar header");o=d.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:o="PLAIN"}const c=Yr({type:o,value:s},{implicitKey:r||l===null,indent:l!==null&&l>0?" ".repeat(l):"",inFlow:a,options:{blockQuote:!0,lineWidth:-1}});switch(c[0]){case"|":case">":XA(t,c);break;case'"':pl(t,c,"double-quoted-scalar");break;case"'":pl(t,c,"single-quoted-scalar");break;default:pl(t,c,"scalar")}}function XA(t,s){const n=s.indexOf(`
`),i=s.substring(0,n),r=s.substring(n+1)+`
`;if(t.type==="block-scalar"){const a=t.props[0];if(a.type!=="block-scalar-header")throw new Error("Invalid block scalar header");a.source=i,t.source=r}else{const{offset:a}=t,o="indent"in t?t.indent:-1,l=[{type:"block-scalar-header",offset:a,indent:o,source:i}];cj(l,"end"in t?t.end:void 0)||l.push({type:"newline",offset:-1,indent:o,source:`
`});for(const c of Object.keys(t))c!=="type"&&c!=="offset"&&delete t[c];Object.assign(t,{type:"block-scalar",indent:o,props:l,source:r})}}function cj(t,s){if(s)for(const n of s)switch(n.type){case"space":case"comment":t.push(n);break;case"newline":return t.push(n),!0}return!1}function pl(t,s,n){switch(t.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":t.type=n,t.source=s;break;case"block-scalar":{const i=t.props.slice(1);let r=s.length;t.props[0].type==="block-scalar-header"&&(r-=t.props[0].source.length);for(const a of i)a.offset+=r;delete t.props,Object.assign(t,{type:n,source:s,end:i});break}case"block-map":case"block-seq":{const r={type:"newline",offset:t.offset+s.length,indent:t.indent,source:`
`};delete t.items,Object.assign(t,{type:n,source:s,end:[r]});break}default:{const i="indent"in t?t.indent:-1,r="end"in t&&Array.isArray(t.end)?t.end.filter(a=>a.type==="space"||a.type==="comment"||a.type==="newline"):[];for(const a of Object.keys(t))a!=="type"&&a!=="offset"&&delete t[a];Object.assign(t,{type:n,indent:i,source:s,end:r})}}}const e_=t=>"type"in t?Ka(t):ka(t);function Ka(t){switch(t.type){case"block-scalar":{let s="";for(const n of t.props)s+=Ka(n);return s+t.source}case"block-map":case"block-seq":{let s="";for(const n of t.items)s+=ka(n);return s}case"flow-collection":{let s=t.start.source;for(const n of t.items)s+=ka(n);for(const n of t.end)s+=n.source;return s}case"document":{let s=ka(t);if(t.end)for(const n of t.end)s+=n.source;return s}default:{let s=t.source;if("end"in t&&t.end)for(const n of t.end)s+=n.source;return s}}}function ka({start:t,key:s,sep:n,value:i}){let r="";for(const a of t)r+=a.source;if(s&&(r+=Ka(s)),n)for(const a of n)r+=a.source;return i&&(r+=Ka(i)),r}const Xl=Symbol("break visit"),t_=Symbol("skip children"),dj=Symbol("remove item");function Sn(t,s){"type"in t&&t.type==="document"&&(t={start:t.start,value:t.value}),uj(Object.freeze([]),t,s)}Sn.BREAK=Xl;Sn.SKIP=t_;Sn.REMOVE=dj;Sn.itemAtPath=(t,s)=>{let n=t;for(const[i,r]of s){const a=n?.[i];if(a&&"items"in a)n=a.items[r];else return}return n};Sn.parentCollection=(t,s)=>{const n=Sn.itemAtPath(t,s.slice(0,-1)),i=s[s.length-1][0],r=n?.[i];if(r&&"items"in r)return r;throw new Error("Parent collection not found")};function uj(t,s,n){let i=n(s,t);if(typeof i=="symbol")return i;for(const r of["key","value"]){const a=s[r];if(a&&"items"in a){for(let o=0;o<a.items.length;++o){const l=uj(Object.freeze(t.concat([[r,o]])),a.items[o],n);if(typeof l=="number")o=l-1;else{if(l===Xl)return Xl;l===dj&&(a.items.splice(o,1),o-=1)}}typeof i=="function"&&r==="key"&&(i=i(s,t))}}return typeof i=="function"?i(s,t):i}const Do="\uFEFF",Io="",Mo="",Nr="",s_=t=>!!t&&"items"in t,n_=t=>!!t&&(t.type==="scalar"||t.type==="single-quoted-scalar"||t.type==="double-quoted-scalar"||t.type==="block-scalar");function i_(t){switch(t){case Do:return"<BOM>";case Io:return"<DOC>";case Mo:return"<FLOW_END>";case Nr:return"<SCALAR>";default:return JSON.stringify(t)}}function mj(t){switch(t){case Do:return"byte-order-mark";case Io:return"doc-mode";case Mo:return"flow-error-end";case Nr:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(t[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}const r_=Object.freeze(Object.defineProperty({__proto__:null,BOM:Do,DOCUMENT:Io,FLOW_END:Mo,SCALAR:Nr,createScalarToken:YA,isCollection:s_,isScalar:n_,prettyToken:i_,resolveAsScalar:ZA,setScalarValue:JA,stringify:e_,tokenType:mj,visit:Sn},Symbol.toStringTag,{value:"Module"}));function Yt(t){switch(t){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const Hm=new Set("0123456789ABCDEFabcdef"),a_=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),ha=new Set(",[]{}"),o_=new Set(` ,[]{}
\r	`),fl=t=>!t||o_.has(t);class hj{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(s,n=!1){if(s){if(typeof s!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+s:s,this.lineEndPos=null}this.atEnd=!n;let i=this.next??"stream";for(;i&&(n||this.hasChars(1));)i=yield*this.parseNext(i)}atLineEnd(){let s=this.pos,n=this.buffer[s];for(;n===" "||n==="	";)n=this.buffer[++s];return!n||n==="#"||n===`
`?!0:n==="\r"?this.buffer[s+1]===`
`:!1}charAt(s){return this.buffer[this.pos+s]}continueScalar(s){let n=this.buffer[s];if(this.indentNext>0){let i=0;for(;n===" ";)n=this.buffer[++i+s];if(n==="\r"){const r=this.buffer[i+s+1];if(r===`
`||!r&&!this.atEnd)return s+i+1}return n===`
`||i>=this.indentNext||!n&&!this.atEnd?s+i:-1}if(n==="-"||n==="."){const i=this.buffer.substr(s,3);if((i==="---"||i==="...")&&Yt(this.buffer[s+3]))return-1}return s}getLine(){let s=this.lineEndPos;return(typeof s!="number"||s!==-1&&s<this.pos)&&(s=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=s),s===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[s-1]==="\r"&&(s-=1),this.buffer.substring(this.pos,s))}hasChars(s){return this.pos+s<=this.buffer.length}setNext(s){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=s,null}peek(s){return this.buffer.substr(this.pos,s)}*parseNext(s){switch(s){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let s=this.getLine();if(s===null)return this.setNext("stream");if(s[0]===Do&&(yield*this.pushCount(1),s=s.substring(1)),s[0]==="%"){let n=s.length,i=s.indexOf("#");for(;i!==-1;){const a=s[i-1];if(a===" "||a==="	"){n=i-1;break}else i=s.indexOf("#",i+1)}for(;;){const a=s[n-1];if(a===" "||a==="	")n-=1;else break}const r=(yield*this.pushCount(n))+(yield*this.pushSpaces(!0));return yield*this.pushCount(s.length-r),this.pushNewline(),"stream"}if(this.atLineEnd()){const n=yield*this.pushSpaces(!0);return yield*this.pushCount(s.length-n),yield*this.pushNewline(),"stream"}return yield Io,yield*this.parseLineStart()}*parseLineStart(){const s=this.charAt(0);if(!s&&!this.atEnd)return this.setNext("line-start");if(s==="-"||s==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const n=this.peek(3);if((n==="---"||n==="...")&&Yt(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,n==="---"?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!Yt(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[s,n]=this.peek(2);if(!n&&!this.atEnd)return this.setNext("block-start");if((s==="-"||s==="?"||s===":")&&Yt(n)){const i=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=i,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const s=this.getLine();if(s===null)return this.setNext("doc");let n=yield*this.pushIndicators();switch(s[n]){case"#":yield*this.pushCount(s.length-n);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(fl),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return n+=yield*this.parseBlockScalarHeader(),n+=yield*this.pushSpaces(!0),yield*this.pushCount(s.length-n),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let s,n,i=-1;do s=yield*this.pushNewline(),s>0?(n=yield*this.pushSpaces(!1),this.indentValue=i=n):n=0,n+=yield*this.pushSpaces(!0);while(s+n>0);const r=this.getLine();if(r===null)return this.setNext("flow");if((i!==-1&&i<this.indentNext&&r[0]!=="#"||i===0&&(r.startsWith("---")||r.startsWith("..."))&&Yt(r[3]))&&!(i===this.indentNext-1&&this.flowLevel===1&&(r[0]==="]"||r[0]==="}")))return this.flowLevel=0,yield Mo,yield*this.parseLineStart();let a=0;for(;r[a]===",";)a+=yield*this.pushCount(1),a+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(a+=yield*this.pushIndicators(),r[a]){case void 0:return"flow";case"#":return yield*this.pushCount(r.length-a),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(fl),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const o=this.charAt(1);if(this.flowKey||Yt(o)||o===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const s=this.charAt(0);let n=this.buffer.indexOf(s,this.pos+1);if(s==="'")for(;n!==-1&&this.buffer[n+1]==="'";)n=this.buffer.indexOf("'",n+2);else for(;n!==-1;){let a=0;for(;this.buffer[n-1-a]==="\\";)a+=1;if(a%2===0)break;n=this.buffer.indexOf('"',n+1)}const i=this.buffer.substring(0,n);let r=i.indexOf(`
`,this.pos);if(r!==-1){for(;r!==-1;){const a=this.continueScalar(r+1);if(a===-1)break;r=i.indexOf(`
`,a)}r!==-1&&(n=r-(i[r-1]==="\r"?2:1))}if(n===-1){if(!this.atEnd)return this.setNext("quoted-scalar");n=this.buffer.length}return yield*this.pushToIndex(n+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let s=this.pos;for(;;){const n=this.buffer[++s];if(n==="+")this.blockScalarKeep=!0;else if(n>"0"&&n<="9")this.blockScalarIndent=Number(n)-1;else if(n!=="-")break}return yield*this.pushUntil(n=>Yt(n)||n==="#")}*parseBlockScalar(){let s=this.pos-1,n=0,i;e:for(let a=this.pos;i=this.buffer[a];++a)switch(i){case" ":n+=1;break;case`
`:s=a,n=0;break;case"\r":{const o=this.buffer[a+1];if(!o&&!this.atEnd)return this.setNext("block-scalar");if(o===`
`)break}default:break e}if(!i&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=n:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{const a=this.continueScalar(s+1);if(a===-1)break;s=this.buffer.indexOf(`
`,a)}while(s!==-1);if(s===-1){if(!this.atEnd)return this.setNext("block-scalar");s=this.buffer.length}}let r=s+1;for(i=this.buffer[r];i===" ";)i=this.buffer[++r];if(i==="	"){for(;i==="	"||i===" "||i==="\r"||i===`
`;)i=this.buffer[++r];s=r-1}else if(!this.blockScalarKeep)do{let a=s-1,o=this.buffer[a];o==="\r"&&(o=this.buffer[--a]);const l=a;for(;o===" ";)o=this.buffer[--a];if(o===`
`&&a>=this.pos&&a+1+n>l)s=a;else break}while(!0);return yield Nr,yield*this.pushToIndex(s+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const s=this.flowLevel>0;let n=this.pos-1,i=this.pos-1,r;for(;r=this.buffer[++i];)if(r===":"){const a=this.buffer[i+1];if(Yt(a)||s&&ha.has(a))break;n=i}else if(Yt(r)){let a=this.buffer[i+1];if(r==="\r"&&(a===`
`?(i+=1,r=`
`,a=this.buffer[i+1]):n=i),a==="#"||s&&ha.has(a))break;if(r===`
`){const o=this.continueScalar(i+1);if(o===-1)break;i=Math.max(i,o-2)}}else{if(s&&ha.has(r))break;n=i}return!r&&!this.atEnd?this.setNext("plain-scalar"):(yield Nr,yield*this.pushToIndex(n+1,!0),s?"flow":"doc")}*pushCount(s){return s>0?(yield this.buffer.substr(this.pos,s),this.pos+=s,s):0}*pushToIndex(s,n){const i=this.buffer.slice(this.pos,s);return i?(yield i,this.pos+=i.length,i.length):(n&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(fl))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const s=this.flowLevel>0,n=this.charAt(1);if(Yt(n)||s&&ha.has(n))return s?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let s=this.pos+2,n=this.buffer[s];for(;!Yt(n)&&n!==">";)n=this.buffer[++s];return yield*this.pushToIndex(n===">"?s+1:s,!1)}else{let s=this.pos+1,n=this.buffer[s];for(;n;)if(a_.has(n))n=this.buffer[++s];else if(n==="%"&&Hm.has(this.buffer[s+1])&&Hm.has(this.buffer[s+2]))n=this.buffer[s+=3];else break;return yield*this.pushToIndex(s,!1)}}*pushNewline(){const s=this.buffer[this.pos];return s===`
`?yield*this.pushCount(1):s==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(s){let n=this.pos-1,i;do i=this.buffer[++n];while(i===" "||s&&i==="	");const r=n-this.pos;return r>0&&(yield this.buffer.substr(this.pos,r),this.pos=n),r}*pushUntil(s){let n=this.pos,i=this.buffer[n];for(;!s(i);)i=this.buffer[++n];return yield*this.pushToIndex(n,!1)}}class pj{constructor(){this.lineStarts=[],this.addNewLine=s=>this.lineStarts.push(s),this.linePos=s=>{let n=0,i=this.lineStarts.length;for(;n<i;){const a=n+i>>1;this.lineStarts[a]<s?n=a+1:i=a}if(this.lineStarts[n]===s)return{line:n+1,col:1};if(n===0)return{line:0,col:s};const r=this.lineStarts[n-1];return{line:n,col:s-r+1}}}}function Ws(t,s){for(let n=0;n<t.length;++n)if(t[n].type===s)return!0;return!1}function Qm(t){for(let s=0;s<t.length;++s)switch(t[s].type){case"space":case"comment":case"newline":break;default:return s}return-1}function fj(t){switch(t?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function pa(t){switch(t.type){case"document":return t.start;case"block-map":{const s=t.items[t.items.length-1];return s.sep??s.start}case"block-seq":return t.items[t.items.length-1].start;default:return[]}}function qn(t){if(t.length===0)return[];let s=t.length;e:for(;--s>=0;)switch(t[s].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;t[++s]?.type==="space";);return t.splice(s,t.length)}function Zm(t){if(t.start.type==="flow-seq-start")for(const s of t.items)s.sep&&!s.value&&!Ws(s.start,"explicit-key-ind")&&!Ws(s.sep,"map-value-ind")&&(s.key&&(s.value=s.key),delete s.key,fj(s.value)?s.value.end?Array.prototype.push.apply(s.value.end,s.sep):s.value.end=s.sep:Array.prototype.push.apply(s.start,s.sep),delete s.sep)}class zd{constructor(s){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new hj,this.onNewLine=s}*parse(s,n=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const i of this.lexer.lex(s,n))yield*this.next(i);n||(yield*this.end())}*next(s){if(this.source=s,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=s.length;return}const n=mj(s);if(n)if(n==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=n,yield*this.step(),n){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+s.length);break;case"space":this.atNewLine&&s[0]===" "&&(this.indent+=s.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=s.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=s.length}else{const i=`Not a YAML token: ${s}`;yield*this.pop({type:"error",offset:this.offset,message:i,source:s}),this.offset+=s.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const s=this.peek(1);if(this.type==="doc-end"&&(!s||s.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!s)return yield*this.stream();switch(s.type){case"document":return yield*this.document(s);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(s);case"block-scalar":return yield*this.blockScalar(s);case"block-map":return yield*this.blockMap(s);case"block-seq":return yield*this.blockSequence(s);case"flow-collection":return yield*this.flowCollection(s);case"doc-end":return yield*this.documentEnd(s)}yield*this.pop()}peek(s){return this.stack[this.stack.length-s]}*pop(s){const n=s??this.stack.pop();if(!n)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield n;else{const i=this.peek(1);switch(n.type==="block-scalar"?n.indent="indent"in i?i.indent:0:n.type==="flow-collection"&&i.type==="document"&&(n.indent=0),n.type==="flow-collection"&&Zm(n),i.type){case"document":i.value=n;break;case"block-scalar":i.props.push(n);break;case"block-map":{const r=i.items[i.items.length-1];if(r.value){i.items.push({start:[],key:n,sep:[]}),this.onKeyLine=!0;return}else if(r.sep)r.value=n;else{Object.assign(r,{key:n,sep:[]}),this.onKeyLine=!r.explicitKey;return}break}case"block-seq":{const r=i.items[i.items.length-1];r.value?i.items.push({start:[],value:n}):r.value=n;break}case"flow-collection":{const r=i.items[i.items.length-1];!r||r.value?i.items.push({start:[],key:n,sep:[]}):r.sep?r.value=n:Object.assign(r,{key:n,sep:[]});return}default:yield*this.pop(),yield*this.pop(n)}if((i.type==="document"||i.type==="block-map"||i.type==="block-seq")&&(n.type==="block-map"||n.type==="block-seq")){const r=n.items[n.items.length-1];r&&!r.sep&&!r.value&&r.start.length>0&&Qm(r.start)===-1&&(n.indent===0||r.start.every(a=>a.type!=="comment"||a.indent<n.indent))&&(i.type==="document"?i.end=r.start:i.items.push({start:r.start}),n.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const s={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&s.start.push(this.sourceToken),this.stack.push(s);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(s){if(s.value)return yield*this.lineEnd(s);switch(this.type){case"doc-start":{Qm(s.start)!==-1?(yield*this.pop(),yield*this.step()):s.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":s.start.push(this.sourceToken);return}const n=this.startBlockValue(s);n?this.stack.push(n):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(s){if(this.type==="map-value-ind"){const n=pa(this.peek(2)),i=qn(n);let r;s.end?(r=s.end,r.push(this.sourceToken),delete s.end):r=[this.sourceToken];const a={type:"block-map",offset:s.offset,indent:s.indent,items:[{start:i,key:s,sep:r}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(s)}*blockScalar(s){switch(this.type){case"space":case"comment":case"newline":s.props.push(this.sourceToken);return;case"scalar":if(s.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(s){const n=s.items[s.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,n.value){const i="end"in n.value?n.value.end:void 0;(Array.isArray(i)?i[i.length-1]:void 0)?.type==="comment"?i?.push(this.sourceToken):s.items.push({start:[this.sourceToken]})}else n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)s.items.push({start:[this.sourceToken]});else if(n.sep)n.sep.push(this.sourceToken);else{if(this.atIndentedComment(n.start,s.indent)){const r=s.items[s.items.length-2]?.value?.end;if(Array.isArray(r)){Array.prototype.push.apply(r,n.start),r.push(this.sourceToken),s.items.pop();return}}n.start.push(this.sourceToken)}return}if(this.indent>=s.indent){const i=!this.onKeyLine&&this.indent===s.indent,r=i&&(n.sep||n.explicitKey)&&this.type!=="seq-item-ind";let a=[];if(r&&n.sep&&!n.value){const o=[];for(let l=0;l<n.sep.length;++l){const c=n.sep[l];switch(c.type){case"newline":o.push(l);break;case"space":break;case"comment":c.indent>s.indent&&(o.length=0);break;default:o.length=0}}o.length>=2&&(a=n.sep.splice(o[1]))}switch(this.type){case"anchor":case"tag":r||n.value?(a.push(this.sourceToken),s.items.push({start:a}),this.onKeyLine=!0):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"explicit-key-ind":!n.sep&&!n.explicitKey?(n.start.push(this.sourceToken),n.explicitKey=!0):r||n.value?(a.push(this.sourceToken),s.items.push({start:a,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(n.explicitKey)if(n.sep)if(n.value)s.items.push({start:[],key:null,sep:[this.sourceToken]});else if(Ws(n.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]});else if(fj(n.key)&&!Ws(n.sep,"newline")){const o=qn(n.start),l=n.key,c=n.sep;c.push(this.sourceToken),delete n.key,delete n.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:l,sep:c}]})}else a.length>0?n.sep=n.sep.concat(a,this.sourceToken):n.sep.push(this.sourceToken);else if(Ws(n.start,"newline"))Object.assign(n,{key:null,sep:[this.sourceToken]});else{const o=qn(n.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:null,sep:[this.sourceToken]}]})}else n.sep?n.value||r?s.items.push({start:a,key:null,sep:[this.sourceToken]}):Ws(n.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const o=this.flowScalar(this.type);r||n.value?(s.items.push({start:a,key:o,sep:[]}),this.onKeyLine=!0):n.sep?this.stack.push(o):(Object.assign(n,{key:o,sep:[]}),this.onKeyLine=!0);return}default:{const o=this.startBlockValue(s);if(o){if(o.type==="block-seq"){if(!n.explicitKey&&n.sep&&!Ws(n.sep,"newline")){yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source});return}}else i&&s.items.push({start:a});this.stack.push(o);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(s){const n=s.items[s.items.length-1];switch(this.type){case"newline":if(n.value){const i="end"in n.value?n.value.end:void 0;(Array.isArray(i)?i[i.length-1]:void 0)?.type==="comment"?i?.push(this.sourceToken):s.items.push({start:[this.sourceToken]})}else n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)s.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(n.start,s.indent)){const r=s.items[s.items.length-2]?.value?.end;if(Array.isArray(r)){Array.prototype.push.apply(r,n.start),r.push(this.sourceToken),s.items.pop();return}}n.start.push(this.sourceToken)}return;case"anchor":case"tag":if(n.value||this.indent<=s.indent)break;n.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==s.indent)break;n.value||Ws(n.start,"seq-item-ind")?s.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return}if(this.indent>s.indent){const i=this.startBlockValue(s);if(i){this.stack.push(i);return}}yield*this.pop(),yield*this.step()}*flowCollection(s){const n=s.items[s.items.length-1];if(this.type==="flow-error-end"){let i;do yield*this.pop(),i=this.peek(1);while(i&&i.type==="flow-collection")}else if(s.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!n||n.sep?s.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return;case"map-value-ind":!n||n.value?s.items.push({start:[],key:null,sep:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!n||n.value?s.items.push({start:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const r=this.flowScalar(this.type);!n||n.value?s.items.push({start:[],key:r,sep:[]}):n.sep?this.stack.push(r):Object.assign(n,{key:r,sep:[]});return}case"flow-map-end":case"flow-seq-end":s.end.push(this.sourceToken);return}const i=this.startBlockValue(s);i?this.stack.push(i):(yield*this.pop(),yield*this.step())}else{const i=this.peek(2);if(i.type==="block-map"&&(this.type==="map-value-ind"&&i.indent===s.indent||this.type==="newline"&&!i.items[i.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&i.type!=="flow-collection"){const r=pa(i),a=qn(r);Zm(s);const o=s.end.splice(1,s.end.length);o.push(this.sourceToken);const l={type:"block-map",offset:s.offset,indent:s.indent,items:[{start:a,key:s,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=l}else yield*this.lineEnd(s)}}flowScalar(s){if(this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}return{type:s,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(s){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const n=pa(s),i=qn(n);return i.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const n=pa(s),i=qn(n);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(s,n){return this.type!=="comment"||this.indent<=n?!1:s.every(i=>i.type==="newline"||i.type==="space")}*documentEnd(s){this.type!=="doc-mode"&&(s.end?s.end.push(this.sourceToken):s.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(s){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:s.end?s.end.push(this.sourceToken):s.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function xj(t){const s=t.prettyErrors!==!1;return{lineCounter:t.lineCounter||s&&new pj||null,prettyErrors:s}}function l_(t,s={}){const{lineCounter:n,prettyErrors:i}=xj(s),r=new zd(n?.addNewLine),a=new kd(s),o=Array.from(a.compose(r.parse(t)));if(i&&n)for(const l of o)l.errors.forEach(Wa(t,n)),l.warnings.forEach(Wa(t,n));return o.length>0?o:Object.assign([],{empty:!0},a.streamInfo())}function gj(t,s={}){const{lineCounter:n,prettyErrors:i}=xj(s),r=new zd(n?.addNewLine),a=new kd(s);let o=null;for(const l of a.compose(r.parse(t),!0,t.length))if(!o)o=l;else if(o.options.logLevel!=="silent"){o.errors.push(new pn(l.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return i&&n&&(o.errors.forEach(Wa(t,n)),o.warnings.forEach(Wa(t,n))),o}function c_(t,s,n){let i;typeof s=="function"?i=s:n===void 0&&s&&typeof s=="object"&&(n=s);const r=gj(t,n);if(!r)return null;if(r.warnings.forEach(a=>Og(r.options.logLevel,a)),r.errors.length>0){if(r.options.logLevel!=="silent")throw r.errors[0];r.errors=[]}return r.toJS(Object.assign({reviver:i},n))}function d_(t,s,n){let i=null;if(typeof s=="function"||Array.isArray(s)?i=s:n===void 0&&s&&(n=s),typeof n=="string"&&(n=n.length),typeof n=="number"){const r=Math.round(n);n=r<1?void 0:r>8?{indent:8}:{indent:r}}if(t===void 0){const{keepUndefined:r}=n??s??{};if(!r)return}return Pn(t)&&!i?t.toString(n):new Pi(t,i,n).toString(n)}const u_=Object.freeze(Object.defineProperty({__proto__:null,Alias:vo,CST:r_,Composer:kd,Document:Pi,Lexer:hj,LineCounter:pj,Pair:ct,Parser:zd,Scalar:ne,Schema:Po,YAMLError:vd,YAMLMap:At,YAMLParseError:pn,YAMLSeq:tn,YAMLWarning:sj,isAlias:rn,isCollection:_e,isDocument:Pn,isMap:Ci,isNode:De,isPair:Te,isScalar:we,isSeq:Ti,parse:c_,parseAllDocuments:l_,parseDocument:gj,stringify:d_,visit:Dn,visitAsync:wo},Symbol.toStringTag,{value:"Module"})),Ym=t=>t.toLowerCase().replace(/[^\p{Letter}\p{Number}]+/gu,"-").replace(/(^-|-$)/g,"")||"sekcja",m_=(t,s)=>{const n=t.split(/\n(?=##\s+)/g);return n.length<=1&&!/^##\s+/.test(t)?[{id:Ym(s||"Sekcja 1"),title:s||"Sekcja 1",content:t}]:n.map((i,r)=>{const o=(i.match(/^##\s+(.+?)\s*$/m)?.[1]||`Sekcja ${r+1}`).trim(),l=i.replace(/^##\s+.+?\n/,"").trim();return{id:Ym(o),title:o,content:l}})},h_=/```quiz\s*?\n([\s\S]*?)```/g,p_=(t,s,n)=>{try{const i=u_.parse(t),r=(i?.options||[]).map(String);return!i?.question||!Array.isArray(i?.options)||typeof i?.answerIndex!="number"||i.answerIndex<0||i.answerIndex>=r.length?null:{question:i.question,options:r,answerIndex:i.answerIndex,key:`${s}:${n}`}}catch{return null}},f_=t=>new Map(t.map(s=>[s.id,[...s.content.matchAll(h_)].map((n,i)=>p_(n[1],s.id,i)).filter(Boolean)])),Jm=(t,s)=>{const[n,i]=te.useState(()=>{try{const r=localStorage.getItem(t);return r?JSON.parse(r):s}catch{return s}});return te.useEffect(()=>{try{localStorage.setItem(t,JSON.stringify(n))}catch(r){console.error("Błąd zapisu do localStorage:",r)}},[t,n]),[n,i]},x_=()=>{const t=te.useRef(null);return{ref:t,say:n=>{t.current&&(t.current.textContent="",setTimeout(()=>t.current&&(t.current.textContent=n),30))}}},g_=()=>e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6",children:[e.jsx("div",{className:"h-5 w-24 rounded bg-muted/60"}),e.jsxs("div",{className:"rounded-2xl border bg-card p-6 shadow-soft animate-pulse",children:[e.jsx("div",{className:"h-6 w-2/3 rounded bg-muted/60 mb-2"}),e.jsx("div",{className:"h-4 w-40 rounded bg-muted/60"})]}),e.jsx("div",{className:"space-y-3",children:Array.from({length:10}).map((t,s)=>e.jsx("div",{className:"h-4 w-full rounded bg-muted/50"},s))}),e.jsx("div",{className:"h-10 w-48 rounded-lg bg-muted/60 ml-auto"})]}),Xm={code:({inline:t,className:s="",children:n,...i})=>{const r=(s||"").toLowerCase();return!t&&r.includes("language-quiz")?null:e.jsx("code",{className:s,...i,children:n})},pre:t=>((Array.isArray(t.children)?t.children[0]:t.children)?.props?.className?.toLowerCase?.()||"").includes("language-quiz")?null:e.jsx("pre",{...t})},j_=({quiz:t,onClose:s,onPass:n})=>{const[i,r]=te.useState(null),[a,o]=te.useState(!1),l=()=>{const c=i!==null&&i===t.answerIndex;o(c),c?(W.success("Poprawna odpowiedź!"),setTimeout(n,200)):W.error("Niepoprawna odpowiedź — spróbuj ponownie.")};return e.jsxs("div",{className:"fixed inset-0 z-[90] flex items-end sm:items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:s}),e.jsxs("div",{className:"relative z-[91] w-full sm:max-w-lg bg-background rounded-t-2xl sm:rounded-2xl border shadow-2xl p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold",children:"Pytanie kontrolne"}),e.jsx("button",{onClick:s,className:"p-1 rounded hover:bg-muted","aria-label":"Zamknij",children:e.jsx(vt,{className:"h-5 w-5"})})]}),e.jsx("p",{className:"mb-3 text-sm sm:text-base",children:t.question}),e.jsx("div",{className:"space-y-2 mb-4",children:t.options.map((c,d)=>e.jsxs("label",{className:"flex items-center gap-2 rounded-md border px-3 py-2 cursor-pointer hover:bg-muted",children:[e.jsx("input",{type:"radio",name:"quiz-choice",className:"h-4 w-4",checked:i===d,onChange:()=>r(d),disabled:a}),e.jsx("span",{className:"text-sm",children:c})]},d))}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:s,className:"rounded-lg border px-3 py-1.5 text-sm hover:bg-muted",children:"Anuluj"}),e.jsx("button",{onClick:l,className:"rounded-lg border px-3 py-1.5 text-sm font-medium hover:bg-muted",disabled:a,children:"Zatwierdź"})]})]})]})},y_=({lessonTitle:t,courseId:s,timeSpent:n,sectionsCount:i,quizzesCompleted:r,pointsEarned:a,nextLessonPath:o})=>{const l=J(),c=d=>{const m=Math.floor(d/60),u=d%60;return m>0?`${m} min ${u} s`:`${u} s`};return e.jsx(ke.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:e.jsxs("div",{className:"w-full max-w-md rounded-2xl border bg-card p-6 shadow-2xl",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 dark:bg-green-900/30 mb-4",children:e.jsx(st,{className:"w-8 h-8 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold",children:"Lekcja ukończona! 🎉"}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:t})]}),e.jsxs("div",{className:"rounded-xl bg-primary/10 p-4 mb-6 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-3xl font-bold text-primary",children:[e.jsx(nt,{className:"w-6 h-6"}),"+",a," punktów"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"za ukończenie materiału"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Se,{className:"w-5 h-5 mx-auto mb-1 text-blue-600"}),e.jsx("p",{className:"text-sm font-medium",children:c(n)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Czas nauki"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(xe,{className:"w-5 h-5 mx-auto mb-1 text-purple-600"}),e.jsx("p",{className:"text-sm font-medium",children:i}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sekcji"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx($e,{className:"w-5 h-5 mx-auto mb-1 text-yellow-600"}),e.jsx("p",{className:"text-sm font-medium",children:r}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pytań"})]})]}),e.jsx("div",{className:"flex gap-3",children:o?e.jsxs("button",{onClick:()=>l(o),className:"flex-1 inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2.5 text-primary-foreground hover:bg-primary/90",children:["Następna lekcja",e.jsx(ae,{className:"w-4 h-4"})]}):e.jsx("button",{onClick:()=>l(`/student/courses/${s}`),className:"flex-1 rounded-lg bg-primary px-4 py-2.5 text-primary-foreground hover:bg-primary/90",children:"Wróć do kursu"})})]})})},b_=()=>{const{courseId:t,lessonId:s}=ut(),n=J(),{data:i,isLoading:r}=Ue({resource:"activities",id:s,meta:{select:"*, topics(title, course_id, courses(title, icon_emoji))"}}),a=i?.data??{},o=a?.content_md??a?.markdown??a?.content,l=te.useMemo(()=>o?m_(o,a?.title??"Sekcja"):[],[o,a?.title]),c=te.useMemo(()=>f_(l),[l]),d=`lesson-progress:${s}`,m=`lesson-quiz:${s}`,[u,h]=Jm(d,Object.fromEntries(l.map(T=>[T.id,!1]))),[p,b]=Jm(m,{}),[f,x]=te.useState(null),[w,y]=te.useState(!1),[N]=te.useState(Date.now());te.useEffect(()=>{l.length&&h(T=>{const E={};return l.forEach(M=>E[M.id]=T[M.id]??!1),E})},[l.map(T=>T.id).join("|")]);const{ref:A,say:S}=x_(),k=l.findIndex(T=>!u[T.id]),v=k===-1,z=T=>{const[E]=c.get(T)??[];E&&x(E)},D=T=>{const E=l[T];if(!E||!(k===-1||T<=k)&&!u[E.id])return;if(u[E.id]){h(X=>({...X,[E.id]:!1})),S(`Sekcja ${T+1} cofnięta.`);return}(c.get(E.id)??[]).length>0?z(E.id):(h(X=>({...X,[E.id]:!0})),S(`Sekcja ${T+1} odhaczona.`))},j=()=>{const T=f;if(x(null),!T)return;b(F=>({...F,[T.key]:!0}));const E=T.key.split(":")[0];h(F=>({...F,[E]:!0}));const M=l.findIndex(F=>F.id===E);S(`Sekcja ${M+1} odhaczona po pytaniu kontrolnym.`)},C=async()=>{if(!v)return W.info("Najpierw odhacz wszystkie sekcje po kolei.");try{await ue.rpc("start_activity",{p_activity_id:parseInt(s)});const{data:T,error:E}=await ue.rpc("complete_material",{p_activity_id:parseInt(s)});if(E)throw E;if(T){const M=Math.floor((Date.now()-N)/1e3);y(!0);try{localStorage.removeItem(d),localStorage.removeItem(m)}catch(F){console.error("Błąd zapisu do localStorage:",F)}Cu("get_course_structure"),Cu("get_my_courses")}}catch{W.error("Nie udało się ukończyć lekcji")}};return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-10 pb-28 lg:pb-16",children:[e.jsx("div",{ref:A,"aria-live":"polite",className:"sr-only"}),e.jsxs("button",{onClick:()=>n(`/student/courses/${t}`),className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Powrót do kursu"})]}),e.jsx("section",{className:"relative overflow-hidden rounded-2xl border bg-white dark:bg-card",children:e.jsx("div",{className:"relative z-10 p-5 sm:p-7 md:p-10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-4xl md:text-5xl leading-none",children:a?.topics?.courses?.icon_emoji||"📚"}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"text-xs sm:text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx("span",{className:"truncate",children:a?.topics?.courses?.title||"…"}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"truncate",children:a?.topics?.title||"…"})]}),e.jsx("h1",{className:"mt-1 text-xl md:text-3xl font-bold tracking-tight",children:a?.title||"Ładowanie…"}),a?.duration_min&&e.jsxs("div",{className:"mt-3 inline-flex items-center gap-2 rounded-full border bg-white/70 dark:bg-background/60 px-3 py-1.5 shadow-soft",children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsxs("span",{className:"text-sm font-medium",children:[a?.duration_min," min czytania"]})]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_280px] gap-10",children:[e.jsx("main",{children:r?e.jsx(g_,{}):e.jsxs("section",{children:[e.jsx("div",{className:"prose prose-neutral dark:prose-invert max-w-[72ch] mx-auto prose-headings:font-semibold prose-p:text-muted-foreground prose-p:leading-relaxed prose-li:leading-relaxed prose-headings:tracking-tight prose-img:rounded-xl prose-blockquote:rounded-xl md:prose-lg",children:l.length?l.map((T,E)=>{const M=!!u[T.id],F=!M&&E===k,R=!(k===-1||E<=k)&&!M,G=(c.get(T.id)??[])[0],U="rounded-[20px] border p-6 sm:p-7 md:p-8 shadow-sm transition-colors duration-200",le=M?"bg-emerald-50 dark:bg-emerald-950/25 border-emerald-300":F?"bg-white dark:bg-background border-neutral-200 shadow-md":R?"bg-white dark:bg-card border-dashed border-muted-foreground/40":"bg-white dark:bg-card border-neutral-200",q=!M&&R?"filter blur-[2px] select-none pointer-events-none":"";return e.jsxs("div",{id:T.id,className:"mb-12 scroll-mt-28",children:[e.jsxs("div",{className:`${U} ${le}`,children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[R&&e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border px-2.5 py-0.5 text-[11px] text-muted-foreground bg-white",children:[e.jsx(rr,{className:"h-3.5 w-3.5"}),"Zablokowana"]}),M&&e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-emerald-300/60 bg-emerald-50/60 px-2.5 py-0.5 text-[11px] text-emerald-700 dark:text-emerald-300",children:[e.jsx(ot,{className:"h-3.5 w-3.5"}),"Ukończona"]}),F&&!M&&e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border bg-white px-2.5 py-0.5 text-[11px]",children:[e.jsx(fa,{className:"h-3.5 w-3.5"}),"W trakcie"]}),G&&e.jsxs("button",{type:"button",onClick:()=>!M&&!R&&z(T.id),disabled:M||R,className:["inline-flex items-center gap-1 rounded-full border px-2.5 py-0.5 text-[11px]",M?"text-emerald-700 border-emerald-300/60 bg-emerald-50/60 dark:bg-emerald-950/25":R?"text-muted-foreground cursor-not-allowed bg-white dark:bg-background/40":"bg-white hover:bg-muted"].join(" "),title:M?"Pytanie rozwiązane":R?"Najpierw odblokuj sekcję":"Kliknij, aby odpowiedzieć","aria-label":"Pytanie kontrolne",children:[e.jsx(dt,{className:"h-3.5 w-3.5"}),G.question.length>72?G.question.slice(0,69)+"…":G.question]})]}),e.jsxs("div",{className:q,children:[e.jsx("h2",{className:"text-[22px] md:text-[26px] font-semibold tracking-tight m-0 mb-4",children:T.title||`Sekcja ${E+1}`}),e.jsx(Jn,{remarkPlugins:[Sl],components:Xm,children:T.content})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("label",{className:["inline-flex items-center gap-3",R?"cursor-not-allowed opacity-60":"cursor-pointer"].join(" "),title:R?"Najpierw ukończ poprzednie sekcje":M?"Sekcja odhaczona — klik, aby cofnąć":G?"Kliknij, aby odpowiedzieć na pytanie":"Odhacz sekcję",children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:M,onChange:()=>!R&&D(E),disabled:R&&!M,"aria-label":`Odhacz sekcję: ${T.title||`Sekcja ${E+1}`}`}),e.jsx("span",{className:["inline-flex items-center gap-2 rounded-lg border px-3 py-2 text-sm font-medium shadow-soft transition-all",M?"bg-emerald-50/70 dark:bg-emerald-950/30 border-emerald-300/60 text-emerald-700 dark:text-emerald-300":"bg-white hover:bg-muted border-neutral-200"].join(" "),children:G&&!M?e.jsx("span",{className:"truncate max-w-[56ch]",children:G.question}):e.jsxs(e.Fragment,{children:[M?e.jsx(ot,{className:"h-4 w-4"}):e.jsx(fa,{className:"h-4 w-4"}),e.jsxs("span",{className:"whitespace-nowrap",children:[String(E+1).padStart(2,"0")," • ",M?"Odhaczono":G?"Odhacz (pytanie)":"Odhacz sekcję"]})]})})]})})]}),e.jsx("div",{className:"h-8"})]},T.id)}):o?e.jsx(Jn,{remarkPlugins:[Sl],components:Xm,children:o}):e.jsx("div",{dangerouslySetInnerHTML:{__html:a?.content||""}})}),!!l.length&&e.jsx("div",{className:"mt-10 flex justify-end",children:e.jsx("button",{onClick:C,className:"inline-flex items-center gap-2 rounded-lg border bg-white px-4 py-2 text-sm font-medium shadow-soft hover:bg-muted transition-colors disabled:opacity-60",disabled:!v,title:v?void 0:"Najpierw odhacz wszystkie sekcje",children:"Zakończ lekcję"})})]})}),e.jsx("aside",{children:e.jsxs("nav",{className:"border rounded-[14px] p-4 bg-white dark:bg-background/60 lg:sticky lg:top-28",children:[e.jsx("h2",{className:"text-sm font-semibold mb-3",children:"Spis treści"}),r?e.jsx("div",{className:"h-4 w-40 rounded bg-muted/60 animate-pulse"}):l.length?e.jsx("ol",{className:"space-y-1.5 text-sm",children:l.map((T,E)=>{const M=!!u[T.id],F=!M&&E===k,R=!(k===-1||E<=k)&&!M,G=()=>{R||document.getElementById(T.id)?.scrollIntoView({behavior:"smooth"})};return e.jsxs("li",{className:"flex items-center gap-1.5",children:[R?e.jsx(rr,{className:"h-3.5 w-3.5 text-muted-foreground"}):M?e.jsx(ot,{className:"h-3.5 w-3.5 text-emerald-600"}):e.jsx(fa,{className:"h-3.5 w-3.5"}),e.jsxs("button",{onClick:G,className:["flex-1 text-left px-2 py-1 rounded transition-colors",R?"text-muted-foreground cursor-not-allowed":"hover:bg-muted",M?"text-emerald-700":"",F?"font-semibold underline":""].join(" "),disabled:R,children:[String(E+1).padStart(2,"0"),". ",T.title||`Sekcja ${E+1}`]})]},T.id)})}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Brak sekcji."})]})})]}),f&&e.jsx(j_,{quiz:f,onClose:()=>x(null),onPass:j}),w&&e.jsx(y_,{lessonTitle:a?.title||"Lekcja",courseId:t,timeSpent:Math.floor((Date.now()-N)/1e3),sectionsCount:l.length,quizzesCompleted:Object.keys(p).length,pointsEarned:5,nextLessonPath:void 0})]})},w_=[e.jsx(V,{path:"/courses/:courseId/lesson/:lessonId",element:e.jsx(b_,{})},"lesson-view")],v_=()=>{const{courseId:t,quizId:s}=ut(),n=J(),[i,r]=te.useState(0),[a,o]=te.useState({}),[l,c]=te.useState(null),[d,m]=te.useState(!1),[u,h]=te.useState([]),[p,b]=te.useState(!0),{data:f,isLoading:x}=Ue({resource:"activities",id:s,meta:{select:"*, topics(title, course_id, courses(title, icon_emoji))"}});te.useEffect(()=>{(async()=>{if(s)try{await ue.rpc("start_activity",{p_activity_id:parseInt(s)}),b(!0);const{data:v,error:z}=await ue.rpc("get_quiz_questions",{p_activity_id:parseInt(s)});if(z)throw z;const D=typeof v=="string"?JSON.parse(v):v;h(Array.isArray(D)?D:[])}catch(v){console.error("Quiz init error:",v),W.error("Błąd podczas ładowania quizu")}finally{b(!1)}})()},[s]),te.useEffect(()=>{f?.data?.time_limit&&l===null&&c(f.data.time_limit*60)},[f]),te.useEffect(()=>{if(l!==null&&l>0){const k=setTimeout(()=>c(l-1),1e3);return()=>clearTimeout(k)}else l===0&&S()},[l]);const w=f?.data,y=u[i],N=u.length>0?(i+1)/u.length*100:0,A=(k,v)=>{o(z=>({...z,[k]:v}))},S=async()=>{m(!0);try{const k=Object.entries(a).map(([D,j])=>({question_id:parseInt(D),option_id:j})),{data:v,error:z}=await ue.rpc("finish_quiz",{p_activity_id:parseInt(s),p_answers:k});if(z)throw z;v&&n(`/student/courses/${t}/quiz/${s}/result`,{state:{courseId:t,quizId:s,result:{...v,passing_score:w?.passing_score||70,max_attempts:w?.max_attempts,attempts_used:w?.attempts||1}}})}catch{W.error("Nie udało się przesłać odpowiedzi")}finally{m(!1)}};return x||p?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-300"})}):e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("button",{onClick:()=>n(`/student/courses/${t}`),className:"flex items-center gap-2 text-gray-500 hover:text-gray-900 transition-colors",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Zakończ quiz"})]}),l!==null&&e.jsxs("div",{className:$("flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium",l<60?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:[e.jsx(Se,{className:"w-4 h-4"}),Math.floor(l/60),":",String(l%60).padStart(2,"0")]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900 mb-2",children:w?.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{children:["Pytanie ",i+1," z ",u.length]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[y?.points," pkt"]})]})]}),e.jsx("div",{className:"h-1 bg-gray-100 rounded-full overflow-hidden mb-8",children:e.jsx(ke.div,{initial:{width:0},animate:{width:`${N}%`},className:"h-full bg-gray-900"})}),e.jsx(uC,{mode:"wait",children:y&&e.jsx(ke.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.2},children:e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-8 mb-8",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-6",children:y.question}),e.jsx("div",{className:"space-y-3",children:y.options.map(k=>e.jsx("label",{className:$("block p-4 rounded-xl border-2 cursor-pointer transition-all",a[y.id]===k.id?"border-gray-900 bg-gray-50":"border-gray-200 hover:border-gray-300"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"radio",name:`question-${y.id}`,value:k.id,checked:a[y.id]===k.id,onChange:()=>A(y.id,k.id),className:"sr-only"}),e.jsx("div",{className:$("w-5 h-5 rounded-full border-2 flex items-center justify-center",a[y.id]===k.id?"border-gray-900":"border-gray-300"),children:a[y.id]===k.id&&e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-gray-900"})}),e.jsx("span",{className:"flex-1",children:k.text})]})},k.id))})]})},y.id)}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>r(Math.max(0,i-1)),disabled:i===0,className:$("flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all",i===0?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"),children:[e.jsx(ye,{className:"w-4 h-4"}),"Poprzednie"]}),e.jsx("div",{className:"flex gap-2",children:u.map((k,v)=>e.jsx("button",{onClick:()=>r(v),className:$("w-2 h-2 rounded-full transition-all",v===i?"bg-gray-900 w-8":a[u[v]?.id]?"bg-gray-600":"bg-gray-300")},v))}),i<u.length-1?e.jsxs("button",{onClick:()=>r(i+1),disabled:!a[y?.id],className:$("flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all",a[y?.id]?"bg-gray-900 text-white hover:bg-gray-800":"bg-gray-100 text-gray-400 cursor-not-allowed"),children:["Następne",e.jsx(ae,{className:"w-4 h-4"})]}):e.jsxs("button",{onClick:S,disabled:d||Object.keys(a).length<u.length,className:$("flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all",d||Object.keys(a).length<u.length?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-green-500 text-white hover:bg-green-600"),children:[d?"Przesyłanie...":"Zakończ quiz",e.jsx(ot,{className:"w-4 h-4"})]})]})]})},N_=()=>{const t=J(),s=kr(),{courseId:n,quizId:i,result:r}=s.state,a=m=>{const u=Math.floor(m/60),h=m%60;return`${u}:${String(h).padStart(2,"0")}`},o=m=>m>=90?"text-green-600":m>=70?"text-yellow-600":"text-red-600",l=m=>m<30?1:m<50?2:m<70?5:10+Math.floor((m-70)/3),c=r.max_attempts&&(r.attempts_used??0)<r.max_attempts,d=r.score===100;return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[e.jsxs(ke.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},className:"rounded-2xl border bg-card p-6 md:p-8 shadow-soft",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:$("inline-flex items-center justify-center w-16 h-16 rounded-full mb-4",r.passed?"bg-green-100":"bg-orange-100"),children:e.jsx($e,{className:$("w-8 h-8",r.passed?"text-green-600":"text-orange-600")})}),e.jsx("h1",{className:"text-2xl font-bold mb-2",children:r.passed?"Quiz zaliczony!":"Niezaliczone, ale zdobywasz punkty!"}),e.jsx("p",{className:"text-muted-foreground",children:r.passed?d?"Perfekcyjny wynik! Jesteś mistrzem!":"Gratulacje! Świetnie Ci poszło.":`Zdobywasz ${r.points_earned} punktów za swoją próbę!`})]}),e.jsx("div",{className:"bg-muted/50 rounded-xl p-6 mb-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:$("text-5xl font-bold mb-2",o(r.score)),children:[r.score,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Twój wynik"})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(nt,{className:"w-4 h-4 text-yellow-600"}),e.jsx("span",{className:"font-semibold text-lg",children:r.points_earned})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Punktów zdobytych"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(Se,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-semibold",children:a(r.time_spent)})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Czas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(ze,{className:"w-4 h-4 text-purple-600"}),e.jsxs("span",{className:"font-semibold",children:[r.passing_score,"%"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Próg zaliczenia"})]})]}),e.jsxs("div",{className:$("rounded-lg p-4 mb-6",r.points_earned>0?"bg-primary/5":"bg-muted/50"),children:[e.jsxs("h3",{className:"font-semibold text-sm mb-3 flex items-center gap-2",children:[e.jsx(It,{className:"w-4 h-4"}),"Jak obliczyliśmy Twoje punkty:"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Punkty bazowe za wynik ",r.score,"%:"]}),e.jsxs("span",{className:"font-medium tabular-nums",children:[r.base_points||l(r.score)," pkt"]})]}),r.multipliers?.quiz_multiplier&&r.multipliers.quiz_multiplier>1&&e.jsxs("div",{className:"flex justify-between items-center text-green-600 dark:text-green-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ds,{className:"w-3 h-3"}),'Ulepszenie "Szybki umysł":']}),e.jsxs("span",{className:"font-medium",children:["×",r.multipliers.quiz_multiplier]})]}),r.streak_days&&r.streak_days>0&&r.multipliers?.streak_multiplier&&e.jsxs("div",{className:"flex justify-between items-center text-orange-600 dark:text-orange-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ls,{className:"w-3 h-3"}),"Streak ",r.streak_days," dni:"]}),e.jsxs("span",{className:"font-medium",children:["×",r.multipliers.streak_multiplier.toFixed(1)]})]}),d&&r.perfect_bonus&&r.perfect_bonus>0&&e.jsxs("div",{className:"flex justify-between items-center text-purple-600 dark:text-purple-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Yy,{className:"w-3 h-3"}),"Bonus perfekcjonisty:"]}),e.jsxs("span",{className:"font-medium",children:["+",r.perfect_bonus," pkt"]})]}),r.multipliers?.min_points&&r.score<30&&e.jsxs("div",{className:"flex justify-between items-center text-blue-600 dark:text-blue-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ai,{className:"w-3 h-3"}),'Gwarancja "Druga szansa":']}),e.jsxs("span",{className:"font-medium",children:["min. ",r.multipliers.min_points," pkt"]})]}),e.jsx("div",{className:"pt-2 mt-2 border-t border-border/50",children:e.jsxs("div",{className:"flex justify-between items-center font-semibold",children:[e.jsx("span",{children:"Łącznie zdobywasz:"}),e.jsxs("span",{className:"text-lg text-primary",children:[r.points_earned," punktów"]})]})})]}),(!r.multipliers?.quiz_multiplier||r.multipliers.quiz_multiplier===1)&&e.jsx("div",{className:"mt-3 p-2 bg-amber-50 dark:bg-amber-900/20 rounded-md",children:e.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-400 flex items-center gap-1",children:"💡 Wskazówka: Kup ulepszenia w zakładce Idle aby zwiększyć punkty z quizów!"})})]}),!r.passed&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"font-medium text-sm mb-1 text-blue-700 dark:text-blue-400",children:"Nie poddawaj się! 💪"}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-300",children:r.score>=60?`Świetnie Ci idzie! Brakuje tylko ${r.passing_score-r.score}% do zaliczenia.`:r.score>=40?"Już prawie połowa! Przejrzyj materiały i spróbuj ponownie.":"Każda próba to krok naprzód. Wróć do materiałów i próbuj dalej!"})]}),e.jsxs("div",{className:"flex gap-3",children:[r.passed?e.jsxs("button",{onClick:()=>t(`/student/courses/${n}`),className:"flex-1 inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2.5 text-primary-foreground hover:bg-primary/90 focus-ring",children:["Kontynuuj kurs",e.jsx(ae,{className:"w-4 h-4"})]}):e.jsx(e.Fragment,{children:c?e.jsxs("button",{onClick:()=>t(`/student/courses/${n}/quiz/${i}`),className:"flex-1 inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-2.5 text-primary-foreground hover:bg-primary/90 focus-ring",children:[e.jsx(ai,{className:"w-4 h-4"}),"Spróbuj ponownie"]}):e.jsx("button",{onClick:()=>t(`/student/courses/${n}`),className:"flex-1 rounded-lg border px-4 py-2.5 hover:bg-muted/50 focus-ring",children:"Wróć do kursu"})}),e.jsx("button",{onClick:()=>t("/student/dashboard"),className:"px-4 py-2.5 rounded-lg border hover:bg-muted/50 focus-ring",children:"Dashboard"})]}),r.max_attempts&&e.jsxs("p",{className:"text-center text-xs text-muted-foreground mt-4",children:["Wykorzystane próby: ",r.attempts_used," z ",r.max_attempts]})]}),d&&e.jsx(ke.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"🎯 Mistrzostwo! Twoja wiedza jest imponująca!"})})]})},k_=[e.jsx(V,{path:"/courses/:courseId/quiz/:quizId",element:e.jsx(v_,{})},"quiz-take"),e.jsx(V,{path:"/courses/:courseId/quiz/:quizId/result",element:e.jsx(N_,{})},"quiz-result")],z_={"⚡":nt,"🚀":pi,"🧠":Ds,"☕":Xy,"📚":Jy},S_=()=>e.jsxs("div",{className:"rounded-2xl border bg-card p-6 shadow-soft animate-pulse",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-muted/70"}),e.jsxs("div",{children:[e.jsx("div",{className:"h-4 w-40 rounded bg-muted/70"}),e.jsx("div",{className:"mt-2 h-3 w-24 rounded bg-muted/60"})]})]}),e.jsx("div",{className:"h-5 w-16 rounded-full bg-muted/60"})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsx("div",{className:"h-3 w-full rounded bg-muted/60"}),e.jsx("div",{className:"h-3 w-2/3 rounded bg-muted/60"})]}),e.jsx("div",{className:"h-10 w-full rounded-lg bg-muted/60"})]}),C_=()=>{const{stats:t,refetch:s}=Wr(),{data:n,isLoading:i,refetch:r}=Kr("get_idle_upgrades"),a=async l=>{try{const{data:c,error:d}=await ue.rpc("buy_idle_upgrade",{p_upgrade_id:l});if(d)throw d;c&&(W.success(`Ulepszenie zakupione! Poziom ${c.new_level}`),s(),r())}catch{W.error("Niewystarczająca ilość punktów")}},o=n||[];return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),e.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-12 md:items-center",children:[e.jsxs("div",{className:"md:col-span-4 space-y-2",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Ulepszenia"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Inwestuj punkty, aby zwiększyć tempo zdobywania kolejnych."})]}),e.jsxs("div",{className:"md:col-span-8 grid grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Punkty / h"}),e.jsx(It,{className:"h-4 w-4 text-accent"})]}),e.jsx("div",{className:"mt-2 flex items-end gap-2",children:e.jsx("span",{className:"text-4xl md:text-5xl font-semibold text-accent leading-none tabular-nums",children:e.jsx(tt,{value:t.idle_rate})})}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Pasywne tempo zdobywania punktów."})]}),e.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Twoje punkty"}),e.jsx(nt,{className:"h-4 w-4 text-primary"})]}),e.jsxs("div",{className:"mt-2 flex items-end gap-2",children:[e.jsx("span",{className:"text-4xl md:text-5xl font-semibold text-primary leading-none tabular-nums",children:e.jsx(tt,{value:t.points})}),e.jsx("span",{className:"mb-[2px] text-sm text-muted-foreground",children:"pkt"})]}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Wydaj je na ulepszenia poniżej."})]}),e.jsxs("div",{className:"rounded-xl border bg-card p-5 shadow-soft",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Do kolejnego poziomu"}),e.jsx(pi,{className:"h-4 w-4 text-secondary"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(zn,{value:t.points%100})}),e.jsxs("p",{className:"mt-1 text-xs text-muted-foreground",children:["Pozostało ",100-t.points%100," pkt"]})]})]})]})})]}),e.jsxs(ke.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between gap-4",children:e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-semibold tracking-tight",children:"Dostępne ulepszenia"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Wybierz i zwiększ swoje tempo zdobywania punktów."})]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 sm:gap-5",children:[i&&Array.from({length:6}).map((l,c)=>e.jsx(S_,{},c)),!i&&o.map((l,c)=>{const d=t.points>=l.next_cost,m=z_[l.icon]||nt;return e.jsxs(zi,{index:c,className:$("group relative rounded-2xl border bg-card p-5 shadow-soft hover:bg-muted/40 transition-colors"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-muted flex items-center justify-center shrink-0",children:e.jsx(m,{className:"w-6 h-6 text-muted-foreground"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:l.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Poziom ",l.current_level]})]})]}),e.jsx("span",{className:$("inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-[11px] font-semibold border",d?"border-primary/30 text-primary":"border-muted-foreground/25 text-muted-foreground"),children:d?"Dostępne":"Za drogie"})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Aktualny bonus"}),e.jsxs("span",{className:"font-medium text-green-600 dark:text-green-400",children:["+",e.jsx(tt,{value:l.total_bonus})," pkt/h"]})]}),e.jsxs("div",{className:"flex justify-between text-xs sm:text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Następny poziom"}),e.jsxs("span",{className:"font-medium",children:["+",l.bonus_per_level," pkt/h"]})]})]}),e.jsxs(ke.button,{whileHover:d?{scale:1.02}:{},whileTap:d?{scale:.98}:{},onClick:()=>a(l.id),disabled:!d,className:$("mt-4 w-full py-2.5 sm:py-3 rounded-lg font-medium focus-ring transition-colors",d?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-muted text-muted-foreground cursor-not-allowed"),title:d?"Kup ulepszenie":"Brakuje punktów",children:["Ulepsz za ",e.jsx(tt,{value:l.next_cost})," pkt"]})]},l.id)})]})]})]})},T_=[e.jsx(V,{path:"/gamification",element:e.jsx(C_,{})},"gamification")],A_=()=>e.jsx("div",{className:"rounded-2xl border bg-card p-4 shadow-soft animate-pulse",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-8 h-5 rounded bg-muted/60"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-muted/70"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 w-40 rounded bg-muted/60"}),e.jsx("div",{className:"mt-2 h-3 w-28 rounded bg-muted/50"})]}),e.jsx("div",{className:"h-5 w-16 rounded bg-muted/60"})]})}),__=()=>{const{data:t}=gt(),[s,n]=te.useState("all"),{data:i,isLoading:r,refetch:a,error:o}=Kr("get_leaderboard",{p_limit:20,p_filter:s});te.useEffect(()=>{let d=!1,m=!1;return(async()=>{if(!(d||m)){m=!0;try{await a()}finally{m=!1}}})(),()=>{d=!0}},[s]);const l=i||[],c=d=>{switch(d){case 1:return e.jsx($e,{className:"w-5 h-5 text-yellow-500"});case 2:return e.jsx(Oh,{className:"w-5 h-5 text-gray-400"});case 3:return e.jsx(yn,{className:"w-5 h-5 text-orange-500"});default:return e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:d})}};return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),e.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Ranking"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Top 20 użytkowników według punktów."})]}),e.jsx("div",{className:"bg-muted rounded-lg p-1 inline-flex gap-1",children:[{value:"all",label:"Wszyscy"},{value:"students",label:"Uczniowie"},{value:"teachers",label:"Nauczyciele"}].map(d=>e.jsx("button",{onClick:()=>n(d.value),className:$("px-3 sm:px-4 py-1.5 rounded-md text-sm font-medium transition-colors",s===d.value?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:d.label},d.value))})]})})]}),e.jsxs(ke.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"space-y-2",children:[r&&Array.from({length:4}).map((d,m)=>e.jsx(A_,{},m)),!r&&(o||l.length===0)&&e.jsxs("div",{className:"rounded-2xl border bg-card p-8 text-center shadow-soft",children:[e.jsx("div",{className:"text-4xl",children:"🥲"}),e.jsx("h4",{className:"mt-3 text-base sm:text-lg font-semibold",children:"Brak wyników"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:o?"Nie udało się pobrać rankingu.":"Brak danych dla wybranego filtra."}),e.jsxs("button",{onClick:()=>a(),className:"mt-4 inline-flex items-center gap-2 rounded-lg border px-3 py-2 text-sm hover:bg-primary/5 focus-ring",children:[e.jsx(eb,{className:"w-4 h-4"}),"Spróbuj ponownie"]})]}),!r&&l.length>0&&l.map((d,m)=>{const u=d.user_id===t?.id,h=d.rank<=3;return e.jsxs(zi,{index:m,className:$("flex items-center gap-4 p-4 rounded-2xl border shadow-soft transition-colors",u?"bg-primary text-primary-foreground border-primary/40":h?"bg-muted/50 border-border":"bg-card hover:bg-muted/40 border-border"),children:[e.jsx("div",{className:"w-8 flex justify-center",children:c(d.rank)}),e.jsx("div",{className:$("w-10 h-10 rounded-full flex items-center justify-center font-semibold shrink-0",u?"bg-primary-foreground text-primary":h?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),"aria-label":`Avatar użytkownika ${d.full_name||"Użytkownik"}`,title:d.full_name||"Użytkownik",children:d.full_name?.charAt(0)??"U"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-medium truncate",children:[d.full_name||"Użytkownik",u&&e.jsx("span",{className:"ml-2 text-sm opacity-80",children:"(Ty)"})]}),e.jsxs("div",{className:$("text-sm",u?"text-primary-foreground/80":"text-muted-foreground"),children:["Poziom ",d.level," • Seria ",d.streak," dni"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-semibold tabular-nums",children:e.jsx(tt,{value:d.points})}),e.jsx("div",{className:$("text-xs",u?"text-primary-foreground/80":"text-muted-foreground"),children:"punktów"})]})]},d.user_id||`${d.rank}-${m}`)})]})]})},P_=[e.jsx(V,{path:"/leaderboard",element:e.jsx(__,{})},"leaderboard")],Fi=[{id:1,icon:ls,title:"Pierwszy Krok",description:"Ukończ pierwszą lekcję",unlocked:!0,rarity:"common",unlockedAt:"2024-01-15",progress:100},{id:2,icon:wn,title:"Perfekcjonista",description:"Zdobądź 100% w 10 quizach",unlocked:!0,rarity:"rare",unlockedAt:"2024-02-20",progress:100},{id:3,icon:nt,title:"Błyskawica",description:"Ukończ 5 lekcji w jeden dzień",unlocked:!1,rarity:"epic",progress:60},{id:4,icon:$e,title:"Mistrz",description:"Osiągnij poziom 50",unlocked:!1,rarity:"legendary",progress:24},{id:5,icon:ze,title:"Snajper",description:"Odpowiedz poprawnie na 100 pytań z rzędu",unlocked:!1,rarity:"epic",progress:45},{id:6,icon:pi,title:"Rakieta",description:"Ukończ kurs w mniej niż tydzień",unlocked:!1,rarity:"rare",progress:0}],eh={common:{bg:"bg-muted",ring:"ring-1 ring-border",label:"Pospolite",badge:"border border-muted-foreground/20 text-muted-foreground bg-background/60"},rare:{bg:"bg-blue-500/10",ring:"ring-1 ring-blue-500/30",label:"Rzadkie",badge:"border border-blue-500/30 text-blue-600 dark:text-blue-400"},epic:{bg:"bg-purple-500/10",ring:"ring-1 ring-purple-500/30",label:"Epiczne",badge:"border border-purple-500/30 text-purple-600 dark:text-purple-400"},legendary:{bg:"bg-orange-500/10",ring:"ring-1 ring-orange-500/30",label:"Legendarne",badge:"border border-orange-500/30 text-orange-600 dark:text-orange-400"}},D_=()=>{const t=Fi.filter(i=>i.unlocked).length,s=Fi.length,n=Math.round(t/s*100);return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),e.jsxs("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:"Osiągnięcia"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Odblokowano"," ",e.jsx("span",{className:"font-semibold tabular-nums",children:t})," ","z"," ",e.jsx("span",{className:"font-semibold tabular-nums",children:s})," ","(",n,"%)"]})]}),e.jsxs("div",{className:"w-full md:w-96",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1.5",children:[e.jsx("span",{className:"text-muted-foreground",children:"Postęp osiągnięć"}),e.jsxs("span",{className:"font-medium tabular-nums",children:[n,"%"]})]}),e.jsx(zn,{value:n})]})]}),e.jsx("div",{className:"mt-4 grid grid-cols-2 sm:grid-cols-4 gap-2",children:Object.entries(eh).map(([i,r])=>{const a=Fi.filter(l=>l.rarity===i&&l.unlocked).length,o=Fi.filter(l=>l.rarity===i).length;return e.jsxs("div",{className:$("rounded-xl border bg-card/70 backdrop-blur-sm p-3 shadow-soft"),children:[e.jsxs("p",{className:"text-lg font-semibold tabular-nums",children:[a,"/",o]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.label})]},i)})})]})]}),e.jsx(ke.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-5",children:Fi.map((i,r)=>{const a=eh[i.rarity],o=i.icon,l=i.unlocked?e.jsx("span",{className:$("inline-flex items-center gap-1 rounded-full px-2.5 py-1 text-[11px] font-semibold",a.badge),children:"Odblokowane"}):e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-primary/30 text-primary px-2.5 py-1 text-[11px] font-semibold",children:[i.progress,"%"]});return e.jsxs(zi,{index:r,className:$("group relative rounded-2xl border bg-card p-5 shadow-soft hover:bg-muted/40 transition-colors",!i.unlocked&&"opacity-95"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:$("w-12 h-12 rounded-xl flex items-center justify-center shrink-0",a.bg,a.ring),children:e.jsx(o,{className:"w-6 h-6"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm sm:text-base text-foreground line-clamp-2",children:i.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:i.description})]})]}),l]}),e.jsx("div",{className:"mt-4",children:i.unlocked?e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Odblokowano:"," ",e.jsx("span",{className:"font-medium",children:new Date(i.unlockedAt).toLocaleDateString("pl-PL")})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Postęp"}),e.jsxs("span",{className:"font-medium tabular-nums",children:[i.progress,"%"]})]}),e.jsx(zn,{value:i.progress})]})})]},i.id)})})]})},I_=[e.jsx(V,{path:"/achievements",element:e.jsx(D_,{})},"achievements")],M_=()=>{const{data:t}=gt(),{stats:s}=Wr(),n=t?.full_name||t?.name||t?.email||"Użytkownik",i=(t?.full_name||t?.name||"U").split(" ").map(o=>o[0]).slice(0,2).join("").toUpperCase()||"U",r=(()=>{const o=t?.created_at;return(o?new Date(o):new Date).toLocaleDateString("pl-PL")})(),a=[{icon:$e,label:"Punkty",value:s.points,iconColor:"text-primary",highlight:"primary",counter:!0},{icon:ze,label:"Ukończone quizy",value:s.quizzes_completed??0,iconColor:"text-green-600 dark:text-green-400",counter:!1},{icon:wn,label:"Perfekcyjne wyniki",value:s.perfect_scores??0,iconColor:"text-yellow-600 dark:text-yellow-400",counter:!1},{icon:ls,label:"Najdłuższa seria",value:`${s.streak??0} dni`,iconColor:"text-destructive",counter:!1},{icon:Se,label:"Czas nauki",value:`${Math.max(0,Math.floor((s.total_time??0)/60))}h`,iconColor:"text-blue-600 dark:text-blue-400",counter:!1},{icon:$e,label:"Poziom",value:`Poziom ${s.level??1}`,iconColor:"text-secondary",counter:!1}];return e.jsxs("div",{className:"container mx-auto px-4 py-6 sm:py-8 space-y-6 sm:space-y-8 pb-24 lg:pb-8",children:[e.jsxs(ke.section,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.45},className:"relative overflow-hidden rounded-2xl border",children:[e.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.12] via-secondary/[0.10] to-accent/[0.12]"}),e.jsx("div",{className:"absolute inset-0 opacity-[0.06]",style:{backgroundImage:`
                linear-gradient(to right, hsl(var(--ring)/0.35) 1px, transparent 1px),
                linear-gradient(to bottom, hsl(var(--ring)/0.35) 1px, transparent 1px)
              `,backgroundSize:"28px 28px"}})]}),e.jsx("div",{className:"relative z-10 p-4 sm:p-6 md:p-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:[e.jsxs("div",{className:"flex items-start gap-4 sm:gap-6",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-2xl bg-primary text-primary-foreground flex items-center justify-center text-xl sm:text-2xl font-semibold shadow-soft",children:i}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight",children:n}),e.jsxs("div",{className:"mt-1 flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-muted-foreground",children:[t?.email&&e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(Cr,{className:"w-4 h-4 shrink-0"}),e.jsx("span",{className:"truncate",children:t.email})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Kt,{className:"w-4 h-4"}),e.jsxs("span",{children:["Dołączył ",r]})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("button",{className:"inline-flex items-center gap-2 rounded-lg border px-3 py-2 text-sm hover:bg-primary/5 focus-ring",children:[e.jsx(tb,{className:"w-4 h-4"}),"Edytuj profil"]}),e.jsx("button",{className:"inline-flex items-center gap-2 rounded-lg bg-primary px-3 py-2 text-sm text-primary-foreground hover:bg-primary/90 focus-ring",children:"Ustawienia"})]})]})})]}),e.jsxs(ke.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.05},children:[e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-semibold tracking-tight mb-4",children:"Statystyki"}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-5",children:a.map((o,l)=>{const c=o.icon;return e.jsx(zi,{index:l,className:"group relative rounded-2xl border bg-card p-5 shadow-soft hover:bg-muted/40 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-muted flex items-center justify-center shrink-0",children:e.jsx(c,{className:`w-6 h-6 ${o.iconColor}`})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:`text-2xl font-semibold leading-none tabular-nums ${o.highlight==="primary"?"text-primary":o.highlight==="secondary"?"text-secondary":o.highlight==="accent"?"text-accent":"text-foreground"}`,children:o.counter?e.jsx(tt,{value:Number(o.value)}):o.value}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:o.label})]})]})},o.label)})})]}),e.jsxs(ke.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.4,delay:.08},className:"space-y-4",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-semibold tracking-tight",children:"Ustawienia"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap gap-3",children:[e.jsx(ke.button,{whileHover:{x:2},whileTap:{scale:.98},className:"w-full sm:w-auto sm:min-w-[220px] inline-flex items-center justify-center rounded-xl bg-primary text-primary-foreground px-4 py-3 shadow-soft hover:bg-primary/90 focus-ring",children:e.jsxs("span",{className:"inline-flex items-center gap-2 font-medium",children:[e.jsx(rr,{className:"w-4 h-4"}),"Zmień hasło"]})}),e.jsx(ke.button,{whileHover:{x:2},whileTap:{scale:.98},className:"w-full sm:w-auto sm:min-w-[220px] inline-flex items-center justify-center rounded-xl bg-secondary text-white px-4 py-3 shadow-soft hover:opacity-95 focus-ring",children:e.jsxs("span",{className:"inline-flex items-center gap-2 font-medium",children:[e.jsx(Rh,{className:"w-4 h-4"}),"Ustawienia powiadomień"]})}),e.jsx(ke.button,{whileHover:{x:2},whileTap:{scale:.98},className:"w-full sm:w-auto sm:min-w-[220px] inline-flex items-center justify-center rounded-xl bg-destructive text-white px-4 py-3 shadow-soft hover:bg-destructive/90 focus-ring",children:e.jsxs("span",{className:"inline-flex items-center gap-2 font-medium",children:[e.jsx(xs,{className:"w-4 h-4"}),"Usuń konto"]})})]})]})]})},E_=[e.jsx(V,{path:"/profile",element:e.jsx(M_,{})},"profile")],L_=[...Z4,...J4,...sA,...w_,...k_,...T_,...P_,...I_,...E_],O_=()=>e.jsx(sc,{children:e.jsxs(V,{element:e.jsx(dS,{children:e.jsx(Ch,{})}),children:[e.jsx(V,{index:!0,element:e.jsx(Qs,{to:"dashboard",replace:!0})}),L_]})}),R_=g.lazy(()=>Promise.resolve({default:O_})),jj=({text:t,colorClass:s})=>e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`inline-block h-12 w-12 animate-spin rounded-full border-4 border-current border-r-transparent ${s}`}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:t})]})}),$_=({children:t})=>{const{data:s,isLoading:n}=gt();return n||!s?e.jsx(jj,{text:"Sprawdzanie uprawnień...",colorClass:"border-blue-600"}):s.role!=="student"?e.jsx(Qs,{to:"/teacher/dashboard/overview",replace:!0}):e.jsx(e.Fragment,{children:t})},q_=e.jsx(V,{path:"/student/*",element:e.jsx(Ph,{fallback:e.jsx(Dh,{to:"/login"}),children:e.jsx($_,{children:e.jsx(g.Suspense,{fallback:e.jsx(jj,{text:"Ładowanie panelu ucznia...",colorClass:"border-blue-600"}),children:e.jsx(R_,{})})})},"student-auth")}),F_={name:"dashboard",list:"/teacher/dashboard/overview",meta:{label:"Zasoby edukacyjne",icon:e.jsx(xe,{className:"h-4 w-4"})}},B_={name:"ai-tools",list:"/teacher/ai-tools",meta:{label:"Narzędzia AI",icon:e.jsx(lt,{className:"h-4 w-4"})}},U_=[F_,{...au,meta:{...au.meta,parent:"dashboard",label:"Kursy"}},{...ou,meta:{...ou.meta,parent:"dashboard",label:"Tematy"}},{...fu,meta:{...fu.meta,parent:"dashboard",hide:!0}},{...xu,meta:{...xu.meta,parent:"dashboard",label:"Grupy"}},B_,{...Nu,list:"/teacher/course-structure",meta:{...Nu.meta,parent:"ai-tools"}},{...ku,list:"/teacher/educational-material",meta:{...ku.meta,parent:"ai-tools"}},{...zu,list:"/teacher/quiz-wizard",meta:{...zu.meta,parent:"ai-tools"}},i1,o1,x1,{...ju,meta:{...ju.meta,parent:"reports"}},{...yu,meta:{...yu.meta,parent:"reports"}},{...bu,meta:{...bu.meta,parent:"reports"}},{...wu,meta:{...wu.meta,parent:"reports"}},{...vu,meta:{...vu.meta,parent:"reports"}}],V_={name:"student-root",meta:{label:"Panel ucznia",route:"/student/dashboard/overview"}},W_=[V_],K_=new ky({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:!1,staleTime:300*1e3}}});function G_({children:t}){const{pathname:s}=kr(),n=s.split("/")[1],i=n==="teacher"?U_:n==="student"?W_:[];return e.jsx(Sy,{dataProvider:Ay(ue),authProvider:Nb,routerProvider:Cy,resources:i,options:{syncWithLocation:!0,warnWhenUnsavedChanges:!1,useNewQueryKeys:!0,disableTelemetry:!0},children:t})}function H_(){return e.jsx(zy,{client:K_,children:e.jsx(my,{children:e.jsx(G_,{children:e.jsxs(sc,{children:[e.jsx(V,{path:"/",element:e.jsx(_b,{})}),Gh,Eb,Rb,Fb,aS,q_,e.jsx(V,{path:"/admin/*",element:e.jsx(Qs,{to:"/teacher",replace:!0})}),e.jsx(V,{path:"*",element:e.jsx(Qs,{to:"/",replace:!0})})]})})})})}const Q_=document.getElementById("root"),Z_=pb.createRoot(Q_);Z_.render(e.jsxs(te.StrictMode,{children:[e.jsx(H_,{}),e.jsx(wy,{position:"top-right",richColors:!0,closeButton:!0,duration:4e3,toastOptions:{style:{width:"500px",fontSize:"20px"},className:"sonner-toast"}})]}));export{ge as A,I as B,_ as C,bs as F,Q as I,ve as L,je as a,O as b,L as c,Me as d,P as e,se as f,ws as g,re as h,Wh as i,Uh as l,Vh as r,ue as s,Kh as u};
