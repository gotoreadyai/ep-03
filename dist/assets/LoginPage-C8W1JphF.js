import{j as e}from"./radix-ui-Cgpwho7y.js";import{w as b,n as f}from"./refine-core-DEHLOwib.js";import{N as v}from"./NarrowCol-7sHlIIuA.js";import{A as N,a as y,C as z,b as C,c as L,d as k,e as S,F as E,f as j,I as p,g as F,B as M,l as P}from"./index-BWz2Jlbk.js";import{R as m,L as h,e as A,o as I,N as B}from"./react-vendor-mGmSsCi4.js";import{a1 as R,ai as Z,ad as D,M as H,R as T,aw as V}from"./ui-utils-s4wUxX08.js";import"./utils-Cjzj2mLR.js";import"./refine-ui-2CGAdPi0.js";import"./forms-twLHWMUg.js";import"./tables-D-JVthzY.js";const w=({children:s})=>e.jsx(v,{children:s}),g=({title:s,message:a})=>e.jsxs(N,{className:"mb-4 border-green-200 bg-green-50",children:[e.jsx(R,{className:"h-4 w-4 text-green-600"}),e.jsxs(y,{className:"text-green-800",children:[e.jsx("strong",{children:s})," ",a]})]}),W=({error:s})=>{const a=()=>s.includes("nie zostaÅ‚ potwierdzony")?"warning":"destructive",n=()=>s.includes("nie zostaÅ‚ potwierdzony")?Z:D;return e.jsxs(N,{variant:a(),children:[m.createElement(n(),{className:"h-4 w-4"}),e.jsxs(y,{children:[e.jsx("strong",{children:"BÅ‚Ä…d logowania:"})," ",s,s.includes("nie zostaÅ‚ potwierdzony")&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsxs("p",{children:["ðŸ’¡ ",e.jsx("strong",{children:"Co robiÄ‡:"})]}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[e.jsx("li",{children:"SprawdÅº swojÄ… skrzynkÄ™ email (takÅ¼e spam)"}),e.jsx("li",{children:"Kliknij link aktywacyjny w emailu"}),e.jsxs("li",{children:["JeÅ›li nie otrzymaÅ‚eÅ› emaila, moÅ¼esz"," ",e.jsx(h,{to:"/resend-confirmation",className:"underline",children:"wysÅ‚aÄ‡ ponownie"})]})]})]}),s.includes("NieprawidÅ‚owe dane")&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsxs("p",{children:["ðŸ’¡ ",e.jsx("strong",{children:"SprawdÅº:"})]}),e.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[e.jsx("li",{children:"Czy email jest wpisany poprawnie"}),e.jsx("li",{children:"Czy hasÅ‚o jest poprawne (uwaga na wielkoÅ›Ä‡ liter)"}),e.jsx("li",{children:"Czy masz juÅ¼ zaÅ‚oÅ¼one konto"})]})]})]})]})},q=({email:s,password:a,setEmail:n,setPassword:t,isLoading:i,error:r,handleSubmit:o,isFormValid:c,showVerifiedMessage:l,showPasswordChangedMessage:u})=>e.jsxs(z,{children:[e.jsxs(C,{className:"space-y-1",children:[e.jsx(L,{className:"text-2xl text-center",children:"Zaloguj siÄ™"}),e.jsx(k,{className:"text-center",children:"WprowadÅº swoje dane aby siÄ™ zalogowaÄ‡"})]}),e.jsxs(S,{children:[l&&e.jsx(g,{title:"Email potwierdzony!",message:"MoÅ¼esz siÄ™ teraz zalogowaÄ‡."}),u&&e.jsx(g,{title:"HasÅ‚o zmienione!",message:"MoÅ¼esz siÄ™ zalogowaÄ‡ uÅ¼ywajÄ…c nowego hasÅ‚a."}),e.jsxs(E,{onSubmit:o,children:[e.jsx(j,{label:e.jsxs("span",{className:"flex items-center",children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Email"]}),htmlFor:"email",error:r?.toLowerCase().includes("email")?"SprawdÅº poprawnoÅ›Ä‡ adresu email":void 0,required:!0,children:e.jsx(p,{id:"email",type:"email",placeholder:"przykÅ‚ad@email.com",value:s,onChange:d=>n(d.target.value),disabled:i,className:r?.toLowerCase().includes("email")?"border-red-500":""})}),e.jsx(j,{label:e.jsxs("span",{className:"flex items-center",children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"HasÅ‚o"]}),htmlFor:"password",error:r?.toLowerCase().includes("hasÅ‚o")?"SprawdÅº poprawnoÅ›Ä‡ hasÅ‚a":void 0,required:!0,children:e.jsx(p,{id:"password",type:"password",placeholder:"WprowadÅº hasÅ‚o",value:a,onChange:d=>t(d.target.value),disabled:i,className:r?.toLowerCase().includes("hasÅ‚o")?"border-red-500":""})}),r&&e.jsx(W,{error:r}),e.jsx(F,{className:"!border-0 !pt-0 justify-center",children:e.jsxs(M,{type:"submit",className:"w-full",disabled:i||!c,children:[i&&e.jsx(V,{className:"mr-2 h-4 w-4 animate-spin"}),i?"Logowanie...":"Zaloguj siÄ™"]})})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx("div",{className:"text-center text-sm",children:e.jsx(h,{to:"/register/step1",className:"text-blue-600 hover:text-blue-500 transition-colors",children:"Nie masz konta? Zarejestruj siÄ™"})}),e.jsx("div",{className:"text-center text-sm",children:e.jsx(h,{to:"/forgot-password",className:"text-blue-600 hover:text-blue-500 transition-colors",children:"ZapomniaÅ‚eÅ› hasÅ‚a?"})}),e.jsx("div",{className:"border-t pt-4 mt-4",children:e.jsxs("div",{className:"text-center text-xs text-gray-500",children:[e.jsx("p",{children:"Problemy z logowaniem?"}),e.jsx(h,{to:"/contact",className:"text-blue-600 hover:text-blue-500 transition-colors",children:"Skontaktuj siÄ™ z pomocÄ… technicznÄ…"})]})})]})]})]}),J=()=>{const s=A(),[a,n]=m.useState(""),[t,i]=m.useState(""),[r,o]=m.useState(null),[c,l]=m.useState(!1);return{email:a,password:t,setEmail:n,setPassword:i,isLoading:c,error:r,handleSubmit:async d=>{if(d.preventDefault(),!a.trim()||!t.trim()){o("WypeÅ‚nij wszystkie pola");return}o(null),l(!0);const x=await P.login(a,t);l(!1),x.success?s(x.redirectTo||"/"):o(x.error)},isFormValid:a.trim().length>0&&t.length>0}},se=()=>{const[s]=I(),{data:a,isLoading:n}=b(),{data:t,isLoading:i}=f(),r=J(),o=s.get("verified")==="true",c=s.get("passwordChanged")==="true";if(n||i)return e.jsx(w,{children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});if(a&&t){const l=t.role==="teacher"||t.role==="admin"?"/teacher/dashboard/overview":t.role==="student"?"/student/dashboard":"/profiles";return e.jsx(B,{to:l,replace:!0})}return e.jsx(w,{children:e.jsx(q,{...r,showVerifiedMessage:o,showPasswordChangedMessage:c})})};export{se as default};
